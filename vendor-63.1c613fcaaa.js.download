"use strict";(window.webpackChunkweb=window.webpackChunkweb||[]).push([["89585"],{54326:function(e,t,s){s.d(t,{dT:()=>n,k3B:()=>a,oc6:()=>r});let a="emoji_show_fallback",r="public_reaction_panel_select_view",n="public_reaction_panel_select_click"},559034:function(e,t,s){s.d(t,{pM:()=>T,rh:()=>h.TraceFlags,tw:()=>l,J:()=>L,yP:()=>m.CanonicalCode,Dx:()=>o,in:()=>g,ZP:()=>C}),(r=o||(o={}))[r.SUCCESS=0]="SUCCESS",r[r.FAILED_NOT_RETRYABLE=1]="FAILED_NOT_RETRYABLE",r[r.FAILED_RETRYABLE=2]="FAILED_RETRYABLE",(n=l||(l={})).Event="event",n.Log="log",n.Metric="metric",n.Tracing="tracing",(i=g||(g={}))[i.Debug=0]="Debug",i[i.Info=1]="Info",i[i.Warn=2]="Warn",i[i.Error=3]="Error",i[i.Fatal=4]="Fatal";var a,r,n,i,o,l,g,c,h=s(226649),u=s(157990),m=s(850562);function p(e){var t;return e&&Array.isArray(t=e)&&2===t.length?1e3*e[0]+e[1]/1e6:e}class f{constructor(){this.attributes={lib:"@lark/acelogger@0.9.2",logger:"acelogger",spanKind:u.SpanKind.INTERNAL,spanName:"unknown"}}setAttributes(e){Object.assign(this.attributes,e)}getAttributes(){return this.attributes}debug(e,t){this.innerLog(Object.assign({},t,{level:g.Debug,message:e,name:"log.debug",type:l.Log}))}info(e,t){this.innerLog(Object.assign({},t,{level:g.Info,message:e,name:"log.info",type:l.Log}))}warn(e,t){this.innerLog(Object.assign({},t,{level:g.Warn,message:e,name:"log.warn",type:l.Log}))}error(e,t){let s="",a="";e instanceof Error?(s=e.message,a=e.stack):s=e,this.innerLog(Object.assign({},t,{level:g.Error,message:s,name:"log.error",stack:a,type:l.Log}))}fatal(e,t){let s="",a="";e instanceof Error?(s=e.message,a=e.stack):s=e,this.innerLog(Object.assign({},t,{level:g.Fatal,message:s,name:"log.fatal",stack:a,type:l.Log}))}storeMetrics(e){let t=e.message?`, ${e.message}`:"";this.innerLog(Object.assign({},e,{level:e.level||g.Debug,message:`store ${JSON.stringify(e.metrics)}${t}`,name:"metric.store",type:l.Metric}))}event(e,t){let s=Object.assign({},t,{level:g.Info,message:t&&t.message||`log event: ${e}`,name:e,type:l.Event});this.innerLog(s)}startSpan(e,t){let s=this.span?Object.assign({},t,{parent:this.span.context}):t,a=this.manager.tracer.createSpan(e,s),r=new f;return r.span=a,r.manager=this.manager,r.setAttributes(Object.assign({},this.attributes,a.attributes,{spanKind:a.kind,spanName:a.name})),s&&!0===s.logStart&&r.innerLog({data:s&&s.data,level:g.Info,message:`${a.name}.start`,metrics:{[`${a.name}.start.latency`]:a.startTime-a.userStartTime},name:`${a.name}.start`,type:l.Tracing}),r}endSpan(e){if(!this.span)return void this.error(Error("logger.endSpan must call after logger.startSpan"));let t=Object.assign({},e,{name:`${this.span.name}.end`,type:l.Tracing});t.level=t.level||g.Info,this.span.endTime=p(t.time)||this.manager.timer.now();let s=this.span.endTime-this.span.startTime;t.metrics=Object.assign({},{[`${this.span.name}.duration`]:s},t.metrics);let a=t.message?`, ${t.message}`:"";t.message=`${this.span.name} end with ${s}ms${a}`,this.innerLog(t)}flush(e){this.manager.flush(e)}innerLog(e){let t=e.traceFlags||h.TraceFlags.NONE,s=Object.assign({},{spanId:"0",traceId:"0"},e.data),a=Object.assign({},this.attributes,e.attributes);this.span&&((void 0===e.traceFlags||null===e.traceFlags)&&(t=this.span.context.traceFlags),s.spanId=this.span.context.spanId,s.traceId=this.span.context.traceId,a.spanName=this.span.name,a.spanKind=this.span.kind);let r=e.status||m.CanonicalCode.OK,n=Math.max(function(e){switch(e){case m.CanonicalCode.OK:return g.Debug;case m.CanonicalCode.INTERNAL:case m.CanonicalCode.RESOURCE_EXHAUSTED:case m.CanonicalCode.UNAVAILABLE:return g.Error;default:return g.Warn}}(r),e.level),i=e.time||this.manager.timer.now(),o="number"==typeof e.samplingRate?e.samplingRate:1;this.manager.addEvent({attributes:a,data:s,level:n,message:e.message,metrics:e.metrics,name:e.name,samplingRate:o,stack:e.stack,status:r,time:i,traceFlags:t,type:e.type})}}let d={$rootSpan:0};class b{constructor(){this.data={startTime:Date.now()}}toJSON(){return this.data}createSpanContext(e){var t;let s,a=Object.assign({},e),r=a.traceId||Math.random().toString(32).substring(2,8)+Math.random().toString(32).substring(2,8);return{isRemote:a.isRemote,spanId:(s=(t=a.spanId)?d[t]?d[t]=d[t]+1:d[t]=1:d.$rootSpan=d.$rootSpan+1,t?`${t}.${s}`:`${r}-${s}`),traceFlags:a.traceFlags||h.TraceFlags.NONE,traceId:r,traceState:a.traceState}}createSpan(e,t){let s=t||{},a=this.manager.timer.now(),r=p(s.startTime)||a;return{attributes:s.attributes,context:this.createSpanContext(s.parent),endTime:0,kind:s.kind||u.SpanKind.INTERNAL,name:e,parentContext:s.parent,startTime:a,userStartTime:r}}start(e){this.data.startTime=p(e)||this.manager.timer.now()}end(e){this.data.endTime=p(e)||this.manager.timer.now()}}let E={now:()=>Date.now()};(a=c||(c={})).Logger="logger",a.Tracer="tracer",a.Timer="timer";class T{constructor(e){this.eventBuffer=new Map,this.registries=new Map,this.exporterMap=new Map,this.bufferCount=0,this.bufferSize=10,this.flushDelay=0,this.defaultLogger=new f,this.defaultLogger.manager=this,this.defaultTracer=new b,this.defaultTracer.manager=this,e&&e.flushDelay&&(this.flushDelay=e&&e.flushDelay)}setLogger(e){this.registries.set("logger",e),e&&(e.manager=this)}get logger(){return this.registries.get(c.Logger)||this.defaultLogger}setTracer(e){this.registries.set("tracer",e),e&&(e.manager=this)}get tracer(){return this.registries.get(c.Tracer)||this.defaultTracer}setTimer(e){this.registries.set(c.Timer,e)}get timer(){return this.registries.get(c.Timer)||E}setBufferSize(e){this.bufferSize=e}setExporter(e,t){return Object.keys(g).forEach(s=>{let a=g[s];if("number"==typeof a&&a>=e){let e=this.exporterMap.get(a)||[];e.push(t),this.exporterMap.set(a,e)}}),this}addEvent(e){let t=this.eventBuffer.get(e.level)||[];return t.push(e),this.bufferCount++,this.eventBuffer.set(e.level,t),this.bufferCount>=this.bufferSize&&this.flush(),this}flush(e){this.flushTimer||(this.flushTimer=setTimeout(()=>{this.eventBuffer.forEach((e,t)=>{this.export(t,e)}),this.eventBuffer=new Map,this.bufferCount=0,this.flushTimer=null,e&&e()},this.flushDelay))}get flushing(){return!!this.flushTimer}export(e,t){try{let s=this.exporterMap.get(e);s&&s.forEach(e=>{e.export(t,e=>{e!==o.SUCCESS&&console.error(`Failed export event with ${e===o.FAILED_NOT_RETRYABLE?"no":""} retry`)})})}catch(e){console.error("Failed export events with error",e)}}}let w={[g.Debug]:"DEBUG",[g.Info]:"INFO",[g.Warn]:"WARN",[g.Error]:"ERROR"};function v(e){let t=(window.__ace_debug||"").split(",");(t.includes(e.attributes.spanName)||t.includes("*")||e.level>=g.Warn)&&function(e,t){if(e.level>=g.Error)return console.warn(...t(e));switch(e.level){case g.Debug:console.debug(...t(e));break;case g.Info:console.info(...t(e));break;case g.Warn:console.warn(...t(e));break;default:console.info(...t(e))}}(e,S)}function S(e){let t=e.level<g.Warn?"#bbbbbb":"#FF7043";return[`%c${w[e.level]} ${function(e){let t=e.attributes||{},s=t.spanName?"|"+t.spanName:"",a=t.spanId?"|"+t.spanId:"";return`${t.logger||""}${s}${a}`}(e)}`,`font-weight: bold; color: ${t};`,`"${e.message||"no message"}"`,e]}class L{constructor(){this.stoped=!1}export(e,t){!this.stoped&&(e.forEach(v),t&&t(o.SUCCESS))}shutdown(){this.stoped=!0}}s(173656);var C=new T}}]);