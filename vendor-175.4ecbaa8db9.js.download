"use strict";(window.webpackChunkweb=window.webpackChunkweb||[]).push([["14892"],{593666:function(t,e,o){o.d(e,{wh:()=>s,zf:()=>u});var l=o(364776),r=o(796241),i=o(20408),n=o(938794),a=o(254833);class h{constructor(t,e,o){this.table=t,this.customCellStyle=e,this.customCellStyleArrangement=o,this._customCellStyleArrangementIndex=new Map,this._customCellStyleArrangementTombstoneCount=0,this._rebuildCustomCellStyleArrangementIndex()}_getCustomCellStyleArrangementKey(t){if(t.range){let{start:e,end:o}=t.range;return`range:${e.col},${e.row},${o.col},${o.row}`}if(void 0!==t.col&&void 0!==t.row)return`cell:${t.col},${t.row}`}_rebuildCustomCellStyleArrangementIndex(){this._customCellStyleArrangementIndex.clear(),this._customCellStyleArrangementTombstoneCount=0;for(let t=0;t<this.customCellStyleArrangement.length;t++){if(!(0,l.Z)(this.customCellStyleArrangement[t].customStyleId)){this._customCellStyleArrangementTombstoneCount++;continue}let e=this._getCustomCellStyleArrangementKey(this.customCellStyleArrangement[t].cellPosition);e&&this._customCellStyleArrangementIndex.set(e,t)}}_compactCustomCellStyleArrangementIfNeeded(){let t=this.customCellStyleArrangement.length;if(this._customCellStyleArrangementTombstoneCount<2048||4*this._customCellStyleArrangementTombstoneCount<t)return;let e=this.customCellStyleArrangement.filter(t=>(0,l.Z)(t.customStyleId));e.length!==this.customCellStyleArrangement.length?(this.customCellStyleArrangement.length=0,this.customCellStyleArrangement.push(...e),this._rebuildCustomCellStyleArrangementIndex()):this._customCellStyleArrangementTombstoneCount=0}getCustomCellStyle(t,e){let o=this.getCustomCellStyleIds(t,e);if(o.length){let l=[];if(o.forEach(o=>{let i=this.getCustomCellStyleOption(o);if((0,r.Z)(null==i?void 0:i.style)){let o=i.style({col:t,row:e,table:this.table,value:this.table.getCellValue(t,e),dataValue:this.table.getCellOriginValue(t,e),cellHeaderPaths:this.table.getCellHeaderPaths(t,e)});l.push(o)}else(null==i?void 0:i.style)&&l.push(i.style)}),!l.length)return;return(0,i.Z)({},...l)}}getCustomCellStyleIds(t,e){let o=[],r=this.table.getCellRange(t,e);for(let t=r.start.col;t<=r.end.col;t++)for(let e=r.start.row;e<=r.end.row;e++)this.customCellStyleArrangement.forEach(r=>{(0,l.Z)(r.customStyleId)&&(r.cellPosition.range?r.cellPosition.range.start.col<=t&&r.cellPosition.range.end.col>=t&&r.cellPosition.range.start.row<=e&&r.cellPosition.range.end.row>=e&&o.push(r.customStyleId):r.cellPosition.col===t&&r.cellPosition.row===e&&o.push(r.customStyleId))});return o}getCustomCellStyleOption(t){return this.customCellStyle.find(e=>e.id===t)}registerCustomCellStyle(t,e){let o=this.customCellStyle.findIndex(e=>e.id===t);-1===o?this.customCellStyle.push({id:t,style:e}):this.customCellStyle[o]={id:t,style:e},this.customCellStyleArrangement.forEach(e=>{let o=e.cellPosition;if(e.customStyleId===t)if(o.range)for(let t=Math.max(0,o.range.start.col);t<=Math.min(this.table.colCount-1,o.range.end.col);t++)for(let e=Math.max(0,o.range.start.row);e<=Math.min(this.table.rowCount-1,o.range.end.row);e++)this.table.scenegraph.updateCellContent(t,e);else this.table.scenegraph.updateCellContent(o.col,o.row)}),this.table.scenegraph.updateNextFrame()}arrangeCustomCellStyle(t,e,o){var r,i;let a=this._getCustomCellStyleArrangementKey(t),h=a&&null!=(r=this._customCellStyleArrangementIndex.get(a))?r:-1;if(a&&-1!==h){let t=this.customCellStyleArrangement[h],e=t?this._getCustomCellStyleArrangementKey(t.cellPosition):void 0;t&&(0,l.Z)(t.customStyleId)&&e===a||(-1!==(h=this.customCellStyleArrangement.findIndex(t=>!!(0,l.Z)(t.customStyleId)&&this._getCustomCellStyleArrangementKey(t.cellPosition)===a))?this._customCellStyleArrangementIndex.set(a,h):this._customCellStyleArrangementIndex.delete(a))}if(-1!==h||a||(h=this.customCellStyleArrangement.findIndex(e=>!!(0,l.Z)(e.customStyleId)&&(e.cellPosition.range&&t.range?e.cellPosition.range.start.col===t.range.start.col&&e.cellPosition.range.start.row===t.range.start.row&&e.cellPosition.range.end.col===t.range.end.col&&e.cellPosition.range.end.row===t.range.end.row:e.cellPosition.col===t.col&&e.cellPosition.row===t.row))),-1===h&&!e)return;if(-1===h&&e){this.customCellStyleArrangement.push({cellPosition:{col:t.col,row:t.row,range:t.range},customStyleId:e});let o=this.customCellStyleArrangement.length-1,l=this._getCustomCellStyleArrangementKey(this.customCellStyleArrangement[o].cellPosition);l&&this._customCellStyleArrangementIndex.set(l,o)}else{if(this.customCellStyleArrangement[h].customStyleId===e)return;if(e)this.customCellStyleArrangement[h].customStyleId=e;else{let t=this._getCustomCellStyleArrangementKey(this.customCellStyleArrangement[h].cellPosition);(0,l.Z)(this.customCellStyleArrangement[h].customStyleId)&&this._customCellStyleArrangementTombstoneCount++,this.customCellStyleArrangement[h].customStyleId=null,t&&this._customCellStyleArrangementIndex.delete(t),this._compactCustomCellStyleArrangementIfNeeded()}}let s=e?null==(i=this.getCustomCellStyleOption(e))?void 0:i.style:void 0;if(s){for(let t in o=!0,s)if(-1===n.n.indexOf(t)){o=!1;break}}if(t.range)for(let e=Math.max(0,t.range.start.col);e<=Math.min(this.table.colCount-1,t.range.end.col);e++)for(let l=Math.max(0,t.range.start.row);l<=Math.min(this.table.rowCount-1,t.range.end.row);l++){let t=this.table.getCellRange(e,l);for(let e=t.start.col;e<=t.end.col;e++)for(let l=t.start.row;l<=t.end.row;l++)this.table.scenegraph.updateCellContent(e,l,o)}else this.table.scenegraph.updateCellContent(t.col,t.row,o);this.table.scenegraph.updateNextFrame()}updateCustomCell(t,e){this.customCellStyle.length=0,this.customCellStyleArrangement.length=0,this._customCellStyleArrangementIndex.clear(),this._customCellStyleArrangementTombstoneCount=0,t.forEach(t=>{this.registerCustomCellStyle(t.id,t.style)}),e.forEach(t=>{this.arrangeCustomCellStyle(t.cellPosition,t.customStyleId)})}hasCustomCellStyle(t){return this.customCellStyle.some(e=>e.id===t)}}function s(t,e){for(let o in t=t.clone(),e){let r=e[o];(0,l.Z)(r)&&(t[`_${o}`]=r)}return t}let u=()=>{a.F.registerComponent("customCellStylePlugin",h)}},162911:function(t,e,o){o.d(e,{t:()=>c});var l=o(695723),r=o(364776),i=o(788536),n=o(507388),a=o(669860),h=o(254833),s=o(170559);class u{constructor(t){this.titleRows=[],this.showedTitleRows=[],this.rowNow=-1,this.skipStartRow=-1,this.skipEndRow=-1,this.table=t,this.table.on("scroll",t=>{"vertical"===t.scrollDirection&&this.updateGroupTitle()}),this.table.on("tree_hierarchy_state_change",t=>{this.updateGroupTitle()}),this.table.on("resize_column",t=>{this.updateGroupTitle()})}updateGroupTitle(){0===this.table.scrollTop?(this.titleRows=[],this.showedTitleRows=[]):-1!==this.skipStartRow&&-1!==this.skipEndRow&&this.skipStartRow!==this.table.scenegraph.proxy.bodyTopRow-1?(this.table.scenegraph.proxy.screenTopRow<=this.skipStartRow||this.table.scenegraph.proxy.screenTopRow>=this.skipEndRow)&&(this.skipStartRow=-1,this.skipEndRow=-1,this.updateGroupTitleInfo()):(this.skipStartRow=-1,this.skipEndRow=-1,this.updateGroupTitleInfo()),this.updateScenegraph()}updateGroupTitleInfo(){this.rowNow=this.table.scenegraph.proxy.screenTopRow+this.titleRows.length;let t=this.table.getRecordIndexByCell(0,this.rowNow),e=this.table.getRecordIndexByCell(0,this.rowNow+1);this.getTitleRowsByRecordIndex(t,e)}getTitleRowsByRecordIndex(t,e){let o=[];(0,l.Z)(t)||(t=[t]),(0,l.Z)(e)||(e=[e]);for(let e=0;e<t.length;e++){let l=t.slice(0,e+1),r=this.table.dataSource.getRaw(l);o.push(r)}let r=[],i=e.length===t.length+1,n=t.slice(0,i?t.length:t.length-1),a=this.table.dataSource.currentIndexedData;for(let e=this.rowNow-this.table.columnHeaderLevelCount;e>=0;e--){let o=a[e];if((0,l.Z)(o)&&n.length===o.length){let t=!0;for(let e=0;e<o.length;e++)if(o[e]!==n[e]){t=!1;break}t&&(r.push(e+this.table.columnHeaderLevelCount),n=n.slice(0,n.length-1))}else if(o===t[0]){r.push(e+this.table.columnHeaderLevelCount);break}}this.titleRows=r.reverse()}updateScenegraph(){let{table:t}=this,{shadowGroup:e,shadowGroupFrozen:o}=function(t){let e=t.scenegraph.colHeaderGroup,o=t.scenegraph.cornerHeaderGroup;if(!e.border){let o=(0,a.f)({x:0,y:0,width:0,height:0,cursor:"pointer"});e.add(o),e.border=o,o.attachShadow(o.shadowRoot),o.name="border-rect",o.addEventListener("click",e=>{let o=t.listTreeStickCellPlugin.titleRows,{shadowTarget:l}=e.pickParams,{col:r,row:i}=(0,s.J$)(l);d(i-o.indexOf(i),t)})}if(!o.border){let e=(0,a.f)({x:0,y:0,width:0,height:0,cursor:"pointer"});o.add(e),o.border=e,e.attachShadow(e.shadowRoot),e.name="border-rect",e.addEventListener("click",e=>{let o=t.listTreeStickCellPlugin.titleRows,{shadowTarget:l}=e.pickParams,{col:r,row:i}=(0,s.J$)(l);d(i-o.indexOf(i),t)})}let l=e.border.shadowRoot,r=o.border.shadowRoot;return l.removeAllChild(),r.removeAllChild(),{shadowGroup:l,shadowGroupFrozen:r}}(t);this.showedTitleRows.length=0;let l=0;for(let s=0;s<t.colCount;s++){let d;s<t.frozenColCount?(d=new i.Z({x:t.getColsWidth(0,s-1),y:t.getFrozenRowsHeight()}),o.add(d)):(d=new i.Z({x:t.getColsWidth(t.frozenColCount,s-1),y:t.getFrozenRowsHeight()}),e.add(d)),d.col=s;for(let e=0;e<this.titleRows.length;e++){var r,h,u,c;let o=this.titleRows[e];if(r=o,h=this.rowNow,u=t.scenegraph.proxy.screenTopRow,c=this.titleRows,r===h&&r!==u+c.length-1||r===u+c.indexOf(r)+1&&r<h){0===s&&l++;continue}0===s&&this.showedTitleRows.push(o);let i=t.scenegraph.getCell(s,o);if("cell"===i.role){let t=function t(e){let o=e.clone();if(o.role=e.role,o.col=e.col,o.row=e.row,o.mergeStartCol=e.mergeStartCol,o.mergeStartRow=e.mergeStartRow,o.mergeEndCol=e.mergeEndCol,o.mergeEndRow=e.mergeEndRow,o.contentWidth=e.contentWidth,o.contentHeight=e.contentHeight,"cell"===o.role){let t=(0,a.f)({x:0,y:0,width:o.attribute.width,height:o.attribute.height});o.add(t)}return"group"===e.type&&e.forEachChildren(e=>{let l=t(e);o.add(l)}),o}(i);t.setAttributes({y:40*e}),d.add(t)}else{let l=(0,n.wW)(s,o,t,!0,!0);l.setAttributes({y:40*e}),d.add(l)}}}l>0&&-1===this.skipStartRow&&-1===this.skipEndRow&&(this.skipStartRow=t.scenegraph.proxy.screenTopRow-1,this.skipEndRow=t.scenegraph.proxy.screenTopRow+1)}}function d(t,e){let o=e.getDrawRange();if((0,r.Z)(t)&&t>=e.frozenRowCount){let l=e.getFrozenRowsHeight(),r=e.getRowsHeight(0,t-1);e.scrollTop=Math.min(r-l,e.getAllRowsHeight()-o.height)-1}e.scenegraph.updateNextFrame()}let c=()=>{h.F.registerComponent("listTreeStickCellPlugin",u)}},473178:function(t,e,o){o.d(e,{Q:()=>l});class l{constructor(t,e){var o;this.plugins=new Map,this.pluginEventMap=new Map,this.table=t,null==(o=e.plugins)||o.map(t=>{this.register(t),this._bindTableEventForPlugin(t)})}register(t){this.plugins.set(t.id,t)}registerAll(t){t.forEach(t=>this.register(t))}getPlugin(t){return this.plugins.get(t)}getPluginByName(t){return Array.from(this.plugins.values()).find(e=>e.name===t)}_bindTableEventForPlugin(t){var e;null==(e=t.runTime)||e.forEach(e=>{let o=this.table.on(e,(...o)=>{var l;null==(l=t.run)||l.call(t,...o,e,this.table)});this.pluginEventMap.set(t.id,[...this.pluginEventMap.get(t.id)||[],o])})}removeOrAddPlugins(t){Array.from(this.plugins.values()).filter(e=>!(null==t?void 0:t.some(t=>t.id===e.id))).forEach(t=>{var e;null==(e=this.pluginEventMap.get(t.id))||e.forEach(t=>{this.table.off(t)}),this.release(),this.plugins.delete(t.id)});let e=null==t?void 0:t.filter(t=>!this.plugins.has(t.id));null==e||e.forEach(t=>{this.register(t),this._bindTableEventForPlugin(t)})}updatePlugins(t){null==t||t.forEach(t=>{t.update&&t.update()})}release(){this.plugins.forEach(t=>{var e;null==(e=t.release)||e.call(t,this.table)})}}},206596:function(t,e,o){o.d(e,{J:()=>a});var l=o(212711),r=o(505850),i=o(788536),n=o(381584);class a extends i.Z{constructor(t){super(t),this._autoWidth=!1,this._autoHeight=!1,this._leftGroup=new i.Z({pickable:!1,fill:!1,stroke:!1}),this._leftGroup.role="content-left",this._rightGroup=new i.Z({pickable:!1,fill:!1,stroke:!1}),this._rightGroup.role="content-right",this._centerGroup=new i.Z({pickable:!1,fill:!1,stroke:!1}),this._centerGroup.role="content-center",this.appendChild(this._leftGroup),this.appendChild(this._rightGroup),this.appendChild(this._centerGroup)}setCellContentOption(t){this._autoWidth=t.autoWidth,this._autoHeight=t.autoHeight,this._cellWidth=t.cellWidth,this._originCellWidth=t.cellWidth,this._cellHeight=t.cellHeight,this._align=t.align,this._baseline=t.baseline}addLeftOccupyingIcon(t){var e,o,l;t.setAttribute("x",this._leftGroup.width+(null!=(e=t.attribute.marginLeft)?e:0)),this._leftGroup.appendChild(t),this._leftGroup.setDeltaWidth((null!=(o=t.attribute.marginLeft)?o:0)+(null!=(l=t.attribute.marginRight)?l:0)+t.attribute.width)}addRightOccupyingIcon(t){var e,o,l;t.setAttribute("x",this._rightGroup.width+(null!=(e=t.attribute.marginLeft)?e:0)),this._rightGroup.appendChild(t),this._rightGroup.setDeltaWidth((null!=(o=t.attribute.marginLeft)?o:0)+(null!=(l=t.attribute.marginRight)?l:0)+t.attribute.width)}addContent(t){let e=this._centerGroup.lastChild;e&&t.setAttributes({x:e.attribute.x+e.AABBBounds.width()}),this._centerGroup.appendChild(t),t instanceof l.x&&(this._centerGroup.setAttribute("pickable",!1),t.setAttribute("textAlign","left"))}layout(){let t=this._leftGroup.width;t===1/0&&(t=0);let e=this._rightGroup.width;if(e===-1/0&&(e=0),this._autoWidth){let o=this._centerGroup.width;this._cellWidth=t+e+o,this.setAttribute("width",this._cellWidth)}else{let o=this._cellWidth-t-e;this.updateCenterLayout(o);let l=this._centerGroup.width;this._cellWidth=t+e+l,this.setAttribute("width",this._cellWidth)}this.updateHorizontalPos();let o=this._leftGroup.height,l=this._rightGroup.height,r=this._centerGroup.height;this._cellHeight=Math.max(o,l,r),this.setAttribute("height",this._cellHeight),this.updateVerticalPos()}updateCenterLayout(t){let e=t;this._centerGroup.forEachChildren(t=>{(t instanceof n.J||t instanceof n.V)&&(e-=t.AABBBounds.width())});let o=this._centerGroup.getChildByName("text");o instanceof r.H?o.setAttribute("width",e):o instanceof l.x&&o.setAttribute("maxLineWidth",e);let i=0;this._centerGroup.forEachChildren(t=>{t.setAttribute("x",i),i+=t.AABBBounds.width()})}updateHorizontalPos(){this._leftGroup.setAttribute("x",0),this._rightGroup.setAttribute("x",this._cellWidth-this._rightGroup.width),this._centerGroup.setAttribute("x",this._leftGroup.width),"left"===this._align||"start"===this._align?this.setAttribute("dx",0):"center"===this._align?this.setAttribute("dx",-this.attribute.width/2):"right"!==this._align&&"end"!==this._align||this.setAttribute("dx",-this.attribute.width)}updateVerticalPos(){"top"===this._baseline?(this._leftGroup.setAttribute("y",0),this._rightGroup.setAttribute("y",0),this._centerGroup.setAttribute("y",0)):"middle"===this._baseline?(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",(this._leftGroup.height-t.AABBBounds.height())/2)}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",(this._rightGroup.height-t.AABBBounds.height())/2)}),this._leftGroup.setAttribute("y",this._cellHeight/2-this._leftGroup.height/2),this._rightGroup.setAttribute("y",this._cellHeight/2-this._rightGroup.height/2),this._centerGroup.setAttribute("y",this._cellHeight/2-this._centerGroup.height/2)):"bottom"===this._baseline&&(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",this._leftGroup.height-t.AABBBounds.height())}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",this._rightGroup.height-t.AABBBounds.height())}),this._leftGroup.setAttribute("y",this._cellHeight-this._leftGroup.height),this._rightGroup.setAttribute("y",this._cellHeight-this._rightGroup.height),this._centerGroup.setAttribute("y",this._cellHeight-this._centerGroup.height))}updateWidth(t){this._cellWidth=t,this._originCellWidth=t,this.layout()}updateHeight(t){this._cellHeight=t,this._cellWidth=this._originCellWidth;let e=this.getChildByName("text",!0);e&&e.setAttribute("heightLimit",t),this.layout()}}},23946:function(t,e,o){o.d(e,{FH:()=>m,Jp:()=>R,cd:()=>y,nH:()=>A,ws:()=>v});var l=o(829425),r=o(30371),i=o(669860),n=o(212711),a=o(226594),h=o(623579),s=o(882595),u=o(796241),d=o(364776),c=o(83624),g=o(480971),b=o(695723),p=o(381584),C=o(26249),f=o(170559);let w="_custom_",m="custom-container",y=w+"_0";function v(t,e,o,s,g,b,f,y,v,G,S){var z,B,F;let M,W,k,P,_=!0,L=!1;if("react-custom-layout"===t&&(t=(null==(z=S.reactCustomLayout)?void 0:z.getCustomLayoutFunc(o,s))||C.D),"function"==typeof t){let e=t({col:null!=(B=null==G?void 0:G.start.col)?B:o,row:null!=(F=null==G?void 0:G.start.row)?F:s,dataValue:S.getCellOriginValue(o,s),value:S.getCellValue(o,s)||"",rect:{left:0,top:0,right:g,bottom:b,width:g,height:b},table:S,originCol:o,originRow:s});if(!e)return{renderDefault:!0};e.rootContainer&&(e.rootContainer=A(e.rootContainer,S.animationManager.timeline)),e.rootContainer instanceof l.ZA&&((P=e.rootContainer).name=m,P.col=o,P.row=s),_=e.renderDefault,L=e.enableCellPadding}else if("function"==typeof e){let t=e({col:o,row:s,dataValue:S.getCellOriginValue(o,s),value:S.getCellValue(o,s)||"",rect:{left:0,top:0,right:g,bottom:b,width:g,height:b},table:S});t&&(k=t.elements,_=t.renderDefault,M=t.expectedWidth,W=t.expectedHeight)}else e&&(M=e.expectedWidth,W=e.expectedHeight,k=e.elements,_=e.renderDefault);return k&&(P=function(t,e,o,s){let g=new l.ZA({x:0,y:0,width:e,height:o,fill:!1,stroke:!1,pickable:!1});return g.name=m,(function(t,e,o,l){let r=[];for(let i=0;i<t.length;i++){let n=Object.assign({},t[i]);for(let t in n)n.hasOwnProperty(t)&&(0,u.Z)(n[t])&&(n[t]=n[t](l));(0,d.Z)(n.x)&&(n.x=(0,c.Z)(n.x)?x(n.x,e-0):Number(n.x)),(0,d.Z)(n.y)&&(n.y=(0,c.Z)(n.y)?x(n.y,o-0):Number(n.y)),"width"in n&&(n.width=(0,c.Z)(n.width)?x(n.width,e-0):Number(n.width)),"height"in n&&(n.height=(0,c.Z)(n.height)?x(n.height,o-0):Number(n.height)),"radius"in n&&(n.radius=(0,c.Z)(n.radius)?x(n.radius,Math.min(e-0,o-0)):Number(n.radius)),"hover"in n&&(n.hover.x=(0,c.Z)(n.hover.x)?x(n.hover.x,e-0):Number(n.hover.x),n.hover.y=(0,c.Z)(n.hover.y)?x(n.hover.y,o-0):Number(n.hover.y),n.hover.width=(0,c.Z)(n.hover.width)?x(n.hover.width,e-0):Number(n.hover.width),n.hover.height=(0,c.Z)(n.hover.height)?x(n.hover.height,o-0):Number(n.hover.height),n.hover.x+=0,n.hover.y+=0),n.x=n.x+0,n.y=n.y+0,r.push(n)}return r})(t,e,o,s).forEach(t=>{var e,o,l,s,u,d,c,b,C,f,w,m,y,v,x,R,A,H,G,S,z,B,F,M,W,k,P,_;switch(t.clickable&&(t.pickable=t.clickable),t.type){case"arc":let L=(0,r.Q)({x:t.x,y:t.y,dx:null!=(e=t.dx)?e:0,dy:null!=(o=t.dy)?o:0,fill:t.fill,stroke:t.stroke,outerRadius:t.radius,startAngle:t.startAngle,endAngle:t.endAngle,pickable:!!t.pickable,cursor:t.cursor});L.name=t.name,g.appendChild(L);break;case"text":if(t.background){let e=null!=(s=null==(l=t.background)?void 0:l.expandX)?s:0,o=null!=(d=null==(u=t.background)?void 0:u.expandY)?d:0,r=(0,i.f)({x:t.x-e,y:t.y-o,dx:null!=(c=t.dx)?c:0,dy:null!=(b=t.dy)?b:0,width:t.width+2*e,height:t.height+2*o,cornerRadius:null!=(f=null==(C=t.background)?void 0:C.cornerRadius)?f:0,fill:null!=(m=null==(w=t.background)?void 0:w.fill)?m:"#888"});g.appendChild(r)}let T=new n.x(Object.assign({pickable:!!t.pickable,fill:null!=(y=t.color)?y:t.fill},t));T.name=t.name,g.appendChild(T);break;case"rect":let E=(0,i.f)({x:t.x,y:t.y,dx:null!=(v=t.dx)?v:0,dy:null!=(x=t.dy)?x:0,width:t.width,height:t.height,cornerRadius:t.radius,fill:t.fill,stroke:t.stroke,pickable:!!t.pickable,cursor:t.cursor});E.name=t.name,g.appendChild(E);break;case"circle":let I=(0,a.y)({x:t.x,y:t.y,dx:null!=(R=t.dx)?R:0,dy:null!=(A=t.dy)?A:0,radius:t.radius,fill:t.fill,stroke:t.stroke,pickable:!!t.pickable,cursor:t.cursor});I.name=t.name,g.appendChild(I);break;case"icon":let D=new p.J({x:t.x,y:t.y,dx:null!=(H=t.dx)?H:0,dy:null!=(G=t.dy)?G:0,width:t.width,height:t.height,image:t.svg,backgroundWidth:t.hover?null!=(S=t.hover.width)?S:t.width:void 0,backgroundHeight:t.hover?null!=(z=t.hover.width)?z:t.width:void 0,backgroundColor:t.hover?null!=(B=t.hover.bgColor)?B:"rgba(22,44,66,0.2)":void 0,pickable:!!t.pickable,cursor:t.cursor});D.name=t.name,D.role="icon-custom",g.appendChild(D);break;case"image":let N=new p.J({x:t.x,y:t.y,dx:null!=(F=t.dx)?F:0,dy:null!=(M=t.dy)?M:0,width:t.width,height:t.height,image:t.src,backgroundWidth:t.hover?null!=(W=t.hover.width)?W:t.width:void 0,backgroundHeight:t.hover?null!=(k=t.hover.width)?k:t.width:void 0,backgroundColor:t.hover?null!=(P=t.hover.bgColor)?P:"rgba(22,44,66,0.2)":void 0,pickable:!!t.pickable,cursor:t.cursor,shape:t.shape});N.name=t.name,N.role="image-custom",g.appendChild(N);break;case"line":let Z=(0,h.W)({points:t.points,lineWidth:null!=(_=t.lineWidth)?_:1,stroke:t.stroke,pickable:!!t.pickable,cursor:t.cursor});Z.name=t.name,g.appendChild(Z)}}),g}(k,f?M:g,y?W:b,S.getCellValue(o,s))),L&&P.setAttributes({x:v[3],y:v[0],width:g-v[1]-v[3],height:b-v[0]-v[2]}),R(P,g,b),G&&(G.start.col!==G.end.col||G.start.row!==G.end.row)&&function t(e,o,l,r,i){e&&(e.name=`${w}${null!=i?i:""}_${r}`,e.onBeforeAttributeUpdate=H,"group"===e.type&&e.childrenCount&&e.forEachChildren((e,n)=>{t(e,o,l,n,(null!=i?i:"")+"_"+r)}))}(P,o,s,0),{elementsGroup:P,renderDefault:_}}function x(t,e){return t.endsWith("px")?parseInt(t,10):t.endsWith("%")&&e?parseInt(t,10)/100*e:parseInt(t,10)}function R(t,e,o){t&&t.forEachChildren(t=>{var l,r;t&&((0,g.Z)(t.attribute.width)&&t.attribute.width.percent&&t.setAttribute("width",Math.max(0,t.attribute.width.percent/100*e+(null!=(l=t.attribute.width.delta)?l:0))),t.attribute.width<0&&t.setAttribute("width",0),(0,g.Z)(t.attribute.height)&&t.attribute.height.percent&&t.setAttribute("height",Math.max(0,t.attribute.height.percent/100*o+(null!=(r=t.attribute.height.delta)?r:0))),t.attribute.height<0&&t.setAttribute("height",0),"group"===t.type&&R(t,t.attribute.width,t.attribute.height))})}function A(t,e){if(!t||!(0,d.Z)(t.$$typeof)&&!(0,d.Z)(t.vtype))return t;let o=t.type,{attribute:l,children:r,stateProxy:i,animation:n}=t.props,a=o({attribute:l});if(function(t,e){let o=!1;switch(t.type){case"richtext":case"rich/image":break;default:o=!0}o&&Object.keys(e).forEach(o=>{let l=s.Nv[o];l&&t.on(l,e[o])})}(a,t.props),i&&(a.stateProxy=i),a.id=l.id,a.name=l.name,(0,b.Z)(r)?r.forEach(t=>{let o=A(t,e);o&&o.type&&a.add(o)}):r&&a.add(A(r,e)),(0,b.Z)(n)&&e){let t=a.animate();t.setTimeline(e),n.forEach(e=>{t[e[0]](...e.slice(1))})}return a}function H(t,e){if(this.skipMergeUpdate)return;let o=(0,f.J$)(this);if(!o||!o.stage)return;let l=o.stage.table;this.skipAttributeUpdate=!0;let{mergeStartCol:r,mergeEndCol:i,mergeStartRow:n,mergeEndRow:a}=o;if((0,d.Z)(r)&&(0,d.Z)(i)&&(0,d.Z)(n)&&(0,d.Z)(a)&&(r!==i||n!==a)){for(let e=r;e<=i;e++)for(let r=n;r<=a;r++){if(e===o.col&&r===o.row)continue;let i=l.scenegraph.highPerformanceGetCell(e,r);if("cell"===i.role){let e=i.getChildByName(this.name,!0);if(!e||e.skipAttributeUpdate)continue;for(let o in t)t[o]!==e.attribute[o]&&"dx"!==o&&"dy"!==o&&e.setAttribute(o,t[o])}}this.skipAttributeUpdate=void 0}}},563042:function(t,e,o){o.d(e,{Q:()=>u,o:()=>r});var l,r,i=o(212711),n=o(657198),a=o(788536),h=o(381584);(l=r||(r={})).dropDown="dropDown",l.contextmenu="contextmenu",l.custom="custom";let s={fontSize:12,fontFamily:"Arial,sans-serif",color:"#000",highlightColor:"#2E68CF",hoverBgColor:"#EEE",lineHeight:30,bgColor:"#FFF",cornerRadius:4,borderWidth:.5,borderColor:"#CCC",menuPadding:6,menuItemPadding:9,maxLineWidth:200};class u{constructor(t){this._table=t,this._menuInstance=new a.Z({x:0,y:0,fill:s.bgColor,stroke:s.borderColor,cornerRadius:s.cornerRadius,lineWidth:s.borderWidth}),this._menuInfo={x:-1,y:-1,col:-1,row:-1,type:r.dropDown,menuInfo:[],highlightIndex:-1}}bindTableComponent(t){t.appendChild(this._menuInstance),this.bindEvent()}release(){}attach(t,e,o,l,i,n){if(i===r.dropDown&&this.checkDropDownMenuChange(o,l)){let t=this.getMenuInfo(o,l,i);if(!t)return;let{menuInfo:e,highlightIndex:r}=t;this.updateMenuInfo(o,l,i,e,r),this.updateMenuInstance(e,r)}else if(i===r.contextmenu&&this.checkContextMenuChange(t,e)){let t=this.getMenuInfo(o,l,i);if(!t)return;let{menuInfo:e,highlightIndex:r}=t;this.updateMenuInfo(o,l,i,e,r),this.updateMenuInstance(e,r)}this.updatePosition(t-this._table.scenegraph.x,e-this._table.scenegraph.y),this.addToScene()}updateMenuInfo(t,e,o,l,r){this._menuInfo.col=t,this._menuInfo.row=e,this._menuInfo.type=o,this._menuInfo.menuInfo=l,this._menuInfo.highlightIndex=r}checkDropDownMenuChange(t,e){let{type:o,col:l,row:i}=this._menuInfo;return o!==r.dropDown||t!==l||e!==i}checkContextMenuChange(t,e){var o;let{type:l,menuInfo:i}=this._menuInfo;return l!==r.contextmenu||i!==(null==(o=this._table.internalProps.menu)?void 0:o.contextMenuItems)}updateMenuInstance(t,e){this._menuInstance.removeAllChild();let o=s.menuPadding,l=s.menuPadding,r=0;t.forEach((t,n)=>{var u,d;let c,g,b=e===n;"string"==typeof t?g=t:"object"==typeof t&&(g=t.text,c=b?t.selectedIcon:t.icon);let p=new a.Z({y:o,x:l,height:s.lineHeight,fill:s.bgColor});p.role="menu-item",this._menuInstance.appendChild(p),p.stateProxy=t=>"hover"===t?{fill:s.hoverBgColor}:{fill:s.bgColor},p.addEventListener("pointerenter",t=>{p.addState("hover",!0,!1),this._table.scenegraph.updateNextFrame()}),p.addEventListener("pointerleave",t=>{p.removeState("hover",!1),this._table.scenegraph.updateNextFrame()});let C=new i.x({x:s.menuItemPadding,y:s.menuItemPadding,fill:b?s.highlightColor:s.color,text:g,textBaseline:"top",fontSize:s.fontSize,fontFamily:s.fontFamily,pickable:!1,maxLineWidth:s.maxLineWidth,ellipsis:"\u2026"});if(p.addChild(C),c){C.AABBBounds.height();let t=null!=(u=c.width)?u:16,e=null!=(d=c.height)?d:16,o=new h.J({x:s.menuItemPadding,y:(s.lineHeight-e)/2,width:t,height:e,image:c.svg,pickable:!1});o.role="menu-icon",p.insertBefore(o,C),C.setAttribute("x",t+s.menuItemPadding)}r=Math.max(p.AABBBounds.width(),r),o+=s.lineHeight}),this._menuInstance.setAttributes({width:r+2*s.menuItemPadding+2*s.menuPadding,height:o+s.menuPadding}),this._menuInstance.forEachChildren(t=>{t.setAttribute("width",r+2*s.menuItemPadding)})}updatePosition(t,e){this._menuInstance.setAttributes({x:this._menuInfo.type===r.dropDown?t-this._menuInstance.attribute.width:t,y:e}),this._menuInfo.x=r.dropDown?t-this._menuInstance.attribute.width:t,this._menuInfo.y=e}addToScene(){this._table.scenegraph.updateNextFrame()}detach(){this._menuInstance.setAttributes({x:-1e3,y:-1e3}),this._table.scenegraph.updateNextFrame()}getMenuInfo(t,e,o){var l;if(o===r.dropDown){let o=this._table.globalDropDownMenu;"function"==typeof(o=this._table._getHeaderLayoutMap(t,e).dropDownMenu)&&(o=o({row:e,col:t,table:this._table}));let l=-1;if(Array.isArray(o)){for(let r=0;r<o.length;r++)if(this._table._dropDownMenuIsHighlight(t,e,r)){l=r;break}}return{menuInfo:o,highlightIndex:l}}if(o===r.contextmenu){let o,r=null==(l=this._table.internalProps.menu)?void 0:l.contextMenuItems;if(Array.isArray(r))o=r;else if("function"==typeof r){let{field:l}=this._table.isHeader(t,e)?this._table.getHeaderDefine(t,e):this._table.getBodyColumnDefine(t,e);o=r(l,e,t)}return{menuInfo:o,highlightIndex:-1}}}bindEvent(){this._menuInstance.addEventListener("click",t=>{let{target:e}=t;if(e&&"menu-item"===e.role){let o=Object.assign(this.getEventInfo(e),this._table.getMenuInfo(this._menuInfo.col,this._menuInfo.row,this._menuInfo.type));o.event=t.nativeEvent,this._table.fireListeners(n.B.DROPDOWN_MENU_CLICK,o)}})}getEventInfo(t){let e=t.parent,o=0;e.forEachChildren((e,l)=>e===t&&(o=l-1,!0));let l="string"==typeof this._menuInfo.menuInfo[o]?this._menuInfo.menuInfo[o]:this._menuInfo.menuInfo[o].text,r="string"==typeof this._menuInfo.menuInfo[o]?l:this._menuInfo.menuInfo[o].menuKey||l;return{col:this._menuInfo.col,row:this._menuInfo.row,dropDownIndex:o,highlight:o===this._menuInfo.highlightIndex,text:l,menuKey:r}}get bounds(){return this._menuInstance.globalAABBBounds}}},87399:function(t,e,o){o.d(e,{k:()=>p,e:()=>b});var l=o(721192),r=o(669860),i=o(20408),n=o(263401),a=o(502837),h=o(364776);let s={},u={};function d(t,e,o,l,r,i=!1,n=!1){var a;(0,h.Z)(s[t])||(s[t]={});let{rowStart:u}=r.getBodyVisibleRowRange(),c=r.getBodyVisibleRowRange().rowEnd;c=Math.min(r.rowCount-1-r.bottomFrozenRowCount,c);for(let d=u;d<=c;d++){let g=r.scenegraph.getCell(t,d),b=null==(a=null==g?void 0:g.getChildren())?void 0:a[0];b.addUpdateShapeAndBoundsTag(),s[t][d]||(0,h.Z)(b)&&(b.activeChartInstance||b.activate(r),s[t][d]=b.activeChartInstance),setTimeout(()=>{var a,h,g,b,p,C;if(null==(a=s[t])?void 0:a[d]){let a=r.options.chartDimensionLinkage,f=!n;if(!n&&"object"==typeof a){if(f=null==(h=a.showTooltip)||h,d===c&&f){let t=null!=(g=a.heightLimitToShowTooltipForEdgeRow)?g:0,{rowEnd:e}=r.getBodyVisibleRowRange(0,-t);if(e===c)f=!0;else{let{rowEnd:t}=r.getBodyVisibleRowRange(0,5);f=t!==c}}else if(d===u&&f){let t=null!=(b=a.heightLimitToShowTooltipForEdgeRow)?b:0,{rowStart:e}=r.getBodyVisibleRowRange(t,0);if(e===u)f=!0;else{let{rowStart:t}=r.getBodyVisibleRowRange(0,-5);f=t!==u}}}if(n)r.stateManager.hover.cellPos.col===t&&r.stateManager.hover.cellPos.row===d||null==(C=(p=s[t][d]).showCrosshair)||C.call(p,t=>"left"===t.layoutOrient?o:e);else{let o=Math.max(r.frozenRowCount?r.getCellRelativeRect(t,r.frozenRowCount-1).bottom:0,r.getCellRelativeRect(t,d).top);i?(r.stateManager.hover.cellPos.col===t&&r.stateManager.hover.cellPos.row===d||s[t][d].hideTooltip(),s[t][d].setDimensionIndex(e,{tooltip:!1,showTooltipOption:{x:l.x,y:o,activeType:"dimension"}})):s[t][d].setDimensionIndex(e,{tooltip:f,showTooltipOption:{x:l.x,y:o,activeType:"dimension"}})}}},0),r.scenegraph.updateNextFrame()}}function c(t,e,o,l,r,i=!1,n=!1){var a;(0,h.Z)(u[t])||(u[t]={});let{colStart:s}=r.getBodyVisibleColRange(),d=r.getBodyVisibleColRange().colEnd;d=Math.min(r.colCount-1-r.rightFrozenColCount,d);for(let c=s;c<=d;c++){let g=r.scenegraph.getCell(c,t),b=null==(a=null==g?void 0:g.getChildren())?void 0:a[0];b.addUpdateShapeAndBoundsTag(),u[t][c]||(0,h.Z)(b)&&(b.activeChartInstance||b.activate(r),u[t][c]=b.activeChartInstance),setTimeout(()=>{var a,h,g,b;if(null==(a=u[t])?void 0:a[c]){let a=r.options.chartDimensionLinkage,p=!n;if(!n&&"object"==typeof a){if(p=null==(h=a.showTooltip)||h,c===d&&p){let t=a.widthLimitToShowTooltipForEdgeColumn,{colEnd:e}=r.getBodyVisibleColRange(0,-t);if(e===d)p=!0;else{let{colEnd:t}=r.getBodyVisibleColRange(0,5);p=t!==d}}else if(c===s&&p){let t=a.widthLimitToShowTooltipForEdgeColumn,{colStart:e}=r.getBodyVisibleColRange(t,0);if(e===s)p=!0;else{let{colStart:t}=r.getBodyVisibleColRange(0,-5);p=t!==s}}}if(n)r.stateManager.hover.cellPos.col===c&&r.stateManager.hover.cellPos.row===t||null==(b=(g=u[t][c]).showCrosshair)||b.call(g,t=>"left"===t.layoutOrient?o:e);else{let o=Math.max(r.frozenColCount?r.getCellRelativeRect(r.frozenColCount-1,t).right:0,r.getCellRelativeRect(c,t).left);i?(r.stateManager.hover.cellPos.col===c&&r.stateManager.hover.cellPos.row===t||u[t][c].hideTooltip(),u[t][c].setDimensionIndex(e,{tooltip:!1,showTooltipOption:{x:o,y:l.y,activeType:"dimension"}})):u[t][c].setDimensionIndex(e,{tooltip:p,showTooltipOption:{x:o,y:l.y,activeType:"dimension"}})}}},0),r.scenegraph.updateNextFrame()}}var g=o(255685);let b=(0,l.Gg)();class p extends r.U{constructor(t,e){if(super(e),this.type="chart",this.activeChartInstanceHoverOnMark=null,this.justShowMarkTooltip=void 0,this.justShowMarkTooltipTimer=Date.now(),this.delayRunDimensionHoverTimer=void 0,this.numberType=b,this.isShareChartSpec=t,e.chartInstance)this.chartInstance=e.chartInstance;else{let t=this.chartInstance=new e.ClassType(e.spec,(0,i.Z)({},this.attribute.tableChartOption,{renderCanvas:e.canvas,mode:"node"===this.attribute.mode?"node":"desktop-browser",modeParams:this.attribute.modeParams,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:e.dpr,interactive:!1,animation:!1,autoFit:!1}));t.renderSync(),t.getStage().enableDirtyBounds(),e.chartInstance=this.chartInstance=t}}activate(t){var e,o,l,r;if(this.activeChartInstance)return;let{col:h,row:s}=this.parent,u=(0,a.J)(this.parent,t),{x1:b,y1:C,x2:f,y2:w}=this.getViewBox(),m=(function(t,e,o){var l,r,i,a,h,s,u,d;let{layoutMap:c}=o.internalProps,g=new n.YZ,b=o.scenegraph.tableGroup.globalAABBBounds;return g.x1=b.x1,g.x2=b.x2,g.y1=b.y1,g.y2=b.y2,c.isLeftBottomCorner(t,e)||c.isRightTopCorner(t,e)||c.isLeftTopCorner(t,e)||c.isRightBottomCorner(t,e)||(c.isFrozenColumn(t,e)?(g.y1=b.y1+o.getFrozenRowsHeight(),g.y2=b.y2-o.getBottomFrozenRowsHeight()):c.isFrozenRow(t,e)?(g.x1=b.x1+o.getFrozenColsWidth(),g.x2=b.x2-o.getRightFrozenColsWidth()):c.isRightFrozenColumn(t,e)?(g.y1=b.y1+o.getFrozenRowsHeight(),g.y2=b.y2-o.getBottomFrozenRowsHeight()):c.isBottomFrozenRow(t,e)?(g.x1=b.x1+o.getFrozenColsWidth(),g.x2=b.x2-o.getRightFrozenColsWidth()):c.isFrozenColumn(t,e)||c.isRightFrozenColumn(t,e)||(g.x1=b.x1+o.getFrozenColsWidth(),g.x2=b.x2-o.getRightFrozenColsWidth(),g.y1=b.y1+o.getFrozenRowsHeight(),g.y2=b.y2-o.getBottomFrozenRowsHeight())),g.x1=g.x1+(null!=(r=null==(l=o.options.viewBox)?void 0:l.x1)?r:0),g.x2=g.x2+(null!=(a=null==(i=o.options.viewBox)?void 0:i.x1)?a:0),g.y1=g.y1+(null!=(s=null==(h=o.options.viewBox)?void 0:h.y1)?s:0),g.y2=g.y2+(null!=(d=null==(u=o.options.viewBox)?void 0:u.y1)?d:0),g})(h,s,t).intersect({x1:b-t.scrollLeft,x2:f-t.scrollLeft,y1:C-t.scrollTop,y2:w-t.scrollTop});null==(e=this.activeChartInstance)||e.release(),this.attribute.ClassType.globalConfig.uniqueTooltip=!1,this.activeChartInstance=new this.attribute.ClassType(this.attribute.spec,(0,i.Z)({},this.attribute.tableChartOption,{renderCanvas:this.attribute.canvas,mode:"desktop-browser",canvasControled:!1,viewBox:{x1:0,x2:f-b,y1:0,y2:w-C},dpr:t.internalProps.pixelRatio,animation:!1,interactive:!0,autoFit:!1,beforeRender:e=>{let o=this.stage,l=e.window.getContext(),r=o.window.getViewBoxTransform(),i=o.window.getViewBox();l.inuse=!0,l.clearMatrix(),l.setTransform(r.a,r.b,r.c,r.d,r.e,r.f,!0),l.translate(i.x1,i.y1),l.setTransformForCurrent(!0),l.beginPath(),l.rect(m.x1,m.y1,m.x2-m.x1,m.y2-m.y1),l.clip(),l.clearMatrix(),t.options.canvas&&!e.needRender&&(e.pauseRender(),t.scenegraph.stage.dirtyBounds.union(this.globalAABBBounds),t.scenegraph.updateNextFrame())},afterRender(t){t.window.getContext().inuse=!1,t.needRender=!1,y.resumeRender()},renderHooks:{afterClearRect(t){let{context:e,layer:o,viewBox:l}=t;o.main&&t.clear&&u&&(e.beginPath(),e.fillStyle=u,e.rect(l.x1,l.y1,l.x2-l.x1,l.y2-l.y1),e.fill())}},componentShowContent:t.options.chartDimensionLinkage&&"scatter"!==this.attribute.spec.type?{tooltip:{dimension:!1,mark:!0},crosshair:!1}:void 0}));let y=this.activeChartInstance.getStage(),v=this.globalTransMatrix.clone(),x=this.stage.window.getViewBoxTransform();v.multiply(x.a,x.b,x.c,x.d,x.e,x.f),y.window.setViewBoxTransform&&y.window.setViewBoxTransform(v.a,v.b,v.c,v.d,v.e,v.f),this.activeChartInstance.renderSync(),null==(l=null==(o=t.internalProps.layoutMap)?void 0:o.updateDataStateToActiveChartInstance)||l.call(o,this.activeChartInstance),this.activeChartInstance.on("click",e=>{var o;!1===(null==(o=this.attribute.spec.select)?void 0:o.enable)?t.scenegraph.updateChartState(null):p.temp&&t.scenegraph.updateChartState(null==e?void 0:e.datum)}),this.activeChartInstance.on("brushEnd",e=>{var o;t.scenegraph.updateChartState(null==(o=null==e?void 0:e.value)?void 0:o.inBrushData),p.temp=0,setTimeout(()=>{p.temp=1},0)}),t.options.chartDimensionLinkage&&this.activeChartInstance.on("dimensionHover",e=>{var o,l;let r=null==e?void 0:e.dimensionInfo[0],i=null==(o=null==e?void 0:e.event)?void 0:o.canvas,n=null==(l=null==e?void 0:e.event)?void 0:l.viewport;if(n){let o=r.data[0].series.positionToDataX(n.x),l=r.data[0].series.positionToDataY(n.y);if("scatter"===this.attribute.spec.type)d(h,o,void 0,i,t,!1,!0),c(s,void 0,l,i,t,!1,!0),(0,g.hZ)(t.rowHeaderLevelCount-1,s,t.internalProps.layoutMap).labelHoverOnAxis&&t.scenegraph.getCell(t.rowHeaderLevelCount-1,s).firstChild.showLabelHoverOnAxis(i.y-t.getCellRelativeRect(h,s).top,l),(0,g.hZ)(h,t.rowCount-t.bottomFrozenRowCount,t.internalProps.layoutMap).labelHoverOnAxis&&t.scenegraph.getCell(h,t.rowCount-t.bottomFrozenRowCount).firstChild.showLabelHoverOnAxis(i.x-t.getCellRelativeRect(h,s).left,o);else{let o=!0,n=this.activeChartInstanceHoverOnMark,a=this.justShowMarkTooltip;e.mark&&e.datum&&!Array.isArray(e.datum)?(this.activeChartInstanceHoverOnMark=e.mark,o=!0):(this.activeChartInstanceHoverOnMark=null,o=!1),this.justShowMarkTooltip=o;let u=!1;if(!1!==a&&!1===o?(this.justShowMarkTooltipTimer=Date.now(),u=!0):!1===a&&!1===o?u=Date.now()-this.justShowMarkTooltipTimer<100:(!1===a&&!0===o||!0===a&&!0===o)&&(u=!1,clearTimeout(this.delayRunDimensionHoverTimer),this.delayRunDimensionHoverTimer=void 0),"enter"===e.action||"move"===e.action||n!==this.activeChartInstanceHoverOnMark){let e=r.value,n=t.options.indicatorsAsCol;if(u?(clearTimeout(this.delayRunDimensionHoverTimer),this.delayRunDimensionHoverTimer=setTimeout(()=>{n?c(s,e,null,i,t,o,!1):d(h,e,null,i,t,o,!1)},100)):n?c(s,e,null,i,t,o,!1):d(h,e,null,i,t,o,!1),n){let o=r.data[0].series,i="histogram"===this.attribute.spec.type||"line"===o.type||"area"===o.type?0:o.getYAxisHelper().getBandwidth(0),n=o.valueToPositionY(e),a=(0,g.hZ)(t.rowHeaderLevelCount-1,s,t.internalProps.layoutMap),h=l;if("histogram"===this.attribute.spec.type){let{series:t,datum:e}=r.data[0];if(e.length>0){let o=e[0][t.fieldY[0]],l=e[0][t.fieldY2];h=o+" ~ "+l,n=(t.valueToPositionY(o)+t.valueToPositionY(l))/2}}a.labelHoverOnAxis&&t.scenegraph.getCell(t.rowHeaderLevelCount-1,s).firstChild.showLabelHoverOnAxis(n+("line"===o.type||"area"===o.type?0:i/2),h)}else{let o=r.data[0].series,l="histogram"===this.attribute.spec.type||"line"===o.type||"area"===o.type?0:o.getXAxisHelper().getBandwidth(0),i=o.valueToPositionX(e),n=(0,g.hZ)(h,t.rowCount-t.bottomFrozenRowCount,t.internalProps.layoutMap),a=e;if("histogram"===this.attribute.spec.type){let{series:t,datum:e}=r.data[0];if(e.length>0){let o=e[0][t.fieldX[0]],l=e[0][t.fieldX2];a=o+" ~ "+l,i=(t.valueToPositionX(o)+t.valueToPositionX(l))/2}}n.labelHoverOnAxis&&t.scenegraph.getCell(h,t.rowCount-t.bottomFrozenRowCount).firstChild.showLabelHoverOnAxis(i+l/2,a)}}}}}),null==(r=t._bindChartEvent)||r.call(t,this.activeChartInstance)}deactivate(t,{releaseChartInstance:e=!0,releaseColumnChartInstance:o=!0,releaseRowChartInstance:l=!0}={}){var r,i,n,a,d,c,g,b,p,C;if(this.activeChartInstanceHoverOnMark=null,this.justShowMarkTooltip=void 0,this.justShowMarkTooltipTimer=Date.now(),clearTimeout(this.delayRunDimensionHoverTimer),this.delayRunDimensionHoverTimer=void 0,e){null==(r=this.activeChartInstance)||r.updateViewBox({x1:-1e3,x2:-800,y1:-1e3,y2:-800},!1,!1),null==(i=this.activeChartInstance)||i.release(),this.activeChartInstance=null;let{col:e,row:o}=this.parent;t.internalProps.layoutMap.isAxisCell(t.rowHeaderLevelCount-1,o)&&(null==(a=null==(n=t.scenegraph.getCell(t.rowHeaderLevelCount-1,o).firstChild)?void 0:n.hideLabelHoverOnAxis)||a.call(n)),t.internalProps.layoutMap.isAxisCell(e,t.rowCount-t.bottomFrozenRowCount)&&(null==(c=null==(d=t.scenegraph.getCell(e,t.rowCount-t.bottomFrozenRowCount).firstChild)?void 0:d.hideLabelHoverOnAxis)||c.call(d))}else{let{col:e,row:r}=this.parent;o&&t.internalProps.layoutMap.isAxisCell(e,t.rowCount-t.bottomFrozenRowCount)&&(null==(b=null==(g=t.scenegraph.getCell(e,t.rowCount-t.bottomFrozenRowCount).firstChild)?void 0:g.hideLabelHoverOnAxis)||b.call(g)),l&&t.internalProps.layoutMap.isAxisCell(t.rowHeaderLevelCount-1,r)&&(null==(C=null==(p=t.scenegraph.getCell(t.rowHeaderLevelCount-1,r).firstChild)?void 0:p.hideLabelHoverOnAxis)||C.call(p))}o&&function(t,e,o){var l;if((0,h.Z)(s[t])){for(let r in s[t]){if((0,h.Z)(e)&&Number(r)===e)continue;let i=o.scenegraph.getCell(t,Number(r)),n=null==(l=null==i?void 0:i.getChildren())?void 0:l[0];n.addUpdateShapeAndBoundsTag(),(0,h.Z)(n)&&(n.deactivate(o,{releaseChartInstance:!0,releaseColumnChartInstance:!1,releaseRowChartInstance:!1}),s[t][r]=null)}delete s[t]}}(this.parent.col,"scatter"===this.attribute.spec.type?this.parent.row:void 0,t),l&&function(t,e,o){var l;if((0,h.Z)(u[t]))for(let r in u[t]){if((0,h.Z)(e)&&Number(r)===e)continue;let i=o.scenegraph.getCell(Number(r),t),n=null==(l=null==i?void 0:i.getChildren())?void 0:l[0];n.addUpdateShapeAndBoundsTag(),(0,h.Z)(n)&&(n.deactivate(o,{releaseChartInstance:!0,releaseColumnChartInstance:!1,releaseRowChartInstance:!1}),u[t][r]=null)}delete u[t]}(this.parent.row,"scatter"===this.attribute.spec.type?this.parent.col:void 0,t)}updateData(t){this.attribute.data=t}getViewBox(){var t,e,o,l,r,i,n,a;let h=this.parent,s=this.attribute.cellPadding,u=this.stage.table,{x1:d,y1:c,x2:g,y2:b}=h.globalAABBBounds;return{x1:Math.ceil(d+s[3]+u.scrollLeft+(null!=(e=null==(t=u.options.viewBox)?void 0:t.x1)?e:0)),x2:Math.ceil(d+h.attribute.width-s[1]+u.scrollLeft+(null!=(l=null==(o=u.options.viewBox)?void 0:o.x1)?l:0)),y1:Math.ceil(c+s[0]+u.scrollTop+(null!=(i=null==(r=u.options.viewBox)?void 0:r.y1)?i:0)),y2:Math.ceil(c+h.attribute.height-s[2]+u.scrollTop+(null!=(a=null==(n=u.options.viewBox)?void 0:n.y1)?a:0))}}}p.temp=1},434399:function(t,e,o){o.d(e,{A8:()=>h,H6:()=>b,LO:()=>s,Ry:()=>g,a5:()=>p,eO:()=>function t(e){c=!0,s.length>0?u=l.rF.getRequestAnimationFrame()(()=>{let o=s.splice(0,d);h.splice(0,d),o.forEach(t=>{C(t),t.addUpdateBoundTag()}),e.render(),t(e)}):c=!1},pF:()=>C});var l=o(474702),r=o(455353),i=o(605380),n=o(364776),a=o(263401);let h=[],s=[],u,d=5,c=!1;function g(t){(0,n.Z)(t)&&(d=t)}function b(){h=[],s=[],c=!1,l.rF.getCancelAnimationFrame()(u)}function p(){return c}function C(t){var e,o,l,r,i,n,h;let{axes:s,dataId:u,data:d,spec:c,ClassType:g,canvas:b,mode:p,modeParams:C,dpr:w}=t.attribute,{chartInstance:m}=t;m||((m=new g(c,{renderCanvas:b,mode:"node"===p?"node":"desktop-browser",modeParams:C,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:w,interactive:!1,animation:!1,autoFit:!1})).renderSync(),t.chartInstance=m);let y=t.getViewBox();y.x2<=y.x1&&(y.x2=y.x1+1),y.y2<=y.y1&&(y.y2=y.y1+1),m.updateViewBox({x1:0,x2:y.x2-y.x1,y1:0,y2:y.y2-y.y1},!1,!1);let v=m.getStage(),x=t.globalTransMatrix,R=t.stage.window.getViewBoxTransform().clone();R.multiply(x.a,x.b,x.c,x.d,x.e,x.f),v.window.setViewBoxTransform&&v.window.setViewBoxTransform(R.a,R.b,R.c,R.d,R.e,R.f);let{table:A}=t.getRootNode(),H=!1;if(A.options.specFormat){let o=A.options.specFormat(t.attribute.spec,m,t);if(o.needFormatSpec&&o.spec){let t=o.spec;m.updateSpecSync(t,!1,{reuse:!1,morph:!1}),H=null==(e=o.updateSpec)||e}}if(!H)if(null==s||s.forEach((t,e)=>{var o,l,r,i,n;"band"===t.type?m.updateModelSpec({type:"axes",index:e},{domain:t.domain.slice(0)},!0):m.updateModelSpecSync({type:"axes",index:e},{min:null!=(l=null==(o=t.range)?void 0:o.min)?l:0,max:null!=(i=null==(r=t.range)?void 0:r.max)?i:0,tick:{tickMode:null==(n=t.tick)?void 0:n.tickMode}},!0)}),null==(l=null==(o=A.internalProps.layoutMap)?void 0:o.updateDataStateToActiveChartInstance)||l.call(o,m),"string"==typeof u||"number"==typeof u)m.getChart().setLayoutTag(!0),m.updateDataSync(u,null!=d?d:[]);else{let t=[];for(let e in u){let o=u[e],l=c.series.find(t=>{var o;return(null==(o=null==t?void 0:t.data)?void 0:o.id)===e});t.push({id:e,values:o?null!=(r=null==d?void 0:d.filter(t=>t.hasOwnProperty(o)))?r:[]:null!=d?d:[],fields:null==(i=null==l?void 0:l.data)?void 0:i.fields}),m.updateFullDataSync||m.updateDataSync(e,o?null!=(n=null==d?void 0:d.filter(t=>t.hasOwnProperty(o)))?n:[]:null!=d?d:[])}m.getChart().setLayoutTag(!0),null==(h=m.updateFullDataSync)||h.call(m,t)}A.fireListeners("before_cache_chart_image",{chartInstance:m}),function(t,e){var o;let{viewWidth:l,viewHeight:r}=t;if(l<2e3&&r<2e3)return e.cacheCanvas=f(t),e.isShareChartSpec||(null==(o=e.chartInstance)||o.release(),e.chartInstance=null,e.setAttribute("chartInstance",null));let i=Math.ceil(r/2e3),n=Math.ceil(l/2e3),h=[];for(let e=0;e<i;e++)for(let o=0;o<n;o++){let i=2e3*o,n=2e3*e,s=i+2e3>l?l:i+2e3,u=n+2e3>r?r:n+2e3,d=s-i,c=u-n,g=new a.YZ;g.setValue(i,n,s,u);let b=f(t,!1,g);h.push({canvas:b,x:i,y:n,width:d,height:c})}e.cacheCanvas=h}(m.getStage(),t)}function f(t,e=!0,o){if("released"===t.releaseStatus)return null;let l=(function(t,e=!0,o){let l=t.window.getViewBoxTransform(),n=r.n.get(i.Oo),a=o?-o.x1:0,h=o?-o.y1:0,s=o?o.x2:t.viewWidth,u=o?o.y2:t.viewHeight,d=o?o.width():t.viewWidth,c=o?o.height():t.viewHeight;return n.create({viewBox:{x1:a,y1:h,x2:s,y2:u},width:d*l.a,height:c*l.d,dpr:t.window.dpr,canvasControled:!0,offscreen:!0,title:""}),n.setViewBoxTransform(l.a,l.b,l.c,l.d,0,0),t.renderTo(n),n})(t,e,o).getNativeHandler();return l.nativeCanvas?l.nativeCanvas:null}},788536:function(t,e,o){o.d(e,{Z:()=>r});var l=o(829425);class r extends l.ZA{clear(){this.removeAllChild()}getChildByName(t,e){let o=null;return this.forEachChildren(e=>e.name===t&&(o=e,!0)),e&&this.forEachChildren(e=>{if(e.getChildByName){let l=e.getChildByName(t,!0);if(l)return o=l,!0}return!1}),o}get width(){var t;let e=this.AABBBounds.width();return e!==1/0&&e!==-1/0||(e=0),Math.max(e,null!=(t=this.attribute.width)?t:0)}get height(){var t;let e=this.AABBBounds.height();return e!==1/0&&e!==-1/0||(e=0),Math.max(e,null!=(t=this.attribute.height)?t:0)}setDeltaWidth(t){var e;0!==t&&(this.setAttribute("width",(null!=(e=this.attribute.width)?e:0)+t),this.border&&(this.border.setAttribute("width",this.border.attribute.width+t),"group"===this.border.type&&this.border.firstChild.setAttribute("width",this.border.firstChild.attribute.width+t)))}setDeltaHeight(t){var e;0!==t&&(this.setAttribute("height",(null!=(e=this.attribute.height)?e:0)+t),this.border&&(this.border.setAttribute("height",this.border.attribute.height+t),"group"===this.border.type&&this.border.firstChild.setAttribute("width",this.border.firstChild.attribute.height+t)))}setDeltaX(t){0!==t&&this.setAttribute("x",this.attribute.x+t)}setDeltaY(t){0!==t&&this.setAttribute("y",this.attribute.y+t)}forEachChildrenSkipChild(t,e="border-rect",o=!1){if(o){let o=this._lastChild,l=0;for(;o;){if(o.name!==e&&t(o,l++))return;o=o._prev}}else{let o=this._firstChild,l=0;for(;o;){if(o.name!==e&&t(o,l++))return;o=o._next}}}getColGroup(t){let e=this._firstChild;if(!e)return null;for(let o=0;o<this.childrenCount;o++){if(e.col===t)return e;e=e._next}return null}getRowGroup(t){let e=this._firstChild;if(!e)return null;for(let o=0;o<this.childrenCount;o++){if(e.row===t)return e;e=e._next}return null}addCellGroup(t){if(0===this.childrenCount||this.lastChild.row===t.row-1)this.addChild(t);else{let e=this._firstChild;for(let o=0;o<this.childrenCount;o++){if(e.row===t.row-1)return void this.insertAfter(t,e);e=e._next}this.addChild(t)}}getChildAt(t){let e=super.getChildAt(t);return e&&"border-rect"===e.name?e._next:e}tryUpdateAABBBounds(){if("cell"===this.role){var t,e;if(!this.shouldUpdateAABBBounds())return this._AABBBounds;let o=this.shouldSelfChangeUpdateAABBBounds(),l=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),t=this,e=o,t.stage&&t.stage.dirtyBounds&&t.stage.renderCount&&(t.isContainer&&!e||t.stage.dirty(t.globalAABBBounds)),l}return super.tryUpdateAABBBounds()}doUpdateAABBBounds(){if("cell"===this.role){let{x:t,y:e,width:o,height:l}=this.attribute;return this._AABBBounds.setValue(t,e,t+o,e+l),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds}return"body"===this.role||"row-header"===this.role||"col-header"===this.role||"right-frozen"===this.role||"bottom-frozen"===this.role||"corner-header"===this.role||"corner-right-top-header"===this.role||"corner-right-bottom-header"===this.role||"corner-left-bottom-header"===this.role?(this._AABBBounds.setValue(-1/0,-1/0,1/0,1/0),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds):super.doUpdateAABBBounds()}updateColumnRowNumber(t){this.rowNumber?this.rowNumber=Math.max(this.rowNumber,t):this.rowNumber=t}updateColumnHeight(t){this.colHeight?this.colHeight+=t:this.colHeight=t}}},381584:function(t,e,o){o.d(e,{J:()=>h,V:()=>s});var l=o(507261),r=o(545293),i=o(212711),n=o(229216),a=o(501800);class h extends l.E{constructor(t){super(t),this.failCallback=()=>{let{svg:t,src:e}=a.U2().damage_pic||{},o=t||e;o&&(super.image=o)},"mouseenter_cell"!==this.attribute.visibleTime&&"click_cell"!==this.attribute.visibleTime||(this.attribute.opacity=0),this.attribute.hoverImage&&(this.attribute.originImage=this.attribute.image),this.attribute.isGif&&this.attribute.gif&&this.loadGif()}loadGif(){this.playing=!1,r.h.GetFile(this.attribute.gif+"?role=gif"+`&radom=${Math.random()}`,"arrayBuffer").then(t=>{let e=(0,n.parseGIF)(t),o=(0,n.decompressFrames)(e,!0);this.renderGIF(o),this.resources.set(this.attribute.image,{state:"success",data:this.gifCanvas})}).catch(t=>{})}get backgroundWidth(){var t,e;return null!=(e=null!=(t=this.attribute.backgroundWidth)?t:this.attribute.width)?e:0}get backgroundHeight(){var t,e;return null!=(e=null!=(t=this.attribute.backgroundHeight)?t:this.attribute.height)?e:0}renderGIF(t){this.loadedFrames=t,this.frameIndex=0,this.tempCanvas||(this.tempCanvas=document.createElement("canvas"),this.tempCtx=this.tempCanvas.getContext("2d")),this.gifCanvas||(this.gifCanvas=document.createElement("canvas"),this.gifCtx=this.gifCanvas.getContext("2d")),this.gifCanvas.width=t[0].dims.width,this.gifCanvas.height=t[0].dims.height,this.playing=!0,this.lastTime=(new Date).getTime(),this.animate().to({},1e3,"linear").loop(1/0)}renderFrame(t,e,o){let l=this.loadedFrames[this.frameIndex||0];2===l.disposalType&&this.gifCtx.clearRect(0,0,this.gifCanvas.width,this.gifCanvas.height),this.drawPatch(l),this.manipulate(t,e,o);let r=(new Date).getTime()-this.lastTime;l.delay<r&&(this.frameIndex++,this.lastTime=(new Date).getTime()),this.frameIndex>=this.loadedFrames.length&&(this.frameIndex=0)}drawPatch(t){let e=t.dims;this.frameImageData&&e.width===this.frameImageData.width&&e.height===this.frameImageData.height||(this.tempCanvas.width=e.width,this.tempCanvas.height=e.height,this.frameImageData=this.tempCtx.createImageData(e.width,e.height)),this.frameImageData.data.set(t.patch),this.tempCtx.putImageData(this.frameImageData,0,0),this.gifCtx.drawImage(this.tempCanvas,e.left,e.top)}manipulate(t,e,o){t.drawImage(this.gifCanvas,0,0,this.gifCanvas.width,this.gifCanvas.height,e,o,this.attribute.width,this.attribute.height)}setAttribute(t,e,o,l){super.setAttribute(t,e,o,l),"gif"===t&&this.loadGif()}setAttributes(t,e,o){super.setAttributes(t,e,o),t.gif&&this.loadGif()}}class s extends i.x{constructor(t){var e,o,l,r,i;t.fill=null!=(e=t.fill)?e:"#00F",t.fontSize=null!=(o=t.fontSize)?o:12,t.underline=null!=(l=t.underline)?l:1,t.textBaseline=null!=(r=t.textBaseline)?r:"top",t.cursor=null!=(i=t.cursor)?i:"pointer",super(t)}}},507388:function(t,e,o){o.d(e,{kE:()=>m,l7:()=>G,pZ:()=>A,wW:()=>v,NQ:()=>H});var l=o(951130),r=o(23946),i=o(297),n=o(720307),a=o(135759),h=o(604410),s=o(254833),u=o(648523),d=o(376352),c=o(944216),g=o(704654),b=o(695723),p=o(768595),C=o(364776);function f(t,e){var o,l;if(this.shadowRoot&&this.shadowRoot.childrenCount&&((0,C.Z)(t.width)||(0,C.Z)(t.height))){let e=this.shadowRoot.findChildrenByName("shadow-rect")[0];e&&e.setAttributes({width:null!=(o=t.width)?o:e.attribute.width,height:null!=(l=t.height)?l:e.attribute.height})}}var w=o(101249);function m(t,e,o,r,n,h,u,d,c,g,b,p,C,w,m,v,x,R){var A,H;let G,S=!1;if((0,a.tI)(e)){if("cell"!==r.scenegraph.highPerformanceGetCell(n,h).role)return G;e=r.getCellValue(n,h),S=!0}if("checkbox"===t&&o.tree)G=s.F.getFunction("createCheckboxCellGroup")(null,g,0,b,n,h,u,d,c,p,C,w,m,r,v,o,x,S,!0);else if("text"===t||"link"===t||R){if("link"===t){let s=e,u=r.getCellOriginValue(n,h),d=r._getCellStyle(n,h);"link"===t&&("templateLink"in o&&o.templateLink||!("linkDetect"in o)||!(0,a.vi)(o.linkDetect,{col:n,row:h,table:r,value:s,dataValue:u,cellHeaderPaths:void 0})||l.tP.test(s))&&(v?(v.text.fill=(0,i.WJ)("linkColor",d,n,h,r),v.group.cursor="pointer"):v={text:{fill:(0,i.WJ)("linkColor",d,n,h,r)},group:{cursor:"pointer"}})}let{customElementsGroup:f,renderDefault:H}=y(r,o,n,h,d,c,p,x,R);G=s.F.getFunction("createTextCellGroup")(r,e,g,0,b,n,h,u,d,c,p,C,w,m,f,H,v,x,S);let z=r.internalProps.layoutMap.getAxisConfigInPivotChart(n,h);if(z){let t=new(s.F.getComponent("axis"))(z,G.attribute.width,G.attribute.height,null!=(A=z.__vtableBodyChartCellPadding)?A:p,r);G.clear(),G.appendChild(t.component),t.overlap()}else r.internalProps.layoutMap.isEmpty(n,h)?(G.setAttributes({fill:!1,stroke:!1}),G.clear()):r.internalProps.layoutMap.isAxisCell(n,h)&&G.clear()}else if("image"===t)G=s.F.getFunction("createImageCellGroup")(g,0,b,n,h,d,c,o.keepAspectRatio,o.imageAutoSizing,p,C,w,m,r,v,x,S);else if("video"===t)G=s.F.getFunction("createVideoCellGroup")(g,0,b,n,h,d,c,o.keepAspectRatio,o.imageAutoSizing,p,C,w,m,r,v,x,S);else if("chart"===t){let t=r.internalProps.layoutMap.getChartInstance(n,h);G=s.F.getFunction("createChartCellGroup")(null,g,0,b,n,h,d,c,p,e,o.chartModule,r.internalProps.layoutMap.getChartSpec(n,h),t,null!=(H=r.internalProps.layoutMap.getChartDataId(n,h))?H:"data",r,v,r.internalProps.layoutMap.isShareChartSpec(n,h),S,r.internalProps.layoutMap.isNoChartDataRenderNothing(n,h))}else if("progressbar"===t){let{customElementsGroup:t,renderDefault:l}=y(r,o,n,h,d,c,p,x,R),i=r._getCellStyle(n,h),a=r.getCellOriginValue(n,h);G=s.F.getFunction("createTextCellGroup")(r,e,g,0,b,n,h,u,d,c,p,C,w,m,t,l,v,x,S);let f=s.F.getFunction("createProgressBarCell")(o,i,u,e,a,n,h,p,r,x);G.firstChild?G.insertBefore(f,G.firstChild):G.appendChild(f)}else if("sparkline"===t)G=s.F.getFunction("createSparkLineCellGroup")(null,g,0,b,n,h,d,c,p,r,v,S);else if("checkbox"===t){let t="isAggregation"in r.internalProps.layoutMap&&r.internalProps.layoutMap.isAggregation(n,h),l=r.internalProps.layoutMap.isSeriesNumber(n,h);G=t&&l?s.F.getFunction("createTextCellGroup")(r,e,g,0,b,n,h,u,d,c,p,C,w,!1,void 0,!0,v,x,S):s.F.getFunction("createCheckboxCellGroup")(null,g,0,b,n,h,u,d,c,p,C,w,m,r,v,o,x,S,!1)}else"radio"===t?G=s.F.getFunction("createRadioCellGroup")(null,g,0,b,n,h,u,d,c,p,C,w,r,v,o,x):"switch"===t?G=s.F.getFunction("createSwitchCellGroup")(null,g,0,b,n,h,u,d,c,p,C,w,m,r,v,o,x,S):"button"===t&&(G=s.F.getFunction("createButtonCellGroup")(null,g,0,b,n,h,u,d,c,p,C,w,m,r,v,o,x,S));return G.onBeforeAttributeUpdate=f,G}function y(t,e,o,l,i,n,a,h,s){let u,d=!0;if(s)u=s.elementsGroup,d=s.renderDefault;else if((null==h?void 0:h.isCustom)&&!t.isCornerHeader(o,l));else{let s,c;if("body"!==t.getCellLocation(o,l)?(s=null==e?void 0:e.headerCustomRender,c=null==e?void 0:e.headerCustomLayout):(s=(null==e?void 0:e.customRender)||t.customRender,c=null==e?void 0:e.customLayout),c||s){let e=(0,r.ws)(c,s,o,l,i,n,!1,t.isAutoRowHeight(l),a,h,t);u=e.elementsGroup,d=e.renderDefault}}return{customElementsGroup:u,renderDefault:d}}function v(t,e,o,l,s,g){var b,C,f,m,y,v,G,S,z,B,F,M,W,k,P,_,L,T;let E,I,D,N=o.scenegraph.highPerformanceGetCell(t,e,!0);if("cell"!==N.role&&!l)return;let Z=o.getCellLocation(t,e),O,$,V,U,J=o.getCellValue(t,e),Y=!1;if(o.internalProps.customMergeCell){let l=o.getCustomMerge(t,e);if(l){let{range:t,text:i,style:n,customLayout:a,customRender:h}=l;O=($=t).start.col!==$.end.col||$.start.row!==$.end.row,J=i,V=n,(a||h)&&(U=(0,r.ws)(a,h,t.start.col,t.start.row,o.getColsWidth(t.start.col,t.end.col),o.getRowsHeight(t.start.row,t.end.row),!1,o.isAutoRowHeight(e),[0,0,0,0],$,o)),Y=!0}}let j=t,X=e;$&&(j=$.start.col,X=$.start.row);let K="body"!==Z?o.getHeaderDefine(j,X):o.getBodyColumnDefine(j,X),q="body"!==Z||(null==K?void 0:K.dragOrder)||!!(null==K?void 0:K.icon)||!!(null==K?void 0:K.tree);!$&&(o.internalProps.enableTreeNodeMerge||"body"!==Z||(null==K?void 0:K.mergeCell))&&(O=($=o.getCellRange(t,e)).start.col!==$.end.col||$.start.row!==$.end.row);let Q=!1;if(o.internalProps.enableTreeNodeMerge&&O){let l=o.getCellRawRecord($.start.col,$.start.row),{vtableMergeName:i,vtableMerge:n}=null!=l?l:{};Q=n,n&&(q=!0,o.internalProps.groupTitleCustomLayout&&(U=(0,r.ws)(o.internalProps.groupTitleCustomLayout,void 0,$.start.col,$.start.row,o.getColsWidth($.start.col,$.end.col),o.getRowsHeight($.start.row,$.end.row),!1,o.isAutoRowHeight(e),[0,0,0,0],$,o)),o.internalProps.groupTitleFieldFormat?J=o.internalProps.groupTitleFieldFormat(l,t,e,o):void 0!==i&&(J=i))}let tt=V||o._getCellStyle($?$.start.col:t,$?$.start.row:e),te=null!=(b=tt.autoWrapText)?b:o.internalProps.autoWrapText,to=(0,n.RT)(tt,o,O?$.start.col:t,O?$.start.row:e,i.WJ).theme;if(to.group.cornerRadius=(0,n.xv)(t,e,o),!l&&!O&&!((null==K?void 0:K.customLayout)||(null==K?void 0:K.customRender)||(null==K?void 0:K.headerCustomLayout)||(null==K?void 0:K.headerCustomRender))&&(g||function(t,e,o,l,r,i){var n;let h=i.getBodyColumnType(t,e),s=i.isAutoRowHeight(e),u=i.getCellValue(t,e);return!(i.isHeader(t,e)||"cell"!==o.role||"text"!==h||l||s||r||"text"!==(null==(n=o.firstChild)?void 0:n.type)||(0,a.tI)(u))}(t,e,N,te,q,o))){let l=o.getColWidth(t),r=o.getRowHeight(e),n=(0,w.d)(t,e,to,o);N.setAttributes({width:l,height:r,lineWidth:null!=(f=null==(C=null==to?void 0:to.group)?void 0:C.lineWidth)?f:void 0,fill:null!=(y=null==(m=null==to?void 0:to.group)?void 0:m.fill)?y:void 0,stroke:null!=(G=null==(v=null==to?void 0:to.group)?void 0:v.stroke)?G:void 0,strokeArrayWidth:null!=n?n:void 0,strokeArrayColor:null!=(z=null==(S=null==to?void 0:to.group)?void 0:S.strokeArrayColor)?z:void 0,cursor:null!=(F=null==(B=null==to?void 0:to.group)?void 0:B.cursor)?F:void 0,cornerRadius:null!=(W=null==(M=null==to?void 0:to.group)?void 0:M.cornerRadius)?W:0,lineDash:null!=(P=null==(k=null==to?void 0:to.group)?void 0:k.lineDash)?P:void 0,y:o.scenegraph.getCellGroupY(e)}),N.mergeStartCol=void 0,N.mergeStartRow=void 0,N.mergeEndCol=void 0,N.mergeEndRow=void 0,N.forEachChildren(t=>{t.setAttributes({dx:0,dy:0})});let a=N.getChildByName("text");if(g&&a){let l=to.text.textAlign,r=(0,u.L)(t,e,o),i={textBaseline:"top",dx:"left"===l?r:0};a.setAttributes(to.text?Object.assign({},to.text,i):i)}else if(a){let n=o.getCellValue(t,e),{text:h,moreThanMaxCharacters:s}=(0,p.$)(n,o),c=(0,u.L)(t,e,o),g=tt.lineClamp,b=null!=(_=(0,d.u)((0,i.WJ)("padding",tt,t,e,o)))?_:[0,0,0,0],C=to.text.textAlign,f=0;f="center"===C?b[3]+(l-(b[1]+b[3]))/2:"right"===C?b[3]+l-(b[1]+b[3]):b[3];let w={text:1!==h.length||te?h:h[0],moreThanMaxCharacters:s,maxLineWidth:l-(b[1]+b[3]+c),textBaseline:"top",autoWrapText:te,lineClamp:g,wordBreak:"break-word",heightLimit:r-Math.floor(b[0]+b[2]),pickable:!1,dx:"left"===C?c:0,x:f};if(a.setAttributes(to.text?Object.assign({},to.text,w):w),a.attribute.text){let t=to.text.textBaseline,e=r-(b[0]+b[2]),o=0;o="middle"===t?b[0]+(e-a.AABBBounds.height())/2:"bottom"===t?b[0]+e-a.AABBBounds.height():b[0],a.setAttributes({y:o})}}return N}if(!l&&"empty"===N.role)return;let tl=Q||Y?"text":o.isHeader(t,e)?null!=(L=o._getHeaderLayoutMap(t,e).headerType)?L:"text":null!=(T=o.getBodyColumnType(t,e))?T:"text",tr=to._vtable.padding,ti=to.text.textAlign,tn=to.text.textBaseline;if($?(I=o.getColsWidth($.start.col,$.end.col),D=o.getRowsHeight($.start.row,$.end.row)):(I=o.getColWidth(t),D=o.getRowHeight(e)),(0,a.tI)(J)?(N.removeAllChild(),(0,h.K)(J,o,R.bind(null,{type:tl,value:J,define:K,table:o,col:t,row:e,cellWidth:I,cellHeight:D,oldCellGroup:N,padding:tr,textAlign:ti,textBaseline:tn,mayHaveIcon:q,addNew:l,range:$,customResult:U,customStyle:V}))):E=x(tl,J,K,o,t,e,I,D,N,tr,ti,tn,q,l,to,$,U),O){let{width:t}=E.attribute,{height:e}=E.attribute;E.contentWidth=t,E.contentHeight=e,s?function(t,e,o,l,r,i,n,a){let{col:h,row:s}=a;t.start.row!==t.end.row&&a.contentHeight!==o&&(0,c.Zl)(a,o,o,n.isAutoRowHeight(s),l,r,i,n),t.start.col!==t.end.col&&a.contentWidth!==e&&(0,c.qs)(a,e,o,0,n.isAutoRowHeight(s),l,r,i,n.scenegraph),a.contentWidth=e,a.contentHeight=o;let u=n.getRowHeight(s);H(a,n.getColWidth(h),u,t,n)}($,I,D,tr,ti,tn,o,E):A($,I,D,tr,ti,tn,o)}return E}function x(t,e,o,l,i,n,h,s,u,d,c,b,p,C,f,w,y){var v,x;if((0,a.tI)(e)&&(e=l.getCellValue(i,n)),!C&&(u.row!==n||u.col!==i))return null;if(!C&&u.parent&&l.reactCustomLayout){let t=u.getChildByName(r.FH);if(t){let{col:e,row:o}=t;(0,g.Z)(e)&&(0,g.Z)(o)&&l.reactCustomLayout.removeCustomCell(e,o)}}let R=m(t,e,o,l,i,n,l.getColWidth(i),h,s,C?l.scenegraph.getColGroup(i):u.parent,C?0:l.scenegraph.getCellGroupY(n),d,c,b,p,f,w,y);return!C&&u.parent&&(u.parent.insertAfter(R,u),u.parent.removeChild(u),u.release(!0),(null==(v=l.scenegraph)?void 0:v.proxy.cellCache.get(i))&&(null==(x=l.scenegraph)||x.proxy.cellCache.set(i,R))),R}function R(t){let{type:e,value:o,define:l,table:r,col:a,row:h,cellWidth:s,cellHeight:u,oldCellGroup:d,padding:c,textAlign:g,textBaseline:b,mayHaveIcon:p,addNew:C,range:f,customResult:w,customStyle:m}=t,y=m||r._getCellStyle(f?f.start.col:a,f?f.start.row:h),v=(0,n.RT)(y,r,f?f.start.col:a,f?f.start.row:h,i.WJ).theme;v.group.cornerRadius=(0,n.xv)(a,h,r),x(e,o,l,r,a,h,s,u,d,c,g,b,p,C,v,f,w)}function A(t,e,o,l,r,i,n){for(let a=t.start.col;a<=t.end.col;a++)for(let h=t.start.row;h<=t.end.row;h++){let s=n.scenegraph.highPerformanceGetCell(a,h,!0);if("cell"!==s.role)continue;t.start.row!==t.end.row&&s.contentHeight!==o&&(0,c.Zl)(s,o,o,n.isAutoRowHeight(h),l,r,i,n),t.start.col!==t.end.col&&s.contentWidth!==e&&(0,c.qs)(s,e,o,0,n.isAutoRowHeight(h),l,r,i,n.scenegraph),s.contentWidth=e,s.contentHeight=o;let u=n.getRowHeight(h);H(s,n.getColWidth(a),u,t,n)}}function H(t,e,o,l,r){var i,n;let{col:a,row:h}=t,s=-r.getColsWidth(l.start.col,a-1),u=0;if(null==(i=r.options.customConfig)?void 0:i._disableColumnAndRowSizeRound)for(let t=l.start.row;t<=h-1;t++)u-=r.getRowHeight(t);else u=-r.getRowsHeight(l.start.row,h-1);t.forEachChildren(t=>{var e,o,l,r,i,n;"number"==typeof t._dx?(t.skipMergeUpdate=!0,t.setAttributes({dx:(null!=(e=t._dx)?e:0)+s})):(t._dx=null!=(o=t.attribute.dx)?o:0,t.skipMergeUpdate=!0,t.setAttributes({dx:(null!=(l=t.attribute.dx)?l:0)+s})),t.skipMergeUpdate=!1,"number"==typeof t._dy?(t.skipMergeUpdate=!0,t.setAttributes({dy:(null!=(r=t._dy)?r:0)+u})):(t._dy=null!=(i=t.attribute.dy)?i:0,t.skipMergeUpdate=!0,t.setAttributes({dy:(null!=(n=t.attribute.dy)?n:0)+u})),t.skipMergeUpdate=!1});let d=null!=(n=t.attribute.strokeArrayWidth)?n:t.attribute.lineWidth,c=(0,b.Z)(d),g=[0,0,0,0];a===l.start.col&&(g[3]=c?d[3]:d),h===l.start.row&&(g[0]=c?d[0]:d),a===l.end.col&&(g[1]=c?d[1]:d),h===l.end.row&&(g[2]=c?d[2]:d);let p=e!==t.attribute.width,C=o!==t.attribute.height;return t.skipMergeUpdate=!0,t.setAttributes({width:e,height:o,strokeArrayWidth:g}),t.skipMergeUpdate=!1,t.mergeStartCol=l.start.col,t.mergeStartRow=l.start.row,t.mergeEndCol=l.end.col,t.mergeEndRow=l.end.row,{widthChange:p,heightChange:C}}function G(t,e,o,l){if(l.internalProps.customMergeCell){let i=l.getCustomMerge(t,e);if(i){let{range:n,text:a,style:h,customLayout:s,customRender:u}=i;if(s||u){let i=(0,r.ws)(s,u,n.start.col,n.start.row,l.getColsWidth(n.start.col,n.end.col),l.getRowsHeight(n.start.row,n.end.row),!1,l.isAutoRowHeight(e),[0,0,0,0],n,l).elementsGroup;o.childrenCount>0&&i?o.insertBefore(i,o.firstChild):i&&o.appendChild(i);let a=l.getRowHeight(e),h=l.getColWidth(t),{width:d}=o.attribute,{height:c}=o.attribute;return o.contentWidth=d,o.contentHeight=c,H(o,h,a,n,l),n}}}}},994308:function(t,e,o){o.d(e,{Gb:()=>f,LP:()=>b,SI:()=>C,Ui:()=>g,km:()=>p});var l=o(507261),r=o(501800),i=o(788536),n=o(621044),a=o(549360),h=o(297),s=o(364776),u=o(376352),d=o(101249),c=o(944216);function g(t,e,o,n,a,g,b,C,f,m,y,v,x,R,A,H,G){var S,z,B,F,M,W,k,P,_,L,T,E,I,D,N,Z,O,$,V,U,J,Y,j,X,K,q,Q,tt,te,to;let tl,tr,ti=R._getCellStyle(n,a),tn=(0,h.vp)("padding",ti,n,a,R);(null==(S=R.options.customConfig)?void 0:S.imageMargin)?m=(0,u.u)(null==(z=R.options.customConfig)?void 0:z.imageMargin):(0,s.Z)(tn)&&(m=tn),(null==(B=null==A?void 0:A.text)?void 0:B.textAlign)&&(y=null==(F=null==A?void 0:A.text)?void 0:F.textAlign),(null==(M=null==A?void 0:A.text)?void 0:M.textBaseline)&&(v=null==(W=null==A?void 0:A.text)?void 0:W.textBaseline);let ta=(0,d.d)(n,a,A,R);if(G&&(tl=R.scenegraph.highPerformanceGetCell(n,a,!0))&&"cell"===tl.role&&tl.setAttributes({x:e,y:o,width:g,height:b,lineWidth:null!=(P=null==(k=null==A?void 0:A.group)?void 0:k.lineWidth)?P:void 0,fill:null!=(L=null==(_=null==A?void 0:A.group)?void 0:_.fill)?L:void 0,stroke:null!=(E=null==(T=null==A?void 0:A.group)?void 0:T.stroke)?E:void 0,strokeArrayWidth:null!=ta?ta:void 0,strokeArrayColor:null!=(D=null==(I=null==A?void 0:A.group)?void 0:I.strokeArrayColor)?D:void 0,cursor:null!=(Z=null==(N=null==A?void 0:A.group)?void 0:N.cursor)?Z:void 0,lineDash:null!=($=null==(O=null==A?void 0:A.group)?void 0:O.lineDash)?$:void 0,lineCap:"butt",clip:!0,cornerRadius:A.group.cornerRadius}),tl&&"cell"===tl.role||((tl=new i.Z({x:e,y:o,width:g,height:b,lineWidth:null!=(U=null==(V=null==A?void 0:A.group)?void 0:V.lineWidth)?U:void 0,fill:null!=(Y=null==(J=null==A?void 0:A.group)?void 0:J.fill)?Y:void 0,stroke:null!=(X=null==(j=null==A?void 0:A.group)?void 0:j.stroke)?X:void 0,strokeArrayWidth:null!=ta?ta:void 0,strokeArrayColor:null!=(q=null==(K=null==A?void 0:A.group)?void 0:K.strokeArrayColor)?q:void 0,cursor:null!=(tt=null==(Q=null==A?void 0:A.group)?void 0:Q.cursor)?tt:void 0,lineDash:null!=(to=null==(te=null==A?void 0:A.group)?void 0:te.lineDash)?to:void 0,lineCap:"butt",clip:!0,cornerRadius:A.group.cornerRadius})).role="cell",tl.col=n,tl.row=a,null==t||t.addCellGroup(tl)),x){let t=n,e=a;H&&(t=H.start.col,e=H.start.row),tr=R.getCellIcons(t,e)}let th=0,ts=0,tu=0;if(Array.isArray(tr)&&0!==tr.length){let{leftIconWidth:t,rightIconWidth:e,absoluteLeftIconWidth:o,absoluteRightIconWidth:l}=(0,c.M4)(tr,tl,H,R);th=t+e,ts=t,tu=e,tl.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+m[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+g-e-m[1]):"icon-absolute-right"===t.role&&t.setAttribute("x",t.attribute.x+g-l-m[1])}),tl.forEachChildren(t=>{"middle"===v?t.setAttribute("y",(b-t.AABBBounds.height())/2):"bottom"===v?t.setAttribute("y",b-t.AABBBounds.height()-m[2]):t.setAttribute("y",m[0])}),tl._cellLeftIconWidth=ts,tl._cellRightIconWidth=tu}let td=R.getCellValue(n,a),tc=(0,l.B)({x:m[3],y:m[0],width:g-m[1]-m[3]-th,height:b-m[0]-m[2],image:td,cursor:"pointer"});return tc.name="image",tc.keepAspectRatio=C,tc.textAlign=y,tc.textBaseline=v,C||f?tc.resources&&tc.resources.has(tc.attribute.image)&&"success"===tc.resources.get(tc.attribute.image).state?(tc.setAttribute("opacity",0),setTimeout(()=>{tc.setAttribute("opacity",1),w(f,C,m,y,v,tc,tl,R),R.scenegraph.updateNextFrame()},0)):tc.successCallback=()=>{w(f,C,m,y,v,tc,tl,R),R.scenegraph.updateNextFrame()}:tc.resources&&tc.resources.has(tc.attribute.image)&&"success"===tc.resources.get(tc.attribute.image).state?p(tl,n,a,0,0,R):tc.successCallback=()=>{p(tl,n,a,0,0,R)},tc.failCallback=()=>{tc.image=r.U2().damage_pic.svg},tl.appendChild(tc),tl}function b(t,e,o,l,r,i,n){let a=!1,h=null,s=null,{width:u,height:d,isMerge:c}=C(n,r.table);if(u<o+i[1]+i[3]&&(h=o+i[1]+i[3],a=!0),d<l+i[2]+i[0]&&(s=l+i[2]+i[0],a=!0),a){if("number"==typeof h)if(c)for(let t=n.mergeStartCol;t<=n.mergeEndCol;t++)r.setColWidth(t,h/(n.mergeEndCol-n.mergeStartCol+1));else r.setColWidth(t,h);if("number"==typeof s)if(c)for(let t=n.mergeStartRow;t<=n.mergeEndRow;t++)r.setRowHeight(t,s/(n.mergeEndRow-n.mergeStartRow+1));else r.setRowHeight(e,s);return r.component.updateScrollBar(),!0}return!1}function p(t,e,o,l,r,i){var s,d,c,g,b,p,w,m,y,v,x,R;let A,H=t.getChildByName("image");if(!H)return;let G="string"!=typeof H.attribute.image&&H.attribute.image||(null==(s=H.resources)?void 0:s.get(H.attribute.image).data);if(!G)return;let S=i._getCellStyle(e,o),z=null!=(d=(0,h.WJ)("textAlign",S,e,o,i))?d:"left",B=null!=(c=(0,h.WJ)("textBaseline",S,e,o,i))?c:"middle";A=(null==(g=i.options.customConfig)?void 0:g.imageMargin)?(0,u.u)(null==(b=i.options.customConfig)?void 0:b.imageMargin):null!=(p=(0,u.u)((0,h.WJ)("padding",S,e,o,i)))?p:[0,0,0,0];let{width:F,height:M,isMerge:W}=C(t,i),k=null!=(w=t.mergeStartCol)?w:t.col,P=null!=(m=t.mergeStartRow)?m:t.row,_=null!=(y=t.mergeEndCol)?y:t.col,L=null!=(v=t.mergeEndCol)?v:t.row,T=null!=(x=t._cellLeftIconWidth)?x:0,E=null!=(R=t._cellRightIconWidth)?R:0;if(H.keepAspectRatio){let{width:t,height:e}=(0,n.f)(G.width||G.videoWidth,G.height||G.videoHeight,F-(A[1]+A[3]),M-(A[0]+A[2])),o=(0,a.W)(0,0,F,M,t,e,z,B,A);for(let l=k;l<=_;l++)for(let r=P;r<=L;r++){let n=i.scenegraph.getCell(l,r).getChildByName("image");null==n||n.setAttributes({x:o.x,y:o.y,width:t,height:e})}}else for(let t=k;t<=_;t++)for(let e=P;e<=L;e++){let o=i.scenegraph.getCell(t,e).getChildByName("image");null==o||o.setAttributes({x:T+A[3],y:A[0],width:F-A[1]-A[3]-E-T,height:M-A[0]-A[2]})}if(t.getChildByName("play-icon")){let{width:e,height:o}=C(t,i),l=Math.floor(Math.min(e-A[1]-A[3],o-A[2]-A[0])/2),r=0+(e>H.attribute.width?H.attribute.x-0+H.attribute.width/2:e/2),n=0+(o>H.attribute.height?H.attribute.y-0+H.attribute.height/2:o/2);for(let t=k;t<=_;t++)for(let e=P;e<=L;e++)i.scenegraph.getCell(t,e).getChildByName("play-icon").setAttributes({x:r-l/2,y:n-l/2,width:l,height:l})}t.forEachChildren(t=>{"icon-left"===t.role||("icon-right"===t.role||"icon-absolute-right"===t.role)&&t.setAttribute("x",t.attribute.x+l)}),t.forEachChildren(t=>{("rect"===t.type||t.role&&t.role.startsWith("icon"))&&("middle"===B?t.setAttribute("y",A[0]+(M-A[0]-A[2]-t.AABBBounds.height())/2):"bottom"===B?t.setAttribute("y",A[0]+M-A[0]-A[2]-t.AABBBounds.height()):t.setAttribute("y",A[0]))}),W&&f(t.mergeStartCol,t.mergeEndCol,t.mergeStartRow,t.mergeEndRow,i)}function C(t,e){return"cell"===t.role&&(0,s.Z)(t.mergeStartCol)&&(0,s.Z)(t.mergeEndCol)&&(0,s.Z)(t.mergeStartRow)&&(0,s.Z)(t.mergeEndRow)?{width:e.getColsWidth(t.mergeStartCol,t.mergeEndCol),height:e.getRowsHeight(t.mergeStartRow,t.mergeEndRow),isMerge:!0}:{width:t.attribute.width,height:t.attribute.height,isMerge:!1}}function f(t,e,o,l,r){for(let i=t;i<=e;i++)for(let t=o;t<=l;t++){let e=r.scenegraph.getCell(i,t);if(e){let o=e.getChildByName("image");o&&o.setAttributes({dx:-r.getColsWidth(e.mergeStartCol,i-1),dy:-r.getRowsHeight(e.mergeStartRow,t-1)});let l=e.getChildByName("play-icon");l&&l.setAttributes({dx:-r.getColsWidth(e.mergeStartCol,i-1),dy:-r.getRowsHeight(e.mergeStartRow,t-1)})}}}function w(t,e,o,l,r,i,h,s){let u=i.resources.get(i.attribute.image).data,{col:d,row:c}=h;if(t&&!m(i)&&b(d,c,u.width,u.height,s.scenegraph,o,h),e||m(i)){let{width:t,height:e,isMerge:d}=C(h,s),{width:c,height:g}=(0,n.f)(u.width,u.height,t-o[1]-o[3],e-o[0]-o[2]),b=(0,a.W)(0,0,t,e,c,g,l,r,o);i.setAttributes({x:b.x,y:b.y,width:c,height:g}),d&&f(h.mergeStartCol,h.mergeEndCol,h.mergeStartRow,h.mergeEndRow,s)}}function m(t){let e=r.U2();return t.attribute.image===e.damage_pic.svg}},808855:function(t,e,o){o.d(e,{yR:()=>to,ah:()=>ta,VT:()=>tn,m4:()=>tr,Jy:()=>ti,ge:()=>ts,au:()=>tu,LQ:()=>te,pk:()=>tl,dB:()=>th});var l=o(254833),r=o(788536),i=o(87399),n=o(75008),a=o(297),h=o(364776),s=o(101249);function u(t,e,o,l,u,d,c,g,b,p,C,f,w,m,y,v,x,R,A){var H,G,S,z,B,F,M,W,k,P,_,L,T,E,I,D,N,Z,O,$,V,U,J,Y,j,X;let K=n.U()[C],q=y._getCellStyle(u,d),Q=(0,a.vp)("padding",q,u,d,y);if((0,h.Z)(Q)&&(b=Q),!t){let i=(0,s.d)(u,d,v,y);R&&(t=y.scenegraph.highPerformanceGetCell(u,d,!0))&&"cell"===t.role&&t.setAttributes({x:o,y:l,width:c,height:g,lineWidth:null!=(G=null==(H=null==v?void 0:v.group)?void 0:H.lineWidth)?G:void 0,fill:null!=(z=null==(S=null==v?void 0:v.group)?void 0:S.fill)?z:void 0,stroke:null!=(F=null==(B=null==v?void 0:v.group)?void 0:B.stroke)?F:void 0,strokeArrayWidth:i,strokeArrayColor:null!=(W=null==(M=null==v?void 0:v.group)?void 0:M.strokeArrayColor)?W:void 0,cursor:null!=(P=null==(k=null==v?void 0:v.group)?void 0:k.cursor)?P:void 0,lineDash:null!=(L=null==(_=null==v?void 0:v.group)?void 0:_.lineDash)?L:void 0,lineCap:"butt",clip:!0,cornerRadius:v.group.cornerRadius}),t&&"cell"===t.role||((t=new r.Z({x:o,y:l,width:c,height:g,lineWidth:null!=(E=null==(T=null==v?void 0:v.group)?void 0:T.lineWidth)?E:void 0,fill:null!=(D=null==(I=null==v?void 0:v.group)?void 0:I.fill)?D:void 0,stroke:null!=(Z=null==(N=null==v?void 0:v.group)?void 0:N.stroke)?Z:void 0,strokeArrayWidth:i,strokeArrayColor:null!=($=null==(O=null==v?void 0:v.group)?void 0:O.strokeArrayColor)?$:void 0,cursor:null!=(U=null==(V=null==v?void 0:v.group)?void 0:V.cursor)?U:void 0,lineDash:null!=(Y=null==(J=null==v?void 0:v.group)?void 0:J.lineDash)?Y:void 0,lineCap:"butt",clip:!0,cornerRadius:v.group.cornerRadius})).role="cell",t.col=u,t.row=d,null==e||e.addCellGroup(t))}if(t.AABBBounds.width(),A&&Array.isArray(y.getCellValue(u,d))||!A){let e=new i.k(x,{stroke:!1,x:b[3],y:b[0],canvas:null!=(j=y.canvas)?j:y.scenegraph.stage.window.getContext().canvas,mode:y.options.mode,modeParams:y.options.modeParams,spec:y.options.specTransformInCell?y.options.specTransformInCell(f,u,d):f,ClassType:K,width:c-b[3]-b[1],height:g-b[2]-b[0],chartInstance:w,dataId:m,data:y.getCellValue(u,d)||[],cellPadding:b,dpr:y.internalProps.pixelRatio,detectPickChartItem:null==(X=y.options.customConfig)?void 0:X.detectPickChartItem,axes:y.isPivotChart()?y.internalProps.layoutMap.getChartAxes(u,d):[],tableChartOption:y.options.chartOption,col:u,row:d});t.appendChild(e),y.internalProps.layoutMap.setChartInstance(u,d,e.chartInstance)}return t}var d=o(839818),c=o(480971),g=o(593439),b=o(648523),p=o(135759),C=o(944216);class f extends r.Z{constructor(t){super(t),this._autoWidth=!1,this._autoHeight=!1,this._leftGroup=new r.Z({pickable:!1,fill:!1,stroke:!1}),this._leftGroup.role="content-left",this._rightGroup=new r.Z({pickable:!1,fill:!1,stroke:!1}),this._rightGroup.role="content-right",this._checkboxGroup=new r.Z({pickable:!1,fill:!1,stroke:!1}),this._checkboxGroup.role="content-center",this.appendChild(this._leftGroup),this.appendChild(this._rightGroup),this.appendChild(this._checkboxGroup)}addLeftOccupyingIcon(t){var e,o,l;t.setAttribute("x",this._leftGroup.width+(null!=(e=t.attribute.marginLeft)?e:0)),this._leftGroup.appendChild(t),this._leftGroup.setDeltaWidth((null!=(o=t.attribute.marginLeft)?o:0)+(null!=(l=t.attribute.marginRight)?l:0)+t.attribute.width)}addRightOccupyingIcon(t){var e,o,l;t.setAttribute("x",this._rightGroup.width+(null!=(e=t.attribute.marginLeft)?e:0)),this._rightGroup.appendChild(t),this._rightGroup.setDeltaWidth((null!=(o=t.attribute.marginLeft)?o:0)+(null!=(l=t.attribute.marginRight)?l:0)+t.attribute.width)}addCheckbox(t){this._checkboxGroup.appendChild(t)}setCheckboxContentOption(t){this._autoWidth=t.autoWidth,this._autoHeight=t.autoHeight,this._cellWidth=t.cellWidth,this._originCellWidth=t.cellWidth,this._cellHeight=t.cellHeight,this._align=t.align,this._baseline=t.baseline}layout(){let t=this._leftGroup.width;t===1/0&&(t=0);let e=this._rightGroup.width;if(e===-1/0&&(e=0),this._autoWidth){let o=this._checkboxGroup.width;this._cellWidth=t+e+o,this.setAttribute("width",this._cellWidth)}else{let o=this._cellWidth-t-e;this.updateCenterLayout(o);let l=this._checkboxGroup.width;this._cellWidth=t+e+l,this.setAttribute("width",this._cellWidth)}this.updateHorizontalPos();let o=this._leftGroup.height,l=this._rightGroup.height,r=this._checkboxGroup.height;this._cellHeight=Math.max(o,l,r),this.setAttribute("height",this._cellHeight),this.updateVerticalPos()}updateCenterLayout(t){let e=t;this._checkboxGroup.forEachChildren(t=>{t instanceof g.J&&(e-=t.AABBBounds.width())});let o=this._checkboxGroup.getChildByName("checkbox-content");o instanceof g.J&&o.setAttribute("width",e);let l=0;this._checkboxGroup.forEachChildren(t=>{t.setAttribute("x",l),l+=t.AABBBounds.width()})}updateHorizontalPos(){this._leftGroup.setAttribute("x",0),this._rightGroup.setAttribute("x",this._cellWidth-this._rightGroup.width),this._checkboxGroup.setAttribute("x",4),"left"===this._align||"start"===this._align?this.setAttribute("dx",0):"center"===this._align?this.setAttribute("dx",-this.attribute.width/2):"right"!==this._align&&"end"!==this._align||this.setAttribute("dx",-this.attribute.width)}updateVerticalPos(){"top"===this._baseline?(this._leftGroup.setAttribute("y",0),this._rightGroup.setAttribute("y",0),this._checkboxGroup.setAttribute("y",0)):"middle"===this._baseline?(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",(this._leftGroup.height-t.AABBBounds.height())/2)}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",(this._rightGroup.height-t.AABBBounds.height())/2)}),this._leftGroup.setAttribute("y",this._cellHeight/2-this._leftGroup.height/2),this._rightGroup.setAttribute("y",this._cellHeight/2-this._rightGroup.height/2),this._checkboxGroup.setAttribute("y",this._cellHeight/2-this._checkboxGroup.height/2)):"bottom"===this._baseline&&(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",this._leftGroup.height-t.AABBBounds.height())}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",this._rightGroup.height-t.AABBBounds.height())}),this._leftGroup.setAttribute("y",this._cellHeight-this._leftGroup.height),this._rightGroup.setAttribute("y",this._cellHeight-this._rightGroup.height),this._checkboxGroup.setAttribute("y",this._cellHeight-this._checkboxGroup.height))}}var w=o(23946);function m(t,e,o,l,i,n,h,u,m,y,v,x,R,A,H,G,S,z,B){var F,M,W,k,P,_,L,T,E,I,D,N,Z,O,$,V,U,J,Y,j,X,K,q,Q;let tt;if(!t){let a=(0,s.d)(i,n,H,A);z&&(t=A.scenegraph.highPerformanceGetCell(i,n,!0))&&"cell"===t.role&&t.setAttributes({x:o,y:l,width:u,height:m,lineWidth:null!=(M=null==(F=null==H?void 0:H.group)?void 0:F.lineWidth)?M:void 0,fill:null!=(k=null==(W=null==H?void 0:H.group)?void 0:W.fill)?k:void 0,stroke:null!=(_=null==(P=null==H?void 0:H.group)?void 0:P.stroke)?_:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(T=null==(L=null==H?void 0:H.group)?void 0:L.strokeArrayColor)?T:void 0,cursor:null!=(I=null==(E=null==H?void 0:H.group)?void 0:E.cursor)?I:void 0,lineDash:null!=(N=null==(D=null==H?void 0:H.group)?void 0:D.lineDash)?N:void 0,lineCap:"butt",clip:!0,cornerRadius:H.group.cornerRadius}),t&&"cell"===t.role||((t=new r.Z({x:o,y:l,width:u,height:m,lineWidth:null!=(O=null==(Z=null==H?void 0:H.group)?void 0:Z.lineWidth)?O:void 0,fill:null!=(V=null==($=null==H?void 0:H.group)?void 0:$.fill)?V:void 0,stroke:null!=(J=null==(U=null==H?void 0:H.group)?void 0:U.stroke)?J:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(j=null==(Y=null==H?void 0:H.group)?void 0:Y.strokeArrayColor)?j:void 0,cursor:null!=(K=null==(X=null==H?void 0:H.group)?void 0:X.cursor)?K:void 0,lineDash:null!=(Q=null==(q=null==H?void 0:H.group)?void 0:q.lineDash)?Q:void 0,lineCap:"butt",clip:!0,cornerRadius:H.group.cornerRadius})).role="cell",t.col=i,t.row=n,null==e||e.addCellGroup(t))}if(R){let t=i,e=n;S&&(t=S.start.col,e=S.start.row),tt=A.getCellIcons(t,e)}let te=0,to=0,tl=0,tr=0,ti=[];if(Array.isArray(tt)&&0!==tt.length){let{leftIconWidth:e,rightIconWidth:o,contentLeftIcons:l,contentRightIcons:r,absoluteLeftIconWidth:i,absoluteRightIconWidth:n}=(0,C.M4)(tt,t,S,A);te=e+o,to=e,tl=o,ti=l,tr=n,t.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+y[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+u-o-y[1]):"icon-absolute-right"===t.role&&t.setAttribute("x",t.attribute.x+u-n-y[1])}),t.forEachChildren(t=>{"middle"===x?t.setAttribute("y",(m-t.AABBBounds.height())/2):"bottom"===x?t.setAttribute("y",m-t.AABBBounds.height()-y[2]):t.setAttribute("y",y[0])})}let tn=function(t,e,o,l,r,i,n,h,s,u){var d,C,f;let w=s._getCellStyle(t,e),m=(0,a.WJ)("size",w,t,e,s),y=(0,a.WJ)("spaceBetweenTextAndIcon",w,t,e,s),v=(0,a.WJ)("defaultFill",w,t,e,s),x=(0,a.WJ)("defaultStroke",w,t,e,s),R=(0,a.WJ)("disableFill",w,t,e,s),A=(0,a.WJ)("checkedFill",w,t,e,s),H=(0,a.WJ)("checkedStroke",w,t,e,s),G=(0,a.WJ)("disableCheckedFill",w,t,e,s),S=(0,a.WJ)("disableCheckedStroke",w,t,e,s),z=(0,a.WJ)("checkIconImage",w,t,e,s),B=(0,a.WJ)("indeterminateIconImage",w,t,e,s),F=s.getCellValue(t,e),M=s.getCellOriginValue(t,e),W,k,P=null!=F?F:"";if((0,c.Z)(F)?(W=F.checked,k=F.disable,P=null!=(d=F.text)?d:""):"boolean"==typeof F&&(W=F,P=""),s.internalProps.layoutMap.isSeriesNumber(t,e)){let o=s.getFieldData(h.field,t,e);o&&("string"==typeof o||("object"==typeof o?(W=o.checked,k=o.disable):"boolean"==typeof o&&(W=o)))}W=s.stateManager.syncCheckedState(t,e,h.field,W);let _=(0,b.L)(t,e,s),L=s._getCellStyle(t,e),T=null!=(C=L.autoWrapText)?C:s.internalProps.autoWrapText,{lineClamp:E}=L,{checked:I,disable:D}=h;if(null==W||"function"==typeof W){let o=(0,p.vi)(I,{col:t,row:e,table:s,context:null,value:F,dataValue:M});W=s.stateManager.syncCheckedState(t,e,h.field,o)}let N=(0,p.vi)(D,{col:t,row:e,table:s,context:null,value:F,dataValue:M}),Z=s.isAutoRowHeight(e),O={text:1===P.length?P[0]:P,maxLineWidth:"auto"===o?1/0:l-(i[1]+i[3]+_)-m-y,textAlign:"left",textBaseline:"top",autoWrapText:T,lineClamp:E,wordBreak:"break-word",heightLimit:Z?-1:r-Math.floor(i[0]+i[2]),pickable:!1,dx:u?0:_,whiteSpace:1!==P.length||T?"normal":"no-wrap"},$={x:0,y:0,text:n.text?Object.assign({},n.text,O):O,icon:{width:Math.floor(m/1.4),height:Math.floor(m/1.4)},box:{width:m,height:m},dx:u?_:0,spaceBetweenTextAndIcon:y,disabled:null!=(f=null!=k?k:N)&&f};"indeterminate"===W?($.checked=void 0,$.indeterminate=!0):($.checked=W,$.indeterminate=void 0),v&&($.box.fill=v),x&&($.box.stroke=x),R&&($.box.disableFill=R),A&&($.box.checkedFill=A),H&&($.box.checkedStroke=H),G&&($.box.disableCheckedFill=G),S&&($.box.disableCheckedStroke=S),z&&($.icon.checkIconImage=z),B&&($.icon.indeterminateIconImage=B);let V=new g.J($);return V.name="checkbox",V}(i,n,h-te,u,m,y,H,G,A,B);if(1!==ti.length||ti[0].name!==d.up.expandIconName&&ti[0].name!==d.up.collapseIconName)tn&&t.appendChild(tn),tn.render();else{let e=new f({x:0,y:0,fill:!1,stroke:!1,pickable:!1});e.name="checkbox-content",e.setCheckboxContentOption({autoWidth:!1,autoHeight:!1,cellWidth:u-(y[1]+y[3]),cellHeight:m-y[0]-y[2],align:v,baseline:x});let o={addedHierarchyOffset:0};ti.forEach(l=>{let r=(0,C.Bg)(l,void 0,t.col,t.row,S,A,o);r.role="icon-content-left",r.name=l.name,e.addLeftOccupyingIcon(r)}),tn&&e.addCheckbox(tn),t.appendChild(e),e.layout(),e.AABBBounds.width(),e.AABBBounds.height();let l=u-(y[1]+y[3]),r=m-(y[0]+y[2]);t.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+y[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+l-tl+y[3]):"icon-absolute-right"===t.role?t.setAttribute("x",t.attribute.x+l-tr+y[3]+y[1]):"content"!==t.name&&"checkbox-content"!==t.name||("center"===v&&"richtext"!==t.type?t.setAttribute("x",y[3]+to+(l-to-tl)/2):"right"===v&&"richtext"!==t.type?t.setAttribute("x",y[3]+l-tl):t.setAttribute("x",y[3]+to))}),t.forEachChildren(t=>{t.name!==w.FH&&("middle"===x?(null==t?void 0:t._checkboxGroup)&&t._leftGroup.setAttribute("y",y[0]+(r-t._checkboxGroup.AABBBounds.height())/2):"bottom"===x?t.setAttribute("y",y[0]+r-t.AABBBounds.height()):t.setAttribute("y",y[0]))})}return u-=y[1]+y[3]+te,m-=y[0]+y[2],"center"===v?tn.setAttribute("x",y[3]+to+(u-tn.AABBBounds.width())/2):"right"===v?tn.setAttribute("x",y[3]+to+u-tn.AABBBounds.width()):tn.setAttribute("x",y[3]+to),"middle"===x?tn.setAttribute("y",y[0]+(m-tn.AABBBounds.height())/2):"bottom"===x?tn.setAttribute("y",y[0]+m-tn.AABBBounds.height()):tn.setAttribute("y",y[0]),t}var y=o(994308),v=o(704654),x=o(695723),R=o(863778),A=o(20408),H=o(383453);function G(t,e,o,l,i,n,h,u,d,c,g,p,C,f,w,m){var y,R,A,H,G,z,B,F,M,W,k,P;if(!t){let a=(0,s.d)(i,n,f,C);(t=new r.Z({x:o,y:l,width:u,height:d,lineWidth:null!=(R=null==(y=null==f?void 0:f.group)?void 0:y.lineWidth)?R:void 0,fill:null!=(H=null==(A=null==f?void 0:f.group)?void 0:A.fill)?H:void 0,stroke:null!=(z=null==(G=null==f?void 0:f.group)?void 0:G.stroke)?z:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(F=null==(B=null==f?void 0:f.group)?void 0:B.strokeArrayColor)?F:void 0,cursor:null!=(W=null==(M=null==f?void 0:f.group)?void 0:M.cursor)?W:void 0,lineDash:null!=(P=null==(k=null==f?void 0:f.group)?void 0:k.lineDash)?P:void 0,lineCap:"butt",clip:!0,cornerRadius:f.group.cornerRadius})).role="cell",t.col=i,t.row=n,null==e||e.addCellGroup(t)}let{width:_,height:L}=function(t,e,o,l,r,i,n,h,s,u,d){var c,g,p,C;let f=d._getCellStyle(t,e),w=(0,a.WJ)("size",f,t,e,d),m=(0,a.WJ)("innerRadius",f,t,e,d),y=(0,a.WJ)("outerRadius",f,t,e,d),R=(0,a.WJ)("spaceBetweenTextAndIcon",f,t,e,d),A=(0,a.WJ)("spaceBetweenRadio",f,t,e,d),H=(0,a.WJ)("defaultFill",f,t,e,d),G=(0,a.WJ)("defaultStroke",f,t,e,d),z=(0,a.WJ)("disableFill",f,t,e,d),B=(0,a.WJ)("checkedFill",f,t,e,d),F=(0,a.WJ)("checkedStroke",f,t,e,d),M=(0,a.WJ)("disableCheckedFill",f,t,e,d),W=(0,a.WJ)("disableCheckedStroke",f,t,e,d);(0,v.Z)(y)?w=2*y:y=Math.round(w/2),(!(0,v.Z)(m)||m<0)&&(m=Math.round(y/7*3));let k=d.getCellValue(t,e),P=d.getCellOriginValue(t,e),_=(0,b.L)(t,e,d),L=d._getCellStyle(t,e),T=null!=(c=L.autoWrapText)?c:d.internalProps.autoWrapText,{lineClamp:E}=L,I=d.isAutoRowHeight(e),D={maxLineWidth:"auto"===o?1/0:l-(i[1]+i[3]+_)-w-R,textAlign:"left",textBaseline:"top",autoWrapText:T,lineClamp:E,wordBreak:"break-word",heightLimit:I?-1:r-Math.floor(i[0]+i[2]),pickable:!1,dx:_},N={x:0,y:0,text:n.text?Object.assign({},n.text,D):D,circle:{innerRadius:m,outerRadius:y},spaceBetweenTextAndIcon:R};H&&(N.circle.fill=H),G&&(N.circle.stroke=G),z&&(N.circle.disableFill=z),B&&(N.circle.checkedFill=B),F&&(N.circle.checkedStroke=F),M&&(N.circle.disableCheckedFill=M),W&&(N.circle.disableCheckedStroke=W);let Z=0,O=0,$=null!=(g=h.radioDirectionInCell)?g:"vertical";if((0,x.Z)(k))k.forEach((o,l)=>{var r,i;let n=S(o,P,l,t,e,h,T,N,d);n&&s.appendChild(n),n.id=`radio-${null!=(r=null==u?void 0:u.start.col)?r:t}-${null!=(i=null==u?void 0:u.start.row)?i:e}-${l}`,n.render();let a=n.AABBBounds;"vertical"===$?(n.setAttribute("y",O),O+=a.height()+(l!==k.length-1?A:0),Z=Math.max(Z,a.width())):"horizontal"===$&&(n.setAttribute("x",Z),Z+=a.width()+(l!==k.length-1?A:0),O=Math.max(O,a.height()))});else{let o=S(k,P,void 0,t,e,h,T,N,d);o&&s.appendChild(o),o.id=`radio-${null!=(p=null==u?void 0:u.start.col)?p:t}-${null!=(C=null==u?void 0:u.start.row)?C:e}`,o.render();let l=o.AABBBounds;Z=l.width(),O=l.height()}return{width:Z,height:O}}(i,n,h,u,d,c,f,w,t,m,C);return u-=c[1]+c[3],d-=c[0]+c[2],t.forEachChildren(t=>{"center"===g?t.setAttribute("x",c[3]+t.attribute.x+(u-_)/2):"right"===g?t.setAttribute("x",c[3]+t.attribute.x+u-_):t.setAttribute("x",c[3]+t.attribute.x),"middle"===p?t.setAttribute("y",c[0]+t.attribute.y+(d-L)/2):"bottom"===p?t.setAttribute("y",c[0]+t.attribute.y+d-L):t.setAttribute("y",c[0]+t.attribute.y)}),t}function S(t,e,o,l,r,i,n,a,h){let s=function(t,e,o,l,r,i,n){var a,h;let s,u,d=null!=(a=i.radioCheckType)?a:"column";return(0,c.Z)(t)?s=t.checked:"boolean"==typeof t&&(s=t),null!=(s=n.stateManager.syncRadioState(l,r,i.field,d,o,s))&&"function"!=typeof s||(u=(0,p.vi)(i.checked,{col:l,row:r,table:n,context:null,value:t,dataValue:e}),s=n.stateManager.syncRadioState(l,r,i.field,d,o,u)),null!=(h=null!=s?s:u)&&h}(t,e,o,l,r,i,h),u=function(t,e,o,l,r,i){var n;let a;(0,c.Z)(t)&&(a=t.disable);let h=(0,p.vi)(r.disable,{col:o,row:l,table:i,context:null,value:t,dataValue:e});return null!=(n=null!=a?a:h)&&n}(t,e,l,r,i,h),d=(0,c.Z)(t)?t.text:(0,R.Z)(t)?"":null!=t?t:"",g=(0,A.Z)({},a,{checked:s,disabled:u,text:{text:1===d.length?d[0]:d,whiteSpace:1!==d.length||n?"normal":"no-wrap"},boundsPadding:0}),b=new H.Y(g);return b.name="radio",b}var z=o(67775);function B(t,e,o,l,i,n,h,u,d,g,f,w,m,y,v,x,R,A){var H,G,S,B,F,M,W,k,P,_,L,T,E,I,D,N,Z,O,$,V,U,J,Y,j;let X;if(!t){let a=(0,s.d)(i,n,v,y);A&&(t=y.scenegraph.highPerformanceGetCell(i,n,!0))&&"cell"===t.role&&t.setAttributes({x:o,y:l,width:u,height:d,lineWidth:null!=(G=null==(H=null==v?void 0:v.group)?void 0:H.lineWidth)?G:void 0,fill:null!=(B=null==(S=null==v?void 0:v.group)?void 0:S.fill)?B:void 0,stroke:null!=(M=null==(F=null==v?void 0:v.group)?void 0:F.stroke)?M:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(k=null==(W=null==v?void 0:v.group)?void 0:W.strokeArrayColor)?k:void 0,cursor:null!=(_=null==(P=null==v?void 0:v.group)?void 0:P.cursor)?_:void 0,lineDash:null!=(T=null==(L=null==v?void 0:v.group)?void 0:L.lineDash)?T:void 0,lineCap:"butt",clip:!0,cornerRadius:v.group.cornerRadius}),t&&"cell"===t.role||((t=new r.Z({x:o,y:l,width:u,height:d,lineWidth:null!=(I=null==(E=null==v?void 0:v.group)?void 0:E.lineWidth)?I:void 0,fill:null!=(N=null==(D=null==v?void 0:v.group)?void 0:D.fill)?N:void 0,stroke:null!=(O=null==(Z=null==v?void 0:v.group)?void 0:Z.stroke)?O:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(V=null==($=null==v?void 0:v.group)?void 0:$.strokeArrayColor)?V:void 0,cursor:null!=(J=null==(U=null==v?void 0:v.group)?void 0:U.cursor)?J:void 0,lineDash:null!=(j=null==(Y=null==v?void 0:v.group)?void 0:Y.lineDash)?j:void 0,lineCap:"butt",clip:!0,cornerRadius:v.group.cornerRadius})).role="cell",t.col=i,t.row=n,null==e||e.addCellGroup(t))}if(m){let t=i,e=n;R&&(t=R.start.col,e=R.start.row),X=y.getCellIcons(t,e)}let K=0,q=0;if(Array.isArray(X)&&0!==X.length){let{leftIconWidth:e,rightIconWidth:o,absoluteLeftIconWidth:l,absoluteRightIconWidth:r}=(0,C.M4)(X,t,R,y);K=e+o,q=e,t.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+g[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+u-o-g[1]):"icon-absolute-right"===t.role&&t.setAttribute("x",t.attribute.x+u-r-g[1])}),t.forEachChildren(t=>{"middle"===w?t.setAttribute("y",(d-t.AABBBounds.height())/2):"bottom"===w?t.setAttribute("y",d-t.AABBBounds.height()-g[2]):t.setAttribute("y",g[0])})}let Q=function(t,e,o,l,r,i,n,h,s){var u,d,g;let C=s._getCellStyle(t,e),f=(0,a.WJ)("spaceBetweenTextAndCircle",C,t,e,s),w=(0,a.WJ)("circleRadius",C,t,e,s),m=(0,a.WJ)("boxWidth",C,t,e,s),y=(0,a.WJ)("boxHeight",C,t,e,s),v=(0,a.WJ)("checkedFill",C,t,e,s),x=(0,a.WJ)("uncheckedFill",C,t,e,s),R=(0,a.WJ)("disableCheckedFill",C,t,e,s),A=(0,a.WJ)("disableUncheckedFill",C,t,e,s),H=(0,a.WJ)("circleFill",C,t,e,s),G=s.getCellValue(t,e),S=s.getCellOriginValue(t,e),B,F,M=null!=G?G:"";(0,c.Z)(G)?(B=G.checked,F=G.disable,M=null!=(u=G.text)?u:""):"boolean"==typeof G&&(B=G,M=""),B=s.stateManager.syncCheckedState(t,e,h.field,B);let W=(0,b.L)(t,e,s),k=s._getCellStyle(t,e),P=null!=(d=k.autoWrapText)?d:s.internalProps.autoWrapText,{lineClamp:_}=k,{checked:L,disable:T,uncheckedText:E,checkedText:I}=h;if(null==B||"function"==typeof B){let o=(0,p.vi)(L,{col:t,row:e,table:s,context:null,value:G,dataValue:S});B=s.stateManager.syncCheckedState(t,e,h.field,o)}let D=(0,p.vi)(T,{col:t,row:e,table:s,context:null,value:G,dataValue:S}),N=(0,p.vi)(I,{col:t,row:e,table:s,context:null,value:G,dataValue:S}),Z=(0,p.vi)(E,{col:t,row:e,table:s,context:null,value:G,dataValue:S}),O=s.isAutoRowHeight(e),$={text:1===M.length?M[0]:M,maxLineWidth:"auto"===o?1/0:l-(i[1]+i[3]+W)-2*w-f,textAlign:"left",textBaseline:"top",autoWrapText:P,lineClamp:_,wordBreak:"break-word",heightLimit:O?-1:r-Math.floor(i[0]+i[2]),pickable:!1,dx:W,whiteSpace:1!==M.length||P?"normal":"no-wrap",checkedText:N,uncheckedText:Z},V={x:0,y:0,text:n.text?Object.assign({},n.text,$):$,circle:{radius:w},box:{width:m,height:y},spaceBetweenTextAndCircle:f,disabled:null!=(g=null!=F?F:D)&&g};V.checked=B,x&&(V.box.uncheckedFill=x),A&&(V.box.disableUncheckedFill=A),v&&(V.box.checkedFill=v),R&&(V.box.disableCheckedFill=R),H&&(V.circle.fill=H);let U=new z.r(V);return U.name="switch",U}(i,n,h-K,u,d,g,v,x,y);return Q&&t.appendChild(Q),Q.render(),u-=g[1]+g[3]+K,d-=g[0]+g[2],"center"===f?Q.setAttribute("x",g[3]+q+(u-Q.AABBBounds.width())/2):"right"===f?Q.setAttribute("x",g[3]+q+u-Q.AABBBounds.width()):Q.setAttribute("x",g[3]+q),"middle"===w?Q.setAttribute("y",g[0]+(d-Q.AABBBounds.height())/2):"bottom"===w?Q.setAttribute("y",g[0]+d-Q.AABBBounds.height()):Q.setAttribute("y",g[0]),t}var F=o(252953),M=o(623579),W=o(806119),k=o(510145);let P=new W.Y,_=new k.f;function L(t,e,o,l,i,n,a,u,d,c,g,b){var p,C,f,w,m,y,v,x,R,A,H,G,S,z,B,M,W,k,L,I,D,N,Z,O;if(!t){let h=(0,s.d)(i,n,g,c);b&&(t=c.scenegraph.highPerformanceGetCell(i,n,!0))&&"cell"===t.role&&t.setAttributes({x:o,y:l,width:a,height:u,lineWidth:null!=(C=null==(p=null==g?void 0:g.group)?void 0:p.lineWidth)?C:void 0,fill:null!=(w=null==(f=null==g?void 0:g.group)?void 0:f.fill)?w:void 0,stroke:null!=(y=null==(m=null==g?void 0:g.group)?void 0:m.stroke)?y:void 0,strokeArrayWidth:h,strokeArrayColor:null!=(x=null==(v=null==g?void 0:g.group)?void 0:v.strokeArrayColor)?x:void 0,cursor:null!=(A=null==(R=null==g?void 0:g.group)?void 0:R.cursor)?A:void 0,lineDash:null!=(G=null==(H=null==g?void 0:g.group)?void 0:H.lineDash)?G:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),t&&"cell"===t.role||((t=new r.Z({x:o,y:l,width:a,height:u,lineWidth:null!=(z=null==(S=null==g?void 0:g.group)?void 0:S.lineWidth)?z:void 0,fill:null!=(M=null==(B=null==g?void 0:g.group)?void 0:B.fill)?M:void 0,stroke:null!=(k=null==(W=null==g?void 0:g.group)?void 0:W.stroke)?k:void 0,strokeArrayWidth:h,strokeArrayColor:null!=(I=null==(L=null==g?void 0:g.group)?void 0:L.strokeArrayColor)?I:void 0,cursor:null!=(N=null==(D=null==g?void 0:g.group)?void 0:D.cursor)?N:void 0,lineDash:null!=(O=null==(Z=null==g?void 0:g.group)?void 0:Z.lineDash)?O:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})).role="cell",t.col=i,t.row=n,null==e||e.addCellGroup(t))}let $=function(t,e,o,l,r,i){let n,a,s,u,d=i.internalProps.layoutMap.getBody(t,e).sparklineSpec,c=i.getCellValue(t,e);if(!Array.isArray(c))return;let g=r[3],b=r[0];o-=r[1]+r[3];let p=l-=r[0]+r[2];"function"==typeof d?a=T(n=d({col:t,row:e,dataValue:i.getCellOriginValue(t,e)||"",value:i.getCellValue(t,e)||"",rect:i.getCellRangeRelativeRect(i.getCellRange(t,e)),table:i}),g,b,o,l):(n=d,a=T(d,g,b,o,l));let C=[],f=[];if("object"==typeof n.xField)P.domain(n.xField.domain),s=n.xField.field;else if("string"==typeof n.xField){let t=c.map(t=>t[n.xField]);P.domain(t),s=n.xField}else Array.isArray(c)&&(P.domain(Array.from({length:c.length},(t,e)=>e)),s=n.xField);if(P.range([0,o]),"object"==typeof n.yField)_.domain(n.yField.domain),u=n.yField.field;else if("string"==typeof n.yField){let t=E(c,n.yField);_.domain([Math.min(...t),Math.max(...t)]),u=n.yField}else if(Array.isArray(c)){let t=E(c);_.domain([Math.min(...t),Math.max(...t)]),u=n.yField}if(_.range([0,l]),"object"==typeof n.xField&&Array.isArray(n.xField.domain)){let t=c.map(t=>t[n.xField.field]),e=n.xField.domain;for(let o=0;o<e.length;o++){let l=!1;for(let r=0;r<t.length;r++)if(e[o]===t[r]){let t=c[r];if(!(0,h.Z)(t[s])||!(0,h.Z)(t[u]))break;C.push({x:0+P.scale(t[s]),y:p-_.scale(t[u]),defined:(0,h.Z)(t[u])}),f.push(t),l=!0;break}l||(C.push({x:0+P.scale(e[o]),y:0,defined:!1}),f.push({[s]:e[o],[u]:null}))}}else for(let t=0;t<c.length;t++){let e=c[t];C.push({x:0+P.scale(s?e[s]:t),y:p-_.scale(u?e[u]:e),defined:(0,h.Z)(u?e[u]:e),rawData:e}),f.push(e)}let w=a.getChildByName("sparkline-line");w&&w.setAttribute("points",C),w.bandwidth=P.step(),w.min=_.range()[0],w.max=_.range()[1];let m=a.getChildByName("sparkline-symbol-group");if(m){let t="isolatedPoint"===n.pointShowRule;if("all"===n.pointShowRule)for(let t=0;t<C.length;t++){let{x:e,y:o,defined:l}=C[t];if(l){let t=(0,F.t)({x:e,y:o});m.appendChild(t)}}else if(t)for(let t=0;t<C.length;t++){let{x:e,y:o,defined:l}=C[t];if(l&&(!C[t-1]||!C[t-1].defined)&&(!C[t+1]||!C[t+1].defined)){let t=(0,F.t)({x:e,y:o});m.appendChild(t)}}}return a}(i,n,a,u,d,c);return $&&t.appendChild($),t}function T(t,e,o,l,i){var n,a,h,s,u,d,c,g,b,p,C,f,w,m,y,v,x,R,A,H,G,S;let z;z="function"==typeof t?t(null):t;let B=new r.Z({x:e,y:o,width:l,height:i,stroke:!1,fill:!1});if(B.name="sparkline","line"===z.type){let t=(0,M.W)({x:0,y:0,curveType:z.smooth?"monotoneX":"linear",stroke:null!=(h=null==(a=null==(n=z.line)?void 0:n.style)?void 0:a.stroke)?h:"blue",lineWidth:null!=(d=null==(u=null==(s=z.line)?void 0:s.style)?void 0:u.strokeWidth)?d:2});t.name="sparkline-line",B.addChild(t),z.crosshair&&(t.hover=null!=(g=null==(c=z.crosshair)?void 0:c.style)?g:{stroke:"#000",interpolate:"linear"});let e=new r.Z({x:0,y:0,width:l,height:i,stroke:!1,fill:!1});e.name="sparkline-symbol-group",e.setTheme({symbol:{stroke:null!=(C=null==(p=null==(b=z.point)?void 0:b.style)?void 0:p.stroke)?C:"#000",lineWidth:null!=(m=null==(w=null==(f=z.point)?void 0:f.style)?void 0:w.strokeWidth)?m:1,fill:null!=(x=null==(v=null==(y=z.point)?void 0:y.style)?void 0:v.fill)?x:"#000",size:2*(null!=(H=null==(A=null==(R=z.point)?void 0:R.style)?void 0:A.size)?H:3),symbolType:"circle"}}),B.addChild(e),e.hover=null!=(S=null==(G=z.point)?void 0:G.hover)&&S}return B}function E(t,e){let o=[];for(let l=0;l<t.length;l++){let r=t[l];(0,h.Z)(e)&&(0,h.Z)(r[e])?o.push(r[e]):!(0,h.Z)(e)&&(0,h.Z)(r)&&o.push(r)}return o}var I=o(507261),D=o(501800),N=o(621044),Z=o(381584),O=o(549360),$=o(376352);let V=D.U2();function U(t,e,o,l,i,n,u,d,c,g,b,p,f,w,m,v,x){var R,A,H,G,S,z,B,F,M,W,k,P,_,L,T,E,D,U,J,Y,j,X,K,q,Q,tt,te,to,tl,tr;let ti,tn,ta=w._getCellStyle(l,i),th=(0,a.vp)("padding",ta,l,i,w);(null==(R=w.options.customConfig)?void 0:R.imageMargin)?g=(0,$.u)(null==(A=w.options.customConfig)?void 0:A.imageMargin):(0,h.Z)(th)&&(g=th),(null==(H=null==m?void 0:m.text)?void 0:H.textAlign)&&(b=null==(G=null==m?void 0:m.text)?void 0:G.textAlign),(null==(S=null==m?void 0:m.text)?void 0:S.textBaseline)&&(p=null==(z=null==m?void 0:m.text)?void 0:z.textBaseline);let ts=(0,s.d)(l,i,m,w);if(x&&(ti=w.scenegraph.highPerformanceGetCell(l,i,!0))&&"cell"===ti.role&&ti.setAttributes({x:e,y:o,width:n,height:u,lineWidth:null!=(F=null==(B=null==m?void 0:m.group)?void 0:B.lineWidth)?F:void 0,fill:null!=(W=null==(M=null==m?void 0:m.group)?void 0:M.fill)?W:void 0,stroke:null!=(P=null==(k=null==m?void 0:m.group)?void 0:k.stroke)?P:void 0,strokeArrayWidth:ts,strokeArrayColor:null!=(L=null==(_=null==m?void 0:m.group)?void 0:_.strokeArrayColor)?L:void 0,cursor:null!=(E=null==(T=null==m?void 0:m.group)?void 0:T.cursor)?E:void 0,lineDash:null!=(U=null==(D=null==m?void 0:m.group)?void 0:D.lineDash)?U:void 0,lineCap:"butt",clip:!0,cornerRadius:m.group.cornerRadius}),ti&&"cell"===ti.role||((ti=new r.Z({x:e,y:o,width:n,height:u,lineWidth:null!=(Y=null==(J=null==m?void 0:m.group)?void 0:J.lineWidth)?Y:void 0,fill:null!=(X=null==(j=null==m?void 0:m.group)?void 0:j.fill)?X:void 0,stroke:null!=(q=null==(K=null==m?void 0:m.group)?void 0:K.stroke)?q:void 0,strokeArrayWidth:ts,strokeArrayColor:null!=(tt=null==(Q=null==m?void 0:m.group)?void 0:Q.strokeArrayColor)?tt:void 0,cursor:null!=(to=null==(te=null==m?void 0:m.group)?void 0:te.cursor)?to:void 0,lineDash:null!=(tr=null==(tl=null==m?void 0:m.group)?void 0:tl.lineDash)?tr:void 0,lineCap:"butt",clip:!0,cornerRadius:m.group.cornerRadius})).role="cell",ti.col=l,ti.row=i,null==t||t.addCellGroup(ti)),f){let t=l,e=i;v&&(t=v.start.col,e=v.start.row),tn=w.getCellIcons(t,e)}let tu=0,td=0;if(Array.isArray(tn)&&0!==tn.length){let{leftIconWidth:t,rightIconWidth:e,absoluteLeftIconWidth:o,absoluteRightIconWidth:l}=(0,C.M4)(tn,ti,v,w);tu=t,td=e,ti.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+g[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+n-e-g[1]):"icon-absolute-right"===t.role&&t.setAttribute("x",t.attribute.x+n-l-g[1])}),ti.forEachChildren(t=>{"middle"===p?t.setAttribute("y",(u-t.AABBBounds.height())/2):"bottom"===p?t.setAttribute("y",u-t.AABBBounds.height()-g[2]):t.setAttribute("y",g[0])}),ti._cellLeftIconWidth=tu,ti._cellRightIconWidth=td}let tc=w.getCellValue(l,i),tg=document.createElement("video");tg.addEventListener("loadeddata",()=>{c&&(0,y.LP)(l,i,tg.videoWidth,tg.videoHeight,w.scenegraph,g,ti);let{width:t,height:e,isMerge:o}=(0,y.SI)(ti,w);if(d){let{width:o,height:l}=(0,N.f)(tg.videoWidth,tg.videoHeight,t-g[1]-g[3],e-g[0]-g[2]),r=(0,O.W)(0,0,t,e,o,l,b,p,g);tb.setAttributes({width:o,height:l,x:r.x,y:r.y,dx:0})}else tb.setAttributes({x:g[3],y:g[0],width:t-g[1]-g[3],height:e-g[2]-g[0],dy:0});o&&(0,y.Gb)(ti.mergeStartCol,ti.mergeEndCol,ti.mergeStartRow,ti.mergeEndRow,w);let{width:r,height:n}=(0,y.SI)(ti,w),a=Math.floor(Math.min(r-g[1]-g[3],n-g[2]-g[0])/2),h=0+(r>tb.attribute.width?tb.attribute.x-0+tb.attribute.width/2:r/2),s=0+(n>tb.attribute.height?tb.attribute.y-0+tb.attribute.height/2:n/2),{dx:u,dy:C}=ti.getChildByName("image",!0).attribute,f=new Z.J({x:h-a/2,y:s-a/2,width:a,height:a,image:V.play.svg,cursor:V.play.cursor,dx:u,dy:C});f.name="play-icon",ti.appendChild(f),w.scenegraph.updateNextFrame()}),tg.onerror=()=>{tb.image=V.damage_pic.svg},tg.src=tc,tg.setAttribute("preload","auto");let tb=(0,I.B)({x:g[3],y:g[0],width:n-g[1]-g[3],height:u-g[2]-g[0],image:tg,cursor:"pointer"});return tb.name="image",tb.keepAspectRatio=d,tb.textAlign=b,tb.textBaseline=p,ti.appendChild(tb),ti}var J=o(30371),Y=o(987373),j=o(669860);function X(t,e,o,l,i,n,u,d,c,g,b,p,f,w,m,y,v,x,R){var A,H,G,S,z,B,F,M,W,k,P,_,L,T,E,I,D,N,Z,O,$,V,U,X,K,q,Q,tt,te,to,tl,tr,ti;let tn,ta=t._getCellStyle(n,u),th=(0,a.vp)("padding",ta,n,u,t);(0,h.Z)(th)&&(b=th),(null==(A=null==v?void 0:v.text)?void 0:A.textAlign)&&(p=null==(H=null==v?void 0:v.text)?void 0:H.textAlign),(null==(G=null==v?void 0:v.text)?void 0:G.textBaseline)&&(f=null==(S=null==v?void 0:v.text)?void 0:S.textBaseline);let ts=t.isAutoRowHeight(u),tu=null!=(z=ta.autoWrapText)?z:t.internalProps.autoWrapText,td=ta.lineClamp,tc=(0,s.d)(n,u,v,t);if(R&&(tn=t.scenegraph.getCell(n,u,!0))&&"cell"===tn.role&&tn.setAttributes({x:l,y:i,width:c,height:g,lineWidth:null!=(F=null==(B=null==v?void 0:v.group)?void 0:B.lineWidth)?F:void 0,fill:null!=(W=null==(M=null==v?void 0:v.group)?void 0:M.fill)?W:void 0,stroke:null!=(P=null==(k=null==v?void 0:v.group)?void 0:k.stroke)?P:void 0,strokeArrayWidth:null!=tc?tc:void 0,strokeArrayColor:null!=(L=null==(_=null==v?void 0:v.group)?void 0:_.strokeArrayColor)?L:void 0,cursor:null!=(E=null==(T=null==v?void 0:v.group)?void 0:T.cursor)?E:void 0,lineDash:null!=(D=null==(I=null==v?void 0:v.group)?void 0:I.lineDash)?D:void 0,lineCap:"butt",clip:!0,cornerRadius:v.group.cornerRadius}),tn&&"cell"===tn.role||((tn=new r.Z({x:l,y:i,width:c,height:g,lineWidth:null!=(Z=null==(N=null==v?void 0:v.group)?void 0:N.lineWidth)?Z:void 0,fill:null!=($=null==(O=null==v?void 0:v.group)?void 0:O.fill)?$:void 0,stroke:null!=(U=null==(V=null==v?void 0:v.group)?void 0:V.stroke)?U:void 0,strokeArrayWidth:null!=tc?tc:void 0,strokeArrayColor:null!=(K=null==(X=null==v?void 0:v.group)?void 0:X.strokeArrayColor)?K:void 0,cursor:null!=(Q=null==(q=null==v?void 0:v.group)?void 0:q.cursor)?Q:void 0,lineDash:null!=(te=null==(tt=null==v?void 0:v.group)?void 0:tt.lineDash)?te:void 0,lineCap:"butt",clip:!0,cornerRadius:v.group.cornerRadius})).role="cell",tn.col=n,tn.row=u,null==o||o.addCellGroup(tn)),m&&tn.appendChild(m),y){let o;if(w){let e=n,l=u;x&&(e=x.start.col,l=x.start.row),o=t.getCellIcons(e,l)}(0,C.Rd)(tn,o,e,b,"auto"===d,ts,tu,"number"==typeof td?td:void 0,tn.attribute.width,tn.attribute.height,p,f,t,v,x),(null==(to=null==v?void 0:v._vtable)?void 0:to.marked)&&function(t,e,o){if("boolean"==typeof t){let t=(0,J.Q)({x:e.attribute.width,y:0,startAngle:Math.PI/2,endAngle:Math.PI,outerRadius:6,fill:"#3073F2",pickable:!1});t.name="mark",e.appendChild(t)}else{let o,l,r,i,n,a,{bgColor:h="#3073F2",shape:s="sector",position:u="right-top",size:d=10,offset:c=0}=t;if("sector"===s)"right-top"===u?(o=e.attribute.width-c,l=c,r=Math.PI/2,i=Math.PI):"left-top"===u?(o=c,l=c,r=0,i=Math.PI/2):"right-bottom"===u?(o=e.attribute.width-c,l=e.attribute.height-c,r=Math.PI,i=Math.PI/2*3):"left-bottom"===u&&(o=c,l=e.attribute.height-c,r=Math.PI/2*3,i=2*Math.PI),n=h,a=(0,J.Q)({x:o,y:l,startAngle:r,endAngle:i,outerRadius:d,fill:n,pickable:!1});else if("triangle"===s){let t,r,i,s;"right-top"===u?(o=e.attribute.width-c,l=c,t=o-d,r=l,i=o,s=l+d):"left-top"===u?(o=c,l=c,t=o+d,r=l,i=o,s=l+d):"right-bottom"===u?(o=e.attribute.width-c,l=e.attribute.height-c,t=o-d,r=l,i=o,s=l-d):"left-bottom"===u&&(o=c,l=e.attribute.height-c,t=o+d,r=l,i=o,s=l-d),n=h,a=(0,Y.p)({points:[{x:o,y:l},{x:t,y:r},{x:i,y:s}],fill:n,pickable:!1})}else"rect"===s&&("right-top"===u?(o=e.attribute.width-d-c,l=c):"left-top"===u?(o=c,l=c):"right-bottom"===u?(o=e.attribute.width-d-c,l=e.attribute.height-d-c):"left-bottom"===u&&(o=c,l=e.attribute.height-d-c),n=h,a=(0,j.f)({x:o,y:l,width:d,height:d,fill:n,pickable:!1}));a.name="mark",e.appendChild(a)}}(null==(tl=null==v?void 0:v._vtable)?void 0:tl.marked,tn,0)}return m&&tn.setAttributes({width:Math.max(tn.attribute.width,null!=(tr=m.attribute.width)?tr:0),height:Math.max(tn.attribute.height,null!=(ti=m.attribute.height)?ti:0)}),tn}function K(t,e,o,l,i,n,h,s,u,d){var c,g,b,C,f,w;if(t.dependField){let e=(0,p.vi)(t.dependField,{col:n,row:h,table:u,value:l,dataValue:i,cellHeaderPaths:void 0});i=null!=(g=null==(c=u.getCellOriginRecord(n,h))?void 0:c[e])?g:i}let m=null!=(b=(0,p.vi)(t.barType,{col:n,row:h,table:u,value:l,dataValue:i,cellHeaderPaths:void 0}))?b:"default",y=null!=(C=(0,p.vi)(t.min,{col:n,row:h,table:u,value:l,dataValue:i,cellHeaderPaths:void 0}))?C:0,x=null!=(f=(0,p.vi)(t.max,{col:n,row:h,table:u,value:l,dataValue:i,cellHeaderPaths:void 0}))?f:y+100,R=0;if(R=d?u.getRowsHeight(d.start.row,d.end.row):u.getRowHeight(h),u.pluginManager&&u.pluginManager.getPluginByName("Master Detail Plugin")){let t=h-u.columnHeaderLevelCount,e=u.internalProps,o=null==(w=null==e?void 0:e.originalRowHeights)?void 0:w.get(t);void 0!==o&&o>0&&(R=o)}let A=o,H=R,G=0;(0,v.Z)(u.theme._contentOffset)&&(G=u.theme._contentOffset);let S=new r.Z({x:-G,y:-G,width:A,height:H});S.name="progress-bar";let{showBar:z,barColor:B,barBgColor:F,barPositiveColor:W,barNegativeColor:k,barAxisColor:P,barRightToLeft:_,showBarMark:L,barMarkPositiveColor:T,barMarkNegativeColor:E,barMarkWidth:I,barMarkPosition:D,barMarkInBar:N}=e,{barHeight:Z,barBottom:O,barPadding:V}=e;1===V.length?V=[V[0],V[0],V[0],V[0]]:2===V.length?V=[V[0],V[1],V[0],V[1]]:3===V.length&&(V=[V[0],V[1],V[2],V[1]]),V=V.map((t,e)=>{if("string"==typeof t&&p.Bd.endsWith(t,"%")){let l=Number(t.substr(0,t.length-1));return 0===e||2===e?R*l/100:o*l/100}return Number(t)});let U=(0,$.u)((0,a.WJ)("borderLineWidth",e,n,h,u)),J=Math.max(V[0],Math.ceil(U[0]/2)),Y=Math.max(V[1],Math.floor(U[1]/2)),X=Math.max(V[2],Math.floor(U[2]/2)),K=Math.max(V[3],Math.ceil(U[3]/2));L&&I>0&&"right"===D&&!1===N&&(Y+=I,K+=I),A-=Y+K,H-=X+J,h===u.rowCount-1&&[0,"0"].includes(O)&&(H-=1);let q=K,Q=A;if(Z="string"==typeof Z&&p.Bd.endsWith(Z,"%")?H*(Z=Number(Z.substr(0,Z.length-1)))/100:Number(Z),O="string"==typeof O&&p.Bd.endsWith(O,"%")?H*(O=Number(O.substr(0,O.length-1)))/100:Number(O),(0,p.vi)(z,{col:n,row:h,table:u,context:null,value:l,dataValue:i})){let t=`${i}`;p.Bd.endsWith(t,"%")&&(t=t.substr(0,t.length-1));let e=Number(t);if(isNaN(e))return S;if("default"===(null!=m?m:"default")){let t=e<y?0:e>x?1:(e-y)/(x-y),o=A,r=J+H-Z-O,a=Math.min(o*t,o),s=_?q+Q-a:q;n!==u.colCount-1||1!==t||_||(a-=1);let d=(0,p.vi)(F,{col:n,row:h,table:u,context:null,value:l,dataValue:i,percentile:t});if(d){let t=(0,j.f)({x:s,y:r,width:o,height:Z,fill:d});S.addChild(t)}let c=(0,p.vi)(B,{col:n,row:h,table:u,context:null,value:l,dataValue:i,percentile:t})||"#20a8d8",g=(0,j.f)({x:s,y:r,width:a,height:Z,fill:c});S.addChild(g)}else if("negative"===m){let t=y<0?-y:0,o=x>0?x:0,r=t/(t+o),a=1-r,s=e>0?e/o:0,d=e<0?-e/t:0,c=A,g=J+H-Z-O,b=(0,p.vi)(F,{col:n,row:h,table:u,context:null,value:l,dataValue:i,percentile:s});if(b){let t=(0,j.f)({x:q,y:g,width:c,height:Z,fill:b});S.addChild(t)}let C=_?a*c:r*c,f=Math.min(c*r*d,c),w=_?{left:q+C,top:g,width:f,height:Z}:{left:q+C-f,top:g,width:f,height:Z},m=(0,p.vi)(k,{col:n,row:h,table:u,context:null,value:l,dataValue:i,percentile:d})||"#20a8d8",v=(0,j.f)({x:w.left,y:w.top,width:w.width,height:w.height,fill:m});S.addChild(v);let G=Math.min(c*a*s,c);n!==u.colCount-1||1!==s||_||(G-=1);let z=_?{left:q+C-G,top:g,width:G,height:Z}:{left:q+C,top:g,width:G,height:Z},B=(0,p.vi)(W,{col:n,row:h,table:u,context:null,value:l,dataValue:i,percentile:s})||"#20a8d8",$=(0,j.f)({x:z.left,y:z.top,width:z.width,height:z.height,fill:B});S.addChild($);let V=_?w.left:z.left,U=(0,p.vi)(P,{col:n,row:h,table:u,context:null,value:l,dataValue:i,percentile:s}),Y=(0,M.W)({x:0,y:0,stroke:U,lineWidth:1,lineDash:[2,2],points:[{x:V,y:0},{x:V,y:R}]});if(S.addChild(Y),L&&(s||d)){let t,e=[];if(s>0)if(t=(0,p.vi)(T,{col:n,row:h,table:u,context:null,value:l,dataValue:i,percentile:s})||"#20a8d8","right"===D){let t=_?z.left+I/2:z.left+z.width+(N?-I/2:I/2);e.push({x:t,y:z.top}),e.push({x:t,y:z.top+z.height})}else"bottom"===D&&(e.push({x:z.left,y:z.top+z.height-I/2}),e.push({x:z.left+z.width,y:z.top+z.height-I/2}));else if(d>0)if(t=(0,p.vi)(E,{col:n,row:h,table:u,context:null,value:l,dataValue:i,percentile:d})||"#20a8d8","right"===D){let t=_?w.left+w.width-I/2:w.left+I/2;e.push({x:t,y:w.top}),e.push({x:t,y:w.top+w.height})}else"bottom"===D&&(e.push({x:w.left,y:w.top+w.height-I/2}),e.push({x:w.left+w.width,y:w.top+w.height-I/2}));let o=(0,M.W)({x:0,y:0,stroke:t,lineWidth:I,points:e});S.addChild(o)}}else if("negative_no_axis"===m){let t,o=Math.max(y<0?-y:0,x>0?x:0),r=0===o?0:Math.abs(e)/o,a=A,s=Math.min(a*r,a);n!==u.colCount-1||1!==r||_||(s-=1);let d=J+H-Z-O,c=_?q+Q-s:q,g=(0,p.vi)(F,{col:n,row:h,table:u,context:null,value:l,dataValue:i,percentile:r});if(g){let t=(0,j.f)({x:c,y:d,width:a,height:Z,fill:g});S.addChild(t)}let b={left:c,top:d,width:s,height:Z};t=e>=0?(0,p.vi)(W,{col:n,row:h,table:u,context:null,value:l,percentile:r,dataValue:i})||"#20a8d8":(0,p.vi)(k,{col:n,row:h,table:u,context:null,value:l,dataValue:i,percentile:r})||"#20a8d8";let C=(0,j.f)({x:b.left,y:b.top,width:b.width,height:b.height,fill:t});if(S.addChild(C),L&&e){let t,o=[];if(t=e>=0?(0,p.vi)(T,{col:n,row:h,table:u,context:null,value:l,dataValue:i,percentile:r})||"#20a8d8":(0,p.vi)(E,{col:n,row:h,table:u,context:null,value:l,dataValue:i,percentile:r})||"#20a8d8","right"===D){let t=_?b.left+I/2:b.left+b.width-I/2;o.push({x:t,y:b.top}),o.push({x:t,y:b.top+b.height})}else"bottom"===D&&(o.push({x:b.left,y:b.top+b.height-I/2}),o.push({x:b.left+b.width,y:b.top+b.height-I/2}));let a=(0,M.W)({x:0,y:0,stroke:t,lineWidth:I,points:o});S.addChild(a)}}}return S}var q=o(483841),Q=o(942747);function tt(t,e,o,l,i,n,h,u,d,c,g,f,w,m,y,v,x,R){var A,H,G,S,z,B,F,M,W,k,P,_,L,T,E,I,D,N,Z,O,$,V,U,J;let Y;if(!t){let a=(0,s.d)(i,n,y,m);R&&(t=m.scenegraph.highPerformanceGetCell(i,n,!0))&&"cell"===t.role&&t.setAttributes({x:o,y:l,width:u,height:d,lineWidth:null!=(H=null==(A=null==y?void 0:y.group)?void 0:A.lineWidth)?H:void 0,fill:null!=(S=null==(G=null==y?void 0:y.group)?void 0:G.fill)?S:void 0,stroke:null!=(B=null==(z=null==y?void 0:y.group)?void 0:z.stroke)?B:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(M=null==(F=null==y?void 0:y.group)?void 0:F.strokeArrayColor)?M:void 0,cursor:null!=(k=null==(W=null==y?void 0:y.group)?void 0:W.cursor)?k:void 0,lineDash:null!=(_=null==(P=null==y?void 0:y.group)?void 0:P.lineDash)?_:void 0,lineCap:"butt",clip:!0,cornerRadius:y.group.cornerRadius}),t&&"cell"===t.role||((t=new r.Z({x:o,y:l,width:u,height:d,lineWidth:null!=(T=null==(L=null==y?void 0:y.group)?void 0:L.lineWidth)?T:void 0,fill:null!=(I=null==(E=null==y?void 0:y.group)?void 0:E.fill)?I:void 0,stroke:null!=(N=null==(D=null==y?void 0:y.group)?void 0:D.stroke)?N:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(O=null==(Z=null==y?void 0:y.group)?void 0:Z.strokeArrayColor)?O:void 0,cursor:null!=(V=null==($=null==y?void 0:y.group)?void 0:$.cursor)?V:void 0,lineDash:null!=(J=null==(U=null==y?void 0:y.group)?void 0:U.lineDash)?J:void 0,lineCap:"butt",clip:!0,cornerRadius:y.group.cornerRadius})).role="cell",t.col=i,t.row=n,null==e||e.addCellGroup(t))}if(w){let t=i,e=n;x&&(t=x.start.col,e=x.start.row),Y=m.getCellIcons(t,e)}let j=0,X=0;if(Array.isArray(Y)&&0!==Y.length){let{leftIconWidth:e,rightIconWidth:o,absoluteLeftIconWidth:l,absoluteRightIconWidth:r}=(0,C.M4)(Y,t,x,m);j=e+o,X=e,t.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+c[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+u-o-c[1]):"icon-absolute-right"===t.role&&t.setAttribute("x",t.attribute.x+u-r-c[1])}),t.forEachChildren(t=>{"middle"===f?t.setAttribute("y",(d-t.AABBBounds.height())/2):"bottom"===f?t.setAttribute("y",d-t.AABBBounds.height()-c[2]):t.setAttribute("y",c[0])})}let K=function(t,e,o,l,r,i,n,h,s){var u,d;let c=s._getCellStyle(t,e),g=(0,a.WJ)("buttonColor",c,t,e,s),C=(0,a.WJ)("buttonBorderColor",c,t,e,s),f=(0,a.WJ)("buttonLineWidth",c,t,e,s),w=(0,a.WJ)("buttonBorderRadius",c,t,e,s),m=(0,a.WJ)("buttonHoverColor",c,t,e,s),y=(0,a.WJ)("buttonHoverBorderColor",c,t,e,s),v=(0,a.WJ)("buttonPadding",c,t,e,s),x=(0,a.WJ)("buttonTextHoverColor",c,t,e,s),R=(0,a.WJ)("buttonDisableColor",c,t,e,s),A=(0,a.WJ)("buttonDisableBorderColor",c,t,e,s),H=(0,a.WJ)("buttonTextDisableColor",c,t,e,s),G=s.getCellValue(t,e),S=s.getCellOriginValue(t,e),z=(0,b.L)(t,e,s),B=s._getCellStyle(t,e),F=null!=(u=B.autoWrapText)?u:s.internalProps.autoWrapText,{lineClamp:M}=B,W=s.isAutoRowHeight(e),{disable:k,text:P}=h,_=(0,p.vi)(k,{col:t,row:e,table:s,context:null,value:G,dataValue:S}),L=(0,p.vi)(P,{col:t,row:e,table:s,context:null,value:G,dataValue:S}),T=null!=(d=null!=L?L:G)?d:"",E={maxLineWidth:"auto"===o?1/0:l-(i[1]+i[3]+z),textAlign:"left",textBaseline:"top",autoWrapText:F,lineClamp:M,wordBreak:"break-word",heightLimit:W?-1:r-Math.floor(i[0]+i[2]),pickable:!1,dx:z,whiteSpace:1!==T.length||F?"normal":"no-wrap"},I=n.text?Object.assign({},n.text,E):E,D={x:0,y:0,cursor:_?"not-allowed":"pointer",disable:_,childrenPickable:!1,text:1===T.length?T[0]:T,textStyle:I,padding:v,panel:{visible:!0,fill:_?R:g,stroke:_?A:C,lineWidth:f,cornerRadius:w},state:{text:{hover:{}},panel:{hover:{fill:m,stroke:y}}}};H&&(D.state.text.fill=H),x&&(D.state.text.hover.fill=x);let N=new Q.V(D);return N.name="button",_||(N.addEventListener("mouseenter",()=>{N.addState("hover",!0,!1),N.stage.renderNextFrame()}),N.addEventListener("mouseleave",()=>{N.removeState("hover",!1),N.stage.renderNextFrame()})),N}(i,n,h-j,u,d,c,y,v,m);return K&&t.appendChild(K),u-=c[1]+c[3]+j,d-=c[0]+c[2],"center"===g?K.setAttribute("x",c[3]+X+(u-K.AABBBounds.width())/2):"right"===g?K.setAttribute("x",c[3]+X+u-K.AABBBounds.width()):K.setAttribute("x",c[3]+X),"middle"===f?K.setAttribute("y",c[0]+(d-K.AABBBounds.height())/2):"bottom"===f?K.setAttribute("y",c[0]+d-K.AABBBounds.height()):K.setAttribute("y",c[0]),t}let te=()=>{l.F.registerFunction("createChartCellGroup",u),l.F.registerFunction("getAxisDomainRangeAndLabels",q.f)},to=()=>{l.F.registerFunction("createCheckboxCellGroup",m)},tl=()=>{l.F.registerFunction("createImageCellGroup",y.Ui)},tr=()=>{l.F.registerFunction("createProgressBarCell",K)},ti=()=>{l.F.registerFunction("createRadioCellGroup",G)},tn=()=>{l.F.registerFunction("createSwitchCellGroup",B)},ta=()=>{l.F.registerFunction("createButtonCellGroup",tt)},th=()=>{l.F.registerFunction("createSparkLineCellGroup",L)},ts=()=>{l.F.registerFunction("createTextCellGroup",X)},tu=()=>{l.F.registerFunction("createVideoCellGroup",U)}},201028:function(t,e,o){o.d(e,{al:()=>w,j8:()=>y,rj:()=>f});var l=o(936781),r=o(839818),i=o(376352),n=o(297),a=o(254833),h=o(364776),s=o(796241),u=o(480971),d=o(695723),c=o(704654),g=o(23946),b=o(768595),p=o(26249),C=o(135759);function f(t,e,o,l){var r,i,n,a,h,s,u,d,c,g;t.internalProps.columnWidthConfig&&(c=t,g=t.internalProps.columnWidthConfig,c.isPivotTable()?function(t,e){for(let o=0;o<(null==e?void 0:e.length);o++){let l=e[o],r=l.dimensions,i=l.width,n=t.getCellAddressByHeaderPaths(r);if(n&&n.col>=t.rowHeaderLevelCount){let e=t.getCellHeaderPaths(n.col,t.columnHeaderLevelCount);if(e.colHeaderPaths.length===r.length){let o=!0;for(let t=0;t<r.length;t++){let l=r[t];if(0>e.colHeaderPaths.findIndex((t,e)=>t.indicatorKey===l.indicatorKey||t.dimensionKey===l.dimensionKey&&t.value===l.value)){o=!1;break}}o&&!t.internalProps._widthResizedColMap.has(n.col)&&(t._setColWidth(n.col,i),t.internalProps._widthResizedColMap.add(n.col))}}else n&&n.col<t.rowHeaderLevelCount&&(t.internalProps._widthResizedColMap.has(n.col)||(t._setColWidth(n.col,i),t.internalProps._widthResizedColMap.add(n.col)))}}(c,g):c.isListTable()&&function(t,e){for(let o=0;o<(null==e?void 0:e.length);o++){let l=e[o],r=l.key,i=l.width,n=t.internalProps.layoutMap.getColumnByKey(r);if(n.columnDefine){let{col:e}=n;t.internalProps._widthResizedColMap.has(e)||(t._setColWidth(e,i),t.internalProps._widthResizedColMap.add(e))}}}(c,g)),t.isPivotTable()&&t.internalProps.columnWidthConfigForRowHeader&&function(t,e){for(let o=0;o<(null==e?void 0:e.length);o++){let l=e[o],r=l.dimensions,i=l.width,n=t.getCellAddressByHeaderPaths(r);n&&n.col<t.rowHeaderLevelCount&&(t.internalProps._widthResizedColMap.has(n.col)||(t._setColWidth(n.col,i),t.internalProps._widthResizedColMap.add(n.col)))}}(t,t.internalProps.columnWidthConfigForRowHeader),e=null!=e?e:0,o=null!=o?o:t.colCount-1,0===e&&o===t.colCount-1&&t._clearColRangeWidthsMap();let b=t.internalProps.layoutMap;t.isPivotTable()&&(b.enableUseGetBodyCache(),b.enableUseHeaderPathCache());let p=[],C=[];if(l)for(let e=0;e<t.colCount;e++)p[e]=t.getColWidth(e);for(let h=e;h<=o;h++){let e;if(!t.internalProps.transpose&&("only-header"===(null==(i=null==(r=t.internalProps.layoutMap.columnObjects)?void 0:r[h])?void 0:i.columnWidthComputeMode)||"only-header"===t.columnWidthComputeMode)&&"showHeader"in t.internalProps.layoutMap){let o=t.internalProps.layoutMap.showHeader;t.internalProps.layoutMap.showHeader=!0,e=w(h,0,t.internalProps.layoutMap.headerLevelCount-1,t),t.internalProps.layoutMap.showHeader=o}else e=t.internalProps.transpose||"only-body"!==(null==(a=null==(n=t.internalProps.layoutMap.columnObjects)?void 0:n[h])?void 0:a.columnWidthComputeMode)&&"only-body"!==t.columnWidthComputeMode?w(h,0,t.rowCount-1,t):w(h,t.internalProps.layoutMap.getBodyRange().start.row,t.internalProps.layoutMap.getBodyRange().end.row,t);t._setColContentWidth(h,e),t.getColWidth(h)!==e&&t._clearColRangeWidthsMap(h),l?C[h]=Math.round(t._adjustColWidth(h,e)):t._setColWidth(h,t._adjustColWidth(h,e),!1,!0)}if("adaptive"===t.widthMode){t._clearColRangeWidthsMap();let e=t.tableNoFrameWidth,o=0,r=0,i=t.colCount;if("only-body"===t.widthAdaptiveMode){for(let e=0;e<t.colCount;e++){let r=l&&null!=(h=C[e])?h:t.getColWidth(e);(e<t.rowHeaderLevelCount||t.isPivotChart()&&e>=t.colCount-t.rightFrozenColCount)&&(o+=r)}r=t.rowHeaderLevelCount,i=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount}y(e-o,r,i,l,C,t)}else if(t.autoFillWidth){t._clearColRangeWidthsMap();let e=t.tableNoFrameWidth,o=0,r=0;for(let e=0;e<t.colCount;e++){let i=l&&null!=(s=C[e])?s:t.getColWidth(e);"only-body"===t.widthAdaptiveMode&&(e<t.rowHeaderLevelCount+t.leftRowSeriesNumberCount||t.isPivotChart()&&e>=t.colCount-t.rightFrozenColCount)&&(o+=i),r+=i}if(r<e&&r>o){let r=0,i=t.colCount;"only-body"===t.widthAdaptiveMode&&(r=t.rowHeaderLevelCount+t.leftRowSeriesNumberCount,i=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount),y(e-o,r,i,l,C,t)}}if(l){for(let e=0;e<t.colCount;e++){let o=null!=(d=null!=(u=C[e])?u:t.getColWidth(e))?d:t.getColWidth(e);o!==p[e]&&t._setColWidth(e,o,!1,!0)}t.stateManager.checkFrozen();for(let e=0;e<t.colCount;e++){let o=t.getColWidth(e);o!==p[e]&&t.scenegraph.updateColWidth(e,o-p[e],!0,!0)}t.scenegraph.updateContainer({async:!0})}t.isPivotTable()&&(b.disableUseGetBodyCache(),b.disableUseHeaderPathCache())}function w(t,e,o,l,r=!1){let i=function(t,e){let o=e.getColWidthDefined(t);return e.internalProps._widthResizedColMap.has(t)?e.getColWidth(t):o}(t,l);return l.internalProps.transpose&&"auto"===i&&("only-header"===l.columnWidthComputeMode&&t>=l.rowHeaderLevelCount||"only-body"===l.columnWidthComputeMode&&t<l.rowHeaderLevelCount)&&(i=l.getDefaultColumnWidth(t)),r&&!l.internalProps.transpose?m(i,t,e,o,r,l):"number"==typeof i?i:"auto"!==i&&"string"==typeof i?l._adjustColWidth(t,l._colWidthDefineToPxWidth(i)):m(i,t,e,o,r,l)}function m(t,e,o,f,w,m){var y,v,x,R,A;let H=0,G=1,S=1;if(f-o>5e3&&(S=Math.ceil((f-o)/5e3)),m.isPivotChart()&&e>=m.rowHeaderLevelCount&&e<m.colCount-m.rightFrozenColCount){if(m.internalProps.layoutMap.indicatorsAsCol)return m.defaultColWidth;{let t=!1;"heatmap"===m.internalProps.layoutMap.getChartSpec(e,m.columnHeaderLevelCount).type&&(t=!0);let o=m.internalProps.layoutMap.getOptimunWidthForChart(e,t);if(o>0)return o}}for(let z=o;z<=f;z+=G){if(m.isPivotChart()){let t=m.internalProps.layoutMap,o=t.getAxisConfigInPivotChart(e,z);if(o){let t=a.F.getFunction("computeAxisComponentWidth")(o,m);if("number"==typeof t){H=Math.max(t,H);continue}}else if(t.isLeftBottomCorner(e,z)||t.isRightTopCorner(e,z)||t.isRightBottomCorner(e,z)||t.isAxisCell(e,z))continue}let o=function(t,e,o){var l,r,a,h,u,d,c,b,C,f;let w=o.getCustomRender(t,e),m=o.getCustomLayout(t,e);if(w||m){let y,v=1,x=0,R=!1,A=!1;(o.isHeader(t,e)||(null==(l=o.getBodyColumnDefine(t,e))?void 0:l.mergeCell)||o.hasCustomMerge())&&(v=(y=o.getCellRange(t,e)).end.col-y.start.col+1);let H={col:null!=(r=null==y?void 0:y.start.col)?r:t,row:null!=(a=null==y?void 0:y.start.row)?a:e,dataValue:o.getCellOriginValue(t,e),value:o.getCellValue(t,e)||"",rect:(b=t,C=e,{left:0,top:0,right:(f=o).getColWidth(b),bottom:f.getRowHeight(C),width:null,height:null}),table:o,originCol:t,originRow:e,forComputation:!0};if("react-custom-layout"===m&&(m=(null==(h=o.reactCustomLayout)?void 0:h.getCustomLayoutFunc(t,e))||p.D),(0,s.Z)(m)){let t=m(H);if(t.rootContainer){t.rootContainer=(0,g.nH)(t.rootContainer),(0,g.Jp)(t.rootContainer,0,o.getRowHeight(e));let l=t.rootContainer.attribute.width;t.rootContainer.setStage(o.scenegraph.stage),x=l>0?l:null!=(u=t.rootContainer.AABBBounds.width())?u:0,R=t.renderDefault,A=t.enableCellPadding}else x=0,R=t.renderDefault,A=t.enableCellPadding}else if("function"==typeof w){let t=w(H);x=null!=(d=null==t?void 0:t.expectedWidth)?d:0,R=null==t?void 0:t.renderDefault}else x=null!=(c=null==w?void 0:w.expectedWidth)?c:0,R=null==w?void 0:w.renderDefault;if(x=Math.ceil(x),A){let l=o._getCellStyle(t,e),r=(0,i.u)((0,n.WJ)("padding",l,t,e,o));x+=r[1]+r[3]}return{width:x/v,renderDefault:R}}}(e,z,m);if(o&&(H=Math.max(o.width,H),!o.renderDefault))continue;if("number"==typeof t&&"standard"===m.widthMode&&!w){H=Math.max(t,H);continue}let f=m.isHeader(e,z)?null==(y=m._getHeaderLayoutMap(e,z))?void 0:y.headerType:m.getBodyColumnType(e,z);if((0,h.Z)(f)&&"text"!==f&&"link"!==f&&"progressbar"!==f&&"checkbox"!==f&&"radio"!==f&&"switch"!==f&&"button"!==f){H=Math.max(H,m.getColWidthDefinedNumber(e)||0);continue}let B=0,F=m.internalProps.layoutMap;if(F.isHeader(e,z)){let t=F.getHeader(e,z);if("only-body"===(null==(v=null==t?void 0:t.define)?void 0:v.columnWidthComputeMode))continue;(0,h.Z)(null==t?void 0:t.hierarchyLevel)&&(B=(null!=(x=t.hierarchyLevel)?x:0)*("tree"===F.rowHierarchyType&&null!=(R=F.rowHierarchyIndent)?R:0),F.rowHierarchyTextStartAlignment&&!m.internalProps.headerHelper.getHierarchyIcon(e,z)&&(B+=m.internalProps.headerHelper.getHierarchyIconWidth()))}else if(m.isListTable()){G=S;let t=m.getBodyColumnDefine(e,z);if(null==t?void 0:t.tree){let t=m.dataSource.getIndexKey(m.getRecordShowIndexByCell(e,z));B=Array.isArray(t)&&m.getHierarchyState(e,z)!==l.g.none?(t.length-1)*(null!=(A=F.hierarchyIndent)?A:0):0,F.hierarchyTextStartAlignment&&!m.internalProps.bodyHelper.getHierarchyIcon(e,z)&&(B+=m.internalProps.headerHelper.getHierarchyIconWidth())}}H=Math.max(function(t,e,o,l){var a,h,s,g;let p,f=0,w=l.getCellValue(t,e),m=l._getCellStyle(t,e),y=0,v=!1;if("body"!==l.getCellLocation(t,e))v=!0;else{let o=l.getBodyColumnDefine(t,e);v=!!(null==o?void 0:o.icon)||!!(null==o?void 0:o.tree)||(null==o?void 0:o.dragOrder)}if(v){let o=l.getCellIcons(t,e);null==o||o.forEach(t=>{var e,o,l;t.positionType!==r.q0.absoluteRight&&(y+=(null!=(e=t.width)?e:0)+(null!=(o=t.marginLeft)?o:0)+(null!=(l=t.marginRight)?l:0))})}let x=1;if(l.isHeader(t,e)||(null==(a=l.getBodyColumnDefine(t,e))?void 0:a.mergeCell)||l.hasCustomMerge()){let o=l.getCellRange(t,e);x=o.end.col-o.start.col+1}let R=(0,i.u)((0,n.WJ)("padding",m,t,e,l)),A=R[1]+R[3],H=(0,n.WJ)("fontSize",m,t,e,l),G=(0,n.WJ)("fontFamily",m,t,e,l),S=(0,n.WJ)("fontWeight",m,t,e,l);if("checkbox"===o)p=(0,u.Z)(w)?w.text:w;else if("radio"===o)if((0,d.Z)(w)){p="";let o=l.getBodyColumnDefine(t,e),r=null!=(h=null==o?void 0:o.radioDirectionInCell)?h:"vertical";"vertical"===r?w.forEach(t=>{p+=((0,u.Z)(t)?t.text:t).toString()+"\n"}):"horizontal"===r&&w.forEach(t=>{p+=((0,u.Z)(t)?t.text:t).toString()})}else p=(0,u.Z)(w)?w.text:w;else if("button"===o){let o=l.getBodyColumnDefine(t,e),r=(0,C.vi)(o.text,{col:t,row:e,table:l,context:null,value:w,dataValue:l.getCellOriginValue(t,e)});p=null!=(s=null!=r?r:w)?s:""}else p=w;let z=(0,b.$)(p,l).text;if(z.length>=1&&(1!==z.length||""!==z[0])?z.forEach(t=>{f=Math.max((l.measureText(t,{fontSize:H,fontFamily:G,fontWeight:S}).width+A+4+y)/x,f)}):f=Math.max((A+4+y)/x,f),!1!==l.internalProps.limitMaxAutoWidth&&(f=Math.min("number"==typeof l.internalProps.limitMaxAutoWidth?l.internalProps.limitMaxAutoWidth:450,f)),"checkbox"===o){let o=(0,n.WJ)("size",m,t,e,l);if(f+=o,p){let o=(0,n.WJ)("spaceBetweenTextAndIcon",m,t,e,l);f+=o}}else if("radio"===o){let o=(0,n.WJ)("size",m,t,e,l),r=(0,n.WJ)("outerRadius",m,t,e,l),i=(0,c.Z)(r)?2*r:o,a=(0,n.WJ)("spaceBetweenTextAndIcon",m,t,e,l);if((0,d.Z)(w)){let o=l.getBodyColumnDefine(t,e),r=(0,n.WJ)("spaceBetweenRadio",m,t,e,l),h=null!=(g=null==o?void 0:o.radioDirectionInCell)?g:"vertical";"vertical"===h?(f+=i,f+=a):"horizontal"===h&&(f+=(i+a)*w.length,f+=r*(w.length-1))}else f+=i,p&&(f+=a)}else if("switch"===o)f=(0,n.WJ)("boxWidth",m,t,e,l);else if("button"===o){let o=(0,n.WJ)("buttonPadding",m,t,e,l);f+=2*o}return f}(e,z,f,m)+B,H),G>1&&m.bottomFrozenRowCount>0&&z<m.rowCount-m.bottomFrozenRowCount&&z+G>=m.rowCount-m.bottomFrozenRowCount&&(z=m.rowCount-m.bottomFrozenRowCount-G,G=1,S=1)}let z=m.getMinColWidth(e),B=m.getMaxColWidth(e);return H<z?z:H>B?B:(H<=0&&(H=m.defaultColWidth),H)}function y(t,e,o,l,r,i,n){var a,h,s,u;let d=0,c=[],g=[],b=0,p=new Map,C=new Map;for(let t=e;t<o;t++){let e=l&&null!=(a=r[t])?a:i.getColWidth(t),o=i.getMaxColWidth(t),n=i.getMinColWidth(t);d+=e,c.push(t),o===e?p.set(t,e):n===e&&C.set(t,e),(null==(h=i.options.customConfig)?void 0:h.shrinkSparklineFirst)&&"sparkline"===i.getBodyColumnType(t,0)&&(g.push({col:t,width:e}),b+=e-i.defaultColWidth)}if(d>t)for(let[e,o]of C){t-=o,d-=o;let l=c.indexOf(e);-1!==l&&c.splice(l,1)}else if(d<t)for(let[e,o]of p){t-=o,d-=o;let l=c.indexOf(e);-1!==l&&c.splice(l,1)}let f=t/d;if((null==(s=i.options.customConfig)?void 0:s.shrinkSparklineFirst)&&f<1&&d-t<b)for(let e=0;e<g.length;e++){let{col:o,width:a}=g[e],h=Math.floor(a-(d-t)/g.length);l?r[o]=i._adjustColWidth(o,h):n?i.scenegraph.setColWidth(o,i._adjustColWidth(o,h)):i._setColWidth(o,i._adjustColWidth(o,h),!1,!0)}else for(let e=0;e<c.length;e++){let o,a=c[e];o=e===c.length-1?t-c.reduce((t,e,o)=>{var n;return e!==a?t+(l?null!=(n=r[e])?n:i.getColWidth(a):i.getColWidth(e)):t},0):Math.round((l&&null!=(u=r[a])?u:i.getColWidth(a))*f),l?r[a]=i._adjustColWidth(a,o):n?i.scenegraph.setColWidth(a,i._adjustColWidth(a,o)):i._setColWidth(a,i._adjustColWidth(a,o),!1,!0)}}},643624:function(t,e,o){o.d(e,{P:()=>F,Y:()=>B});var l=o(505850),r=o(839818),i=o(297),n=o(376352),a=o(944216),h=o(254833),s=o(695723),u=o(364776),d=o(704654),c=o(796241),g=o(23946),b=o(727594),p=o(648523),C=o(480971),f=o(75665),w=o(593439),m=o(383453),y=o(942747);let v=new w.J({}),x=new m.Y({}),R=new y.V({});function A(t,e,o,l,r,n,a,h,s,u,c,g,b,p,w){let m=(0,C.Z)(t)?t.text:t,y=(0,f.cw)(m).split("\n")||[],v=w.getColsWidth(e,l),R=(0,i.WJ)("size",r,e,o,w),A=(0,i.WJ)("outerRadius",r,e,o,w),H=(0,d.Z)(A)?2*A:R,G=0;if(n){let t=(0,i.WJ)("spaceBetweenTextAndIcon",r,e,o,w),l=v-(p[1]+p[3])-a-H-t;(0,d.Z)(A)||(A=Math.round(R/2)),x.setAttributes({text:{maxLineWidth:l,text:y,fontSize:h,fontStyle:s,fontWeight:u,fontFamily:c,lineHeight:g,wordBreak:"break-word",lineClamp:b},circle:{outerRadius:A},spaceBetweenTextAndIcon:t}),x.render(),G=x.AABBBounds.height()}else G=Math.max(R,y.length*g);return G}var H=o(908429),G=o(768595),S=o(26249);let z=new l.H({width:0,height:0,textConfig:[]});function B(t,e,o,l=!0,r){var i,n,a,h,d,c,g,p,C,f,w;let m=[],y=[];if(r)for(let l=e;l<=o;l++)m[l]=t.getRowHeight(l);let v=t.internalProps.layoutMap;t.isPivotTable()&&(v.enableUseGetBodyCache(),v.enableUseHeaderPathCache()),t.defaultHeaderRowHeight,t.defaultHeaderColWidth;let x="auto"===t.defaultHeaderRowHeight||(0,s.Z)(t.defaultHeaderRowHeight)&&t.defaultHeaderRowHeight.some(t=>"auto"===t),R=t.isAutoRowHeight(e)||"adaptive"===t.heightMode&&!1!==t.options.autoHeightInAdaptiveMode,A="auto"===t.options.defaultRowHeight;if(R||x||A){e=null!=e?e:0,o=null!=o?o:t.rowCount-1,(0===e&&o===t.rowCount-1||l)&&t._clearRowRangeHeightsMap();for(let o=e;o<t.columnHeaderLevelCount;o++){let e=0,l=t.colCount-1;if((t.isPivotTable()&&!t.isPivotChart()||t.isPivotChart()&&!t.internalProps.layoutMap.indicatorsAsCol)&&function(t,e){var o,l,r;let{layoutMap:i}=t.internalProps;if(t.internalProps.autoWrapText&&(t.isAutoRowHeight(e)||"adaptive"===t.options.heightMode))return!1;let n=i.getHeader(t.rowHeaderLevelCount,e);if("function"==typeof n.style||"function"==typeof n.icons||(null==(o=n.define)?void 0:o.headerCustomRender)||(null==(l=n.define)?void 0:l.headerCustomLayout)||"function"==typeof(null==(r=n.define)?void 0:r.icon))return!1;let a=t._getCellStyle(t.rowHeaderLevelCount,e);return"function"!=typeof a.padding&&"function"!=typeof a.fontSize&&"function"!=typeof a.lineHeight&&!0!==a.autoWrapText}(t,o)&&!(0,b.Z)(t,t.rowHeaderLevelCount,o)&&(e=0,l=t.rowHeaderLevelCount),R||"auto"===t.getDefaultRowHeight(o)){let i=F(o,e,l,t);y[o]=Math.round(i),"only-body"!==t.heightAdaptiveMode&&r||t._setRowHeight(o,i)}}for(let e=t.rowCount-t.bottomFrozenRowCount;e<=o;e++)if(R||"auto"===t.getDefaultRowHeight(e)){let o=F(e,0,t.colCount-1,t);r?y[e]=Math.round(o):t._setRowHeight(e,o)}if(!(o<t.columnHeaderLevelCount)&&(R||A))if(t.internalProps.transpose||t.isPivotTable()&&!t.internalProps.layoutMap.indicatorsAsCol||t.options.customComputeRowHeight||t.options.rowHeightConfig||!function(t,e){var o,l,r;let{layoutMap:i}=t.internalProps,n=t.columnHeaderLevelCount;if((t.internalProps.autoWrapText||t.internalProps.enableLineBreak||t.isPivotChart())&&(t.isAutoRowHeight(e)||"adaptive"===t.options.heightMode))return!1;for(let e=0;e<t.colCount;e++){let a=i.getBody(e,n);if("radio"===a.cellType||"function"==typeof a.style||"function"==typeof a.icon||(null==(o=a.define)?void 0:o.customRender)||(null==(l=a.define)?void 0:l.customLayout)||"function"==typeof(null==(r=a.define)?void 0:r.icon))return!1;let h=t._getCellStyle(e,n);if("function"==typeof h.padding||"function"==typeof h.fontSize||"function"==typeof h.lineHeight||!0===h.autoWrapText)return!1}return!0}(t,e))if(t.internalProps.transpose||t.isPivotTable()&&!t.internalProps.layoutMap.indicatorsAsCol)for(let l=Math.max(e,t.columnHeaderLevelCount);l<=o;l++){let e;e=!function(t,e){var o,l,r;let{layoutMap:i}=t.internalProps;if((t.internalProps.autoWrapText||t.internalProps.enableLineBreak)&&(t.isAutoRowHeight(e)||"adaptive"===t.options.heightMode))return!1;let n=i.getBody(t.rowHeaderLevelCount,e);if("function"==typeof n.style||"function"==typeof n.icon||(null==(o=n.define)?void 0:o.customRender)||(null==(l=n.define)?void 0:l.customLayout)||"function"==typeof(null==(r=n.define)?void 0:r.icon))return!1;let a=t._getCellStyle(t.rowHeaderLevelCount,e);return"function"!=typeof a.padding&&"function"!=typeof a.fontSize&&"function"!=typeof a.lineHeight&&!0!==a.autoWrapText}(t,l)?F(l,0,t.colCount-1,t):F(l,0,t.rowHeaderLevelCount,t),r?y[l]=Math.round(e):t._setRowHeight(l,e)}else for(let l=Math.max(e,t.columnHeaderLevelCount);l<=o;l++){let e=F(l,0,t.colCount-1,t);r?y[l]=Math.round(e):t._setRowHeight(l,e)}else{!function(t,e,o,l,r){if(!l.internalProps.useOneRowHeightFillAll){for(let i=e;i<=o;i++)r?r[i]=t:l._setRowHeight(i,t);l.internalProps.useOneRowHeightFillAll=!0}}(F(t.columnHeaderLevelCount,0,t.colCount-1,t),t.columnHeaderLevelCount,t.rowCount-1-t.bottomFrozenRowCount,t,r?y:void 0);for(let e=t.rowCount-t.bottomFrozenRowCount;e<=o;e++){let o=F(e,0,t.colCount-1,t);r?y[e]=Math.round(o):t._setRowHeight(e,o)}}}else if(("adaptive"===t.heightMode||t.autoFillHeight)&&t.clearRowHeightCache(),r)for(let l=e;l<=o;l++)y[l]=t.getRowHeight(l);if((0===e&&o===t.rowCount-1||l)&&t._clearRowRangeHeightsMap(),"adaptive"===t.heightMode){t._clearRowRangeHeightsMap();let e=t.tableNoFrameHeight,o=0,l=t.rowCount;if("only-body"===t.heightAdaptiveMode){let r=t.getRowsHeight(0,t.columnHeaderLevelCount-1),i=t.isPivotChart()?t.getBottomFrozenRowsHeight():0;e=t.tableNoFrameHeight-r-i,o=t.columnHeaderLevelCount,l=t.isPivotChart()?t.rowCount-t.bottomFrozenRowCount:t.rowCount}let a=0;for(let e=o;e<l;e++)a+=r&&null!=(i=y[e])?i:t.getRowHeight(e);let h=e/a;for(let i=o;i<l;i++){let a;a=i===l-1?e-(r?y.reduce((t,e,r)=>r>=o&&r<=l-2?t+e:t,0):t.getRowsHeight(o,l-2)):Math.round((r&&null!=(n=y[i])?n:t.getRowHeight(i))*h),r?y[i]=a:t._setRowHeight(i,a,!1)}}else if(t.autoFillHeight){t._clearRowRangeHeightsMap();let e=t.tableNoFrameHeight,o=0,l=0;for(let e=0;e<t.rowCount;e++){let i=r&&null!=(a=y[e])?a:t.getRowHeight(e);(e<t.columnHeaderLevelCount||t.isPivotChart()&&e>=t.rowCount-t.bottomFrozenRowCount)&&(l+=i),o+=i}if(t.scenegraph._dealAutoFillHeightOriginRowsHeight=o,o<e&&o-l>0){let i=t.columnHeaderLevelCount,n=t.isPivotChart()?t.rowCount-t.bottomFrozenRowCount:t.rowCount,a=(e-l)/(o-l);for(let o=i;o<n;o++){let s;s=o===n-1?e-l-(r?y.reduce((t,e,o)=>o>=i&&o<=n-2?t+e:t,0):t.getRowsHeight(i,n-2)):Math.round((r&&null!=(h=y[o])?h:t.getRowHeight(o))*a),r?y[o]=s:t._setRowHeight(o,s,!1)}}}if(r){for(let l=e;l<=o;l++){let e=null!=(d=y[l])?d:t.getRowHeight(l);(0,u.Z)(e)&&t._setRowHeight(l,e)}for(let e=0;e<=t.frozenRowCount-1;e++){let o=t.getRowHeight(e);o!==(null!=(c=m[e])?c:t.getRowHeight(e))&&t.scenegraph.updateRowHeight(e,o-(null!=(g=m[e])?g:t.getRowHeight(e)),!0)}for(let e=t.rowCount-t.bottomFrozenRowCount;e<=t.rowCount-1;e++){let o=t.getRowHeight(e);o!==(null!=(p=m[e])?p:t.getRowHeight(e))&&t.scenegraph.updateRowHeight(e,o-(null!=(C=m[e])?C:t.getRowHeight(e)),!0)}for(let e=t.scenegraph.proxy.rowStart;e<=t.scenegraph.proxy.rowEnd;e++){let o=t.getRowHeight(e);o!==(null!=(f=m[e])?f:t.getRowHeight(e))&&t.scenegraph.updateRowHeight(e,o-(null!=(w=m[e])?w:t.getRowHeight(e)),!0)}}t.isPivotTable()&&(v.disableUseGetBodyCache(),v.disableUseHeaderPathCache())}function F(t,e,o,l){var b;let w;if(!(l.isAutoRowHeight(t)||"adaptive"===l.heightMode&&!1!==l.options.autoHeightInAdaptiveMode)&&"auto"!==l.getDefaultRowHeight(t))return l.getDefaultRowHeight(t);if(l.options.customComputeRowHeight){let e=l.options.customComputeRowHeight({row:t,table:l});if("number"==typeof e)return e;if("auto"!==e)return l.getDefaultRowHeight(t)}if(l.internalProps.rowHeightConfig){let e=l.internalProps.rowHeightConfig.find(e=>e.key===t);if(e)return l.internalProps._heightResizedRowMap.has(t)||(l._setRowHeight(t,e.height),l.internalProps._heightResizedRowMap.add(t)),e.height}if(l.isPivotChart()&&t>=l.columnHeaderLevelCount&&t<l.rowCount-l.bottomFrozenRowCount){let e=l.internalProps.layoutMap.indicatorsAsCol,o=!1;if(l.internalProps.layoutMap.indicatorsAsCol||"heatmap"!==l.internalProps.layoutMap.getChartSpec(l.rowHeaderLevelCount,t).type||(o=!0,e=!0),e){let e=l.internalProps.layoutMap.getOptimunHeightForChart(t,o);if(e>0)return e}else{let e=l.getDefaultRowHeight(t);if((0,d.Z)(e))return e}}for(let d=e;d<=o;d++){let e=function(t,e,o){var l,r,a,h,s,u,d,b,p,C;let f=o.getCustomRender(t,e),w=o.getCustomLayout(t,e);if(f||w){let m,y=1,v=0,x=!1,R=!1;(o.isHeader(t,e)||(null==(l=o.getBodyColumnDefine(t,e))?void 0:l.mergeCell)||o.hasCustomMerge())&&(y=(m=o.getCellRange(t,e)).end.row-m.start.row+1);let A={col:null!=(r=null==m?void 0:m.start.col)?r:t,row:null!=(a=null==m?void 0:m.start.row)?a:e,dataValue:o.getCellOriginValue(t,e),value:o.getCellValue(t,e)||"",rect:(b=t,p=e,{left:0,top:0,right:(C=o).getColWidth(b),bottom:C.getRowHeight(p),width:C.getColWidth(b),height:0}),table:o,originCol:t,originRow:e,forComputation:!0};if("react-custom-layout"===w&&(w=(null==(h=o.reactCustomLayout)?void 0:h.getCustomLayoutFunc(t,e))||S.D),(0,c.Z)(w)){let e=w(A);e.rootContainer?(e.rootContainer=(0,g.nH)(e.rootContainer),(0,g.Jp)(e.rootContainer,o.getColWidth(t),0),e.rootContainer.setStage(o.scenegraph.stage),v=null!=(s=e.rootContainer.AABBBounds.height())?s:0):v=0,x=e.renderDefault,R=e.enableCellPadding}else if("function"==typeof f){let t=f(A);v=null!=(u=null==t?void 0:t.expectedHeight)?u:0,x=null==t?void 0:t.renderDefault}else v=null!=(d=null==f?void 0:f.expectedHeight)?d:0,x=null==f?void 0:f.renderDefault;if(R){let l=o._getCellStyle(t,e),r=(0,n.u)((0,i.WJ)("padding",l,t,e,o));v+=r[0]+r[2]}return{height:v/y,renderDefault:x}}}(d,t,l);if(e&&(w=(0,u.Z)(w)?Math.max(e.height,w):e.height,!e.renderDefault))continue;if(l.isPivotChart()){let e=l.internalProps.layoutMap.getAxisConfigInPivotChart(d,t);if(e){let t=h.F.getFunction("computeAxisComponentHeight")(e,l);if("number"==typeof t){w=(0,u.Z)(w)?Math.max(t,w):t;continue}}}if(l.isPivotChart()&&(l.isLeftFrozenColumn(d)&&l.isBottomFrozenRow(t)||l.isRightFrozenColumn(d)&&l.isBottomFrozenRow(t)))continue;let o=l.isHeader(d,t)?null==(b=l._getHeaderLayoutMap(d,t))?void 0:b.headerType:l.getBodyColumnType(d,t),m=function(t,e,o,l){var h,u,d,c,g;let b=0,w=l.getCellValue(t,e),m=l._getCellStyle(t,e),y=0,S=0,B=[],F=0,M=[],W=0,k=!1;if("body"!==l.getCellLocation(t,e))k=!0;else{let o=l.getBodyColumnDefine(t,e);k=!!(null==o?void 0:o.icon)||!!(null==o?void 0:o.tree)||(null==o?void 0:o.dragOrder)}if(k){let o=l.getCellIcons(t,e);null==o||o.forEach(t=>{var e,o,l,i,n,a,h,s,u,d;t.positionType!==r.q0.absoluteRight&&t.positionType!==r.q0.inlineFront&&t.positionType!==r.q0.inlineEnd?(S+=(null!=(e=t.width)?e:0)+(null!=(o=t.marginLeft)?o:0)+(null!=(l=t.marginRight)?l:0),y=Math.max(y,null!=(i=t.height)?i:0)):t.positionType===r.q0.inlineFront?(B.push(t),F=Math.max(F,(null!=(n=t.height)?n:0)+(null!=(a=t.marginLeft)?a:0)+(null!=(h=t.marginRight)?h:0))):t.positionType===r.q0.inlineEnd&&(M.push(t),W=Math.max(W,(null!=(s=t.height)?s:0)+(null!=(u=t.marginLeft)?u:0)+(null!=(d=t.marginRight)?d:0)))})}let P=1,_=t;if(l.isHeader(t,e)||(null==(h=l.getBodyColumnDefine(t,e))?void 0:h.mergeCell)||l.hasCustomMerge()){let o=l.getCellRange(t,e);P=o.end.row-o.start.row+1,t=o.start.col,_=o.end.col}let L=(0,n.u)((0,i.WJ)("padding",m,t,e,l)),T=(0,i.WJ)("fontSize",m,t,e,l),E=(0,i.WJ)("fontStyle",m,t,e,l),I=(0,i.WJ)("fontWeight",m,t,e,l),D=null!=(u=(0,i.WJ)("lineHeight",m,t,e,l))?u:T,N=(0,i.WJ)("fontFamily",m,t,e,l),Z=(0,i.WJ)("autoWrapText",m,t,e,l),O=(0,i.WJ)("lineClamp",m,t,e,l),$=(0,i.WJ)("underline",m,t,e,l),V=null!=(d=(0,i.WJ)("underlineOffset",m,t,e,l))?d:0;if("text"!==o&&"link"!==o&&"progressbar"!==o&&"checkbox"!==o&&"radio"!==o&&"switch"!==o&&"button"!==o)b=D;else if("checkbox"===o)b=function(t,e,o,l,r,n,a,h,s,u,d,c,g,b,p){let w=(0,C.Z)(t)?t.text:t,m=(0,f.cw)(w).split("\n")||[],y=p.getColsWidth(e,l),x=(0,i.WJ)("size",r,e,o,p),R=0;if(n){let t=(0,i.WJ)("spaceBetweenTextAndIcon",r,e,o,p),l=y-(b[1]+b[3])-a-x-t;v.setAttributes({text:{maxLineWidth:l,text:m,fontSize:h,fontStyle:s,fontWeight:u,fontFamily:d,lineHeight:c,wordBreak:"break-word",lineClamp:g},icon:{width:Math.floor(x/1.4),height:Math.floor(x/1.4)},box:{width:x,height:x},spaceBetweenTextAndIcon:t}),v.render(),R=v.AABBBounds.height()}else R=Math.max(x,m.length*c);return R}(w,t,e,_,m,Z,S,T,E,I,N,D,O,L,l);else if("radio"===o)b=function(t,e,o,l,r,n,a,h,u,d,c,g,b,p,C){var f;if((0,s.Z)(t)){let s=0,w=C.getBodyColumnDefine(e,o),m=(0,i.WJ)("spaceBetweenRadio",r,e,o,C),y=null!=(f=null==w?void 0:w.radioDirectionInCell)?f:"vertical";return"vertical"===y?t.forEach((i,f)=>{let w=A(i,e,o,l,r,n,a,h,u,d,c,g,b,p,C);s+=w,f!==t.length-1&&(s+=m)}):"horizontal"===y&&t.forEach(t=>{s=Math.max(A(t,e,o,l,r,n,a,h,u,d,c,g,b,p,C),s)}),s}return A(t,e,o,l,r,n,a,h,u,d,c,g,b,p,C)}(w,t,e,_,m,Z,S,T,E,I,N,D,O,L,l);else if("switch"===o)g=t,b=(0,i.WJ)("boxWidth",m,g,e,l);else if("button"===o)b=function(t,e,o,l,r,n,a,h,s,u,d,c,g,b,p){let w=(0,C.Z)(t)?t.text:t,m=(0,f.cw)(w).split("\n")||[],y=p.getColsWidth(e,l),v=(0,i.WJ)("buttonPadding",r,e,o,p),A=(0,i.WJ)("buttonLineWidth",r,e,o,p),H=0;if(n){let t=y-(b[1]+b[3]);R.setAttributes({text:m,textStyle:{maxLineWidth:t,fontSize:h,fontStyle:s,fontWeight:u,fontFamily:d,lineHeight:c,wordBreak:"break-word",lineClamp:g},padding:v,panel:{visible:!0,fill:"red",stroke:"red",lineWidth:A}}),x.render(),H=x.AABBBounds.height()}else H=m.length*c+2*v;return H}(w,t,e,_,m,Z,0,T,E,I,N,D,O,L,l);else{let o=(0,G.$)(w,l).text,r=l.getColsWidth(t,_);if(B.length||M.length)if(Z){let t=Object.assign({text:null==w?void 0:w.toString(),fontFamily:N,fontSize:T,fontStyle:E,fontWeight:I,lineHeight:D});t.textBaseline="middle";let e=[...B.map(t=>(0,a.vQ)(t)),t,...M.map(t=>(0,a.vQ)(t))];z.setAttributes({width:r-(L[1]+L[3])-S,height:0,textConfig:e}),b=z.AABBBounds.height()}else b=0,o.forEach((t,e)=>{var r;(null==(r=l.options.customConfig)?void 0:r.multilinesForXTable)&&0!==e||(0===e&&B.length?b+=Math.max(D,F):e===o.length-1&&M.length?b+=Math.max(D,W):b+=D)});else if(Z){let i=(0,p.L)(t,e,l),n=r-(L[1]+L[3])-S-i;b=((0,H.Rc)({maxLineWidth:n,text:o,fontSize:T,fontStyle:E,fontWeight:I,fontFamily:N,lineHeight:D,wordBreak:"break-word",whiteSpace:1!==o.length||Z?"normal":"no-wrap",lineClamp:O}).height()||("number"==typeof D?D:T))+($?V:0)}else b=(null==(c=l.options.customConfig)?void 0:c.multilinesForXTable)?D:o.length*D}return(Math.max(b,y)+L[0]+L[2])/P}(d,t,o,l);w=(0,u.Z)(w)?Math.max(m,w):m}if((0,u.Z)(w))return w;let m=l.getDefaultRowHeight(t);return(0,d.Z)(m)?m:l.defaultRowHeight}},289761:function(t,e,o){o.d(e,{F6:()=>n,V5:()=>i,gw:()=>r});var l=o(170559);function r(t){let{internalProps:e}=t;e.bodyDomContainer=document.createElement("div"),e.bodyDomContainer.id="vtable-body-dom-container",e.bodyDomContainer.classList.add("table-component-container"),e.element.appendChild(e.bodyDomContainer),e.headerDomContainer=document.createElement("div"),e.headerDomContainer.id="vtable-header-dom-container",e.headerDomContainer.classList.add("table-component-container"),e.element.appendChild(e.headerDomContainer),e.frozenBodyDomContainer=document.createElement("div"),e.frozenBodyDomContainer.id="vtable-frozen-body-dom-container",e.frozenBodyDomContainer.classList.add("table-component-container"),e.element.appendChild(e.frozenBodyDomContainer),e.frozenHeaderDomContainer=document.createElement("div"),e.frozenHeaderDomContainer.id="vtable-frozen-header-dom-container",e.frozenHeaderDomContainer.classList.add("table-component-container"),e.element.appendChild(e.frozenHeaderDomContainer),e.rightFrozenBodyDomContainer=document.createElement("div"),e.rightFrozenBodyDomContainer.id="vtable-right-frozen-body-dom-container",e.rightFrozenBodyDomContainer.classList.add("table-component-container"),e.element.appendChild(e.rightFrozenBodyDomContainer),e.rightFrozenHeaderDomContainer=document.createElement("div"),e.rightFrozenHeaderDomContainer.id="vtable-right-frozen-header-dom-container",e.rightFrozenHeaderDomContainer.classList.add("table-component-container"),e.element.appendChild(e.rightFrozenHeaderDomContainer),e.frozenBottomDomContainer=document.createElement("div"),e.frozenBottomDomContainer.id="vtable-frozen-bottom-dom-container",e.frozenBottomDomContainer.classList.add("table-component-container"),e.element.appendChild(e.frozenBottomDomContainer),e.bottomDomContainer=document.createElement("div"),e.bottomDomContainer.id="vtable-bottom-dom-container",e.bottomDomContainer.classList.add("table-component-container"),e.element.appendChild(e.bottomDomContainer),e.rightFrozenBottomDomContainer=document.createElement("div"),e.rightFrozenBottomDomContainer.id="vtable-right-frozen-bottom-dom-container",e.rightFrozenBottomDomContainer.classList.add("table-component-container"),e.element.appendChild(e.rightFrozenBottomDomContainer)}function i(t){let{headerDomContainer:e,bodyDomContainer:o,frozenBodyDomContainer:l,frozenHeaderDomContainer:r,rightFrozenBodyDomContainer:i,rightFrozenHeaderDomContainer:n,bottomDomContainer:a,frozenBottomDomContainer:h,rightFrozenBottomDomContainer:s}=t.internalProps;if(!(e||o||l||r||i||n||a||h||s))return;let u=t.getAllColsWidth(),d=Math.min(u,t.tableNoFrameWidth),c=t.getFrozenColsWidth(),g=t.getRightFrozenColsWidth(),b=c+g,p=Math.min(u-b,d-b),C=t.getAllRowsHeight(),f=Math.min(C,t.tableNoFrameHeight),w=t.getFrozenRowsHeight(),m=t.getBottomFrozenRowsHeight(),y=w+m,v=Math.min(C-y,f-y);t.frozenColCount>0?(e.style.left=`${t.tableX+c}px`,o.style.left=`${t.tableX+c}px`,a.style.left=`${t.tableX+c}px`):0===t.frozenColCount&&(e.style.left=`${t.tableX}px`,o.style.left=`${t.tableX}px`,a.style.left=`${t.tableX}px`),l.style.left=`${t.tableX}px`,r.style.left=`${t.tableX}px`,e.style.width=`${p}px`,e.style.height=`${w}px`,o.style.top=`${t.tableY}px`,o.style.width=`${p}px`,o.style.height=`${v}px`,o.style.top=`${t.tableY+w}px`,l.style.width=`${c}px`,l.style.height=`${v}px`,l.style.top=`${t.tableY+w}px`,r.style.width=`${c}px`,r.style.height=`${w}px`,r.style.top=`${t.tableY}px`,i.style.width=`${g}px`,i.style.height=`${v}px`,i.style.top=`${t.tableY+w}px`,i.style.left=t.tableX+d-g+"px",n.style.width=`${g}px`,n.style.height=`${w}px`,n.style.top=`${t.tableY}px`,n.style.left=t.tableX+d-g+"px",a.style.width=`${p}px`,a.style.height=`${m}px`,a.style.top=t.tableY+f-m+"px",h.style.width=`${c}px`,h.style.height=`${m}px`,h.style.top=t.tableY+f-m+"px",s.style.width=`${g}px`,s.style.height=`${m}px`,s.style.top=t.tableY+f-m+"px",s.style.left=t.tableX+d-g+"px"}function n(t){if(!t.table.reactCustomLayout)return;let{table:e,stage:o}=t,r=o.pluginService.findPluginsByName("ReactAttributePlugin")[0],{htmlMap:i,renderId:n}=r;for(let a in i){let h,s=i[a],{graphic:u,wrapContainer:d,renderId:c}=s;if(c===n){if(t.frozenColCount>e.frozenColCount){let o=(0,l.J$)(u);if(!o)continue;let{col:r,row:i}=o;i>=e.rowCount-e.bottomFrozenRowCount&&r<t.frozenColCount&&r>=e.frozenColCount&&u.attribute.react.container===e.frozenBottomDomContainer?h=e.bottomDomContainer:i>=e.frozenRowCount&&r<t.frozenColCount&&r>=e.frozenColCount&&u.attribute.react.container===e.frozenBodyDomContainer?h=e.bodyDomContainer:i<e.frozenRowCount&&r<t.frozenColCount&&r>=e.frozenColCount&&u.attribute.react.container===e.frozenHeaderDomContainer&&(h=e.headerDomContainer)}else if(t.frozenColCount<e.frozenColCount){let o=(0,l.J$)(u);if(!o)continue;let{col:r,row:i}=o;i>=e.rowCount-e.bottomFrozenRowCount&&r<e.frozenColCount&&r>=t.frozenColCount&&u.attribute.react.container===e.bottomDomContainer?h=e.frozenBottomDomContainer:i>=e.frozenRowCount&&r<e.frozenColCount&&r>=t.frozenColCount&&u.attribute.react.container===e.bodyDomContainer?h=e.frozenBodyDomContainer:i<e.frozenRowCount&&r<e.frozenColCount&&r>=t.frozenColCount&&u.attribute.react.container===e.headerDomContainer&&(h=e.frozenHeaderDomContainer)}h&&(h.appendChild(d),s.nativeContainer=h,s.container=h,u.attribute.react.container=h,r.updateStyleOfWrapContainer(u,o,d,h,u.attribute.react))}}}},957426:function(t,e,o){o.d(e,{RW:()=>n,kl:()=>i,s8:()=>a,s9:()=>r});var l=o(475133);function r(t,e){let{table:o}=t,l=o.internalProps.layoutMap,r=-1===e?"all":o.internalProps.columnResizeType;if("column"===r){let l=t.getColGroup(e),r=t.getColGroup(e,!0),i=t.getColGroupInBottom(e,!0);if(null==l||l.forEachChildren(t=>{h(t,o.getColWidth(t.col),o.getRowHeight(t.row))}),null==r||r.forEachChildren(t=>{h(t,o.getColWidth(t.col),o.getRowHeight(t.row))}),null==i||i.forEachChildren(t=>{h(t,o.getColWidth(t.col),o.getRowHeight(t.row))}),"adaptive"===o.widthMode&&e<o.colCount-1){let l=t.getColGroup(e+1),r=t.getColGroup(e+1,!0),i=t.getColGroupInBottom(e+1,!0);null==l||l.forEachChildren(t=>{h(t,o.getColWidth(t.col),o.getRowHeight(t.row))}),null==r||r.forEachChildren(t=>{h(t,o.getColWidth(t.col),o.getRowHeight(t.row))}),null==i||i.forEachChildren(t=>{h(t,o.getColWidth(t.col),o.getRowHeight(t.row))})}}else{let i,n,a,s=o.rowHeaderLevelCount,u=o.colCount-1;if("indicator"===r)if(l.indicatorsAsCol)i=l.getIndicatorKey(e,o.columnHeaderLevelCount);else{let t=l.getCellHeaderPaths(e,o.columnHeaderLevelCount-1),r=t.colHeaderPaths[t.colHeaderPaths.length-1];n=r.dimensionKey,a=r.value}else if("indicatorGroup"===r){let t=o.internalProps.layoutMap,e=t.getCellHeaderPaths(o.stateManager.columnResize.col,o.columnHeaderLevelCount),l=t.getHeadNodeByRowOrColDimensions(e.colHeaderPaths.slice(0,e.colHeaderPaths.length-1));s=l.startInTotal+o.frozenColCount,u=l.startInTotal+o.frozenColCount+l.size-1}for(let e=s;e<=u;e++){let s=t.getColGroup(e),u=t.getColGroup(e,!0),d=t.getColGroupInBottom(e,!0);if(s){if("indicator"===r){let t=l.getIndicatorKey(e,o.columnHeaderLevelCount);if(l.indicatorsAsCol&&t!==i)continue;if(!l.indicatorsAsCol){let t=l.getCellHeaderPaths(e,o.columnHeaderLevelCount-1),r=null==t?void 0:t.colHeaderPaths[t.colHeaderPaths.length-1];if(!r||n!==r.dimensionKey||a!==r.value)continue}}s.forEachChildren(t=>{h(t,o.getColWidth(t.col),o.getRowHeight(t.row))}),null==u||u.forEachChildren(t=>{h(t,o.getColWidth(t.col),o.getRowHeight(t.row))}),null==d||d.forEachChildren(t=>{h(t,o.getColWidth(t.col),o.getRowHeight(t.row))})}}}}function i(t,e){var o;let{table:l}=t,r=l.internalProps.layoutMap,i=l.stateManager,n=-1===e?"all":l.internalProps.rowResizeType,a,s,u,d=l.columnHeaderLevelCount,c=l.rowCount-1;if("indicator"===n)if(r.indicatorsAsCol){let t=r.getCellHeaderPaths(l.rowHeaderLevelCount-1,e),i=null==(o=t.rowHeaderPaths)?void 0:o[t.rowHeaderPaths.length-1];s=null==i?void 0:i.dimensionKey,u=null==i?void 0:i.value}else a=r.getIndicatorKey(l.rowHeaderLevelCount,e);else if("indicatorGroup"===n){let t=l.internalProps.layoutMap,o=t.getCellHeaderPaths(l.rowHeaderLevelCount,e),r=t.getHeadNodeByRowOrColDimensions(o.rowHeaderPaths.slice(0,o.rowHeaderPaths.length-1));d=r.startInTotal+l.frozenRowCount,c=r.startInTotal+l.frozenRowCount+r.size-1}let g=[{startCol:t.proxy.colStart,endCol:t.proxy.colEnd}];l.frozenColCount&&g.push({startCol:0,endCol:l.frozenColCount-1}),l.rightFrozenColCount&&g.push({startCol:l.colCount-l.rightFrozenColCount,endCol:l.colCount-1}),g.forEach(({startCol:o,endCol:g})=>{for(let b=o;b<=g;b++)if("row"===n){let o=t.highPerformanceGetCell(b,e);if("cell"!==o.role)continue;if(h(o,l.getColWidth(o.col),l.getRowHeight(o.row)),"adaptive"===l.heightMode&&e<l.rowCount-1){let o=t.highPerformanceGetCell(b,e+1);h(o,l.getColWidth(o.col),l.getRowHeight(o.row))}}else for(let e=d;e<=c;e++){if("indicator"===n){let t=r.getIndicatorKey(i.table.rowHeaderLevelCount,e);if(!r.indicatorsAsCol&&t!==a)continue;if(r.indicatorsAsCol){let t=r.getCellHeaderPaths(i.table.rowHeaderLevelCount-1,e),o=null==t?void 0:t.rowHeaderPaths[t.rowHeaderPaths.length-1];if(!o||s!==o.dimensionKey||u!==o.value)continue}}let o=t.highPerformanceGetCell(b,e);"cell"===o.role&&h(o,l.getColWidth(o.col),l.getRowHeight(o.row))}})}function n(t){var e;for(let o=t.proxy.colStart;o<=t.proxy.colEnd;o++){let l=t.getColGroup(o);null==(e=null==l?void 0:l.getChildren())||e.forEach(t=>{t.children.forEach(t=>{"chart"===t.type&&(t.cacheCanvas=null,t.addUpdateBoundTag())})})}}function a(t,e){let o=t.table;if(o.isPivotChart()){let r=o._selectedDataItemsInChart.length;if((null==e||0===(null==e?void 0:e.length)||0===Object.keys(e).length)&&0===r)return;let i=[];if(Array.isArray(e))e.forEach(t=>{if(t&&0!==t.key&&Object.keys(t).length>0){let e={};for(let o in t)o.startsWith("VGRAMMAR_")||o.startsWith("__VCHART")||(e[o]=t[o]);i.push(e)}});else if(e&&0!==e.key&&Object.keys(e).length>0){let t={};for(let o in e)o.startsWith("VGRAMMAR_")||o.startsWith("__VCHART")||(t[o]=e[o]);i.push(t)}(0,l.X)(o._selectedDataItemsInChart,i)||(o._selectedDataItemsInChart=i,o.internalProps.layoutMap.updateDataStateToChartInstance(),n(t),o.scenegraph.updateNextFrame())}}function h(t,e,o){t.forEachChildren(t=>{"chart"===t.type&&(t.cacheCanvas=null,t.setAttributes({width:Math.ceil(e-t.attribute.cellPadding[3]-t.attribute.cellPadding[1]),height:Math.ceil(o-t.attribute.cellPadding[0]-t.attribute.cellPadding[2])}))})}},200063:function(t,e,o){o.d(e,{Y:()=>e$});var l=o(6499),r=o(455353),i=o(474702),n=o(482894),a=o(839818),h=o(727594),s=o(254833),u=o(720307),d=o(23946),c=o(994308),g=o(507388),b=o(297),p=o(874783),C=o(376352),f=o(944216),w=o(643624),m=o(615829);function y(t,e,o,l){!l&&o&&t.table._setRowHeight(e,t.table.getRowHeight(e)+o,!0);for(let l=0;l<t.table.colCount;l++){var r,i,n,a,s,u,d;let c=t.getCell(l,e);if("empty"===c.role)continue;let g=(0,h.Z)(t.table,l,e);g&&g.start.col!==l||(r=t,i=c,n=l,a=e,s=c.attribute.height+o,u=o,d=t.table.isHeader(l,e),i&&v(r,i,n,a,s,u,d),t.updateCellContentWhileResize(l,e))}let c=0,g=0;e<t.table.frozenRowCount?(c=e+1,g=t.table.frozenRowCount-1):e>=t.table.rowCount-t.table.bottomFrozenRowCount?(c=e+1,g=t.table.rowCount-1):(c=e+1,g=Math.min(t.proxy.rowEnd,t.table.rowCount-t.table.bottomFrozenRowCount-1));for(let e=0;e<t.table.colCount;e++)for(let l=c;l<=g;l++){let r=t.highPerformanceGetCell(e,l);"cell"===r.role&&r.setAttribute("y",r.attribute.y+o)}}function v(t,e,o,l,r,i,n){var a,h,f,w,m;if(e.attribute.height===r&&!e.needUpdateHeight)return;e.needUpdateHeight=!1,e.setAttribute("height",r);let y=null==(a=t.table.getCellRawRecord(o,l))?void 0:a.vtableMerge,v=!!t.table.getCustomMerge(o,l),R=y||v?"text":t.table.isHeader(o,l)?null!=(h=t.table._getHeaderLayoutMap(o,l).headerType)?h:"text":null!=(f=t.table.getBodyColumnType(o,l))?f:"text";if("progressbar"===R){let n,a=t.table.getBodyColumnDefine(o,l),h=t.table._getCellStyle(o,l),u=t.table.getCellValue(o,l),d=t.table.getCellOriginValue(o,l),c=(0,C.u)((0,b.WJ)("padding",h,o,l,t.table));(null==a?void 0:a.mergeCell)&&(n=t.table.getCellRange(o,l));let g=s.F.getFunction("createProgressBarCell")(a,h,e.attribute.width,u,d,o,l,c,t.table,n),p=e.getChildByName("progress-bar");e.insertBefore(g,p),e.removeChild(p),p.removeAllChild(),p.release(),x(e,r,i,t.table.isAutoRowHeight(l),!0,t.table)}else if("sparkline"===R){e.removeAllChild();let r=t.table._getCellStyle(o,l),i=(0,C.u)((0,b.WJ)("padding",r,o,l,t.table));s.F.getFunction("createSparkLineCellGroup")(e,e.parent,e.attribute.x,e.attribute.y,o,l,e.attribute.width,e.attribute.height,i,t.table,(0,u.RT)(r,t.table,o,l,b.WJ).theme,!1)}else if("image"===R||"video"===R)(0,c.km)(e,o,l,0,i,t.table);else if("axis"===(null==(w=e.firstChild)?void 0:w.name))null==(m=e.firstChild)||m.originAxis.resize(e.attribute.width,e.attribute.height);else{let n=!0,a=e.getChildByName(d.FH)||e.getChildByName(d.cd);if(a){let r;e.removeChild(a);let i=(0,g.l7)(o,l,e,t.table);if(i)for(let e=i.start.row;e<=i.end.row;e++){if(e===l)continue;let r=t.getCell(o,e),i=r.getChildByName(d.FH)||r.getChildByName(d.cd);i.removeAllChild(),r.removeChild(i),(0,g.l7)(o,e,r,t.table)}else{let i,a,h=t.table.getCellLocation(o,l),{vtableMerge:s}=t.table.getCellRawRecord(o,l)||{};if(s&&t.table.internalProps.groupTitleCustomLayout)a=t.table.internalProps.groupTitleCustomLayout;else if("body"!==h){let e=t.table.getHeaderDefine(o,l);i=null==e?void 0:e.headerCustomRender,a=null==e?void 0:e.headerCustomLayout}else{let e=t.table.getBodyColumnDefine(o,l);i=(null==e?void 0:e.customRender)||t.table.customRender,a=null==e?void 0:e.customLayout}if((i||a)&&(0,p.b)(e))for(let o=e.mergeStartCol;o<=e.mergeEndCol;o++)for(let r=e.mergeStartRow;r<=e.mergeEndRow;r++)r!==l&&t.updateCellContent(o,r);if(a||i){let h=t.table._getCellStyle(o,l),s=(0,C.u)((0,b.WJ)("padding",h,o,l,t.table)),u=e.attribute.width,c=e.attribute.height;(0,p.b)(e)&&(u=t.table.getColsWidth(e.mergeStartCol,e.mergeEndCol),c=t.table.getRowsHeight(e.mergeStartRow,e.mergeEndRow));let g=(0,d.ws)(a,i,o,l,u,c,!1,t.table.isAutoRowHeight(l),s,(0,p.b)(e)?{start:{col:e.mergeStartCol,row:e.mergeStartRow},end:{col:e.mergeEndCol,row:e.mergeEndRow}}:void 0,t.table);r=g.elementsGroup,n=g.renderDefault}e.childrenCount>0&&r?e.insertBefore(r,e.firstChild):r&&e.appendChild(r)}}x(e,r,i,t.table.isAutoRowHeight(l),n,t.table)}}function x(t,e,o,l,r,i){if((0,p.b)(t)){e=0;for(let o=t.mergeStartRow;o<=t.mergeEndRow;o++)e+=i.getRowHeight(o);let{colStart:n,colEnd:a,rowStart:h,rowEnd:s}=(0,m.e)(t,i.scenegraph);for(let u=n;u<=a;u++)for(let a=h;a<=s;a++){let s=i.scenegraph.getCell(u,a);if("cell"!==s.role)continue;if(s.forEachChildren(t=>{t.setAttributes({dx:0,dy:0})}),r){let t=i._getCellStyle(n,h),r=(0,C.u)((0,b.WJ)("padding",t,u,a,i));(0,f.Zl)(s,e,o,l,r,t.textAlign,t.textBaseline,i)}let d=i.getRowHeight(a),c=i.getColWidth(u);s.contentHeight=e;let{widthChange:p}=(0,g.NQ)(s,c,d,{start:{col:t.mergeStartCol,row:t.mergeStartRow},end:{col:t.mergeEndCol,row:t.mergeEndRow}},i);p&&(s.needUpdateWidth=!0)}}else{let r=i._getCellStyle(t.col,t.row),n=(0,C.u)((0,b.WJ)("padding",r,t.col,t.row,i));(0,f.Zl)(t,e,o,l,n,r.textAlign,r.textBaseline,i)}}var R=o(648523);function A(t,e,o,l){var r,i,n,a,f,w,m;let y=!1,v=null!=(r=null==t?void 0:t.attribute.width)?r:0;if(null==t||t.setAttribute("width",v+e),null==t||t.forEachChildren((t,r)=>{if(function(t,e,o,l,r,i,n,a,h){var f,w,m,y,v,x,R;if(e.attribute.width===i&&!e.needUpdateWidth)return!1;if(e.needUpdateWidth=!1,e.setAttribute("width",i),!e)return!1;let A=t.table.isAutoRowHeight(l),G=null==(f=t.table.getCellRawRecord(o,l))?void 0:f.vtableMerge,S=!!t.table.getCustomMerge(o,l),z=G||S?"text":t.table.isHeader(o,l)?null!=(w=t.table._getHeaderLayoutMap(o,l).headerType)?w:"text":null!=(m=t.table.getBodyColumnType(o,l))?m:"text",B=!1;if("progressbar"===z){let r,a=t.table.getBodyColumnDefine(o,l),h=t.table._getCellStyle(o,l),u=t.table.getCellValue(o,l),d=t.table.getCellOriginValue(o,l),c=(0,C.u)((0,b.WJ)("padding",h,o,l,t.table));(null==a?void 0:a.mergeCell)&&(r=t.table.getCellRange(o,l));let g=s.F.getFunction("createProgressBarCell")(a,h,e.attribute.width,u,d,o,l,c,t.table,r),p=e.getChildByName("progress-bar");e.insertBefore(g,p),e.removeChild(p),p.removeAllChild(),p.release();let f=H(e,i,n,A,!0,t.table);B=B||f}else if("sparkline"===z){e.removeAllChild();let r=t.table._getCellStyle(o,l),i=(0,C.u)((0,b.WJ)("padding",r,o,l,t.table));s.F.getFunction("createSparkLineCellGroup")(e,e.parent,e.attribute.x,e.attribute.y,o,l,e.attribute.width,e.attribute.height,i,t.table,(0,u.RT)(r,t.table,o,l,b.WJ).theme,!1)}else if("image"===z||"video"===z)(0,c.km)(e,o,l,n,0,t.table);else if("axis"===(null==(y=e.firstChild)?void 0:y.name)){let r=t.table.internalProps.layoutMap.getAxisConfigInPivotChart(o,l),i=t.table._getCellStyle(o,l),n=(0,C.u)((0,b.WJ)("padding",i,o,l,t.table));if(r){let o=new(s.F.getComponent("axis"))(r,e.attribute.width,e.attribute.height,null!=(v=r.__vtableBodyChartCellPadding)?v:n,t.table);e.clear(),e.appendChild(o.component),o.overlap()}}else if("axis"===(null==(x=e.firstChild)?void 0:x.name))null==(R=e.firstChild)||R.originAxis.resize(e.attribute.width,e.attribute.height);else{let r=!0,a=e.getChildByName(d.FH)||e.getChildByName(d.cd);if(a){let i;e.removeChild(a);let n=(0,g.l7)(o,l,e,t.table);if(n)for(let e=n.start.col;e<=n.end.col;e++){if(e===o)continue;let r=t.getCell(e,l),i=r.getChildByName(d.FH)||r.getChildByName(d.cd);i.removeAllChild(),r.removeChild(i),(0,g.l7)(e,l,r,t.table)}else{let n,a,h=t.table.getCellLocation(o,l),{vtableMerge:s}=t.table.getCellRawRecord(o,l)||{};if(s&&t.table.internalProps.groupTitleCustomLayout)a=t.table.internalProps.groupTitleCustomLayout;else if("body"!==h){let e=t.table.getHeaderDefine(o,l);n=null==e?void 0:e.headerCustomRender,a=null==e?void 0:e.headerCustomLayout}else{let e=t.table.getBodyColumnDefine(o,l);n=(null==e?void 0:e.customRender)||t.table.customRender,a=null==e?void 0:e.customLayout}if((n||a)&&(0,p.b)(e)){for(let l=e.mergeStartCol;l<=e.mergeEndCol;l++)if(l!==o)for(let o=e.mergeStartRow;o<=e.mergeEndRow;o++)t.updateCellContent(l,o)}if(a||n){let h=t.table._getCellStyle(o,l),s=(0,C.u)((0,b.WJ)("padding",h,o,l,t.table)),u=e.attribute.width,c=e.attribute.height;(0,p.b)(e)&&(u=t.table.getColsWidth(e.mergeStartCol,e.mergeEndCol),c=t.table.getRowsHeight(e.mergeStartRow,e.mergeEndRow));let g=(0,d.ws)(a,n,o,l,u,c,!1,t.table.isAutoRowHeight(l),s,(0,p.b)(e)?{start:{col:e.mergeStartCol,row:e.mergeStartRow},end:{col:e.mergeEndCol,row:e.mergeEndRow}}:void 0,t.table);i=g.elementsGroup,r=g.renderDefault,B=!0}e.childrenCount>0&&i?e.insertBefore(i,e.firstChild):i&&e.appendChild(i)}}let h=H(e,i,n,A,r,t.table);B=B||h}return h||(h=t.table._getCellStyle(o,l).autoWrapText),!(!A||!h)&&B}(l,t,t.col,t.row,0,v+e,e,"row-body"!==o||(t.col,l.table.rowHeaderLevelCount),l.table.internalProps.autoWrapText)){let e=(0,h.Z)(l.table,t.col,t.row);if(e&&e.end.row-e.start.row)for(let t=e.start.row;t<=e.end.row;t++)G(l,t);else G(l,t.row);y=!0}}),y){let t,e,r,h=0;for(let s=0;s<l.table.colCount;s++){if("col-corner"===o?(r=0,t=l.getColGroup(s,!0),e=null!=(i=l.colHeaderGroup.attribute.height)?i:0):"row-body"===o?(r=l.table.frozenRowCount,t=l.getColGroup(s,!1),e=null!=(n=l.bodyGroup.attribute.height)?n:0):"bottom"===o?(r=l.table.rowCount-l.table.bottomFrozenRowCount,t=l.getColGroupInBottom(s),e=null!=(a=l.bottomFrozenGroup.attribute.height)?a:0):"left-bottom"===o?(r=l.table.rowCount-l.table.bottomFrozenRowCount,t=l.getColGroupInLeftBottomCorner(s),e=null!=(f=l.leftBottomCornerGroup.attribute.height)?f:0):"right-top"===o?(r=0,t=l.getColGroupInRightTopCorner(s),e=null!=(w=l.rightTopCornerGroup.attribute.height)?w:0):"right-bottom"===o&&(r=l.table.rowCount-l.table.bottomFrozenRowCount,t=l.getColGroupInRightBottomCorner(s),e=null!=(m=l.rightBottomCornerGroup.attribute.height)?m:0),!t)continue;let u=0;t.forEachChildren(t=>{var e;t.setAttribute("y",u),u+=null!=(e=l.table.getRowHeight(t.row))?e:0}),h=u}l.updateContainerHeight(r,h-e);for(let t=0;t<l.table.frozenColCount;t++){let e=l.getColGroupInLeftBottomCorner(t),o=0;null==e||e.forEachChildren(t=>{t.setAttribute("y",o),o+=l.table.getRowHeight(t.row)})}for(let t=l.table.colCount-l.table.rightFrozenColCount;t<l.table.colCount;t++){let e=l.getColGroupInRightBottomCorner(t),o=0;null==e||e.forEachChildren(t=>{t.setAttribute("y",o),o+=l.table.getRowHeight(t.row)})}for(let t=l.table.frozenColCount;t<l.table.colCount-l.table.rightFrozenColCount;t++){let e=l.getColGroupInBottom(t),o=0;null==e||e.forEachChildren(t=>{t.setAttribute("y",o),o+=l.table.getRowHeight(t.row)})}}}function H(t,e,o,l,r,i){if((0,p.b)(t)){e=0;let n=!1;for(let o=t.mergeStartCol;o<=t.mergeEndCol;o++)e+=i.getColWidth(o);let a=0;for(let e=t.mergeStartRow;e<=t.mergeEndRow;e++)a+=i.getRowHeight(e);let{colStart:h,colEnd:s,rowStart:u,rowEnd:d}=(0,m.e)(t,i.scenegraph);for(let c=h;c<=s;c++)for(let s=u;s<=d;s++){if(c===t.col&&s!==t.row)continue;let d=i.scenegraph.getCell(c,s);if("cell"!==d.role)continue;d.forEachChildren(t=>{t.setAttributes({dx:0,dy:0})});let p=!1;if(r){let t=i._getCellStyle(h,u),r=(0,C.u)((0,b.WJ)("padding",t,c,s,i)),n=t.textAlign,g=t.textBaseline;p=(0,f.qs)(d,e,a,o,l,r,n,g,i.scenegraph);let w=(0,R.L)(d.col,d.row,i);if(w){let t=d.getChildByName("text"),e=d.getChildByName("expand")||d.getChildByName("collapse");"icon-left"!==(null==e?void 0:e.role)&&t&&t.setAttribute("dx",w)}}let w=i.getRowHeight(s),m=i.getColWidth(c);d.contentWidth=e;let{heightChange:y}=(0,g.NQ)(d,m,w,{start:{col:t.mergeStartCol,row:t.mergeStartRow},end:{col:t.mergeEndCol,row:t.mergeEndRow}},i);y&&(d.needUpdateHeight=!0),n=n||p}return n}let n=i._getCellStyle(t.col,t.row),a=(0,C.u)((0,b.WJ)("padding",n,t.col,t.row,i)),h=n.textAlign,s=n.textBaseline;return(0,f.qs)(t,e,i.getRowHeight(t.row),o,l,a,h,s,i.scenegraph)}function G(t,e){let o=Math.round((0,w.P)(e,0,t.table.colCount-1,t.table));t.table._setRowHeight(e,o,!0);for(let n=0;n<t.table.colCount;n++){var l,r,i;let a=t.highPerformanceGetCell(n,e);"empty"!==a.role&&(l=n,r=o-a.attribute.height,i=t.table.isHeader(n,e),a&&v(t,a,l,e,o,r,i))}}var S=o(623579),z=o(212711),B=o(669860),F=o(829425),M=o(744818),W=o(563042),k=o(381584),P=o(501800);let _=P.U2();class L{constructor(){let t=_.drillDown;this.icon=new k.J({x:-1e3,y:-1e3,image:t.svg,width:t.width,height:t.height,dx:-t.width/2,dy:-t.height/2,visible:!1,funcType:t.funcType,cursor:t.cursor}),this.icon.role="icon-drill"}appand(t){t.appendChild(this.icon)}update(t,e,o,l,r,i){if(!t||l&&r)return this.icon.setAttributes({x:-1e3,y:-1e3,visible:!1}),void i.updateNextFrame();let n=_.drillDown,a=_.drillUp;this.icon.setAttributes({x:e,y:o,image:l?n.svg:a.svg,visible:!0}),this.icon.loadImage(this.icon.attribute.image),i.updateNextFrame()}}var T=o(252953);class E{constructor(t){let e=t.theme.dragHeaderSplitLine.lineWidth,o=t.theme.dragHeaderSplitLine.lineColor,l=t.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel=(0,T.t)({visible:!1,pickable:!1,x:0,y:0,symbolType:"triangle",fill:o}),this.columnMoverLine=(0,S.W)({visible:!1,pickable:!1,stroke:o,lineWidth:e,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnMoverBack=(0,B.f)({visible:!1,pickable:!1,fill:l,x:0,y:0,width:0,height:0}),this.table=t}appand(t){t.appendChild(this.columnMoverLabel),t.appendChild(this.columnMoverLine),t.appendChild(this.columnMoverBack)}show(t,e,o){let l=this.table.getCellLocation(t,e),r=(0,h.Z)(this.table,t,e);r&&(t=r.start.col,e=r.start.row);let i=0,n=0,a=0,s=0,u=0,d=0,c=0,g=0,b=Math.PI,p=[],C=this.table.stateManager.columnMove.movingColumnOrRow;return"columnHeader"===l&&void 0===C||"column"===C?(i=this.table.getColsWidth(0,t-1)-this.table.stateManager.scroll.horizontalBarPos,n=this.table.getRowsHeight(0,this.table.frozenRowCount-1),s=this.table.tableNoFrameHeight,a=r?this.table.getColsWidth(r.start.col,r.end.col):this.table.getColWidth(t),u=i-o,c=i+a,g=2,p.push({x:0,y:0}),p.push({x:0,y:this.table.tableNoFrameHeight})):("rowHeader"===l||this.table.internalProps.layoutMap.isSeriesNumberInBody(t,e)||"row"===C)&&(n=this.table.getRowsHeight(0,e-1)-this.table.stateManager.scroll.verticalBarPos,i=this.table.getColsWidth(0,this.table.frozenColCount-1),a=this.table.tableNoFrameWidth,s=r?this.table.getRowsHeight(r.start.row,r.end.row):this.table.getRowHeight(e),d=n-o,c=2,g=n+s,b=Math.PI/2,p.push({x:0,y:0}),p.push({x:this.table.tableNoFrameWidth,y:0})),this.columnMoverBack.setAttributes({visible:!0,x:i-u,y:n-d,width:a,height:s,dx:u,dy:d}),this.columnMoverLine.setAttributes({x:c,y:g,visible:!0,points:p}),this.columnMoverLabel.setAttributes({visible:!0,x:c,y:g,angle:b}),{backX:i-u,lineX:c,backY:n-d,lineY:g}}hide(){this.columnMoverLabel.setAttribute("visible",!1),this.columnMoverLine.setAttribute("visible",!1),this.columnMoverBack.setAttribute("visible",!1)}update(t,e,o,l){"number"==typeof t&&"number"==typeof e?(this.columnMoverLabel.setAttribute("x",e),this.columnMoverLine.setAttribute("x",e),this.columnMoverBack.setAttribute("x",t)):"number"==typeof o&&"number"==typeof l&&(this.columnMoverLabel.setAttribute("y",l),this.columnMoverLine.setAttribute("y",l),this.columnMoverBack.setAttribute("y",o))}updateStyle(){let t=this.table.theme.dragHeaderSplitLine.lineWidth,e=this.table.theme.dragHeaderSplitLine.lineColor,o=this.table.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel.setAttributes({fill:e}),this.columnMoverLine.setAttributes({stroke:e,lineWidth:t}),this.columnMoverBack.setAttributes({fill:o})}}function I(t,e,o){if(o)return Math.min(e.tableNoFrameWidth,e.getAllColsWidth())-e.getColsWidth(t,e.colCount-1);let l=e.getColsWidth(0,t);return t>=e.frozenColCount&&(l-=e.scrollLeft),l}function D(t,e,o){if(o)return Math.min(e.tableNoFrameWidth,e.getAllRowsHeight())-e.getRowsHeight(t,e.rowCount-1);let l=e.getRowsHeight(0,t);return t>=e.frozenRowCount&&(l-=e.scrollTop),l}var N=o(364776);class Z{constructor(t){var e,o,l,r,i,n,a,h,s,u,d,c,g,b,p,C,f,w,m;this.table=t;let y=this.table.theme;this.createScrollBar();let v=null==(e=y.columnResize)?void 0:e.lineColor,x=null==(o=y.columnResize)?void 0:o.lineWidth,R=null==(l=y.columnResize)?void 0:l.bgColor,A=null==(r=y.columnResize)?void 0:r.width,H=null==(n=null==(i=y.columnResize)?void 0:i.labelVisible)||n,G=null==(a=y.columnResize)?void 0:a.labelColor,M=null==(h=y.columnResize)?void 0:h.labelFontSize,k=null==(s=y.columnResize)?void 0:s.labelFontFamily,P=null==(u=y.columnResize)?void 0:u.labelBackgroundFill,_=null==(d=y.columnResize)?void 0:d.labelBackgroundCornerRadius;this.labelVisible=H,this.columnResizeLine=(0,S.W)({visible:!1,pickable:!1,stroke:v,lineWidth:x,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnResizeBgLine=(0,S.W)({visible:!1,pickable:!1,stroke:R,lineWidth:A,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]});let T=(0,z.r)({visible:!1,pickable:!1,x:0,y:0,fontSize:M,fill:G,fontFamily:k,text:"",textBaseline:"top",dx:16,dy:-M/2}),I=(0,B.f)({visible:!1,pickable:!1,fill:P,x:0,y:0,width:5*M*.8,height:M+8,cornerRadius:_,dx:12,dy:-M/2-4});this.columnResizeLabel=(0,F.sS)({visible:!1,pickable:!1,x:0,y:0}),this.columnResizeLabel.appendChild(I),this.columnResizeLabel.appendChild(T),this.rowResizeLine=(0,S.W)({visible:!1,pickable:!1,stroke:v,lineWidth:x,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.rowResizeBgLine=(0,S.W)({visible:!1,pickable:!1,stroke:R,lineWidth:A,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]});let D=(0,z.r)({visible:!1,pickable:!1,x:0,y:0,fontSize:M,fill:G,fontFamily:k,text:"",textBaseline:"top",dx:16,dy:-M/2}),N=(0,B.f)({visible:!1,pickable:!1,fill:P,x:0,y:0,width:5*M*.8,height:M+8,cornerRadius:_,dx:12,dy:-M/2-4});this.rowResizeLabel=(0,F.sS)({visible:!1,pickable:!1,x:0,y:0}),this.rowResizeLabel.appendChild(N),this.rowResizeLabel.appendChild(D),this.cellMover=new E(this.table);let Z=null==(g=null==(c=y.frozenColumnLine)?void 0:c.shadow)?void 0:g.width,O=null==(p=null==(b=y.frozenColumnLine)?void 0:b.shadow)?void 0:p.startColor,$=null==(f=null==(C=y.frozenColumnLine)?void 0:C.shadow)?void 0:f.endColor,V=null==(m=null==(w=y.frozenColumnLine)?void 0:w.shadow)?void 0:m.visible;this.frozenShadowLine=(0,B.f)({visible:"always"===V,pickable:!1,x:0,y:0,width:Z,height:0,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:O,offset:0},{color:$,offset:1}]}}),this.rightFrozenShadowLine=(0,B.f)({visible:"always"===V,pickable:!1,x:0,y:0,width:Z,height:0,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:$,offset:0},{color:O,offset:1}]}}),this.menu=new W.Q(this.table),this.drillIcon=new L}addToGroup(t){t.addChild(this.frozenShadowLine),t.addChild(this.rightFrozenShadowLine),t.addChild(this.columnResizeBgLine),t.addChild(this.columnResizeLine),t.addChild(this.columnResizeLabel),t.addChild(this.rowResizeBgLine),t.addChild(this.rowResizeLine),t.addChild(this.rowResizeLabel),this.table.theme.scrollStyle.hoverOn&&!this.table.theme.scrollStyle.barToSide?(t.addChild(this.hScrollBar),t.addChild(this.vScrollBar)):(t.stage.defaultLayer.addChild(this.hScrollBar),t.stage.defaultLayer.addChild(this.vScrollBar)),this.menu.bindTableComponent(t),this.drillIcon.appand(t),this.cellMover.appand(t)}createScrollBar(){var t,e,o,l,r,i;let n,a=this.table.theme,h=null==(t=a.scrollStyle)?void 0:t.scrollRailColor,s=null==(e=a.scrollStyle)?void 0:e.scrollSliderColor,u=null==(o=a.scrollStyle)?void 0:o.scrollSliderCornerRadius,d=null==(l=a.scrollStyle)?void 0:l.width,c=null==(r=a.scrollStyle)?void 0:r.horizontalPadding,g=null==(i=a.scrollStyle)?void 0:i.verticalPadding;n=(0,N.Z)(u)?{cornerRadius:u,fill:s}:{fill:s},this.hScrollBar=new M.B({direction:"horizontal",x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),width:this.table.tableNoFrameWidth,height:d,padding:c,railStyle:{fill:h},sliderStyle:n,range:[0,.1],visible:!1}),this.hScrollBar.render(),this.hScrollBar.hideAll(),this.vScrollBar=new M.B({direction:"vertical",x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),width:d,height:this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight(),padding:g,railStyle:{fill:h},sliderStyle:n,range:[0,.1],visible:!1}),this.vScrollBar.render(),this.vScrollBar.hideAll()}updateScrollBar(){var t,e,o,l,r,i,n,a,h;let s=this.table.stateManager.scroll.horizontalBarPos,u=this.table.stateManager.scroll.verticalBarPos,d=this.table.theme,c=null==(t=d.scrollStyle)?void 0:t.width,g=null==(e=d.scrollStyle)?void 0:e.visible,b=null!=(l=null==(o=d.scrollStyle)?void 0:o.horizontalVisible)?l:g,p=null!=(i=null==(r=d.scrollStyle)?void 0:r.verticalVisible)?i:g,C=Math.ceil(this.table.tableNoFrameWidth),f=Math.ceil(this.table.tableNoFrameHeight),w=this.table.getAllRowsHeight(),m=this.table.getAllColsWidth(),y=this.table.getFrozenRowsHeight(),v=this.table.getFrozenColsWidth(),x=this.table.getBottomFrozenRowsHeight(),R=this.table.getRightFrozenColsWidth(),A=this.table.theme.scrollStyle.hoverOn,H=+(null!=(n=this.table.options.customConfig)&&!!n._disableColumnAndRowSizeRound);if(m>C+H){let t=Math.min(f,w),e=Math.max(.05,(C-v)/(m-v)),o=0;o=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameHeight-(A?c:-this.table.scenegraph.tableGroup.attribute.y)+this.table.tableY:t-(A?c:-this.table.scenegraph.tableGroup.attribute.y);let l=v+(A?0:this.table.scenegraph.tableGroup.attribute.x),r=C-v-R;null!=(h=null==(a=this.table.theme.scrollStyle)?void 0:a.ignoreFrozenCols)&&h?(l=A?0:this.table.scenegraph.tableGroup.attribute.x,r=C):(l=v+(A?0:this.table.scenegraph.tableGroup.attribute.x),r=C-v-R),this.hScrollBar.setAttributes({x:l,y:o,width:r,range:[0,e],visible:"always"===b});let i=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:i.x1,y:i.y1},"always"===b&&this.hScrollBar.showAll()}else this.hScrollBar.setAttributes({x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),width:0,visible:!1});if(w>f+H){let t=Math.min(C,m),e=Math.max(.05,(f-y)/(w-y)),o=0;o=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameWidth-(A?c:-this.table.scenegraph.tableGroup.attribute.x)+this.table.tableX:t-(A?c:-this.table.scenegraph.tableGroup.attribute.x),this.vScrollBar.setAttributes({x:o,y:y+(A?0:this.table.scenegraph.tableGroup.attribute.y),height:f-y-x,range:[0,e],visible:"always"===p});let l=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:l.x1,y:l.y1},"always"===p&&this.vScrollBar.showAll()}else this.vScrollBar.setAttributes({x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),height:0,visible:!1});this.table.stateManager.setScrollLeft(s),this.table.stateManager.setScrollTop(u)}hideResizeCol(){this.columnResizeLine.setAttribute("visible",!1),this.columnResizeBgLine.setAttribute("visible",!1),this.columnResizeLabel.setAttribute("visible",!1),this.columnResizeLabel.hideAll()}showResizeCol(t,e,o){let l=I(t,this.table,o);this.columnResizeLine.setAttributes({visible:!0,x:l,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({visible:!0,x:l,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.showAll(),this.columnResizeLabel.setAttributes({visible:!0,x:l,y:e}),this.columnResizeLabel.lastChild.setAttribute("text",`${this.table.getColWidth(t)}px`))}updateResizeCol(t,e,o){let l=I(t,this.table,o);this.columnResizeLine.setAttributes({x:l,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({x:l,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.setAttributes({x:l,y:e}),this.columnResizeLabel.lastChild.setAttribute("text",`${Math.floor(this.table.getColWidth(t))}px`))}hideResizeRow(){this.rowResizeLine.setAttribute("visible",!1),this.rowResizeBgLine.setAttribute("visible",!1),this.rowResizeLabel.setAttribute("visible",!1),this.rowResizeLabel.hideAll()}showResizeRow(t,e,o){let l=D(t,this.table,o);this.rowResizeLine.setAttributes({visible:!0,y:l,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({visible:!0,y:l,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.showAll(),this.rowResizeLabel.setAttributes({visible:!0,y:l,x:e}),this.rowResizeLabel.lastChild.setAttribute("text",`${this.table.getRowHeight(t)}px`))}updateResizeRow(t,e,o){let l=D(t,this.table,o);this.rowResizeLine.setAttributes({y:l,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({y:l,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.setAttributes({y:l,x:e}),this.rowResizeLabel.lastChild.setAttribute("text",`${Math.floor(this.table.getRowHeight(t))}px`))}hideMoveCol(){this.cellMover.hide()}showMoveCol(t,e,o){return this.cellMover.show(t,e,o)}updateMoveCol(t,e,o,l){this.cellMover.update(t,e,o,l)}setFrozenColumnShadow(t,e){var o,l;let r=I(t,this.table,e);t<0||"always"!==(null==(l=null==(o=this.table.theme.frozenColumnLine)?void 0:o.shadow)?void 0:l.visible)?this.frozenShadowLine.setAttributes({visible:!1,x:r,height:this.table.getDrawRange().height}):this.frozenShadowLine.setAttributes({visible:!0,x:r,height:this.table.getDrawRange().height})}setRightFrozenColumnShadow(t){var e,o;let l=I(t,this.table,!0);t>=this.table.colCount||"always"!==(null==(o=null==(e=this.table.theme.frozenColumnLine)?void 0:e.shadow)?void 0:o.visible)?this.rightFrozenShadowLine.setAttributes({visible:!1,x:l-this.rightFrozenShadowLine.attribute.width,height:this.table.getDrawRange().height}):this.rightFrozenShadowLine.setAttributes({visible:!0,x:l-this.rightFrozenShadowLine.attribute.width,height:this.table.getDrawRange().height})}hideFrozenColumnShadow(){var t,e,o,l,r;let i=null==(e=null==(t=this.table.theme.frozenColumnLine)?void 0:t.shadow)?void 0:e.visible;"scrolling"===(null!=(r=null==(l=null==(o=this.table.theme.frozenColumnLine)?void 0:o.shadow)?void 0:l.visible)?r:i)&&(this.frozenShadowLine.setAttribute("visible",!1),this.rightFrozenShadowLine.setAttribute("visible",!1),this.table.scenegraph.updateNextFrame())}showFrozenColumnShadow(){var t,e,o,l,r;let i=null==(e=null==(t=this.table.theme.frozenColumnLine)?void 0:t.shadow)?void 0:e.visible;"scrolling"===(null!=(r=null==(l=null==(o=this.table.theme.frozenColumnLine)?void 0:o.shadow)?void 0:l.visible)?r:i)&&(this.frozenShadowLine.setAttribute("visible",!0),this.rightFrozenShadowLine.setAttribute("visible",!0),this.table.scenegraph.updateNextFrame())}hideVerticalScrollBar(){var t;let e=this.table.theme.scrollStyle.visible,o=null!=(t=this.table.theme.scrollStyle.verticalVisible)?t:e;"focus"!==o&&"scrolling"!==o||(this.vScrollBar.setAttribute("visible",!1),this.vScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showVerticalScrollBar(){var t;let e=this.table.theme.scrollStyle.visible,o=null!=(t=this.table.theme.scrollStyle.verticalVisible)?t:e;"focus"!==o&&"scrolling"!==o||(this.vScrollBar.setAttribute("visible",!0),this.vScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}hideHorizontalScrollBar(){var t;let e=this.table.theme.scrollStyle.visible,o=null!=(t=this.table.theme.scrollStyle.horizontalVisible)?t:e;"focus"!==o&&"scrolling"!==o||(this.hScrollBar.setAttribute("visible",!1),this.hScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showHorizontalScrollBar(){var t;let e=this.table.theme.scrollStyle.visible,o=null!=(t=this.table.theme.scrollStyle.horizontalVisible)?t:e;"focus"!==o&&"scrolling"!==o||(this.hScrollBar.setAttribute("visible",!0),this.hScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}updateVerticalScrollBarPos(t){let e=this.vScrollBar.attribute.range,o=e[1]-e[0],l=t*(1-o);this.vScrollBar.setAttribute("range",[l,l+o]);let r=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:r.x1,y:r.y1}}updateHorizontalScrollBarPos(t){let e=this.hScrollBar.attribute.range,o=e[1]-e[0],l=t*(1-o);this.hScrollBar.setAttribute("range",[l,l+o]);let r=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:r.x1,y:r.y1}}updateStyle(){var t,e,o,l,r,i,n,a,h,s,u,d,c,g,b,p,C,f,w,m,y,v,x;let R,A=this.table.theme,H=null==(t=A.scrollStyle)?void 0:t.scrollRailColor,G=null==(e=A.scrollStyle)?void 0:e.scrollSliderColor,z=null==(o=A.scrollStyle)?void 0:o.scrollSliderCornerRadius,B=null==(l=A.scrollStyle)?void 0:l.width,F=null==(r=A.scrollStyle)?void 0:r.horizontalPadding,M=null==(i=A.scrollStyle)?void 0:i.verticalPadding;R=(0,N.Z)(z)?{cornerRadius:z,fill:G}:{fill:G},this.hScrollBar.setAttributes({height:B,padding:F,railStyle:{fill:H},sliderStyle:R}),this.vScrollBar.setAttributes({width:B,padding:M,railStyle:{fill:H},sliderStyle:R});let W=null==(n=A.columnResize)?void 0:n.lineColor,k=null==(a=A.columnResize)?void 0:a.lineWidth,P=null==(h=A.columnResize)?void 0:h.bgColor,_=null==(s=A.columnResize)?void 0:s.width;this.columnResizeLine.setAttributes({stroke:W,lineWidth:k}),this.columnResizeBgLine=(0,S.W)({stroke:P,lineWidth:_});let L=null==(u=A.columnResize)?void 0:u.labelColor,T=null==(d=A.columnResize)?void 0:d.labelFontSize,E=null==(c=A.columnResize)?void 0:c.labelFontFamily,I=null==(g=A.columnResize)?void 0:g.labelBackgroundFill,D=null==(b=A.columnResize)?void 0:b.labelBackgroundCornerRadius,Z=null==(C=null==(p=A.columnResize)?void 0:p.labelVisible)||C;this.labelVisible=Z,this.columnResizeLabel.lastChild.setAttributes({fontSize:T,fill:L,fontFamily:E,dy:-T/2}),this.columnResizeLabel.firstChild.setAttributes({fill:I,width:5*T*.8,height:T+8,cornerRadius:D,dy:-T/2-4}),this.rowResizeLabel.lastChild.setAttributes({fontSize:T,fill:L,fontFamily:E,dy:-T/2}),this.rowResizeLabel.firstChild.setAttributes({fill:I,width:5*T*.8,height:T+8,cornerRadius:D,dy:-T/2-4});let O=null==(w=null==(f=A.frozenColumnLine)?void 0:f.shadow)?void 0:w.width,$=null==(y=null==(m=A.frozenColumnLine)?void 0:m.shadow)?void 0:y.startColor,V=null==(x=null==(v=A.frozenColumnLine)?void 0:v.shadow)?void 0:x.endColor;this.frozenShadowLine.setAttributes({width:O,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:$,offset:0},{color:V,offset:1}]}}),this.rightFrozenShadowLine.setAttributes({width:O,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:V,offset:0},{color:$,offset:1}]}}),this.cellMover.updateStyle()}}var O=o(439898),$=o(263457),V=o(42628),U=o(925428),J=o(197721),Y=o(194937),j=o(64269),X=o(508338),K=o(25666),q=o(360309),Q=o(87399),tt=o(434399),te=o(695723);let to=Symbol.for("ChartRender");Symbol.for("ChartRenderContribution");let tl=class extends X.Y{constructor(){super(...arguments),this.numberType=Q.e}drawShape(t,e,o,l,r,i,n,a){var h,s,u,d;let c=(0,K.gh)(t,null==i?void 0:i.theme).group,{dataId:g,data:b,spec:p}=t.attribute,{width:C=c.width,height:f=c.height}=(t.getViewBox(),t.attribute),{table:w}=t.getRootNode(),{cacheCanvas:m,activeChartInstance:y}=t;if(!y&&m)(0,te.Z)(m)?m.forEach(t=>{let{x:o,y:l,width:r,height:i,canvas:n}=t;e.drawImage(n,o,l,r,i)}):e.drawImage(m,o,l,C,f);else if(y){if(w.options.specFormat){let e=w.options.specFormat(t.attribute.spec,y,t);if(e.needFormatSpec&&e.spec){let t=e.spec;y.updateSpecSync(t,!1,{reuse:!1,morph:!1})}}let e=t.getViewBox();y.updateViewBox({x1:0,x2:e.x2-e.x1,y1:0,y2:e.y2-e.y1},!1,!1);let o=y.getStage();o.needRender=!0;let l=t.globalTransMatrix.clone(),r=t.stage.window.getViewBoxTransform().clone();if(r.multiply(l.a,l.b,l.c,l.d,l.e,l.f),o.window.setViewBoxTransform(r.a,r.b,r.c,r.d,r.e,r.f),"string"==typeof g||"number"==typeof g)y.updateDataSync(g,null!=b?b:[]);else{let t=[];for(let e in g){let o=g[e],l=p.series.find(t=>{var o;return(null==(o=null==t?void 0:t.data)?void 0:o.id)===e});t.push({id:e,values:o?null!=(h=null==b?void 0:b.filter(t=>t.hasOwnProperty(o)))?h:[]:null!=b?b:[],fields:null==(s=null==l?void 0:l.data)?void 0:s.fields}),y.updateFullDataSync||y.updateDataSync(e,o?null!=(u=null==b?void 0:b.filter(t=>t.hasOwnProperty(o)))?u:[]:null!=b?b:[])}null==(d=y.updateFullDataSync)||d.call(y,t)}}else w.internalProps.renderChartAsync?(-1===tt.A8.indexOf(`${t.parent.col}+${t.parent.row}`)&&(tt.A8.push(`${t.parent.col}+${t.parent.row}`),tt.LO.push(t)),(0,tt.a5)()||(0,tt.eO)(w)):(0,tt.pF)(t)}draw(t,e,o,l){this._draw(t,{},!1,o,l)}};tl=function(t,e,o,l){var r,i=arguments.length,n=i<3?e:null===l?l=Object.getOwnPropertyDescriptor(e,o):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,o,l);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(n=(i<3?r(n):i>3?r(e,o,n):r(e,o))||n);return i>3&&n&&Object.defineProperty(e,o,n),n}([(0,q.b)()],tl);var tr=o(916905),ti=function(t,e,o,l){var r,i=arguments.length,n=i<3?e:null===l?l=Object.getOwnPropertyDescriptor(e,o):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,o,l);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(n=(i<3?r(n):i>3?r(e,o,n):r(e,o))||n);return i>3&&n&&Object.defineProperty(e,o,n),n};let tn=class{constructor(){this.time=tr.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d,c){let{shape:g}=t.attribute;if("circle"===g){let{width:r=h.width,height:i=h.height}=t.attribute;e.beginPath(),e.arc(o+r/2,l+i/2,Math.min(r,i)/2,0,2*Math.PI),e.closePath(),e.save(),e.clip()}}};tn=ti([(0,q.b)()],tn);let ta=class{constructor(){this.time=tr.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d,c){let{shape:g}=t.attribute;"circle"===g&&e.restore()}};ta=ti([(0,q.b)()],ta);let th=class{constructor(){this.time=tr.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d,c){let{isGif:g}=t.attribute;g&&t.playing&&(t.attribute.opacity=0)}};th=ti([(0,q.b)()],th);let ts=class{constructor(){this.time=tr.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d,c){let{isGif:g}=t.attribute;g&&t.playing&&(t.attribute.opacity=1,e.globalAlpha=t.attribute.opacity,t.renderFrame(e,o,l))}};ts=ti([(0,q.b)()],ts);var tu=o(521564),td=o(502837),tc=o(426902),tg=o(859582),tb=function(t,e,o,l){var r,i=arguments.length,n=i<3?e:null===l?l=Object.getOwnPropertyDescriptor(e,o):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,o,l);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(n=(i<3?r(n):i>3?r(e,o,n):r(e,o))||n);return i>3&&n&&Object.defineProperty(e,o,n),n};let tp=class{constructor(){this.time=tr.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d,c){let{stroke:g=h.stroke,strokeArrayWidth:b=h.strokeArrayWidth,strokeArrayColor:p=h.strokeArrayColor}=t.attribute;g&&(Array.isArray(b)||Array.isArray(p))&&(c.doStroke=!1)}};tp=tb([(0,q.b)()],tp);let tC=class{constructor(){this.time=tr.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d){var c,g;let{stroke:b=h.stroke,strokeArrayColor:p=h.strokeArrayColor,strokeArrayWidth:C=h.strokeArrayWidth,lineWidth:f=h.lineWidth,strokeColor:w=h.stroke,cornerRadius:m=h.cornerRadius}=t.attribute,y,v,{width:x=h.width,height:R=h.height}=t.attribute;if(b&&(Array.isArray(C)||0!==f)&&(Array.isArray(p)||Array.isArray(C))){if("number"==typeof f&&1&f||Array.isArray(C)&&C.some(t=>1&t)){let e=t.stage.table;if(!e)return;let r="bottom-right"===(null==(c=null==e?void 0:e.theme)?void 0:c.cellBorderClipDirection);if(r){if(o=Math.floor(o)-.5,l=Math.floor(l)-.5,"cell"===t.role){let e=t.col,r=t.row;0===e&&(o+=1),0===r&&(l+=1)}}else o=Math.floor(o)+.5,l=Math.floor(l)+.5;(null==(g=e.options.customConfig)?void 0:g._disableColumnAndRowSizeRound)&&(x=Math.round(x),R=Math.round(R));let{width:i,height:n}=tS(t,Math.ceil(x),Math.ceil(R),r);y=i,v=n}else y=Math.ceil(x),v=Math.ceil(R);0===m||(0,te.Z)(m)&&m.every(t=>0===t)?tw(t,e,o,l,h,b,C||f,p||w,y,v):(e.beginPath(),(0,tu.U)(e,o,l,y,v,m,!0,[,,,,].fill(0).map((r,i)=>(r,n,a,s)=>{tM(i,r,n,a,s,t,e,o,l,h,b,C||f,p||w,y,v)})),e.stroke())}}};function tf(t){let e;if(!Array.isArray(t))return{isSplitDraw:!1,width:t};for(let o=0;o<t.length;o++){let l=t[o];if(l)if(e){if(l!==e)return{isSplitDraw:!0}}else e=l}return{isSplitDraw:!1,width:e}}function tw(t,e,o,l,r,i,n,a,h,s,u,d){var c,g,b,p;let C=tf(n),f=!Array.isArray(n),w=!Array.isArray(i),m=Array.isArray(d),y=Array.isArray(a)||C.isSplitDraw;e.setStrokeStyle(t,t.attribute,o,l,r);let{lineDash:v=r.lineDash}=t.attribute,x=!1;v.length&&v.some(t=>Array.isArray(t))&&(x=!0),e.beginPath(),e.moveTo(o,l);let R=(w||i[0])&&(f||n[0]),A=(w||i[1])&&(f||n[1]),H=(w||i[2])&&(f||n[2]),G=(w||i[3])&&(f||n[3]);if(R){let t=(f?C.width:n[0])/2,r=(f?C.width:n[0])/2;m&&Array.isArray(d[0])?(e.moveTo(o-t+(h+t+r)*d[0][0],l),e.lineTo(o-t+(h+t+r)*(d[0][1]-d[0][0]),l),e.moveTo(o+h+r,l)):(e.moveTo(o-t,l),e.lineTo(o+h+r,l)),(y||x)&&(a&&a[0]?e.strokeStyle=a[0]:a&&!a[0]&&(e.strokeStyle="transparent"),f||(e.lineWidth=n[0]),e.lineDashOffset=e.currentMatrix.e/e.currentMatrix.a,x&&e.setLineDash(null!=(c=v[0])?c:[]),e.stroke(),e.beginPath(),e.moveTo(o+h,l))}else e.moveTo(o+h,l);if(A){let t=(f?C.width:n[1])/2,r=(f?C.width:n[1])/2;m&&Array.isArray(d[1])?(e.moveTo(o+h,l-t+s*d[1][0]),e.lineTo(o+h,l-t+(s+t+r)*(d[1][1]-d[1][0])),e.moveTo(o+h,l+s+r)):(e.moveTo(o+h,l-t),e.lineTo(o+h,l+s+r)),(y||x)&&(a&&a[1]?e.strokeStyle=a[1]:a&&!a[1]&&(e.strokeStyle="transparent"),f||(e.lineWidth=n[1]),e.lineDashOffset=e.currentMatrix.f/e.currentMatrix.d,x&&e.setLineDash(null!=(g=v[1])?g:[]),e.stroke(),e.beginPath(),e.moveTo(o+h,l+s))}else e.moveTo(o+h,l+s);if(H){let t=(f?C.width:n[2])/2,r=(f?C.width:n[2])/2;m&&Array.isArray(d[2])?(e.moveTo(o-t+(h+t+r)*d[2][0],l+s),e.lineTo(o-t+(h+t+r)*(d[2][1]-d[2][0]),l+s),e.moveTo(o-t,l+s)):(e.moveTo(o-t,l+s),e.lineTo(o+h+r,l+s)),(y||x)&&(a&&a[2]?e.strokeStyle=a[2]:a&&!a[2]&&(e.strokeStyle="transparent"),f||(e.lineWidth=n[2]),e.lineDashOffset=e.currentMatrix.e/e.currentMatrix.a,x&&e.setLineDash(null!=(b=v[2])?b:[]),e.stroke(),e.beginPath(),e.moveTo(o,l+s))}else e.moveTo(o,l+s);if(G){let t=(f?C.width:n[3])/2,r=(f?C.width:n[3])/2;m&&Array.isArray(d[3])?(e.moveTo(o,l-t+(s+t+r)*d[3][0]),e.lineTo(o,l-t+(s+t+r)*(d[3][1]-d[3][0])),e.moveTo(o,l-t)):(e.moveTo(o,l-t),e.lineTo(o,l+s+r)),(y||x)&&(a&&a[3]?e.strokeStyle=a[3]:a&&!a[3]&&(e.strokeStyle="transparent"),f||(e.lineWidth=n[3]),e.lineDashOffset=e.currentMatrix.f/e.currentMatrix.d,x&&e.setLineDash(null!=(p=v[3])?p:[]),e.stroke(),e.beginPath(),e.moveTo(o,l))}else e.moveTo(o,l);y||x||(!f&&C.width&&(e.lineWidth=C.width),e.stroke()),e.lineDashOffset=0,e.setLineDash([])}tC=tb([(0,q.b)()],tC);let tm=class{constructor(){this.time=tr.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d,c){var g;let{lineDash:b=h.lineDash,stroke:p=h.stroke,strokeArrayColor:C=h.strokeArrayColor,strokeArrayWidth:f=h.strokeArrayWidth}=t.attribute;p&&Array.isArray(b)&&b.length&&(null==(g=b[0])?void 0:g.length)&&!Array.isArray(C)&&!Array.isArray(f)&&(c.doStroke=!1)}};tm=tb([(0,q.b)()],tm);let ty=class{constructor(){this.time=tr.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d){var c,g,b,p,C,f,w;let{lineDash:m=h.lineDash,stroke:y=h.stroke,strokeArrayColor:v=h.strokeArrayColor,strokeArrayWidth:x=h.strokeArrayWidth,lineWidth:R=h.lineWidth}=t.attribute;if(!y||!(Array.isArray(m)&&m.length&&(null==(c=m[0])?void 0:c.length))||Array.isArray(v)||Array.isArray(x))return;let A=t.stage.table;if(!A)return;let H=(0,te.Z)(m[0])?1===(w=m).length?[w[0],w[0],w[0],w[0]]:2===w.length?[w[0],w[1],w[0],w[1]]:w:[m,m,m,m],G,S,{width:z=h.width,height:B=h.height}=t.attribute;if((null==(g=A.options.customConfig)?void 0:g._disableColumnAndRowSizeRound)?(z=Math.round(z),B=Math.round(B)):(z=Math.ceil(z),B=Math.ceil(B)),1&R){let e="bottom-right"===A.theme.cellBorderClipDirection;e?(o=Math.floor(o)-.5,l=Math.floor(l)-.5,"cell"===t.role&&(0===t.col&&(o+=1),0===t.row&&(l+=1))):(o=Math.floor(o)+.5,l=Math.floor(l)+.5);let{width:r,height:i}=tS(t,Math.ceil(z+0),Math.ceil(B+0),e);G=r,S=i}else G=Math.ceil(z),S=Math.ceil(B);e.setStrokeStyle(t,t.attribute,o,l,h),e.beginPath(),e.moveTo(o,l),e.lineTo(o+G,l),e.lineDashOffset=e.currentMatrix.e/e.currentMatrix.a,e.setLineDash(null!=(b=H[0])?b:[]),e.stroke(),e.beginPath(),e.moveTo(o+G,l),e.lineTo(o+G,l+S),e.lineDashOffset=e.currentMatrix.f/e.currentMatrix.d,e.setLineDash(null!=(p=H[1])?p:[]),e.stroke(),e.beginPath(),e.moveTo(o,l+S),e.lineTo(o+G,l+S),e.lineDashOffset=e.currentMatrix.e/e.currentMatrix.a,e.setLineDash(null!=(C=H[2])?C:[]),e.stroke(),e.beginPath(),e.moveTo(o,l),e.lineTo(o,l+S),e.lineDashOffset=e.currentMatrix.f/e.currentMatrix.d,e.setLineDash(null!=(f=H[3])?f:[]),e.stroke(),e.lineDashOffset=0,e.setLineDash([])}};ty=tb([(0,q.b)()],ty);let tv=class{constructor(){this.time=tr.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d,c){let{lineWidth:g=h.lineWidth,stroke:b=h.stroke,lineDash:p=h.lineDash,strokeArrayWidth:C=h.strokeArrayWidth,strokeArrayColor:f=h.strokeArrayColor,notAdjustPos:w}=t.attribute;!0!==w&&b&&Array.isArray(p)&&!p.length&&!Array.isArray(f)&&!Array.isArray(C)&&1&g&&(c.doStroke=!1)}};tv=tb([(0,q.b)()],tv);let tx=class{constructor(){this.time=tr.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d){var c,g;let{lineWidth:b=h.lineWidth,stroke:p=h.stroke,lineDash:C=h.lineDash,strokeArrayWidth:f=h.strokeArrayWidth,strokeArrayColor:w=h.strokeArrayColor,notAdjustPos:m,cornerRadius:y=h.cornerRadius}=t.attribute,{width:v=h.width,height:x=h.height}=t.attribute;if(!0!==m&&p&&Array.isArray(C)&&!C.length&&!Array.isArray(w)&&!Array.isArray(f)&&1&b){let r=t.stage.table;if(!r)return;(null==(c=r.options.customConfig)?void 0:c._disableColumnAndRowSizeRound)&&(v=Math.round(v),x=Math.round(x)),e.beginPath();let i="bottom-right"===(null==(g=null==r?void 0:r.theme)?void 0:g.cellBorderClipDirection);i?(o=Math.floor(o)-.5,l=Math.floor(l)-.5,"cell"===t.role&&(0===t.col&&(o+=1),0===t.row&&(l+=1))):(o=Math.floor(o)+.5,l=Math.floor(l)+.5);let{width:n,height:a}=tS(t,Math.ceil(v),Math.ceil(x),i);y?(0,tu.U)(e,o,l,n+0,a+0,y):e.rect(o,l,n,a),e.setStrokeStyle(t,t.attribute,o,l,h),e.stroke()}}};tx=tb([(0,q.b)()],tx);let tR=class{constructor(){this.time=tr.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d,c){if("cell"===t.role){let e=t.stage.table;if(e){let o=(0,tg.zh)(t,e);if(o)t.attribute._vtableHightLightFill=o;else if(e.stateManager.interactionState!==tc.F.scrolling){let o=(0,td.J)(t,e);o&&(t.attribute._vtableHightLightFill=o)}}}}};tR=tb([(0,q.b)()],tR);let tA=class{constructor(){this.time=tr.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d){if(t.attribute._vtableHightLightFill){if(u);else if(n){let r=t.attribute.fill;t.attribute.fill=t.attribute._vtableHightLightFill,e.setCommonStyle(t,t.attribute,o,l,h),e.fill(),t.attribute.fill=r,t.attribute._vtableHightLightFill=void 0}}}};tA=tb([(0,q.b)()],tA);let tH=class{constructor(){this.time=tr.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d,c){var g,b,p,C,f,w;let m=t.stage.table;m&&("body"===t.role?tG(e,-(null!=(g=t.attribute.x)?g:0)+m.getFrozenColsWidth(),-(null!=(b=t.attribute.y)?b:0)+m.getFrozenRowsHeight(),t.parent.attribute.width-m.getFrozenColsWidth()-m.getRightFrozenColsWidth(),t.parent.attribute.height-m.getFrozenRowsHeight()-m.getBottomFrozenRowsHeight()):"row-header"===t.role?tG(e,0,-(null!=(p=t.attribute.y)?p:0)+m.getFrozenRowsHeight(),m.getFrozenColsWidth(),t.parent.attribute.height-m.getFrozenRowsHeight()-m.getBottomFrozenRowsHeight()):"col-header"===t.role?tG(e,-(null!=(C=t.attribute.x)?C:0)+m.getFrozenColsWidth(),0,t.parent.attribute.width-m.getFrozenColsWidth()-m.getRightFrozenColsWidth(),m.getFrozenRowsHeight()):"right-frozen"===t.role?tG(e,0,-(null!=(f=t.attribute.y)?f:0)+m.getFrozenRowsHeight(),m.getRightFrozenColsWidth(),t.parent.attribute.height-m.getFrozenRowsHeight()-m.getBottomFrozenRowsHeight()):"bottom-frozen"===t.role?tG(e,-(null!=(w=t.attribute.x)?w:0)+m.getFrozenColsWidth(),0,t.parent.attribute.width-m.getFrozenColsWidth()-m.getRightFrozenColsWidth(),m.getBottomFrozenRowsHeight()):"corner-header"===t.role?tG(e,0,0,m.getFrozenColsWidth(),m.getFrozenRowsHeight()):"corner-right-top-header"===t.role?tG(e,0,0,m.getRightFrozenColsWidth(),m.getFrozenRowsHeight()):"corner-right-bottom-header"===t.role?tG(e,0,0,m.getRightFrozenColsWidth(),m.getBottomFrozenRowsHeight()):"corner-left-bottom-header"===t.role&&tG(e,0,0,m.getFrozenColsWidth(),m.getBottomFrozenRowsHeight()))}};function tG(t,e,o,l,r){t.beginPath();let i=t.applyedMatrix;Math.abs(i.f)>0x1000000||Math.abs(i.g)>0x1000000?t.rect(e-0x1000000,o-0x1000000,l+0x2000000,r+0x2000000):t.rect(e,o,l,r)}function tS(t,e,o,l){var r,i;let n=t.stage.table;if(!n)return{width:e,height:o};if("cell"===t.role){let a=t.col,s=t.row,u=(0,h.Z)(n,a,s);u&&(a=u.end.col,s=u.end.row),l?(0===a&&(e-=1),0===s&&(o-=1)):((a===n.colCount-1||a===n.frozenColCount-1&&n.scrollLeft||(null==(r=n.containerFit)?void 0:r.width)&&n.rightFrozenColCount&&a===n.colCount-n.rightFrozenColCount-1)&&(e-=1),(s===n.rowCount-1||s===n.frozenRowCount-1&&n.scrollTop||(null==(i=n.containerFit)?void 0:i.height)&&n.bottomFrozenRowCount&&s===n.rowCount-n.bottomFrozenRowCount-1)&&(o-=1))}else"corner-frozen"===t.role&&(n.scrollLeft&&!l&&(e-=1),n.scrollTop&&!l&&(o-=1));return{width:e,height:o}}tH=tb([(0,q.b)()],tH);var tz=function(t,e,o,l){var r,i=arguments.length,n=i<3?e:null===l?l=Object.getOwnPropertyDescriptor(e,o):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,o,l);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(n=(i<3?r(n):i>3?r(e,o,n):r(e,o))||n);return i>3&&n&&Object.defineProperty(e,o,n),n};let tB=class{constructor(){this.time=tr.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d,c){let{stroke:g=h.stroke,strokeArrayWidth:b=h.strokeArrayWidth,strokeArrayColor:p=h.strokeArrayColor}=t.attribute;g&&(Array.isArray(g)||Array.isArray(b)||Array.isArray(p))&&(c.doStroke=!1)}};tB=tz([(0,q.b)()],tB);let tF=class{constructor(){this.time=tr.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d){let{width:c=h.width,height:g=h.height,stroke:b=h.stroke,strokeArrayColor:p=h.strokeArrayColor,strokeArrayWidth:C=h.strokeArrayWidth,lineWidth:f=h.lineWidth,strokeColor:w=h.stroke,cornerRadius:m=h.cornerRadius}=t.attribute;!(!b||!Array.isArray(C)&&0===f||c<=0||g<=0)&&(Array.isArray(b)||Array.isArray(p)||Array.isArray(C))&&("border-rect"!==t.name&&"table-border-rect"!==t.name&&("number"==typeof f&&1&f||Array.isArray(C)&&C.some(t=>1&t))&&(o=Math.floor(o)+.5,l=Math.floor(l)+.5),0===m||(0,te.Z)(m)&&m.every(t=>0===t)?tw(t,e,o,l,h,b,C||f,p||w,"table-border-rect"!==t.name?Math.ceil(c+0):c+0,"table-border-rect"!==t.name?Math.ceil(g+0):g+0):(e.beginPath(),(0,tu.U)(e,o,l,c,g,m,!0,[,,,,].fill(0).map((r,i)=>(r,n,a,s)=>{tM(i,r,n,a,s,t,e,o,l,h,b,C||f,p||w,Math.ceil(c+0),Math.ceil(g+0))})),e.stroke()))}};function tM(t,e,o,l,r,i,n,a,h,s,u,d,c,g,b){var p,C,f,w;let m=tf(d),y=!Array.isArray(d),v=!Array.isArray(u),x=Array.isArray(c)||m.isSplitDraw;n.stroke(),n.setStrokeStyle(i,i.attribute,a,h,s);let{lineDash:R=s.lineDash}=i.attribute,A=!1;R.length&&R.some(t=>Array.isArray(t))&&(A=!0),n.beginPath(),n.moveTo(a,h);let H=(v||u[0])&&(y||d[0]),G=(v||u[1])&&(y||d[1]),S=(v||u[2])&&(y||d[2]),z=(v||u[3])&&(y||d[3]);H&&0===t?(y?m.width:d[0],y?m.width:d[0],n.moveTo(e,o),n.lineTo(l,r),(x||A)&&(c&&c[0]?n.strokeStyle=c[0]:c&&!c[0]&&(n.strokeStyle="transparent"),y||(n.lineWidth=d[0]),n.lineDashOffset=n.currentMatrix.e/n.currentMatrix.a,A&&n.setLineDash(null!=(p=R[0])?p:[]),n.stroke(),n.beginPath())):0===t&&n.moveTo(a+g,h),G&&1===t?(y?m.width:d[1],y?m.width:d[1],n.moveTo(e,o),n.lineTo(l,r),(x||A)&&(c&&c[1]?n.strokeStyle=c[1]:c&&!c[1]&&(n.strokeStyle="transparent"),y||(n.lineWidth=d[1]),n.lineDashOffset=n.currentMatrix.f/n.currentMatrix.d,A&&n.setLineDash(null!=(C=R[1])?C:[]),n.stroke(),n.beginPath(),n.moveTo(a+g,h+b))):1===t&&n.moveTo(a+g,h+b),S&&2===t?(y?m.width:d[2],y?m.width:d[2],n.moveTo(e,o),n.lineTo(l,r),(x||A)&&(c&&c[2]?n.strokeStyle=c[2]:c&&!c[2]&&(n.strokeStyle="transparent"),y||(n.lineWidth=d[2]),n.lineDashOffset=n.currentMatrix.e/n.currentMatrix.a,A&&n.setLineDash(null!=(f=R[2])?f:[]),n.stroke(),n.beginPath(),n.moveTo(a,h+b))):2===t&&n.moveTo(a,h+b),z&&3===t?(y?m.width:d[3],y?m.width:d[3],n.moveTo(e,o),n.lineTo(l,r),(x||A)&&(c&&c[3]?n.strokeStyle=c[3]:c&&!c[3]&&(n.strokeStyle="transparent"),y||(n.lineWidth=d[3]),n.lineDashOffset=n.currentMatrix.f/n.currentMatrix.d,A&&n.setLineDash(null!=(w=R[3])?w:[]),n.stroke(),n.beginPath(),n.moveTo(a,h))):3===t&&n.moveTo(a,h),n.closePath(),x||A||(!y&&m.width&&(n.lineWidth=m.width),n.stroke()),n.lineDashOffset=0,n.setLineDash([]),n.beginPath()}tF=tz([(0,q.b)()],tF);var tW=o(507261),tk=o(621044);let tP,t_=class{constructor(){this.order=1,this.interceptors=[new tL]}afterDrawItem(t,e,o,l,r){for(let i=0;i<this.interceptors.length;i++)if(this.interceptors[i].afterDrawItem&&this.interceptors[i].afterDrawItem(t,e,o,l,r))return!0;return!1}beforeDrawItem(t,e,o,l,r){if((!t.in3dMode||o.in3dInterceptor)&&!t.shadowRoot&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(let i=0;i<this.interceptors.length;i++)if(this.interceptors[i].beforeDrawItem&&this.interceptors[i].beforeDrawItem(t,e,o,l,r))return!0;return!1}};t_=function(t,e,o,l){var r,i=arguments.length,n=i<3?e:null===l?l=Object.getOwnPropertyDescriptor(e,o):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,o,l);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(n=(i<3?r(n):i>3?r(e,o,n):r(e,o))||n);return i>3&&n&&Object.defineProperty(e,o,n),n}([(0,q.b)()],t_);class tL{constructor(){this.order=1}afterDrawItem(t,e,o,l,r){return"image"===t.type&&this.drawItem(t,e,o,l,r),!1}drawItem(t,e,o,l,r){let{image:i,gif:n}=t.attribute;if(n&&t.playing||!i||!t.resources)return!1;let a=t.resources.get(i);if(!a||"loading"!==a.state)return!1;if(!tP){let t=P.U2(),e=t.loading_pic.svg,o=t.loading_pic.width,l=t.loading_pic.height;tP=(0,tW.B)({width:o,height:l,image:e})}let{image:h}=tP.attribute;if(!i||!tP.resources)return!1;let s=tP.resources.get(h);if("success"!==s.state)return!1;let{context:u}=o;u.highPerformanceSave(),t.parent&&u.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&u.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);let d=t.AABBBounds,{width:c,height:g}=(0,tk.f)(s.data.width,s.data.height,d.width(),d.height());return u.drawImage(s.data,d.x1+(d.width()-c)/2,d.y1+(d.height()-g)/2,c,g),u.highPerformanceRestore(),!0}}var tT=o(780949),tE=o(492859),tI=o(83624),tD=o(908429);let tN=class{constructor(){this.time=tr.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,o,l,r,i,n,a,h,s,u,d,c){var g,b;let{text:p,underline:C=h.underline,lineThrough:f=h.lineThrough,direction:w=h.direction,whiteSpace:m=h.whiteSpace,fontSize:y=h.fontSize,verticalMode:v=h.verticalMode,ellipsis:x=h.ellipsis,textAlign:R=h.textAlign,textBaseline:A=h.textBaseline,x:H=h.x,y:G=h.y}=t.attribute,S=!1;if(Array.isArray(t)){let e=null==(g=t.cache)?void 0:g.layoutData;x&&e&&e.lines.every(t=>""===t.str)&&(S=!0)}else{let{cache:e}=t;x&&e&&""===e.clipedText&&0===e.clipedWidth&&(S=!0)}if(!S)return;let z=(0,tI.Z)(x)?x:"...",B=null!=(b=(0,tT.VA)(t.attribute.lineHeight,y))?b:y,F=0;B!==y&&("top"===A?F=(B-y)/2:"middle"===A||"bottom"===A&&(F=-(B-y)/2)),i&&(d?d(e,t.attribute,h):a&&(e.setStrokeStyle(t,t.attribute,H-o,G-l,h),e.strokeText(z,H,G+F))),r&&(u?u(e,t.attribute,h):n&&(e.setCommonStyle(t,t.attribute,H-o,G-l,h),e.fillText(z,H,G+F),this.drawUnderLine(C,f,t,H,G+F,0,h,e,z)))}drawUnderLine(t,e,o,l,r,i,n,a,h){if(e+t<=0)return;let{textAlign:s=n.textAlign,textBaseline:u=n.textBaseline,fontSize:d=n.fontSize,fontFamily:c=n.fontFamily,fontWeight:g=n.fontWeight,fontStyle:b=n.fontStyle,fill:p=n.fill,opacity:C=n.opacity,underlineOffset:f=n.underlineOffset,underlineDash:w=n.underlineDash,fillOpacity:m=n.fillOpacity}=o.attribute;if(!t&&!e)return;let y=tD.QC.measureTextWidth(h,{fontSize:d,fontFamily:c,fontWeight:g,fontStyle:b}),v=(0,tE.js)(s,y),x=(0,tE.nV)(u,d,d),R={lineWidth:0,stroke:p,opacity:C,strokeOpacity:m};if(t){R.lineWidth=t,a.setStrokeStyle(o,R,l,r,n),a.setLineDash(w),a.beginPath();let e=r+x+d+f;a.moveTo(l+v,e,i),a.lineTo(l+v+y,e,i),a.stroke()}if(e){R.lineWidth=e,a.setStrokeStyle(o,R,l,r,n),a.beginPath();let t=r+x+d/2;a.moveTo(l+v,t,i),a.lineTo(l+v+y,t,i),a.stroke()}}};tN=function(t,e,o,l){var r,i=arguments.length,n=i<3?e:null===l?l=Object.getOwnPropertyDescriptor(e,o):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,o,l);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(n=(i<3?r(n):i>3?r(e,o,n):r(e,o))||n);return i>3&&n&&Object.defineProperty(e,o,n),n}([(0,q.b)()],tN);let tZ=class{constructor(){this.type="chart",this.numberType=Q.e}contains(t,e,o){var l;if(t.attribute.detectPickChartItem){let o=t.activeChartInstance;if(!o)return!1;let r=o.getStage();null==(l=r.dirtyBounds)||l.clear();let i=r.pick(e.x,e.y);return(null!==i.graphic||"root"!==i.group.name)&&i}return!!t.AABBBounds.containsPoint(e)}};tZ=function(t,e,o,l){var r,i=arguments.length,n=i<3?e:null===l?l=Object.getOwnPropertyDescriptor(e,o):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,o,l);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(n=(i<3?r(n):i>3?r(e,o,n):r(e,o))||n);return i>3&&n&&Object.defineProperty(e,o,n),n}([(0,q.b)()],tZ);var tO=new $.n((t,e,o,l)=>{o(V.d4)?l(V.d4).to(tB).inSingletonScope():(t(tB).toSelf().inSingletonScope(),t(U.d5).toService(tB)),o(V.Er)?l(V.Er).to(tF).inSingletonScope():(t(tF).toSelf().inSingletonScope(),t(U.d5).toService(tF)),t(tl).toSelf().inSingletonScope(),t(to).to(tl),t(J.uz).to(tl),t(tZ).toSelf().inSingletonScope(),t(Y.EL).toService(tZ),t(tn).toSelf().inSingletonScope(),t(U.JO).toService(tn),t(ta).toSelf().inSingletonScope(),t(U.JO).toService(ta),t(th).toSelf().inSingletonScope(),t(U.JO).toService(th),t(ts).toSelf().inSingletonScope(),t(U.JO).toService(ts),t(tR).toSelf().inSingletonScope(),t(U.jd).toService(tR),t(tA).toSelf().inSingletonScope(),t(U.jd).toService(tA),t(tC).toSelf().inSingletonScope(),t(U.jd).toService(tC),t(tp).toSelf().inSingletonScope(),t(U.jd).toService(tp),t(tm).toSelf().inSingletonScope(),t(U.jd).toService(tm),t(ty).toSelf().inSingletonScope(),t(U.jd).toService(ty),t(tv).toSelf().inSingletonScope(),t(U.jd).toService(tv),t(tx).toSelf().inSingletonScope(),t(U.jd).toService(tx),t(tH).toSelf().inSingletonScope(),t(U.jd).toService(tH),t(t_).toSelf().inSingletonScope(),t(j.xL).toService(t_),t(tN).toSelf().inSingletonScope(),t(U.$K).toService(tN)}),t$=o(704654),tV=o(788536),tU=o(201028),tJ=o(506613),tY=o(135759),tj=o(604410);function tX(t,e,o,l,r,i,n,a,h){var s,c;let p,C,f,w=0;t.lastChild&&t.lastChild.row===l-1?w=t.lastChild.attribute.y+t.lastChild.attribute.height:t.colHeight?w=t.colHeight:l>=a.columnHeaderLevelCount&&l<a.rowCount-a.bottomFrozenRowCount&&(w=a.getRowsHeight(a.columnHeaderLevelCount,l-1));for(let m=l;m<=r;m++){let r=m,y,v,x,R,A=a.getCellLocation(e,r),H=a.getCellValue(e,r),G=o,S=a.getRowHeight(r),z=!1;if(a.internalProps.customMergeCell){let t=a.getCustomMerge(e,r);if(t){let{range:e,text:o,style:n,customLayout:h,customRender:s}=t;if(v=(y=e).start.col!==y.end.col||y.start.row!==y.end.row){let t=tq(y,i,a,l>y.start.row);G=t.cellWidth,S=t.cellHeight}H=o,x=n,(h||s)&&(R=(0,d.ws)(h,s,e.start.col,e.start.row,a.getColsWidth(e.start.col,e.end.col),a.getRowsHeight(e.start.row,e.end.row),!1,a.isAutoRowHeight(r),[0,0,0,0],y,a)),z=!0}}let B,F=e,M=r;y&&(F=y.start.col,M=y.start.row),!a.isPivotTable()&&("columnHeader"===A||"cornerHeader"===A)&&r>=a.columnHeaderLevelCount&&(A="body"),B=!a.isPivotTable()&&a.isSeriesNumberInBody(e,r)?a.getBodyColumnDefine(F,M):"body"!==A?a.getHeaderDefine(F,M):a.getBodyColumnDefine(F,M);let W="isAggregation"in a.internalProps.layoutMap&&a.internalProps.layoutMap.isAggregation(e,r),k=a.internalProps.layoutMap.isSeriesNumber(e,r),P="body"!==A||((null==B?void 0:B.dragOrder)||!!(null==B?void 0:B.icon)||!!(null==B?void 0:B.tree))&&!(W&&k);if(!y&&(a.internalProps.enableTreeNodeMerge||"body"!==A||(null==B?void 0:B.mergeCell))&&(v=(y=a.getCellRange(e,r)).start.col!==y.end.col||y.start.row!==y.end.row)){let t=tq(y,i,a,l>y.start.row);G=t.cellWidth,S=t.cellHeight}let _=!1;if(a.internalProps.enableTreeNodeMerge&&v){let t=a.getCellRawRecord(y.start.col,y.start.row),{vtableMergeName:o,vtableMerge:l}=null!=t?t:{};_=l,l&&(P=!0,a.internalProps.groupTitleCustomLayout&&(R=(0,d.ws)(a.internalProps.groupTitleCustomLayout,void 0,y.start.col,y.start.row,a.getColsWidth(y.start.col,y.end.col),a.getRowsHeight(y.start.row,y.end.row),!1,a.isAutoRowHeight(r),[0,0,0,0],y,a)),a.internalProps.groupTitleFieldFormat?H=a.internalProps.groupTitleFieldFormat(t,e,r,a):void 0!==o&&(H=o))}let L=_||z?"text":null!=(c=a.isHeader(e,r)?null!=(s=a._getHeaderLayoutMap(e,r).headerType)?s:"text":a.getBodyColumnType(e,r))?c:"text";if((0,tY.tI)(H)){(function(t,e,o,l,r,i,n){let a=new tV.Z({x:0,y:l,width:r,height:i});a.role="cell",a.col=t,a.row=e,n.addChild(a)})(e,r,0,w,G,S,t),(0,tj.K)(H,a,tK.bind(null,{type:L,value:H,define:B,table:a,col:e,row:r,colWidth:o,cellWidth:G,cellHeight:S,columnGroup:t,y:w,customStyle:x,mayHaveIcon:P,cellLocation:A,range:y,customResult:R,defaultRowHeight:n})),t.updateColumnRowNumber(r);let l=a.getRowHeight(r);t.updateColumnHeight(l),w+=l}else{let l=x||a._getCellStyle(y?y.start.col:e,y?y.start.row:r),i=(0,u.RT)(l,a,y?y.start.col:e,y?y.start.row:r,b.WJ).theme;i.group.cornerRadius=(0,u.xv)(e,r,a),i.group.width=o,i.group.height=Array.isArray(n)?n[r]:n,i._vtable.padding&&(p=i._vtable.padding),i.text.textAlign&&(C=i.text.textAlign),i.text.textBaseline&&(f=i.text.textBaseline),"body"===A||i.group.fill||(i.group.fill="#fff");let h=(0,g.kE)(L,H,B,a,e,r,o,G,S,t,w,p,C,f,P,i,y,R);if(t.updateColumnRowNumber(r),v){let o=a.getRowHeight(r),{width:l}=(a.getColWidth(e),h.attribute),{height:i}=h.attribute;h.contentWidth=l,h.contentHeight=i,(0,g.pZ)(y,l,i,p,C,f,a),t.updateColumnHeight(o),w+=o}else t.updateColumnHeight(S),w+=S}if(h&&r>h)break}return t.setAttribute("width",o),{width:o,height:w}}function tK(t){let e,o,l,{type:r,value:i,define:n,table:a,col:h,row:s,colWidth:d,cellWidth:c,cellHeight:p,columnGroup:C,y:f,cellLocation:w,mayHaveIcon:m,customStyle:y,range:v,customResult:x,defaultRowHeight:R}=t,A=y||a._getCellStyle(v?v.start.col:h,v?v.start.row:s),H=(0,u.RT)(A,a,v?v.start.col:h,v?v.start.row:s,b.WJ).theme;H.group.cornerRadius=(0,u.xv)(h,s,a),H.group.width=d,H.group.height=Array.isArray(R)?R[s]:R,H._vtable.padding&&(e=H._vtable.padding),H.text.textAlign&&(o=H.text.textAlign),H.text.textBaseline&&(l=H.text.textBaseline),"body"===w||H.group.fill||(H.group.fill="#fff"),(0,g.kE)(r,i,n,a,h,s,d,c,p,C,f,e,o,l,m,H,v,x)}function tq(t,e,o,l){let r=0,i=0,n=e.get(`${t.start.col},${t.start.row};${t.end.col},${t.end.row}`);if(!n||l){for(let e=t.start.col;e<=t.end.col;e++)r+=o.getColWidth(e);for(let e=t.start.row;e<=t.end.row;e++)i+=o.getRowHeight(e);e.set(`${t.start.col},${t.start.row};${t.end.col},${t.end.row}`,{cellWidth:r,cellHeight:i})}else r=n.cellWidth,i=n.cellHeight;return{cellWidth:r,cellHeight:i}}function tQ(t,e,o,l,r,i,n,a,h,s){if(l>r||i>n)return;let{layoutMap:u,defaultHeaderRowHeight:d,defaultColWidth:c}=h.internalProps,g=h.defaultRowHeight,b=0,p=0;for(let u=l;u<=r;u++){let l=u,r=h.getColWidth(l),c=new tV.Z({x:e+b,y:o,width:r,height:0,clip:!1,pickable:!1});c.role="column",c.col=u,t.addChild(c);let{width:C,height:f}=tX(c,l,r,i,n,h.scenegraph.mergeMap,"columnHeader"===a&&(0,t$.Z)(d)?d:g,h,s);b+=C,p=Math.max(p,f)}t.setAttribute("width",b),t.setAttribute("height",p)}function t0(t){let e=t.firstChild;for(;e&&"group"!==e.type;)e=e._next;return e}function t1(t){let e=t.lastChild;for(;e&&"group"!==e.type;)e=e._prev;return e}function t2(t,e,o,l="left"){for(let r=t;r<=e;r++){let t=o.scenegraph.getColGroup(r);t&&t3(t,o,l);let e=o.scenegraph.getColGroup(r,!0);e&&t3(e,o,l);let i=o.scenegraph.getColGroupInBottom(r);i&&t3(i,o,l)}let r=Math.min(o.scenegraph.proxy.colLimit,o.scenegraph.proxy.bodyRightCol-o.scenegraph.proxy.bodyLeftCol+1),i=o.getColsWidth(o.frozenColCount,o.frozenColCount+r),n=o.getColsWidth(o.frozenColCount,o.colCount-1);o.scenegraph.proxy.xLimitLeft=i/2,o.scenegraph.proxy.xLimitRight=n-i/2}function t3(t,e,o="left"){if("left"===o){let o,l=function(t){let e=t._prev;for(;e&&"group"!==e.type;)e=e._prev;return e}(t);o=l?l.attribute.x+e.getColWidth(t._prev.col):e.getColsWidth(e.frozenColCount,t.col-1),t.setAttribute("x",o)}else{let o,l=function(t){let e=t._next;for(;e&&"group"!==e.type;)e=e._next;return e}(t);o=l?l.attribute.x-e.getColWidth(t.col):e.getColsWidth(e.frozenColCount,t.col-1),t.setAttribute("x",o)}}var t5=function(t,e,o,l){return new(o||(o=Promise))(function(r,i){function n(t){try{h(l.next(t))}catch(t){i(t)}}function a(t){try{h(l.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?r(t.value):((e=t.value)instanceof o?e:new o(function(t){t(e)})).then(n,a)}h((l=l.apply(t,e||[])).next())})};function t4(t,e,o,l,r,i){return t5(this,void 0,void 0,function*(){if("left"===e&&i.colEnd+t>i.bodyRightCol?t=i.bodyRightCol-i.colEnd:"right"===e&&i.colStart-t<i.bodyLeftCol&&(t=i.colStart-i.bodyLeftCol),0!==t)if(t<0&&(e="left"===e?"right":"left",t=-t),t<i.colEnd-i.colStart){let r="left"===e?i.colStart:i.colEnd-t+1,n="left"===e?i.colStart+t-1:i.colEnd,a="left"===e?i.colEnd+1:i.colStart-t,h="left"===e?i.colEnd+t:i.colStart-1;(0,tU.rj)(i.table,a,h),function(t,e,o,l){for(let r=t;r<=e;r++)l.table.scenegraph.bodyGroup.childrenCount>0&&"group"===l.table.scenegraph.bodyGroup.firstChild.type&&t7(l.table.scenegraph.bodyGroup,o,l),l.table.scenegraph.colHeaderGroup.childrenCount>0&&"group"===l.table.scenegraph.colHeaderGroup.firstChild.type&&t7(l.table.scenegraph.colHeaderGroup,o,l),l.table.scenegraph.bottomFrozenGroup.childrenCount>0&&"group"===l.table.scenegraph.bottomFrozenGroup.firstChild.type&&t7(l.table.scenegraph.bottomFrozenGroup,o,l)}(r,n,e,i),i.colStart="left"===e?i.colStart+t:i.colStart-t,i.colEnd="left"===e?i.colEnd+t:i.colEnd-t,t9(a,h,i),t2(a,h,i.table,e);let s=l-((i.table.scenegraph.getColGroup(o)||i.table.scenegraph.getColGroup(o,!0)).attribute.x+i.table.getFrozenColsWidth()+i.table.scenegraph.proxy.deltaX);i.table.scenegraph.proxy.deltaX+=s,i.currentCol="left"===e?i.currentCol+t:i.currentCol-t,i.totalCol=Math.max(0,Math.min(i.table.colCount-1,"left"===e?i.totalCol+t:i.totalCol-t)),i.referenceCol=i.colStart+Math.floor((i.colEnd-i.colStart)/2),i.colUpdatePos=a,i.colUpdateDirection=e,i.table.scenegraph.updateNextFrame()}else{var r,n,a,h;let o="left"===e?i.colStart+t:i.colStart-t,l="left"===e?i.colEnd+t:i.colEnd-t;(0,tU.rj)(i.table,o,l),r=i.table.getColsWidth(i.bodyLeftCol,o-1),n=t,a=e,(h=i).table.scenegraph.colHeaderGroup.forEachChildren((t,e)=>{"group"===t.type&&t6(t,"left"===a?t.col+n:t.col-n,0===e?r:t._prev.attribute.x+h.table.getColWidth(t._prev.col))}),h.table.scenegraph.bottomFrozenGroup.forEachChildren((t,e)=>{"group"===t.type&&t6(t,"left"===a?t.col+n:t.col-n,0===e?r:t._prev.attribute.x+h.table.getColWidth(t._prev.col))}),h.table.scenegraph.bodyGroup.forEachChildren((t,e)=>{"group"===t.type&&t6(t,"left"===a?t.col+n:t.col-n,0===e?r:t._prev.attribute.x+h.table.getColWidth(t._prev.col))}),i.colStart=o,i.colEnd=l,t9(o,l,i),t2(o,l,i.table,l>i.bodyRightCol-(i.colEnd-i.colStart+1)?"right":"left"),i.currentCol="left"===e?i.currentCol+t:i.currentCol-t,i.totalCol=Math.max(0,Math.min(i.table.colCount-1,"left"===e?i.totalCol+t:i.totalCol-t)),i.referenceCol=i.colStart+Math.floor((i.colEnd-i.colStart)/2),i.colUpdatePos=i.colStart,i.colUpdateDirection=l>i.bodyRightCol-(i.colEnd-i.colStart+1)?"right":"left",i.table.scenegraph.updateNextFrame()}})}function t6(t,e,o){t.col=e,t.forEachChildren(t=>{t.col=e,t.needUpdate=!0}),t.setAttribute("x",o),t.needUpdate=!0}function t8(t,e){if(!t)return;let o=t.firstChild;for(;o;)o=e.updateCellGroupContent(o)._next;t.needUpdate=!1,t.setAttribute("width",e.table.getColWidth(t.col))}function t7(t,e,o){if("left"===e){let e=t0(t),l=t1(t);t6(e,l.col+1,l.attribute.x+o.table.getColWidth(l.col)),t.appendChild(e),t.border&&t.appendChild(t.border)}else{let e=t1(t),l=t0(t);t6(e,l.col-1,l.attribute.x-o.table.getColWidth(l.col-1)),t.insertBefore(e,t.firstChild)}}function t9(t,e,o){for(let l=t;l<=e;l++){let t=o.table.scenegraph.getColGroup(l,!0);t&&t8(t,o);let e=o.table.scenegraph.getColGroupInBottom(l);e&&t8(e,o);let r=o.table.scenegraph.getColGroupInRightTopCorner(l);r&&t8(r,o);let i=o.table.scenegraph.getColGroupInRightBottomCorner(l);i&&t8(i,o);let n=o.table.scenegraph.getColGroup(l);n&&function(t,e){if(!t)return;let o=e.screenTopRow,l=Math.max(e.bodyTopRow,o-e.screenRowCount),r=Math.min(e.bodyBottomRow,o+2*e.screenRowCount,e.table.rowCount-1);for(let o=l;o<=r;o++){let l=e.highPerformanceGetCell(t.col,o,!0);e.updateCellGroupContent(l)}e.rowUpdatePos=e.rowStart,t.needUpdate=!1,t.setAttribute("width",e.table.getColWidth(t.col))}(n,o)}et(o.table.scenegraph.colHeaderGroup),et(o.table.scenegraph.bottomFrozenGroup),et(o.table.scenegraph.bodyGroup),o.progress()}function et(t){var e,o;let l=t1(t);if(l&&(t.setAttribute("width",l.attribute.x+l.attribute.width),t.border)){let r=t.border;r.setAttribute("width",l.attribute.x+l.attribute.width-(null!=(e=r.attribute.borderLeft)?e:0)/2-(null!=(o=r.attribute.borderRight)?o:0)/2)}}function ee(t,e,o,l,r,i="up",n){var a,h;if("up"===i)for(let i=t;i<=e;i++)for(let t=o;t<=l;t++){let e,o=r.scenegraph.highPerformanceGetCell(i,t,!0);if("cell"===o.role&&o.row){if(o._prev)e=(null==(a=o._prev)?void 0:a.attribute.y)+r.getRowHeight(o._prev.row);else if(n){let o=l===r.rowCount-r.bottomFrozenRowCount-1?l:l+1;if(e=r.scenegraph.highPerformanceGetCell(i,o,!0).attribute.y,(0,N.Z)(e))for(let l=t;l<o;l++)e-=r.getRowHeight(l)}else e=eo(o.row,r);(0,N.Z)(e)&&o.setAttribute("y",e)}}else for(let i=t;i<=e;i++)for(let t=l;t>=o;t--){let e,l=r.scenegraph.highPerformanceGetCell(i,t,!0);if("cell"===l.role&&l.row){if(l._next)e=(null==(h=l._next)?void 0:h.attribute.y)-r.getRowHeight(l.row);else if(n){let l=o<=r.frozenRowCount?r.frozenRowCount:o-1;e=o<=r.frozenRowCount?0:r.scenegraph.highPerformanceGetCell(i,l,!0).attribute.y;for(let o=l;o<t;o++)e+=r.getRowHeight(o)}else e=eo(l.row,r);(0,N.Z)(e)&&l.setAttribute("y",e)}}let s=Math.min(r.scenegraph.proxy.rowLimit,r.scenegraph.proxy.bodyBottomRow-r.scenegraph.proxy.bodyTopRow+1),u=r.getRowsHeight(r.frozenRowCount,r.frozenRowCount+s),d=r.getRowsHeight(r.frozenRowCount,r.rowCount-1);r.scenegraph.proxy.yLimitTop=u/2,r.scenegraph.proxy.yLimitBottom=d-u/2}function eo(t,e){return t<e.frozenRowCount?e.getRowsHeight(0,t-1):t>=e.rowCount-e.bottomFrozenRowCount?e.getRowsHeight(e.rowCount-e.bottomFrozenRowCount,t-1):e.getRowsHeight(e.frozenRowCount,t-1)}var el=function(t,e,o,l){return new(o||(o=Promise))(function(r,i){function n(t){try{h(l.next(t))}catch(t){i(t)}}function a(t){try{h(l.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?r(t.value):((e=t.value)instanceof o?e:new o(function(t){t(e)})).then(n,a)}h((l=l.apply(t,e||[])).next())})};function er(t,e,o,l,r,i){return el(this,void 0,void 0,function*(){if("up"===e&&i.rowEnd+t>i.bodyBottomRow?t=i.bodyBottomRow-i.rowEnd:"down"===e&&i.rowStart-t<i.bodyTopRow&&(t=i.rowStart-i.bodyTopRow),0!==t)if(t<0&&(e="up"===e?"down":"up",t=-t),t<i.rowEnd-i.rowStart){let l,r,n="up"===e?i.rowStart:i.rowEnd-t+1,a="up"===e?i.rowStart+t-1:i.rowEnd,h="up"===e?i.rowEnd+1:i.rowStart-t,s="up"===e?i.rowEnd+t:i.rowStart-1;i.table.isAutoRowHeight(n)?(l=h,r=s):(l=Math.max(i.bodyTopRow,o-i.screenRowCount),r=Math.min(i.bodyBottomRow,o+2*i.screenRowCount,i.table.rowCount-1)),(0,w.Y)(i.table,l,r,!1),function(t,e,o,l){for(let r=0;r<l.table.frozenColCount;r++){let i=l.table.scenegraph.getColGroup(r);if(i)for(let r=t;r<=e;r++)ei(i,o,l)}for(let r=l.table.colCount-l.table.rightFrozenColCount;r<l.table.colCount;r++){let i=l.table.scenegraph.getColGroup(r);if(i)for(let r=t;r<=e;r++)ei(i,o,l)}for(let r=l.bodyLeftCol;r<=l.bodyRightCol;r++){let i=l.table.scenegraph.getColGroup(r);if(i)for(let r=t;r<=e;r++)ei(i,o,l)}}(n,a,e,i),i.rowStart="up"===e?i.rowStart+t:i.rowStart-t,i.rowEnd="up"===e?i.rowEnd+t:i.rowEnd-t;let u=en(l,r,i,!0);i.table.isAutoRowHeight(n)&&(ee(i.bodyLeftCol,i.bodyRightCol,l,r,i.table,s>i.bodyBottomRow-(i.rowEnd-i.rowStart+1)?"down":"up",!0),ee(0,i.table.frozenColCount-1,l,r,i.table,s>i.bodyBottomRow-(i.rowEnd-i.rowStart+1)?"down":"up",!0),ee(i.table.colCount-i.table.rightFrozenColCount,i.table.colCount-1,l,r,i.table,s>i.bodyBottomRow-(i.rowEnd-i.rowStart+1)?"down":"up",!0)),i.currentRow="up"===e?i.currentRow+t:i.currentRow-t,i.totalRow=Math.max(0,Math.min(i.bodyBottomRow,"up"===e?i.totalRow+t:i.totalRow-t,i.table.rowCount-1)),i.referenceRow=i.rowStart+Math.floor((i.rowEnd-i.rowStart)/2),i.table.isAutoRowHeight(n)&&u?i.rowUpdatePos=Math.min(i.rowUpdatePos,i.rowEnd+1):i.rowUpdatePos=Math.min(i.rowUpdatePos,h),i.rowUpdateDirection=e,i.table.scenegraph.updateNextFrame(),yield i.progress()}else{let l,r,n="up"===e?i.rowStart+t:i.rowStart-t,a=Math.min(i.table.rowCount-1,"up"===e?i.rowEnd+t:i.rowEnd-t),h=i.table.getRowsHeight(i.bodyTopRow,n-1);i.table.isAutoRowHeight(n)?(l=n,r=a):(l=Math.max(i.bodyTopRow,o-i.screenRowCount),r=Math.min(i.bodyBottomRow,o+2*i.screenRowCount,i.table.rowCount-1)),(0,w.Y)(i.table,l,r,!1),function(t,e,o,l){for(let r=0;r<l.table.frozenColCount;r++){let i=l.table.scenegraph.getColGroup(r);null==i||i.forEachChildren((r,i)=>{l.updateCellGroupPosition(r,"up"===o?r.row+e:r.row-e,0===i?t:r._prev.attribute.y+l.table.getRowHeight(r._prev.row))})}for(let r=l.table.colCount-l.table.rightFrozenColCount;r<l.table.colCount;r++){let i=l.table.scenegraph.getColGroup(r);null==i||i.forEachChildren((r,i)=>{l.updateCellGroupPosition(r,"up"===o?r.row+e:r.row-e,0===i?t:r._prev.attribute.y+l.table.getRowHeight(r._prev.row))})}for(let r=l.bodyLeftCol;r<=l.bodyRightCol;r++){let i=l.table.scenegraph.getColGroup(r);null==i||i.forEachChildren((r,i)=>{l.updateCellGroupPosition(r,"up"===o?r.row+e:r.row-e,0===i?t:r._prev.attribute.y+l.table.getRowHeight(r._prev.row))})}}(h,t,e,i),i.rowStart=n,i.rowEnd=a;let s=en(l,r,i,!0);i.table.isAutoRowHeight(n)&&(ee(i.bodyLeftCol,i.bodyRightCol,l,r,i.table,a>i.bodyBottomRow-(i.rowEnd-i.rowStart+1)?"down":"up"),ee(0,i.table.frozenColCount-1,l,r,i.table,a>i.bodyBottomRow-(i.rowEnd-i.rowStart+1)?"down":"up"),ee(i.table.colCount-i.table.rightFrozenColCount,i.table.colCount-1,l,r,i.table,a>i.bodyBottomRow-(i.rowEnd-i.rowStart+1)?"down":"up")),i.currentRow="up"===e?i.currentRow+t:i.currentRow-t,i.totalRow=Math.max(0,Math.min(i.bodyBottomRow,"up"===e?i.totalRow+t:i.totalRow-t,i.table.rowCount-1)),i.referenceRow=i.rowStart+Math.floor((i.rowEnd-i.rowStart)/2),i.table.isAutoRowHeight(n)&&s?i.rowUpdatePos=i.rowEnd+1:i.rowUpdatePos=i.rowStart,i.rowUpdateDirection=a>i.bodyBottomRow-(i.rowEnd-i.rowStart+1)?"down":"up",i.table.scenegraph.updateNextFrame(),yield i.progress()}})}function ei(t,e,o){if(t.childrenCount>=1)if("up"===e){let e=t.firstChild;o.updateCellGroupPosition(e,t.lastChild.row+1,t.lastChild.attribute.y+o.table.getRowHeight(t.lastChild.row)),t.appendChild(e)}else{let e=t.lastChild;o.updateCellGroupPosition(e,t.firstChild.row-1,t.firstChild.attribute.y-o.table.getRowHeight(e.row)),t.insertBefore(e,t.firstChild)}}function en(t,e,o,l=!1){for(let l=0;l<o.table.frozenColCount;l++)for(let r=t;r<=e;r++){let t=o.highPerformanceGetCell(l,r,!0);o.updateCellGroupContent(t)}for(let l=o.table.colCount-o.table.rightFrozenColCount;l<o.table.colCount;l++)for(let r=t;r<=e;r++){let t=o.highPerformanceGetCell(l,r);o.updateCellGroupContent(t)}let r=o.bodyLeftCol,i=o.bodyRightCol,n=!0;if(l){let t=o.screenLeftCol;r=Math.max(o.bodyLeftCol,t-o.screenColCount),i=Math.min(o.bodyRightCol,t+2*o.screenColCount),r===o.bodyLeftCol&&i===o.bodyRightCol||(n=!1)}for(let l=r;l<=i;l++)for(let r=t;r<=e;r++){let t=o.highPerformanceGetCell(l,r);o.updateCellGroupContent(t)}return ea(o.table.scenegraph.rowHeaderGroup),ea(o.table.scenegraph.rightFrozenGroup),ea(o.table.scenegraph.bodyGroup),o.table.scenegraph.updateNextFrame(),n}function ea(t){var e,o;let l=t1(t);if(!l)return;let r=t1(l);if(r&&(t.setAttribute("height",r.attribute.y+r.attribute.height),t.border)){let l=t.border;l.setAttribute("height",r.attribute.y+r.attribute.height-(null!=(e=l.attribute.borderTop)?e:0)/2-(null!=(o=l.attribute.borderBottom)?o:0)/2)}}var eh=o(675876),es=function(t,e,o,l){return new(o||(o=Promise))(function(r,i){function n(t){try{h(l.next(t))}catch(t){i(t)}}function a(t){try{h(l.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?r(t.value):((e=t.value)instanceof o?e:new o(function(t){t(e)})).then(n,a)}h((l=l.apply(t,e||[])).next())})};class eu{constructor(t){this.isRelease=!1,this.mode="column",this.rowLimit=200,this.currentRow=0,this.rowStart=0,this.rowEnd=0,this.referenceRow=0,this.screenTopRow=0,this.deltaY=0,this.deltaHeight=0,this.colLimit=100,this.screenLeftCol=0,this.deltaX=0,this.deltaWidth=0,this.cellCache=new Map,this.table=t,this.table.isPivotChart()?(this.rowLimit=Math.max(100,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight)),this.colLimit=Math.max(100,Math.ceil(2*t.tableNoFrameWidth/t.defaultColWidth))):this.table.isAutoRowHeight(t.columnHeaderLevelCount)?this.rowLimit=Math.max(100,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight)):("autoWidth"===this.table.widthMode||(this.rowLimit=Math.max(200,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight))),this.colLimit=Math.max(100,Math.ceil(2*t.tableNoFrameWidth/t.defaultColWidth))),this.table.internalProps.transpose?this.mode="row":this.table.isPivotTable()&&(this.mode="pivot"),this.table.options.maintainedDataCount&&(this.rowLimit=this.table.options.maintainedDataCount),this.table.options.maintainedColumnCount&&(this.colLimit=this.table.options.maintainedColumnCount),"adaptive"===this.table.heightMode&&(this.rowLimit=this.table.rowCount),"adaptive"===this.table.widthMode&&(this.colLimit=this.table.colCount)}get bodyLeftCol(){return this.table.frozenColCount}get bodyTopRow(){return this.table.frozenRowCount}setParamsForColumn(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;let t=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1);this.totalActualBodyColCount=t,this.totalCol=this.bodyLeftCol+t-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol;let e=this.table.defaultColWidth;this.taskColCount=+Math.ceil(this.table.tableNoFrameWidth/e);let o=e*t,l=e*(this.bodyRightCol-this.bodyLeftCol+1);this.xLimitLeft=o/2,this.xLimitRight=l-o/2;let r=5*this.table.tableNoFrameWidth;this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/e),this.firstScreenColLimit=Math.max(15,this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(r/e))),this.colUpdatePos=this.bodyRightCol}setParamsForRow(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;let t=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1);this.totalActualBodyRowCount=t,this.totalRow=this.bodyTopRow+t-1,this.rowStart=this.bodyTopRow,this.rowEnd=this.totalRow;let e=this.table.defaultRowHeight;this.taskRowCount=+Math.ceil(this.table.tableNoFrameHeight/e);let o=e*t,l=e*(this.bodyBottomRow-this.bodyTopRow+1);this.yLimitTop=o/2,this.yLimitBottom=l-o/2;let r=5*this.table.tableNoFrameHeight;this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/e),this.firstScreenRowLimit=Math.max(30,this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(r/e))),this.rowUpdatePos=this.bodyBottomRow}refreshRowCount(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;let t=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1);this.totalActualBodyRowCount=t,this.totalRow=this.rowStart+t-1}refreshColCount(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;let t=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1);this.totalActualBodyColCount=t,this.totalCol=this.bodyLeftCol+t-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol}resize(){let t=this.table.defaultColWidth;this.taskColCount=+Math.ceil(this.table.tableNoFrameWidth/t);let e=5*this.table.tableNoFrameWidth;this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/t),this.firstScreenColLimit=this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(e/t));let o=this.table.defaultRowHeight;this.taskRowCount=+Math.ceil(this.table.tableNoFrameHeight/o);let l=5*this.table.tableNoFrameHeight;this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/o),this.firstScreenRowLimit=this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(l/o))}createGroupForFirstScreen(t,e,o,l,r,i,n,a){!function(t,e,o,l,r,i,n,a,h){var s,u,d,c,g,b,p,C,f,m,y,v,x;let R,A,H,G,{table:S}=h,{leftBottomCornerGroup:z,rightTopCornerGroup:B,rightBottomCornerGroup:F}=S.scenegraph;h.setParamsForRow(),h.setParamsForColumn(),("adaptive"===S.widthMode||S.options.autoWrapText&&("adaptive"===S.heightMode||S.isAutoRowHeight(S.columnHeaderLevelCount)))&&(H=S.colCount-1),R=Math.min(h.firstScreenColLimit-1,S.colCount-1),"adaptive"===S.heightMode&&(G=S.rowCount-1),A=Math.min(h.firstScreenRowLimit-1,S.rowCount-1),0===S.internalProps._widthResizedColMap.size&&(0,tU.rj)(S,0,null!=H?H:R),0===S.internalProps._heightResizedRowMap.size&&(0,w.Y)(S,0,"auto"===S.options.canvasHeight||(null==(s=S.options.customConfig)?void 0:s.forceComputeAllRowHeight)?S.rowCount-1:null!=G?G:A),R<S.colCount-S.rightFrozenColCount&&S.colCount-S.rightFrozenColCount<=S.colCount-1&&(0,tU.rj)(S,S.colCount-S.rightFrozenColCount,S.colCount-1),A<S.rowCount-S.bottomFrozenRowCount&&S.rowCount-S.bottomFrozenRowCount<=S.rowCount-1&&(0,w.Y)(S,S.rowCount-S.bottomFrozenRowCount,S.rowCount-1),S.scenegraph.colHeaderGroup.setAttribute("x",S.getFrozenColsWidth()),S.scenegraph.rowHeaderGroup.setAttribute("y",S.getFrozenRowsHeight()),S.scenegraph.bottomFrozenGroup.setAttribute("x",S.getFrozenColsWidth()),S.scenegraph.rightFrozenGroup.setAttribute("y",S.getFrozenRowsHeight()),S.scenegraph.bodyGroup.setAttributes({x:S.getFrozenColsWidth(),y:S.getFrozenRowsHeight()}),tQ(t,n,a,0,S.frozenColCount-1,0,S.frozenRowCount-1,S.isListTable()?"columnHeader":"cornerHeader",S),R-S.rightFrozenColCount>=S.frozenColCount&&tQ(e,n,a,S.frozenColCount,R-S.rightFrozenColCount,0,S.frozenRowCount-1,"columnHeader",S),S.frozenColCount>0&&(S.leftRowSeriesNumberCount>0&&tQ(o,n,a,0,S.leftRowSeriesNumberCount-1,S.frozenRowCount,A-S.bottomFrozenRowCount,"rowHeader",S),S.frozenColCount>S.leftRowSeriesNumberCount&&tQ(o,n,a,S.leftRowSeriesNumberCount,Math.min(S.frozenColCount-1,S.rowHeaderLevelCount+S.leftRowSeriesNumberCount-1),S.frozenRowCount,A-S.bottomFrozenRowCount,"rowHeader",S),S.frozenColCount>S.rowHeaderLevelCount+S.leftRowSeriesNumberCount&&tQ(o,n,a,S.rowHeaderLevelCount+S.leftRowSeriesNumberCount,S.frozenColCount-1,S.frozenRowCount,A-S.bottomFrozenRowCount,"body",S)),S.bottomFrozenRowCount>0&&(S.frozenColCount>0&&(S.leftRowSeriesNumberCount>0&&tQ(z,n,a,0,S.leftRowSeriesNumberCount-1,S.rowCount-1-S.bottomFrozenRowCount+1,S.rowCount-1,"rowHeader",S),S.rowHeaderLevelCount>0&&tQ(z,n,a,S.leftRowSeriesNumberCount,S.leftRowSeriesNumberCount+S.rowHeaderLevelCount-1,S.rowCount-1-S.bottomFrozenRowCount+1,S.rowCount-1,"rowHeader",S),S.frozenColCount>S.rowHeaderLevelCount+S.leftRowSeriesNumberCount&&tQ(z,n,a,S.rowHeaderLevelCount+S.leftRowSeriesNumberCount,S.frozenColCount-1,S.rowCount-1-S.bottomFrozenRowCount+1,S.rowCount-1,"body",S)),R-S.rightFrozenColCount>=S.frozenColCount&&tQ(r,n,a,S.frozenColCount,R-S.rightFrozenColCount,S.rowCount-1-S.bottomFrozenRowCount+1,S.rowCount-1,S.isPivotChart()?"rowHeader":"body",S)),S.rightFrozenColCount>0&&(tQ(B,n,a,S.colCount-1-S.rightFrozenColCount+1,S.colCount-1,0,S.frozenRowCount-1,"columnHeader",S),tQ(l,n,a,S.colCount-1-S.rightFrozenColCount+1,S.colCount-1,S.frozenRowCount,A-S.bottomFrozenRowCount,S.isPivotChart()?"rowHeader":"body",S)),S.bottomFrozenRowCount>0&&S.rightFrozenColCount>0&&tQ(F,n,a,S.colCount-1-S.rightFrozenColCount+1,S.colCount-1,S.rowCount-1-S.bottomFrozenRowCount+1,S.rowCount-1,"body",S),R-S.rightFrozenColCount>=S.frozenColCount&&tQ(i,n,a,S.frozenColCount,R-S.rightFrozenColCount,S.frozenRowCount,A-S.bottomFrozenRowCount,"body",S),i.firstChild||e.firstChild||t.firstChild||o.firstChild?(h.currentRow=null!=(g=null!=(d=null==(u=i.firstChild)?void 0:u.rowNumber)?d:null==(c=o.firstChild)?void 0:c.rowNumber)?g:h.totalRow,h.rowEnd=h.currentRow,h.rowUpdatePos=h.rowEnd+1,h.referenceRow=h.rowStart+Math.floor((h.rowEnd-h.rowStart)/2),h.currentCol=null!=(x=null!=(y=null!=(f=null!=(p=null==(b=i.lastChild)?void 0:b.col)?p:null==(C=e.lastChild)?void 0:C.col)?f:null==(m=o.lastChild)?void 0:m.col)?y:null==(v=t.lastChild)?void 0:v.col)?x:h.totalCol,h.colEnd=h.currentCol,h.colUpdatePos=h.colEnd+1,h.referenceCol=h.colStart+Math.floor((h.colEnd-h.colStart)/2),h.progress()):(h.currentRow=h.totalRow,h.rowEnd=h.currentRow,h.rowUpdatePos=h.rowEnd+1,h.referenceRow=h.rowStart+Math.floor((h.rowEnd-h.rowStart)/2),h.currentCol=h.totalCol,h.colEnd=h.currentCol,h.colUpdatePos=h.colEnd+1,h.referenceCol=h.colStart+Math.floor((h.colEnd-h.colStart)/2))}(t,e,o,l,r,i,n,a,this)}progress(){return es(this,void 0,void 0,function*(){if(!this.isProgressing)return this.isProgressing=!0,new Promise((t,e)=>{setTimeout(()=>es(this,void 0,void 0,function*(){this.isProgressing=!1,this.isRelease||(this.colUpdatePos<=this.colEnd?(yield this.updateColCellGroupsAsync(),yield this.progress()):this.rowUpdatePos<=this.rowEnd?(yield this.updateRowCellGroupsAsync(),yield this.progress()):this.currentCol<this.totalCol?(yield this.createCol(),yield this.progress()):this.currentRow<this.totalRow&&(yield this.createRow(),yield this.progress()),(0,eh.pu)(this.table),this.table.scenegraph.updateNextFrame(),t())}),16)})})}createRow(){return es(this,void 0,void 0,function*(){this.taskRowCount&&this.createRowCellGroup(this.taskRowCount)})}createCol(){return es(this,void 0,void 0,function*(){this.taskColCount&&this.createColGroup(this.taskRowCount)})}createRowCellGroup(t){let e=Math.min(this.totalRow,this.currentRow+t);if("adaptive"!==this.table.heightMode&&(0,w.Y)(this.table,this.currentRow+1,e,!1),this.rowEnd=e,this.table.frozenColCount){let t=0;for(let o=0;o<this.table.frozenColCount;o++){let l=this.table.scenegraph.getColGroup(o),{height:r}=(this.table.isListTable(),tX(l,o,l.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table));t=Math.max(t,r),this.table.scenegraph.rowHeaderGroup.setAttribute("height",t)}}if(this.table.rightFrozenColCount){let t=0;for(let o=this.table.colCount-this.table.rightFrozenColCount;o<this.table.colCount;o++){let l=this.table.scenegraph.getColGroup(o),{height:r}=(this.table.isPivotChart(),tX(l,o,l.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table));t=Math.max(t,r),this.table.scenegraph.rightFrozenGroup.setAttribute("height",t)}}let o=0;for(let t=this.bodyLeftCol;t<=this.bodyRightCol;t++){let l=this.table.scenegraph.getColGroup(t);if(!l)continue;this.table.rowHeaderLevelCount;let{height:r}=tX(l,t,l.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table);o=Math.max(o,r)}this.table.scenegraph.bodyGroup.setAttribute("height",o),this.currentRow=e,this.rowUpdatePos=this.rowEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}createColGroup(t){let e=Math.min(this.totalCol,this.currentCol+t);"adaptive"!==this.table.widthMode&&(0,tU.rj)(this.table,this.currentCol+1,e),this.colEnd=e;for(let t=0;t<this.table.rowCount;t++){let e=this.highPerformanceGetCell(this.currentCol,t);"cell"===e.role&&(0,t$.Z)(e.mergeStartCol)&&e.mergeStartCol>this.currentCol&&this.table.scenegraph.updateCellContent(e.col,e.row)}if(this.table.frozenRowCount){let t=this.table.scenegraph.colHeaderGroup.lastChild instanceof tV.Z?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev,o=t.attribute.x+t.attribute.width,l=t.attribute.y;tQ(this.table.scenegraph.colHeaderGroup,o,l,this.currentCol+1,e,0,this.table.frozenRowCount-1,"columnHeader",this.table)}if(this.table.bottomFrozenRowCount){let t=this.table.scenegraph.bottomFrozenGroup.lastChild instanceof tV.Z?this.table.scenegraph.bottomFrozenGroup.lastChild:this.table.scenegraph.bottomFrozenGroup.lastChild._prev,o=t.attribute.x+t.attribute.width,l=t.attribute.y;tQ(this.table.scenegraph.bottomFrozenGroup,o,l,this.currentCol+1,e,this.table.rowCount-this.table.bottomFrozenRowCount,this.table.rowCount-1,"columnHeader",this.table)}let o=this.table.scenegraph.bodyGroup.lastChild&&(this.table.scenegraph.bodyGroup.lastChild instanceof tV.Z?this.table.scenegraph.bodyGroup.lastChild:this.table.scenegraph.bodyGroup.lastChild._prev);o||(o=this.table.scenegraph.colHeaderGroup.lastChild&&(this.table.scenegraph.colHeaderGroup.lastChild instanceof tV.Z?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev));let l=o.attribute.x+o.attribute.width,r=o.attribute.y;tQ(this.table.scenegraph.bodyGroup,l,r,this.currentCol+1,e,this.rowStart,this.rowEnd,"body",this.table),this.currentCol=e,this.colUpdatePos=this.colEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}setY(t,e=!1){return es(this,void 0,void 0,function*(){let o=this.table.getRowsHeight(this.bodyTopRow,this.bodyTopRow+(this.rowEnd-this.rowStart+1))/2,l=this.table.getAllRowsHeight()-o,r=this.table.getTargetRowAt(t+this.table.scenegraph.colHeaderGroup.attribute.height);r&&(this.screenTopRow=r.row),t<o&&this.rowStart===this.bodyTopRow||t>l&&this.rowEnd===this.bodyBottomRow?(this.updateDeltaY(t),this.updateBody(t-this.deltaY)):this.table.scenegraph.bodyGroup.firstChild&&"group"===this.table.scenegraph.bodyGroup.firstChild.type&&0!==this.table.scenegraph.bodyGroup.firstChild.childrenCount||this.table.scenegraph.rowHeaderGroup.firstChild&&"group"===this.table.scenegraph.rowHeaderGroup.firstChild.type&&0!==this.table.scenegraph.rowHeaderGroup.firstChild.childrenCount?this.dynamicSetY(t,r,e):(this.updateDeltaY(t),this.updateBody(t-this.deltaY))})}setX(t,e=!1){return es(this,void 0,void 0,function*(){let o=this.table.getColsWidth(this.bodyLeftCol,this.bodyLeftCol+(this.colEnd-this.colStart+1))/2,l=this.table.getAllColsWidth()-o,r=this.table.getTargetColAt(t+this.table.scenegraph.rowHeaderGroup.attribute.width);r&&(this.screenLeftCol=r.col),t<o&&this.colStart===this.bodyLeftCol||t>l&&this.colEnd===this.bodyRightCol||this.table.scenegraph.bodyGroup.firstChild&&"group"===this.table.scenegraph.bodyGroup.firstChild.type&&0===this.table.scenegraph.bodyGroup.firstChild.childrenCount?(this.updateDeltaX(t),this.table.scenegraph.setBodyAndColHeaderX(-t+this.deltaX)):this.dynamicSetX(t,r,e)})}dynamicSetY(t,e,o=!1){return es(this,void 0,void 0,function*(){!function(t,e,o,l){el(this,void 0,void 0,function*(){var r,i,n,a,h;if(!e)return;let s=e.row,u=e.top;if(r=o?l.bodyBottomRow-l.rowEnd:s-l.referenceRow,i=s,n=u,a=t,h=l,r>0?er(r,"up",i,n,a,h):r<0&&er(-r,"down",i,n,a,h),h.updateDeltaY(a,n,i),h.updateBody(a-h.deltaY),o){let e=l.table.scenegraph.highPerformanceGetCell(l.colStart,l.rowEnd,!0);if("cell"===e.role){let o=e.attribute.y+e.attribute.height-(l.table.tableNoFrameHeight-l.table.getFrozenRowsHeight()-l.table.getBottomFrozenRowsHeight())-t;l.deltaY=-o,l.updateBody(t-l.deltaY)}}})}(t,e,o,this)})}dynamicSetX(t,e,o=!1){return es(this,void 0,void 0,function*(){!function(t,e,o,l){t5(this,void 0,void 0,function*(){var r,i,n,a,h;if(!e)return;let s=e.col,u=e.left;if(r=o?l.bodyRightCol-l.colEnd:l.screenLeftCol-l.referenceCol,i=s,n=u,a=t,h=l,r>0?t4(r,"left",h.screenLeftCol,n,a,h):r<0&&t4(-r,"right",h.screenLeftCol,n,a,h),h.updateDeltaX(a,n,i),h.table.scenegraph.setBodyAndColHeaderX(-a+h.deltaX),o){let e=l.table.scenegraph.getColGroup(l.colEnd);if(e){let o=e.attribute.x+e.attribute.width-(l.table.tableNoFrameWidth-l.table.getFrozenColsWidth()-l.table.getRightFrozenColsWidth())-t;l.deltaX=-o,l.table.scenegraph.setBodyAndColHeaderX(-t+l.deltaX)}}l.table.scenegraph.updateNextFrame()})}(t,e,o,this)})}updateBody(t){this.table.scenegraph.setBodyAndRowHeaderY(-t)}updateRowCellGroupsAsync(){return es(this,void 0,void 0,function*(){this.updateCellGroups(this.taskRowCount)})}updateCellGroups(t){let e=Math.min(this.bodyBottomRow,this.rowUpdatePos+t);this.table.isAutoRowHeight(this.rowUpdatePos)&&(0,w.Y)(this.table,this.rowUpdatePos,e,!1),en(this.rowUpdatePos,e,this),this.table.isAutoRowHeight(this.rowUpdatePos)&&(ee(this.bodyLeftCol,this.bodyRightCol,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0),ee(0,this.table.frozenColCount-1,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0),ee(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0)),this.rowUpdatePos=e+1}updateBottomFrozenCellGroups(){let t=this.table.rowCount-this.table.bottomFrozenRowCount,e=this.table.rowCount-1;this.table.isAutoRowHeight(t)&&(0,w.Y)(this.table,t,e,!1),en(t,e,this),this.table.isAutoRowHeight(t)&&(ee(this.bodyLeftCol,this.bodyRightCol,t,e,this.table,this.rowUpdateDirection),ee(0,this.table.frozenColCount-1,t,e,this.table,this.rowUpdateDirection),ee(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,t,e,this.table,this.rowUpdateDirection))}updateRightFrozenCellGroups(){let t=this.table.colCount-this.table.rightFrozenColCount,e=this.table.colCount-1;"autoWidth"===this.table.widthMode&&(0,tU.rj)(this.table,t,e,!1),t9(t,e,this),this.table.isAutoRowHeight(this.rowStart)&&t2(t,e,this.table,this.colUpdateDirection)}updateColCellGroupsAsync(){return es(this,void 0,void 0,function*(){this.updateColGroups(this.taskRowCount)})}updateColGroups(t){let e=Math.min(this.bodyRightCol,this.colUpdatePos+t);"autoWidth"===this.table.widthMode&&(0,tU.rj)(this.table,this.colUpdatePos,e),t9(this.colUpdatePos,e,this),this.colUpdatePos=e+1}updateCellGroupPosition(t,e,o){t.row=e,t.mergeStartCol=void 0,t.mergeStartRow=void 0,t.mergeEndCol=void 0,t.mergeEndRow=void 0,t.setAttribute("y",o),t.needUpdate=!0,t.needUpdateForAutoRowHeight=!0}updateCellGroupContent(t){if(!t.needUpdate||"cell"!==t.role)return t;let e=this.table.scenegraph.updateCellContent(t.col,t.row);return t.needUpdate=!1,e||t}sortCellVertical(){return es(this,void 0,void 0,function*(){yield function(t){var e,o,l,r,i;return o=this,l=void 0,r=void 0,i=function*(){let o,l;t.table.scenegraph.bodyGroup.forEachChildren((t,e)=>{"group"===t.type&&(t.needUpdate=!0,null==t||t.forEachChildren(t=>{t.needUpdate=!0}))}),t.table.isAutoRowHeight(t.rowStart)?(o=t.rowStart,l=t.rowEnd):(o=Math.max(t.bodyTopRow,t.screenTopRow-t.screenRowCount),l=Math.min(t.bodyBottomRow,t.screenTopRow+2*t.screenRowCount,t.table.rowCount-1));let r=t.table.getAllRowsHeight();(0,w.Y)(t.table,o,l);let i=t.table.getAllRowsHeight();r!==i&&t.table.scenegraph.updateContainerHeight(t.table.frozenRowCount,i-r);for(let o=0;o<(null!=(e=t.table.frozenColCount)?e:0);o++){let e=t.table.scenegraph.getColGroup(o);null==e||e.setAttribute("chartInstance",void 0);for(let e=t.rowStart;e<=t.rowEnd;e++)t.table.scenegraph.updateCellContent(o,e);for(let e=t.table.rowCount-t.table.bottomFrozenRowCount;e<t.table.rowCount;e++)t.table.scenegraph.updateCellContent(o,e)}for(let e=t.colStart;e<=t.colEnd;e++){let o=t.table.scenegraph.getColGroup(e);null==o||o.setAttribute("chartInstance",void 0);for(let o=t.table.rowCount-t.table.bottomFrozenRowCount;o<t.table.rowCount;o++)t.table.scenegraph.updateCellContent(e,o)}for(let e=t.table.colCount-t.table.rightFrozenColCount;e<t.table.colCount;e++){let o=t.table.scenegraph.getColGroup(e);null==o||o.setAttribute("chartInstance",void 0);for(let o=t.rowStart;o<=t.rowEnd;o++)t.table.scenegraph.updateCellContent(e,o);for(let o=t.table.rowCount-t.table.bottomFrozenRowCount;o<t.table.rowCount;o++)t.table.scenegraph.updateCellContent(e,o)}en(o,l,t),t.table.isAutoRowHeight(o)&&ee(t.bodyLeftCol,t.bodyRightCol,o,l,t.table,t.rowEnd>t.bodyBottomRow-(t.rowEnd-t.rowStart+1)?"down":"up"),t.rowUpdatePos=t.rowStart,t.rowUpdateDirection=t.rowEnd>t.bodyBottomRow-(t.rowEnd-t.rowStart+1)?"down":"up",t.table.scenegraph.updateNextFrame(),t.table.isAutoRowHeight(t.rowStart)||(yield t.progress())},new(r||(r=Promise))(function(t,e){function n(t){try{h(i.next(t))}catch(t){e(t)}}function a(t){try{h(i.throw(t))}catch(t){e(t)}}function h(e){var o;e.done?t(e.value):((o=e.value)instanceof r?o:new r(function(t){t(o)})).then(n,a)}h((i=i.apply(o,l||[])).next())})}(this)})}sortCellHorizontal(){return es(this,void 0,void 0,function*(){yield function(t){var e,o,l,r;return e=this,o=void 0,l=void 0,r=function*(){t.table.scenegraph.bodyGroup.forEachChildren((t,e)=>{"group"===t.type&&(t.needUpdate=!0,null==t||t.forEachChildren(t=>{t.needUpdate=!0}))});let e=Math.max(t.bodyLeftCol,t.screenLeftCol-t.screenColCount),o=Math.min(t.bodyRightCol,t.screenLeftCol+2*t.screenColCount);(0,tU.rj)(t.table,e,o);for(let e=t.colStart;e<=t.colEnd;e++){let o=t.table.scenegraph.getColGroup(e);null==o||o.setAttribute("chartInstance",void 0);for(let o=t.table.rowCount-t.table.bottomFrozenRowCount;o<t.table.rowCount;o++)t.table.scenegraph.updateCellContent(e,o)}for(let e=t.table.colCount-t.table.rightFrozenColCount;e<t.table.colCount;e++){let o=t.table.scenegraph.getColGroup(e);null==o||o.setAttribute("chartInstance",void 0);for(let o=t.rowStart;o<=t.rowEnd;o++)t.table.scenegraph.updateCellContent(e,o);for(let o=t.table.rowCount-t.table.bottomFrozenRowCount;o<t.table.rowCount;o++)t.table.scenegraph.updateCellContent(e,o)}t9(e,o,t),t.colUpdatePos=t.colStart,t.colUpdateDirection=t.colEnd>t.bodyRightCol-(t.colEnd-t.colStart+1)?"right":"left",t.table.scenegraph.updateNextFrame(),yield t.progress()},new(l||(l=Promise))(function(t,i){function n(t){try{h(r.next(t))}catch(t){i(t)}}function a(t){try{h(r.throw(t))}catch(t){i(t)}}function h(e){var o;e.done?t(e.value):((o=e.value)instanceof l?o:new l(function(t){t(o)})).then(n,a)}h((r=r.apply(e,o||[])).next())})}(this)})}highPerformanceGetCell(t,e,o){if(e>=this.table.frozenRowCount&&e<this.table.rowCount-this.table.bottomFrozenRowCount&&(e<this.rowStart||e>this.rowEnd)||t>=this.table.frozenColCount&&t<this.table.colCount-this.table.rightFrozenColCount&&(t<this.colStart||t>this.colEnd))return tJ.V;if(this.cellCache.get(t)){let l=this.cellCache.get(t);if((l._next||l._prev)&&Math.abs(l.row-e)<e){let r=function t(e,o){if(!e)return null;if(e.row===o)return e;let l=e._prev,r=e._next;return e.row>o&&l&&l.row===e.row-1?t(l,o):e.row<o&&r&&r.row===e.row+1?t(r,o):null}(l,e);return r&&(o||"shadow-cell"!==r.role)||(r=this.table.scenegraph.getCell(t,e,o)),r.row&&this.cellCache.set(t,r),r}let r=this.table.scenegraph.getCell(t,e,o);return r.col===t&&r.row&&this.cellCache.set(t,r),r}let l=this.table.scenegraph.getCell(t,e,o);return l.col===t&&l.row&&this.cellCache.set(t,l),l}updateDeltaY(t,e,o){if(this.rowStart===this.bodyTopRow){let t=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowStart,!0);if("cell"===t.role){let e=t.attribute.y;this.deltaY=-e}}else if(this.rowEnd===this.bodyBottomRow){let t=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowEnd,!0);if("cell"===t.role){let e=this.table.getRowHeight(this.rowEnd),o=t.attribute.y+e-(this.table.getAllRowsHeight()-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight());this.deltaY=-o}}else if((0,N.Z)(e)&&(0,N.Z)(o)){let l=this.table.scenegraph.highPerformanceGetCell(this.colStart,o,!0);"cell"!==l.role&&(l=this.table.scenegraph.highPerformanceGetCell(0,o,!0));let r=t-this.deltaY,i=e-r,n=l.attribute.y-r+this.table.getFrozenRowsHeight();this.deltaY=i-n}}updateDeltaX(t,e,o){if(this.colStart===this.bodyLeftCol){let t=this.table.scenegraph.getColGroup(this.colStart);if(t){let e=t.attribute.x;this.deltaX=-e}}else if(this.colEnd===this.bodyRightCol){let t=this.table.scenegraph.getColGroup(this.colEnd);if(t){let e=t.attribute.x+t.attribute.width-(this.table.getAllColsWidth()-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth());this.deltaX=-e}}else if((0,N.Z)(e)&&(0,N.Z)(o)){let l=this.table.scenegraph.getColGroup(o)||this.table.scenegraph.getColGroup(o,!0),r=t-this.deltaX,i=e-r,n=l.attribute.x-r+this.table.getFrozenColsWidth();this.deltaX=i-n}}release(){this.isRelease=!0}}var ed=o(300434),ec=o(540321);function eg(t){t.selectingRangeComponents.forEach((e,o)=>{var l;t.selectedRangeComponents.get(o)&&(t.selectingRangeComponents.get(o).rect.delete(),null==(l=t.selectingRangeComponents.get(o).fillhandle)||l.delete()),t.selectedRangeComponents.set(o,e)}),t.selectingRangeComponents=new Map,t.updateNextFrame()}var eb=o(636989),ep=o(75665);function eC(t,e){for(let o=0;o<e.table.colCount;o++){let l=new tV.Z({x:0,y:0,width:e.table.getColWidth(o),height:e.table.getRowHeight(t)});if(l.role="cell",l.col=o,l.row=t,l.needUpdate=!0,!l)continue;let r=e.getColGroup(o);if(r)if(r.firstChild&&t<r.firstChild.row)r.insertBefore(l,r.firstChild),r.firstChild.row=r.firstChild.row+1;else if(r.lastChild&&t>r.lastChild.row)r.appendChild(l);else{let i=e.highPerformanceGetCell(o,t,!0);i!==l&&(r.insertBefore(l,i),i&&(i.row=i.row+1),i!==r.lastChild&&r.lastChild&&(r.lastChild.row=r.lastChild.row+1))}}}function ef(t,e){for(let o=0;o<e.table.colCount;o++){let l,r=e.getColGroup(o,!1);r&&(r.forEachChildren(e=>e.row===t&&(l=e,!0)),l&&(r.updateColumnHeight(-l.attribute.height),r.removeChild(l)))}}function ew(t,e,o){let l;for(let r=0;r<o.table.colCount;r++){let i,n=o.table.getCellRange(r,t);n.start.row<=t+1&&n.end.row>=t+1&&(ey(n,o),i=n.start.row);let a=o.table.getCellRange(r,e);a.start.row<=e+1&&a.end.row>=e+1&&(ey(a,o),i=a.start.row),(0,N.Z)(i)&&(l=(0,N.Z)(l)?Math.min(l,i):i)}return l}function em(t,e,o){let l;for(let r=0;r<o.table.colCount;r++){let i,n=o.highPerformanceGetCell(r,t);n.mergeStartRow&&n.mergeEndRow&&n.mergeEndRow>t&&(ey({start:{row:n.mergeStartRow,col:o.table.isAutoRowHeight(e)?0:n.mergeStartCol},end:{row:n.mergeEndRow,col:o.table.isAutoRowHeight(e)?o.table.colCount-1:n.mergeEndCol}},o),i=n.mergeStartRow);let a=o.highPerformanceGetCell(r,e);a.mergeStartRow&&a.mergeEndRow&&a.mergeStartRow<e&&(ey({start:{row:a.mergeStartRow,col:o.table.isAutoRowHeight(e)?0:a.mergeStartCol},end:{row:a.mergeEndRow,col:o.table.isAutoRowHeight(e)?o.table.colCount-1:a.mergeEndCol}},o),i=a.mergeStartRow),(0,N.Z)(i)&&(l=(0,N.Z)(l)?Math.min(l,i):i)}return l}function ey(t,e){let{start:o,end:l}=t;for(let t=o.col;t<=l.col;t++)for(let r=o.row;r<=l.row;r++){let o=e.highPerformanceGetCell(t,r,!0);o&&(o.needUpdate=!0)}}var ev=o(289761);function ex(t){let e=t.bodyGroup.firstChild instanceof tV.Z?t.bodyGroup.firstChild:null;e&&(t.rowHeaderGroup.appendChild(e),t.rowHeaderGroup.setAttribute("width",t.rowHeaderGroup.attribute.width+e.attribute.width),t.bodyGroup.setAttribute("width",t.bodyGroup.attribute.width-e.attribute.width))}function eR(t){let e=t.colHeaderGroup.firstChild instanceof tV.Z?t.colHeaderGroup.firstChild:null;e&&(t.cornerHeaderGroup.appendChild(e),t.cornerHeaderGroup.setAttribute("width",t.cornerHeaderGroup.attribute.width+e.attribute.width),t.colHeaderGroup.setAttribute("width",t.colHeaderGroup.attribute.width-e.attribute.width))}function eA(t){var e;let o=t.rowHeaderGroup.lastChild instanceof tV.Z?t.rowHeaderGroup.lastChild:null==(e=t.rowHeaderGroup.lastChild)?void 0:e._prev;o&&(ez(t.bodyGroup,o,t.bodyGroup.firstChild),t.bodyGroup.setAttribute("width",t.bodyGroup.attribute.width+o.attribute.width),t.rowHeaderGroup.setAttribute("width",t.rowHeaderGroup.attribute.width-o.attribute.width))}function eH(t){var e;let o=t.cornerHeaderGroup.lastChild instanceof tV.Z?t.cornerHeaderGroup.lastChild:null==(e=t.cornerHeaderGroup.lastChild)?void 0:e._prev;o&&(ez(t.colHeaderGroup,o,t.colHeaderGroup.firstChild),t.colHeaderGroup.setAttribute("width",t.colHeaderGroup.attribute.width+o.attribute.width),t.cornerHeaderGroup.setAttribute("width",t.cornerHeaderGroup.attribute.width-o.attribute.width))}function eG(t){let e=t.bottomFrozenGroup.firstChild instanceof tV.Z?t.bottomFrozenGroup.firstChild:null;e&&(t.leftBottomCornerGroup.appendChild(e),t.leftBottomCornerGroup.setAttribute("width",t.leftBottomCornerGroup.attribute.width+e.attribute.width),t.bottomFrozenGroup.setAttribute("width",t.bottomFrozenGroup.attribute.width-e.attribute.width),t.table.isPivotChart()&&e.forEachChildren(t=>{t.setAttributes({stroke:!1,fill:!1})}))}function eS(t){var e;let o=t.leftBottomCornerGroup.lastChild instanceof tV.Z?t.leftBottomCornerGroup.lastChild:null==(e=t.leftBottomCornerGroup.lastChild)?void 0:e._prev;o&&(ez(t.bottomFrozenGroup,o,t.bottomFrozenGroup.firstChild),t.bottomFrozenGroup.setAttribute("width",t.bottomFrozenGroup.attribute.width+o.attribute.width),t.leftBottomCornerGroup.setAttribute("width",t.leftBottomCornerGroup.attribute.width-o.attribute.width),t.table.isPivotChart()&&o.forEachChildren(e=>{var o,l,r,i;let n=t.table._getCellStyle(e.col,e.row),a=t.table.getCellRange(e.col,e.row),h=(0,u.RT)(n,t.table,a?a.start.col:e.col,a?a.start.row:e.row,b.WJ).theme;e.setAttributes({fill:null!=(l=null==(o=null==h?void 0:h.group)?void 0:o.fill)?l:void 0,stroke:null!=(i=null==(r=null==h?void 0:h.group)?void 0:r.stroke)?i:void 0})}))}function ez(t,e,o){e&&t&&(o?t.insertBefore(e,o):t.appendChild(e))}function eB(t){return t instanceof tV.Z&&"table-border-rect"!==(null==t?void 0:t.name)}var eF=o(957426);function eM(t,e,o){return new tV.Z({x:0,y:0,width:t,height:e,clip:null!=o&&o,pickable:!1})}var eW=o(350621),ek=o(570469);function eP(t,e,o,l,r){let i=t.name;eL(o,l,t=>t.name===i,t=>{(0,f.Bg)(e,t),t.name=e.name},r),r.updateNextFrame()}function e_(t,e,o){t&&"empty"!==t.role&&t.forEachChildren(t=>{"group"===t.type?e_(t,e,o):e(t)&&o(t)})}function eL(t,e,o,l,r){let i=r.getCell(t,e);if("cell"===i.role&&(0,N.Z)(i.mergeStartCol)&&(0,N.Z)(i.mergeStartRow)&&(0,N.Z)(i.mergeEndCol)&&(0,N.Z)(i.mergeEndRow)){let{colStart:t,colEnd:e,rowStart:n,rowEnd:a}=(0,m.e)(i,r);for(let i=t;i<=e;i++)for(let t=n;t<=a;t++)e_(r.highPerformanceGetCell(i,t),o,l)}else e_(i,o,l)}var eT=o(974882),eE=o(485920);function eI(t){let e=[];for(let o=0;o<t.length;o++)-1===e.indexOf(t[o])&&e.push(t[o]);return e}function eD(t){let e=t.bodyColStart;function o(o){o.col=e;let l=(0,h.Z)(t.table,o.col,o.row);l&&(o.mergeStartCol=l.start.col,o.mergeStartCol=l.start.col,o.mergeEndCol=l.end.col,o.mergeEndCol=l.end.col),o.role}t.bodyGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{o(t)}),e++}),e=t.bodyColStart,t.colHeaderGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{o(t)}),e++}),e=t.bodyColStart,t.bottomFrozenGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{o(t)}),e++})}function eN(t,e){if(e.colHeaderGroup&&e.table.columnHeaderLevelCount>0){let l=new tV.Z({x:0,y:0,width:e.table.getColWidth(t),height:0,clip:!1,pickable:!1});l.role="column",l.col=t;let r=e.getColGroup(t,!0);r?e.colHeaderGroup.insertBefore(l,r):e.colHeaderGroup.appendChild(l),o(l,t,0,e.table.columnHeaderLevelCount-1)}if(e.bodyGroup){let l=new tV.Z({x:0,y:0,width:e.table.getColWidth(t),height:0,clip:!1,pickable:!1});l.role="column",l.col=t;let r=e.getColGroup(t,!1);r?e.bodyGroup.insertBefore(l,r):e.bodyGroup.appendChild(l),o(l,t,e.bodyRowStart,e.bodyRowEnd)}if(e.bottomFrozenGroup&&e.table.bottomFrozenRowCount>0){let l=new tV.Z({x:0,y:0,width:e.table.getColWidth(t),height:0,clip:!1,pickable:!1});l.role="column",l.col=t;let r=e.getColGroupInBottom(t);r?e.bottomFrozenGroup.insertBefore(l,r):e.bottomFrozenGroup.appendChild(l),o(l,t,e.table.rowCount-e.table.bottomFrozenRowCount,e.table.rowCount-1)}function o(t,o,l,r){for(let i=l;i<=r;i++){let l=new tV.Z({x:0,y:0,width:e.table.getColWidth(o),height:e.table.getRowHeight(i)});l.role="cell",l.col=o,l.row=i,l.needUpdate=!0,t.appendChild(l)}}}var eZ=o(657198),eO=o(170559);(0,l.sTO)(),r.n.load(tO),r.n.load(tD.ZP);class e${constructor(t){let e,o;this._needUpdateContainer=!1,this.table=t,this.hasFrozen=!1,this.clear=!0,this.mergeMap=new Map,(0,ek.C)(this.table.theme.textPopTipStyle),"node"===eT.X.mode?(i.rF.setEnv("node",t.options.modeParams),e=t.canvasWidth,o=t.canvasHeight):t.options.canvas&&t.options.viewBox?(i.rF.setEnv("browser"),e=t.options.viewBox.x2-t.options.viewBox.x1,o=t.options.viewBox.y2-t.options.viewBox.y1):(i.rF.setEnv("browser"),e=t.canvas.width,o=t.canvas.height),this.stage=(0,n.H)(Object.assign({canvas:t.canvas,width:e,height:o,disableDirtyBounds:!1,background:t.theme.underlayBackgroundColor,dpr:t.internalProps.pixelRatio,enableLayout:!0,beforeRender:t=>{this.table.options.beforeRender&&this.table.options.beforeRender(t),this.table.animationManager.ticker.start()},afterRender:t=>{this.table.options.afterRender&&this.table.options.afterRender(t),this.table.fireListeners("after_render",null)},canvasControled:!t.options.canvas,viewBox:t.options.viewBox},t.options.renderOption)),this.stage.defaultLayer.setTheme({group:{boundsPadding:0,strokeBoundsBuffer:0,lineJoin:"round"},text:{ignoreBuf:!0}}),this.initSceneGraph(),this.stage.defaultLayer.add(this.tableGroup),this.stage.table=this.table,this.createComponent()}get width(){var t,e;return null!=(e=null==(t=this.tableGroup.attribute)?void 0:t.width)?e:0}get height(){var t,e;return null!=(e=null==(t=this.tableGroup.attribute)?void 0:t.height)?e:0}get x(){var t,e;return null!=(e=null==(t=this.tableGroup.attribute)?void 0:t.x)?e:0}get y(){var t,e;return null!=(e=null==(t=this.tableGroup.attribute)?void 0:t.y)?e:0}get bodyRowStart(){var t;return null!=(t=this.proxy.rowStart)?t:0}get bodyRowEnd(){var t;return null!=(t=this.proxy.rowEnd)?t:this.table.rowCount-1}get bodyColStart(){var t;return null!=(t=this.proxy.colStart)?t:0}get bodyColEnd(){var t;return null!=(t=this.proxy.colEnd)?t:this.table.colCount-1}initSceneGraph(){this.isPivot=this.table.isPivotTable(),function(t){let e=t.table.tableNoFrameWidth,o=t.table.tableNoFrameHeight;t.tableGroup=new tV.Z({x:0,y:0,width:e,height:o,clip:!0,pickable:!1}),t.tableGroup.role="table";let l=eM(0,0,!t.table.internalProps.enableTreeStickCell);l.role="col-header",t.colHeaderGroup=l;let r=eM(0,0,!t.table.options.enableTreeStickCell);r.role="corner-header",t.cornerHeaderGroup=r;let i=eM(0,0,!0);i.role="row-header",t.rowHeaderGroup=i;let n=eM(e,0,!0);n.role="body",t.bodyGroup=n;let a=eM(0,0,!0);a.role="right-frozen",t.rightFrozenGroup=a;let h=eM(0,0,!0);h.role="bottom-frozen",t.bottomFrozenGroup=h;let s=eM(0,0);s.role="component",t.componentGroup=s;let u=eM(0,0,!0);u.role="corner-right-top-header",t.rightTopCornerGroup=u;let d=eM(0,0,!0);d.role="corner-right-bottom-header",t.rightBottomCornerGroup=d;let c=eM(0,0,!0);c.role="corner-left-bottom-header",t.leftBottomCornerGroup=c,t.tableGroup.addChild(n),t.tableGroup.addChild(i),t.tableGroup.addChild(h),t.tableGroup.addChild(l),t.tableGroup.addChild(a),t.tableGroup.addChild(d),t.tableGroup.addChild(u),t.tableGroup.addChild(c),t.tableGroup.addChild(r),t.tableGroup.addChild(s)}(this)}canvasShowMenu(){this.stage.addEventListener("rightdown",t=>{let e=(0,eO.RJ)(t);e.eventArgs||(this.table.stateManager.triggerContextMenu(-1,-1,e.abstractPos.x,e.abstractPos.y),this.table.fireListeners(eZ.B.CONTEXTMENU_CANVAS,{event:t,x:e.abstractPos.x,y:e.abstractPos.y,col:-1,row:-1,target:void 0}))})}clearCells(){var t,e;this.table.animationManager.clear(),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.findPluginsByName("poptipForText").forEach(t=>{t.deactivate(this.stage.pluginService)}),this.clear=!0,this.hasFrozen=!1,this.mergeMap.clear(),this.colHeaderGroup.clear(),delete this.colHeaderGroup.border,this.rowHeaderGroup.clear(),delete this.rowHeaderGroup.border,this.cornerHeaderGroup.clear(),delete this.cornerHeaderGroup.border,this.bodyGroup.clear(),delete this.bodyGroup.border,this.bottomFrozenGroup.clear(),delete this.bottomFrozenGroup.border,this.rightFrozenGroup.clear(),delete this.rightFrozenGroup.border,this.rightTopCornerGroup.clear(),delete this.rightTopCornerGroup.border,this.rightBottomCornerGroup.clear(),delete this.rightBottomCornerGroup.border,this.leftBottomCornerGroup.clear(),delete this.leftBottomCornerGroup.border,this.colHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rowHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.cornerHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bodyGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bottomFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightTopCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.leftBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.rightBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:0,height:0}),this.tableGroup.border&&(this.tableGroup.parent.removeChild(this.tableGroup.border),delete this.tableGroup.border),null==(t=this.proxy)||t.release(),null==(e=this.table.reactCustomLayout)||e.clearCache()}updateStageBackground(){this.stage.background=this.table.theme.underlayBackgroundColor,this.stage.renderNextFrame()}createComponent(){this.component=new Z(this.table),this.component.addToGroup(this.componentGroup),this.selectedRangeComponents=new Map,this.selectingRangeComponents=new Map,this.customSelectedRangeComponents=new Map}updateComponent(){this.component.updateStyle()}createSceneGraph(t=!1){t||(this.table.rowHeightsMap.clear(),this.table.internalProps.layoutMap.clearCellRangeMap()),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.autoEnablePlugins.getContributions().forEach(t=>{"poptipForText"===t.name&&this.stage.pluginService.register(t)}),this.clear=!1,this.frozenColCount=this.table.frozenColCount,this.frozenRowCount=this.table.frozenRowCount,this.proxy=new eu(this.table),(0,O.CY)(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0,!0),this.table.isPivotChart()&&((0,eE.z)(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle||this.table.theme.cornerHeaderStyle||{}),(0,eE.z)(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle||this.table.theme.cornerHeaderStyle||{}),(0,eE.z)(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle||this.table.theme.cornerHeaderStyle||{})),this.proxy.createGroupForFirstScreen(this.cornerHeaderGroup,this.colHeaderGroup,this.rowHeaderGroup,this.rightFrozenGroup,this.bottomFrozenGroup,this.bodyGroup,0,0),this.afterScenegraphCreated()}renderSceneGraph(){this.stage.render()}getCell(t,e,o){var l,r,i,n,a,h;let s;if((s=this.table.rightFrozenColCount>0&&t>=this.table.colCount-this.table.rightFrozenColCount&&e<this.table.frozenRowCount?null==(l=this.rightTopCornerGroup.getColGroup(t))?void 0:l.getRowGroup(e):this.table.bottomFrozenRowCount>0&&e>=this.table.rowCount-this.table.bottomFrozenRowCount&&t<this.table.frozenColCount?null==(r=this.leftBottomCornerGroup.getColGroup(t))?void 0:r.getRowGroup(e):this.table.rightFrozenColCount>0&&this.table.bottomFrozenRowCount>0&&t>=this.table.colCount-this.table.rightFrozenColCount&&e>=this.table.rowCount-this.table.bottomFrozenRowCount?null==(i=this.rightBottomCornerGroup.getColGroup(t))?void 0:i.getRowGroup(e):this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?null==(n=this.rightFrozenGroup.getColGroup(t))?void 0:n.getRowGroup(e):this.table.bottomFrozenRowCount>0&&e>this.table.rowCount-1-this.table.bottomFrozenRowCount?null==(a=this.bottomFrozenGroup.getColGroup(t))?void 0:a.getRowGroup(e):null==(h=this.getColGroup(t,e<this.frozenRowCount))?void 0:h.getRowGroup(e))&&"shadow-cell"===s.role&&!o){let o=this.table.getCellRange(t,e);o.start.col===t&&o.start.row===e||(s=this.getCell(o.start.col,o.start.row))}return s||tJ.V}highPerformanceGetCell(t,e,o){return this.proxy.highPerformanceGetCell(t,e,o)}getColGroup(t,e=!1){return(t<this.frozenColCount&&e?this.cornerHeaderGroup.getColGroup(t):t<this.frozenColCount?this.rowHeaderGroup.getColGroup(t):e&&this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?this.rightTopCornerGroup.getColGroup(t):!e&&this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?this.rightFrozenGroup.getColGroup(t):e?this.colHeaderGroup.getColGroup(t):this.bodyGroup.getColGroup(t))||void 0}getColGroupInBottom(t,e=!1){var o;if(e){let e=null!=(o=this.getColGroupInLeftBottomCorner(t))?o:this.getColGroupInRightBottomCorner(t);if(e)return e}if(this.table.bottomFrozenRowCount>0)return this.bottomFrozenGroup.getColGroup(t)}getColGroupInLeftBottomCorner(t){if(this.table.bottomFrozenRowCount>0)return this.leftBottomCornerGroup.getColGroup(t)}getColGroupInRightTopCorner(t){if(this.table.rightFrozenColCount>0)return this.rightTopCornerGroup.getColGroup(t)}getColGroupInRightBottomCorner(t){if(this.table.rightFrozenColCount>0&&this.table.bottomFrozenRowCount>0)return this.rightBottomCornerGroup.getColGroup(t)}getCellSize(t,e){let o=this.getCell(t,e),l=(0,h.Z)(this.table,t,e),r=o.attribute.width,i=o.attribute.height;return l&&(r/=l.end.col-l.start.col+1,i/=l.end.row-l.start.row+1),{width:r,height:i}}updateNextFrame(){this.updateContainerSync(),this.resetAllSelectComponent(),this.stage.renderNextFrame()}resetAllSelectComponent(){var t,e,o,l;((null==(e=null==(t=this.table.stateManager.select)?void 0:t.ranges)?void 0:e.length)>0||(null==(l=null==(o=this.table.stateManager.select)?void 0:o.customSelectRanges)?void 0:l.length)>0)&&(0,ed.Iy)(this)}hideHoverIcon(t,e){-1!==t&&-1!==e&&(eL(t,e,t=>"mouseenter_cell"===t.attribute.visibleTime,t=>{t.setAttribute("opacity",0);let e=t.parent.getChildByName("icon-back");e&&e.setAttribute("visible",!1)},this),this.updateNextFrame())}showHoverIcon(t,e){-1!==t&&-1!==e&&(eL(t,e,t=>"mouseenter_cell"===t.attribute.visibleTime,t=>{t.setAttribute("opacity",1)},this),this.updateNextFrame())}hideClickIcon(t,e){-1!==t&&-1!==e&&(eL(t,e,t=>"click_cell"===t.attribute.visibleTime,t=>{t.setAttribute("opacity",0)},this),this.updateNextFrame())}showClickIcon(t,e){-1!==t&&-1!==e&&(eL(t,e,t=>"click_cell"===t.attribute.visibleTime,t=>{t.setAttribute("opacity",1)},this),this.updateNextFrame())}getIcon(t,e,o,l){let r;return this.getCell(t,e).forEachChildren(t=>{t.role&&t.role.startsWith("icon")&&t.containsPoint(o,l,tr.LZ.GLOBAL)&&(r=t)}),r}setIconHoverStyle(t,e,o,l){!function(t,e,o,l,r){var i,n;if((t.attribute.backgroundColor||t.attribute.hoverImage)&&eL(e,o,e=>e.name===t.name,t=>{var e,o,l,r,i,n,a,h;if(t.attribute.backgroundColor){let s=t.parent.getChildByName("icon-back");s?s.setAttributes({x:(null!=(e=t.attribute.x)?e:0)+(t.AABBBounds.width()-t.backgroundWidth)/2,y:(null!=(o=t.attribute.y)?o:0)+(t.AABBBounds.height()-t.backgroundHeight)/2,dx:null!=(l=t.attribute.dx)?l:0,dy:null!=(r=t.attribute.dy)?r:0,width:t.backgroundWidth,height:t.backgroundHeight,fill:t.attribute.backgroundColor,cornerRadius:5,visible:!0}):(s=(0,B.f)({x:(null!=(i=t.attribute.x)?i:0)+(t.AABBBounds.width()-t.backgroundWidth)/2,y:(null!=(n=t.attribute.y)?n:0)+(t.AABBBounds.height()-t.backgroundHeight)/2,dx:null!=(a=t.attribute.dx)?a:0,dy:null!=(h=t.attribute.dy)?h:0,width:t.backgroundWidth,height:t.backgroundHeight,fill:t.attribute.backgroundColor,cornerRadius:5,pickable:!1,visible:!0})).name="icon-back",t.parent.insertBefore(s,t)}t.attribute.hoverImage&&t.attribute.image!==t.attribute.hoverImage&&(t.image=t.attribute.hoverImage)},r),t.tooltip){let{x1:l,x2:a,y1:h,y2:s}=t.globalAABBBounds,u={content:t.tooltip.title,referencePosition:{rect:{left:l,right:a,top:h,bottom:s,width:t.globalAABBBounds.width(),height:t.globalAABBBounds.height()},placement:t.tooltip.placement},disappearDelay:t.tooltip.disappearDelay,style:Object.assign({},null==(i=r.table.internalProps.theme)?void 0:i.tooltipStyle,null==(n=t.tooltip)?void 0:n.style)};r.table.internalProps.tooltipHandler.isBinded(u)||r.table.showTooltip(e,o,u)}}(t,e,o,0,this)}updateSortIcon(t){let{col:e,row:o,iconMark:l,order:r,oldSortCol:i,oldSortRow:n,oldIconMark:a}=t;!function(t){let{col:e,row:o,iconMark:l,order:r,oldSortCol:i,oldSortRow:n,oldIconMark:a,scene:h}=t,s=h.table.internalProps.headerHelper.getSortIcon(r,h.table,e,o);if(l&&eP(l,s,e,o,h),!function(t,e,o,l,r){let i=r.getCellRange(t,e),n=r.getCellRange(o,l);return i.start.col===n.start.col&&i.start.row===n.start.row&&i.end.col===n.end.col&&i.end.row===n.end.row}(e,o,i,n,h.table)){let t=h.table.internalProps.headerHelper.getSortIcon("normal",h.table,i,n);a?eP(a,t,i,n,h):function(t,e,o,l){let r=l.getCell(t,e);if((0,N.Z)(r.mergeStartCol)&&(0,N.Z)(r.mergeStartRow)&&(0,N.Z)(r.mergeEndCol)&&(0,N.Z)(r.mergeEndRow))for(let t=r.mergeStartCol;t<=r.mergeEndCol;t++)for(let e=r.mergeStartRow;e<=r.mergeEndRow;e++){let r;l.getCell(t,e).forEachChildren(t=>"sort"===t.attribute.funcType&&(r=t,!0)),r&&((0,f.Bg)(o,r),r.name=o.name)}else{let t;(0,ep.yW)(r,"children",e=>"sort"===e.attribute.funcType&&(t=e,!0)),t&&((0,f.Bg)(o,t),t.name=o.name)}}(i,n,t,h)}}({col:e,row:o,iconMark:l,order:r,oldSortCol:i,oldSortRow:n,oldIconMark:a,scene:this})}updateFrozenIcon(t,e){var o=this;for(let t=0;t<o.table.colCount;t++)for(let e=0;e<o.table.columnHeaderLevelCount;e++)eL(t,e,t=>"frozen"===t.attribute.funcType,l=>{let r=o.table.internalProps.headerHelper.getFrozenIcon(t,e);(0,f.Bg)(r,l),l.name=r.name},o)}updateHierarchyIcon(t,e){let o;o=this.table.isHeader(t,e)?this.table.internalProps.headerHelper.getHierarchyIcon(t,e):this.table.internalProps.bodyHelper.getHierarchyIcon(t,e),eL(t,e,t=>t.attribute.funcType===a.cI.collapse||t.attribute.funcType===a.cI.expand,t=>{(0,f.Bg)(o,t),t.name=null==o?void 0:o.name},this)}setIconNormalStyle(t,e,o){(t.attribute.backgroundColor||t.attribute.hoverImage)&&eL(e,o,e=>e.name===t.name,t=>{let e=t.parent.getChildByName("icon-back");e&&e.setAttribute("visible",!1),t.attribute.hoverImage&&t.attribute.image!==t.attribute.originImage&&(t.image=t.attribute.originImage)},this)}residentHoverIcon(t,e){eL(t,e,t=>t.attribute.funcType===a.cI.dropDown,t=>{t.oldVisibleTime=t.attribute.visibleTime,t.setAttribute("visibleTime","always"),t.setAttribute("opacity",1)},this)}resetResidentHoverIcon(t,e){eL(t,e,t=>t.attribute.funcType===a.cI.dropDown,t=>{t.oldVisibleTime&&t.setAttribute("visibleTime",t.oldVisibleTime),t.setAttribute("opacity",+("always"===t.attribute.visibleTime))},this)}deactivateChart(t,e){var o,l,r;if(-1===t||-1===e)return;let i=this.getCell(t,e);if(null==(o=null==i?void 0:i.firstChild)?void 0:o.deactivate){let o=(null==i?void 0:i.firstChild).attribute.spec.type;null==(r=null==(l=null==i?void 0:i.firstChild)?void 0:l.deactivate)||r.call(l,this.table,this.table.options.chartDimensionLinkage?{releaseChartInstance:"scatter"===o?t!==this.table.stateManager.hover.cellPos.col&&e!==this.table.stateManager.hover.cellPos.row||this.table.stateManager.hover.cellPos.row<this.table.frozenRowCount||this.table.stateManager.hover.cellPos.row>this.table.rowCount-1-this.table.bottomFrozenRowCount||this.table.stateManager.hover.cellPos.col<this.table.frozenColCount||this.table.stateManager.hover.cellPos.col>this.table.colCount-1-this.table.rightFrozenColCount:this.table.options.indicatorsAsCol?e!==this.table.stateManager.hover.cellPos.row||this.table.stateManager.hover.cellPos.col<this.table.frozenColCount||this.table.stateManager.hover.cellPos.col>this.table.colCount-1-this.table.rightFrozenColCount:t!==this.table.stateManager.hover.cellPos.col||this.table.stateManager.hover.cellPos.row<this.table.frozenRowCount||this.table.stateManager.hover.cellPos.row>this.table.rowCount-1-this.table.bottomFrozenRowCount,releaseColumnChartInstance:t!==this.table.stateManager.hover.cellPos.col||this.table.stateManager.hover.cellPos.row<this.table.frozenRowCount||this.table.stateManager.hover.cellPos.row>this.table.rowCount-1-this.table.bottomFrozenRowCount,releaseRowChartInstance:e!==this.table.stateManager.hover.cellPos.row||this.table.stateManager.hover.cellPos.col<this.table.frozenColCount||this.table.stateManager.hover.cellPos.col>this.table.colCount-1-this.table.rightFrozenColCount}:void 0)}}activateChart(t,e){var o,l,r;if(-1===t||-1===e)return;let i=this.getCell(t,e);return null==(l=null==(o=null==i?void 0:i.firstChild)?void 0:o.activate)||l.call(o,this.table),null==(r=null==i?void 0:i.firstChild)?void 0:r.activeChartInstance}removeInteractionBorder(t,e){let o=this.getCell(t,e);o.setAttribute("highlightStroke",void 0),o.setAttribute("highlightStrokeArrayWidth",void 0),o.setAttribute("highlightStrokeArrayColor",void 0)}createCellSelectBorder(t,e,o,l,r,i,n){(0,ec.E)(this,t,e,o,l,r,i,n)}moveSelectingRangeComponentsToSelectedRangeComponents(){eg(this)}deleteLastSelectedRangeComponents(){(0,eb.q8)(this)}deleteAllSelectBorder(){(0,eb.gW)(this),(0,eb.$0)(this)}updateCellSelectBorder(t,e=!0){(0,ed.eo)(this,t,e)}removeFillHandleFromSelectComponents(){(0,eb.UC)(this)}recreateAllSelectRangeComponents(){(0,eb.gW)(this),this.table.stateManager.select.ranges.forEach(t=>{(0,ed.eo)(this,t),eg(this)})}updateColWidth(t,e,o,l){(function(t,e,o,l){l||t.table._setColWidth(e,t.table.getColWidth(e)+o,!0);let r=t.getColGroup(e,!0),i=t.getColGroupInRightTopCorner(e);r&&!i&&A(r,o,"col-corner",t),i&&A(i,o,"right-top",t);let n=t.getColGroup(e);n&&A(n,o,"row-body",t);let a=t.getColGroupInLeftBottomCorner(e);a&&A(a,o,"left-bottom",t);let h=t.getColGroupInBottom(e);h&&A(h,o,"bottom",t);let s=t.getColGroupInRightBottomCorner(e);s&&A(s,o,"right-bottom",t),e<t.frozenColCount?(t.cornerHeaderGroup.forEachChildrenSkipChild((t,l)=>{t.col>e&&t.setAttribute("x",t.attribute.x+o)}),t.rowHeaderGroup.forEachChildrenSkipChild((t,l)=>{t.col>e&&t.setAttribute("x",t.attribute.x+o)})):(t.colHeaderGroup.forEachChildrenSkipChild((t,l)=>{t.col>e&&t.setAttribute("x",t.attribute.x+o)}),t.bodyGroup.forEachChildrenSkipChild((t,l)=>{t.col>e&&t.setAttribute("x",t.attribute.x+o)})),a&&t.leftBottomCornerGroup.forEachChildrenSkipChild((t,l)=>{t.col>e&&t.setAttribute("x",t.attribute.x+o)}),h&&t.bottomFrozenGroup.forEachChildrenSkipChild((t,l)=>{t.col>e&&t.setAttribute("x",t.attribute.x+o)}),s&&t.rightBottomCornerGroup.forEachChildrenSkipChild((t,l)=>{t.col>e&&t.setAttribute("x",t.attribute.x+o)})})(this,t,Math.round(e),l),o||this.updateContainer({async:!0})}updateChartSizeForResizeColWidth(t){(0,eF.s9)(this,t)}updateChartSizeForResizeRowHeight(t){(0,eF.kl)(this,t)}updateChartState(t){this.table.isPivotChart()&&(0,eF.s8)(this,t)}updateCheckboxCellState(t,e,o){var l,r;if(this.table.transpose)null==(l=this.bodyGroup.children)||l.forEach(t=>{var l;null==(l=t.getChildAt(e))||l.getChildren().forEach(t=>{"checkbox"===t.name&&("indeterminate"===o?(t.setAttribute("indeterminate",!0),t.setAttribute("checked",void 0)):(t.setAttribute("indeterminate",void 0),t.setAttribute("checked",o))),"checkbox-content"===t.name&&("indeterminate"===o?(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",o)))})});else{let e=this.getColGroup(t);null==(r=null==e?void 0:e.children)||r.forEach(t=>{t.getChildren().find(t=>{"checkbox"===t.name&&("indeterminate"===o?(t.setAttribute("indeterminate",!0),t.setAttribute("checked",void 0)):(t.setAttribute("indeterminate",void 0),t.setAttribute("checked",o))),"checkbox-content"===t.name&&("indeterminate"===o?(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",o)))})})}}updateHeaderCheckboxCellState(t,e,o){var l,r;this.table.transpose?null==(l=this.rowHeaderGroup.children)||l.forEach(t=>{t.getChildAt(e).getChildren().forEach(t=>{"checkbox"===t.name&&("indeterminate"===o?(t.setAttribute("indeterminate",!0),t.setAttribute("checked",void 0)):(t.setAttribute("indeterminate",void 0),t.setAttribute("checked",o))),"checkbox-content"===t.name&&("indeterminate"===o?(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",o)))})}):null==(r=this.getColGroup(t,!0).children)||r.forEach(t=>{t.getChildren().find(t=>{"checkbox"===t.name&&("indeterminate"===o?(t.setAttribute("indeterminate",!0),t.setAttribute("checked",void 0)):(t.setAttribute("indeterminate",void 0),t.setAttribute("checked",o))),"checkbox-content"===t.name&&("indeterminate"===o?(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",o)))})})}updateAutoColWidth(t){this.table.internalProps._widthResizedColMap.delete(t);let e=this.table.getColWidth(t),o=(0,tU.al)(t,0,this.table.rowCount-1,this.table,!0);o!==e&&this.updateColWidth(t,o-e)}recalculateColWidths(){let t=this.table;"adaptive"===t.widthMode||t.autoFillWidth||t.internalProps.transpose?(0,tU.rj)(this.table,0,this.table.colCount-1,!0):(t._clearColRangeWidthsMap(),t.frozenColCount>0&&(0,tU.rj)(this.table,0,t.frozenColCount-1,!0),t.rightFrozenColCount>0&&(0,tU.rj)(this.table,t.rightFrozenColCount,t.colCount-1,!0),(0,tU.rj)(t,this.proxy.colStart,this.proxy.colEnd,!0))}recalculateRowHeights(){let t=this.table;t.internalProps.useOneRowHeightFillAll=!1,"adaptive"===t.heightMode||t.autoFillHeight?(0,w.Y)(this.table,0,this.table.rowCount-1,!0,!0):(t.frozenRowCount>0&&(0,w.Y)(this.table,0,t.frozenRowCount-1,!0,!0),t.bottomFrozenRowCount>0&&(0,w.Y)(this.table,t.bottomFrozenRowCount,t.rowCount-1,!0,!0),(0,w.Y)(t,this.proxy.rowStart,this.proxy.rowEnd,!0,!0))}resize(){var t,e;this.proxy.resize(),("adaptive"===this.table.widthMode||this.table.autoFillWidth)&&(0===this.table.internalProps._widthResizedColMap.size?this.recalculateColWidths():this.dealWidthMode()),"adaptive"===this.table.heightMode?0===this.table.internalProps._heightResizedRowMap.size?this.recalculateRowHeights():this.dealHeightMode():this.table.autoFillHeight&&this.dealHeightMode(),this.resetFrozen(),this.updateTableSize(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),("adaptive"===this.table.widthMode||"adaptive"===this.table.heightMode||this.table.autoFillWidth||this.table.autoFillHeight||(null==(t=this.table.containerFit)?void 0:t.width)||(null==(e=this.table.containerFit)?void 0:e.height))&&this.updateChartSizeForResizeColWidth(-1),this.proxy.progress(),this.updateNextFrame()}updateTableSize(){var t,e,o,l,r,i,n,a,h,s,u,d,c,g,b;let p=Math.max(this.colHeaderGroup.attribute.width,this.bodyGroup.attribute.width,this.bottomFrozenGroup.attribute.width,0)+Math.max(this.cornerHeaderGroup.attribute.width,this.rowHeaderGroup.attribute.width,this.leftBottomCornerGroup.attribute.width,0)+Math.max(this.rightTopCornerGroup.attribute.width,this.rightFrozenGroup.attribute.width,this.rightBottomCornerGroup.attribute.width,0),C=Math.max(this.colHeaderGroup.attribute.height,this.cornerHeaderGroup.attribute.height,this.rightTopCornerGroup.attribute.height,0)+Math.max(this.rowHeaderGroup.attribute.height,this.bodyGroup.attribute.height,this.rightFrozenGroup.attribute.height,0)+Math.max(this.leftBottomCornerGroup.attribute.height,this.bottomFrozenGroup.attribute.height,this.rightBottomCornerGroup.attribute.height,0),f=p,w=C;if(f=(null==(t=this.table.containerFit)?void 0:t.width)?this.table.tableNoFrameWidth:Math.min(this.table.tableNoFrameWidth,p),w=(null==(e=this.table.containerFit)?void 0:e.height)?this.table.tableNoFrameHeight:Math.min(this.table.tableNoFrameHeight,C),this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:f,height:w}),this.tableGroup.border){let t,e,p,C,f=null==(o=this.tableGroup.border)?void 0:o.attribute;(null==f?void 0:f.strokeArrayWidth)?(t=f.strokeArrayWidth?f.strokeArrayWidth[0]:null!=(l=f.lineWidth)?l:0,e=f.strokeArrayWidth?f.strokeArrayWidth[1]:null!=(r=f.lineWidth)?r:0,p=f.strokeArrayWidth?f.strokeArrayWidth[2]:null!=(i=f.lineWidth)?i:0,C=f.strokeArrayWidth?f.strokeArrayWidth[3]:null!=(n=f.lineWidth)?n:0):(t=null!=(a=null==f?void 0:f.lineWidth)?a:0,e=null!=(h=null==f?void 0:f.lineWidth)?h:0,p=null!=(s=null==f?void 0:f.lineWidth)?s:0,C=null!=(u=null==f?void 0:f.lineWidth)?u:0),"rect"===this.tableGroup.border.type?(null==(d=this.table.theme.frameStyle)?void 0:d.innerBorder)?this.tableGroup.border.setAttributes({x:this.table.tableX+C/2,y:this.table.tableY+t/2,width:this.tableGroup.attribute.width-C/2-e/2,height:this.tableGroup.attribute.height-t/2-p/2}):this.tableGroup.border.setAttributes({x:this.table.tableX-C/2,y:this.table.tableY-t/2,width:this.tableGroup.attribute.width+C/2+e/2,height:this.tableGroup.attribute.height+t/2+p/2}):"group"===this.tableGroup.border.type&&((null==(c=this.table.theme.frameStyle)?void 0:c.innerBorder)?(this.tableGroup.border.setAttributes({x:this.table.tableX+C/2,y:this.table.tableY+t/2,width:this.tableGroup.attribute.width-C/2-e/2,height:this.tableGroup.attribute.height-t/2-p/2}),null==(g=this.tableGroup.border.firstChild)||g.setAttributes({x:0,y:0,width:this.tableGroup.attribute.width-C/2-e/2,height:this.tableGroup.attribute.height-t/2-p/2})):(this.tableGroup.border.setAttributes({x:this.table.tableX-C/2,y:this.table.tableY-t/2,width:this.tableGroup.attribute.width+C/2+e/2,height:this.tableGroup.attribute.height+t/2+p/2}),null==(b=this.tableGroup.border.firstChild)||b.setAttributes({x:C/2,y:t/2,width:this.tableGroup.attribute.width,height:this.tableGroup.attribute.height})))}this.table.bottomFrozenRowCount>0&&(this.bottomFrozenGroup.setAttribute("y",this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight()),this.leftBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight(),width:this.table.getFrozenColsWidth()}),this.rightBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight()})),this.table.rightFrozenColCount>0&&(this.rightFrozenGroup.setAttribute("x",this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth()),this.rightTopCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth(),height:this.table.getFrozenRowsHeight()}),this.rightBottomCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth()})),this.updateDomContainer()}updateRowHeight(t,e,o){y(this,t,e=Math.round(e),o),this.updateContainerHeight(t,e)}updateRowsHeight(t,e,o){for(let l=0;l<t.length;l++){let r=t[l];if(r>=this.proxy.rowStart&&r<=this.proxy.rowEnd){let t=e[l];y(this,r,Math.round(t),o),this._updateContainerHeight(r,t)}}this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}updateContainerWidth(t,e){t<this.frozenColCount?(this.rowHeaderGroup.setDeltaWidth(e),this.cornerHeaderGroup.setDeltaWidth(e),this.colHeaderGroup.setDeltaX(e),this.bodyGroup.setDeltaX(e)):(this.colHeaderGroup.setDeltaWidth(e),this.bodyGroup.setDeltaWidth(e)),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}_updateContainerHeight(t,e){t<this.table.frozenRowCount?(this.colHeaderGroup.setDeltaHeight(e),this.cornerHeaderGroup.setDeltaHeight(e),this.rowHeaderGroup.setDeltaY(e),this.bodyGroup.setDeltaY(e),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaY(e)):t>=this.table.rowCount-this.table.bottomFrozenRowCount?(this.leftBottomCornerGroup.setDeltaHeight(e),this.bottomFrozenGroup.setDeltaHeight(e),this.table.rightFrozenColCount&&this.rightBottomCornerGroup.setDeltaHeight(e)):(this.rowHeaderGroup.setDeltaHeight(e),this.bodyGroup.setDeltaHeight(e),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaHeight(e))}updateContainerHeight(t,e){this._updateContainerHeight(t,e),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}setColWidth(t,e){let o=this.table.getColWidth(t);o!==e&&(this.updateColWidth(t,e-o),this.table._clearColRangeWidthsMap(t))}setRowHeight(t,e){let o=this.table.getRowHeight(t);o!==e&&((t>=this.proxy.rowStart&&t<=this.proxy.rowEnd||t>=this.table.rowCount-this.table.bottomFrozenRowCount&&t<=this.table.rowCount-1||t<this.table.frozenRowCount)&&this.updateRowHeight(t,e-o),this.table._clearRowRangeHeightsMap(t))}setX(t,e=!1){this.table.scenegraph.proxy.setX(-t,e)}setY(t,e=!1){this.table.scenegraph.proxy.setY(-t,e)}setBodyAndRowHeaderY(t){var e,o,l,r,i,n;let a=null!=(o=null==(e=this.bodyGroup.firstChild)?void 0:e.firstChild)?o:null==(l=this.rowHeaderGroup.firstChild)?void 0:l.firstChild,h=null!=(i=null==(r=this.bodyGroup.firstChild)?void 0:r.lastChild)?i:null==(n=this.rowHeaderGroup.firstChild)?void 0:n.lastChild;0===t&&a&&a.row===this.table.frozenRowCount&&a.attribute.y+t<0?t=-a.attribute.y:h&&this.table.tableNoFrameHeight<this.table.getAllRowsHeight()&&h.row===this.table.rowCount-this.table.bottomFrozenRowCount-1&&h.attribute.y+this.table.getRowHeight(h.row)+t<this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()&&(t=this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()-h.attribute.y-this.table.getRowHeight(h.row)),this.colHeaderGroup.attribute.height+t!==this.bodyGroup.attribute.y&&(this.bodyGroup.setAttribute("y",this.colHeaderGroup.attribute.height+t),this.rowHeaderGroup.setAttribute("y",this.cornerHeaderGroup.attribute.height+t),this.table.rightFrozenColCount>0&&this.rightFrozenGroup.setAttribute("y",this.rightTopCornerGroup.attribute.height+t),this.updateNextFrame())}setBodyAndColHeaderX(t){let e=this.bodyGroup.firstChild,o=this.bodyGroup.lastChild;0===t&&e&&e.col===this.table.frozenColCount&&e.attribute.x+t<0?t=-e.attribute.x:o&&this.table.tableNoFrameWidth<this.table.getAllColsWidth()&&o.col===this.table.colCount-this.table.rightFrozenColCount-1&&o.attribute.x+o.attribute.width+t<this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()&&(t=this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()-o.attribute.x-o.attribute.width),this.table.getFrozenColsWidth()+t!==this.bodyGroup.attribute.x&&(this.bodyGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.colHeaderGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.table.bottomFrozenRowCount>0&&this.bottomFrozenGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.updateNextFrame())}afterScenegraphCreated(){var t;this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount?this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):this.component.setFrozenColumnShadow(-1):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.table.stateManager.checkFrozen(),this.updateContainer(),this.createFrameBorder(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),(0,eh.pu)(this.table),this.table.options.animationAppear&&function(t){var e,o,l,r;let i,n,a,h;if(!t.options.animationAppear)return;!0===t.options.animationAppear?(i=500,n=0,a="one-by-one",h="column"):(i=null!=(e=t.options.animationAppear.duration)?e:500,n=null!=(o=t.options.animationAppear.delay)?o:0,a=null!=(l=t.options.animationAppear.type)?l:"one-by-one",h=null!=(r=t.options.animationAppear.direction)?r:"row");let{scenegraph:s,frozenColCount:u,frozenRowCount:d}=t,{colStart:c,colEnd:g,rowStart:b,rowEnd:p}=s.proxy;for(let t=0;t<=g;t++)for(let e=0;e<=p;e++){let o=s.highPerformanceGetCell(t,e);o&&"cell"===o.role&&o.forEachChildren(o=>{o.setAttribute("opacity",0),o.animate().wait("one-by-one"===a?("row"===h?e:t)*(i-n):n).to({opacity:1},i,"linear")})}}(this.table),!1===(null==(t=this.table.options.menu)?void 0:t.contextMenuWorkOnlyCell)&&this.canvasShowMenu(),this.updateNextFrame()}dealWidthMode(){let t=this.table;if("adaptive"===t.widthMode){t._clearColRangeWidthsMap();let e=t.tableNoFrameWidth,o=0,l=0,r=t.colCount;if("only-body"===t.widthAdaptiveMode){for(let e=0;e<t.colCount;e++)(e<t.rowHeaderLevelCount||t.isPivotChart()&&e>=t.colCount-t.rightFrozenColCount)&&(o+=t.getColWidth(e));l=t.rowHeaderLevelCount,r=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount}(0,tU.j8)(e-o,l,r,!1,[],t,!0)}else if(t.autoFillWidth){t._clearColRangeWidthsMap();let e=t.tableNoFrameWidth,o=0,l=0;for(let e=0;e<t.colCount;e++){let r=t.getColWidth(e);"only-body"===t.widthAdaptiveMode&&(e<t.rowHeaderLevelCount||t.isPivotChart()&&e>=t.colCount-t.rightFrozenColCount)&&(o+=r),l+=r}if(l<e&&l>o){let l=0,r=t.colCount;"only-body"===t.widthAdaptiveMode&&(l=t.rowHeaderLevelCount,r=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount),(0,tU.j8)(e-o,l,r,!1,[],t,!0)}}let e=0;this.bodyGroup.forEachChildrenSkipChild(t=>{e+=t.attribute.width}),this.bodyGroup.setAttribute("width",e);let o=0;this.colHeaderGroup.forEachChildrenSkipChild(t=>{o+=t.attribute.width}),this.colHeaderGroup.setAttribute("width",o);let l=0;this.rowHeaderGroup.forEachChildrenSkipChild(t=>{l+=t.attribute.width}),this.rowHeaderGroup.setAttribute("width",l);let r=0;this.cornerHeaderGroup.forEachChildrenSkipChild(t=>{r+=t.attribute.width}),this.cornerHeaderGroup.setAttribute("width",r),this.colHeaderGroup.setAttribute("x",this.cornerHeaderGroup.attribute.width),this.rowHeaderGroup.setAttribute("y",this.cornerHeaderGroup.attribute.height),this.bodyGroup.setAttributes({x:this.rowHeaderGroup.attribute.width,y:this.colHeaderGroup.attribute.height})}dealHeightMode(){var t;let e=this.table;if("adaptive"===e.heightMode){e._clearRowRangeHeightsMap();let t=e.getRowsHeight(0,e.columnHeaderLevelCount-1),o=e.isPivotChart()?e.getBottomFrozenRowsHeight():0,l=e.tableNoFrameHeight-t-o,r=e.columnHeaderLevelCount,i=e.isPivotChart()?e.rowCount-e.bottomFrozenRowCount:e.rowCount,n=0;for(let t=r;t<i;t++)n+=e.getRowHeight(t);let a=l/n;for(let t=r;t<i;t++){let o;o=t===i-1?l-e.getRowsHeight(r,i-2):Math.round(e.getRowHeight(t)*a),this.setRowHeight(t,o)}}else if(e.autoFillHeight){e._clearRowRangeHeightsMap();let o=e.tableNoFrameHeight,l=0,r=0;for(let t=0;t<e.rowCount;t++){let o=e.getRowHeight(t);(t<e.columnHeaderLevelCount||e.isPivotChart()&&t>=e.rowCount-e.bottomFrozenRowCount)&&(r+=o),l+=o}if((null!=(t=this._dealAutoFillHeightOriginRowsHeight)?t:l)<o&&l-r>0){let t=e.columnHeaderLevelCount,i=e.isPivotChart()?e.rowCount-e.bottomFrozenRowCount:e.rowCount,n=(o-r)/(l-r);for(let l=t;l<i;l++){let a;a=l===i-1?o-r-e.getRowsHeight(t,i-2):Math.round(e.getRowHeight(l)*n),this.setRowHeight(l,a)}}}}dealFrozen(){!function(t){var e,o,l,r;if(t.table.frozenColCount>t.table.rowHeaderLevelCount){t.rowHeaderGroup.setAttribute("height",t.bodyGroup.attribute.height),t.rowHeaderGroup.setAttribute("y",t.bodyGroup.attribute.y),t.cornerHeaderGroup.setAttribute("height",t.colHeaderGroup.attribute.height);for(let e=0;e<t.table.frozenColCount-t.table.rowHeaderLevelCount;e++)ex(t),eR(t),eG(t)}else if(t.table.frozenColCount<t.table.rowHeaderLevelCount){t.bodyGroup.setAttribute("height",t.rowHeaderGroup.attribute.height),t.bodyGroup.setAttribute("y",t.rowHeaderGroup.attribute.y),t.colHeaderGroup.setAttribute("height",t.cornerHeaderGroup.attribute.height);for(let e=0;e<t.table.rowHeaderLevelCount-t.table.frozenColCount;e++)eA(t),eH(t),eS(t)}t.bodyGroup.setAttribute("x",t.rowHeaderGroup.attribute.width),t.colHeaderGroup.setAttribute("x",t.cornerHeaderGroup.attribute.width),t.updateContainer(),t.updateBorderSizeAndPosition(),t.isPivot||t.table.transpose?t.table.options.frozenColCount?t.component.setFrozenColumnShadow(t.table.frozenColCount-1):t.table.options.frozenColCount&&t.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount):(t.component.setFrozenColumnShadow(t.table.frozenColCount-1),t.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount)),t.hasFrozen=!0,t.frozenColCount=t.table.frozenColCount,t.frozenRowCount=null!=(r=null!=(o=null==(e=t.colHeaderGroup.firstChild)?void 0:e.childrenCount)?o:null==(l=t.cornerHeaderGroup.firstChild)?void 0:l.childrenCount)?r:t.table.frozenRowCount}(this)}resetFrozen(){!function(t){var e,o,l,r,i,n;if(t.frozenColCount>t.table.frozenColCount){t.bodyGroup.setAttribute("height",t.rowHeaderGroup.attribute.height),t.bodyGroup.setAttribute("y",t.rowHeaderGroup.attribute.y),t.colHeaderGroup.setAttribute("height",t.cornerHeaderGroup.attribute.height);for(let e=0;e<t.frozenColCount-t.table.frozenColCount;e++)eA(t),eH(t),eS(t)}else if(t.frozenColCount<t.table.frozenColCount){t.rowHeaderGroup.setAttribute("height",t.bodyGroup.attribute.height),t.rowHeaderGroup.setAttribute("y",t.bodyGroup.attribute.y),t.cornerHeaderGroup.setAttribute("height",t.colHeaderGroup.attribute.height);for(let e=0;e<t.table.frozenColCount-t.frozenColCount;e++)ex(t),eR(t),eG(t)}(0,ev.F6)(t),t.recreateAllSelectRangeComponents(),t.frozenColCount=t.table.frozenColCount,t.frozenRowCount=null!=(r=null!=(o=null==(e=t.colHeaderGroup.firstChild)?void 0:e.childrenCount)?o:null==(l=t.cornerHeaderGroup.firstChild)?void 0:l.childrenCount)?r:t.table.frozenRowCount,t.proxy.colStart=null!=(n=null==(i=t.bodyGroup.firstChild)?void 0:i.col)?n:t.table.frozenColCount,t.bodyGroup.setAttribute("x",t.rowHeaderGroup.attribute.width),t.colHeaderGroup.setAttribute("x",t.cornerHeaderGroup.attribute.width),t.updateContainer(),t.updateBorderSizeAndPosition(),t.isPivot||t.table.transpose?t.table.options.frozenColCount?t.component.setFrozenColumnShadow(t.table.frozenColCount-1):t.table.options.rightFrozenColCount&&t.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount):(t.component.setFrozenColumnShadow(t.table.frozenColCount-1),t.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount)),t.hasFrozen=!0}(this)}resetRowFrozen(){!function(t){var e,o,l,r,i;if(t.frozenRowCount>t.table.frozenRowCount){t.bodyGroup.setAttribute("width",t.colHeaderGroup.attribute.width),t.bodyGroup.setAttribute("x",t.colHeaderGroup.attribute.x),t.rowHeaderGroup.setAttribute("width",t.cornerHeaderGroup.attribute.width);for(let e=0;e<t.frozenRowCount-t.table.frozenRowCount;e++)(function(t){let e=!1;for(let o=0;o<t.colHeaderGroup.childrenCount;o++){let l=t.colHeaderGroup.children[o];if(!eB(l))continue;let r=t.bodyGroup.children[o];if(!r)continue;let i=l.lastChild;ez(r,i,r.firstChild),e||(t.colHeaderGroup.setAttribute("height",t.colHeaderGroup.attribute.height-i.attribute.height),t.bodyGroup.setAttribute("height",t.bodyGroup.attribute.height+i.attribute.height),e=!0)}})(t),function(t){let e=!1;for(let o=0;o<t.cornerHeaderGroup.childrenCount;o++){let l=t.cornerHeaderGroup.children[o];if(!eB(l))continue;let r=t.rowHeaderGroup.children[o];if(!r)continue;let i=l.lastChild;ez(r,i,r.firstChild),e||(t.cornerHeaderGroup.setAttribute("height",t.cornerHeaderGroup.attribute.height-i.attribute.height),t.rowHeaderGroup.setAttribute("height",t.rowHeaderGroup.attribute.height+i.attribute.height),e=!0)}}(t),function(t){let e=!1;for(let o=0;o<t.rightTopCornerGroup.childrenCount;o++){let l=t.rightTopCornerGroup.children[o];if(!eB(l))continue;let r=t.rightFrozenGroup.children[o];if(!r)continue;let i=l.lastChild;ez(r,i,r.firstChild),e||(t.rightTopCornerGroup.setAttribute("height",t.rightTopCornerGroup.attribute.height-i.attribute.height),t.rightFrozenGroup.setAttribute("height",t.rightFrozenGroup.attribute.height+i.attribute.height),e=!0)}}(t)}else if(t.frozenRowCount<t.table.frozenRowCount){t.colHeaderGroup.setAttribute("width",t.bodyGroup.attribute.width),t.colHeaderGroup.setAttribute("x",t.bodyGroup.attribute.x),t.cornerHeaderGroup.setAttribute("width",t.rowHeaderGroup.attribute.width);for(let e=0;e<t.table.frozenRowCount-t.frozenRowCount;e++)(function(t){var e;let o=!1;for(let l=0;l<t.bodyGroup.childrenCount;l++){let r=t.bodyGroup.children[l];if(!eB(r))continue;let i=r.firstChild;t.colHeaderGroup.children[l]||tQ(t.colHeaderGroup,0,0,i.col,i.col,0,0,"columnHeader",t.table),null==(e=t.colHeaderGroup.children[l])||e.appendChild(i),o||(t.colHeaderGroup.setAttribute("height",t.colHeaderGroup.attribute.height+i.attribute.height),t.bodyGroup.setAttribute("height",t.bodyGroup.attribute.height-i.attribute.height),o=!0)}})(t),function(t){var e;let o=!1;for(let l=0;l<t.rowHeaderGroup.childrenCount;l++){let r=t.rowHeaderGroup.children[l];if(!eB(r))continue;let i=r.firstChild;t.cornerHeaderGroup.children[l]||tQ(t.cornerHeaderGroup,0,0,i.col,i.col,0,0,t.table.isListTable()?"columnHeader":"cornerHeader",t.table),null==(e=t.cornerHeaderGroup.children[l])||e.appendChild(i),o||(t.cornerHeaderGroup.setAttribute("height",t.cornerHeaderGroup.attribute.height+i.attribute.height),t.rowHeaderGroup.setAttribute("height",t.rowHeaderGroup.attribute.height-i.attribute.height),o=!0)}}(t),function(t){let e=!1;for(let o=0;o<t.rightFrozenGroup.childrenCount;o++){let l=t.rightFrozenGroup.children[o];if(!eB(l))continue;let r=l.firstChild;t.rightTopCornerGroup.children[o]||tQ(t.rightTopCornerGroup,0,0,r.col,r.col,0,0,"columnHeader",t.table),t.rightTopCornerGroup.children[o].appendChild(r),e||(t.rightTopCornerGroup.setAttribute("height",t.rightTopCornerGroup.attribute.height+r.attribute.height),t.rightFrozenGroup.setAttribute("height",t.rightFrozenGroup.attribute.height-r.attribute.height),e=!0)}}(t)}(0,ev.F6)(t),t.recreateAllSelectRangeComponents(),t.frozenRowCount=t.table.frozenRowCount,t.frozenColCount=null!=(o=null==(e=t.rowHeaderGroup)?void 0:e.childrenCount)?o:0,t.proxy.rowStart=null!=(i=null==(r=null==(l=t.bodyGroup.firstChild)?void 0:l.firstChild)?void 0:r.row)?i:t.table.frozenRowCount,t.bodyGroup.setAttribute("y",t.colHeaderGroup.attribute.height),t.rowHeaderGroup.setAttribute("y",t.cornerHeaderGroup.attribute.height),t.updateContainer({needUpdateCellY:!0}),t.updateBorderSizeAndPosition(),t.hasFrozen=!0}(this)}updateCellLayoutWidthCertainWidth(t,e,o){let l=t.attribute.width,r=!1;return t.forEachChildren((t,i)=>{i+=e;let n=(0,h.Z)(this.table,o,i);n?t=this.getCell(n.start.col,n.start.row):t.setAttribute("width",l);let a=this.table._getCellStyle(o,i),s=(0,C.u)((0,b.WJ)("padding",a,o,i,this.table)),u=t.getChildByName("text"),d=0,c=0;if(u)d=u.AABBBounds.height()+(s[0]+s[2]),u.setAttribute("maxLineWidth",l-(s[1]+s[3])),c=u.AABBBounds.height()+(s[0]+s[2]);else{let e=t.getChildAt(1);d=e.AABBBounds.height()+(s[0]+s[2]),e._cellWidth=l-(s[1]+s[3]),e.layout(),c=e.AABBBounds.height()+(s[0]+s[2])}let g=this.table.getRowHeight(i);t.attribute.height!==c&&(t.setAttribute("height",c),(g===d||c>g)&&(r=!0))}),r}updateHeaderPosition(t,e,o,l,r){!function(t,e,o,l,r,i){let n=i.scenegraph;for(let o=t;o<=e;o++){let t=i.getColWidth(o),e=i.scenegraph.getColGroup(o,!0),l=i.scenegraph.getColGroup(o),r=i.scenegraph.getColGroupInBottom(o),n=i.scenegraph.getColGroupInLeftBottomCorner(o),a=i.scenegraph.getColGroupInRightBottomCorner(o);e&&(e.setAttribute("width",t),e.forEachChildren(e=>{e.setAttribute("width",t)})),l&&(l.setAttribute("width",t),l.forEachChildren(e=>{e.setAttribute("width",t)})),r&&(r.setAttribute("width",t),r.forEachChildren(e=>{e.setAttribute("width",t)})),a&&(a.setAttribute("width",t),a.forEachChildren(e=>{e.setAttribute("width",t)})),n&&(n.setAttribute("width",t),n.forEachChildren(e=>{e.setAttribute("width",t)}))}if(n.updateContainer(),"column"===r)for(let o=t;o<=e;o++){let t=i.scenegraph.getColGroup(o);null==t||t.setAttribute("chartInstance",void 0);for(let t=0;t<=i.frozenRowCount-1;t++)n.updateCellContent(o,t);for(let t=n.bodyRowStart;t<=n.bodyRowEnd;t++)n.updateCellContent(o,t);for(let t=i.rowCount-i.bottomFrozenRowCount;t<=i.rowCount-1;t++)n.updateCellContent(o,t)}else{for(let t=0;t<=i.frozenColCount-1;t++){let e=i.scenegraph.getColGroup(t);null==e||e.setAttribute("chartInstance",void 0);for(let e=o;e<=l;e++)n.updateCellContent(t,e)}for(let t=n.bodyColStart;t<=n.bodyColEnd;t++){let e=i.scenegraph.getColGroup(t);null==e||e.setAttribute("chartInstance",void 0);for(let e=o;e<=l;e++)n.updateCellContent(t,e)}for(let t=i.colCount-i.rightFrozenColCount;t<=i.colCount-1;t++){let e=i.scenegraph.getColGroup(t);null==e||e.setAttribute("chartInstance",void 0);for(let e=o;e<=l;e++)n.updateCellContent(t,e)}}}(t,e,o,l,r,this.table)}updateContainerAttrWidthAndX(){var t,e,o;let l=(0,eW.T)(this.cornerHeaderGroup,0),r=(0,eW.T)(this.rowHeaderGroup,0),i=this.colHeaderGroup.hasChildNodes()&&this.colHeaderGroup.firstChild?(0,eW.T)(this.colHeaderGroup,this.colHeaderGroup.firstChild.col>0?this.table.getColsWidth(null!=(t=this.table.frozenColCount)?t:0,this.colHeaderGroup.firstChild.col-1):0):0,n=this.bodyGroup.hasChildNodes()&&this.bodyGroup.firstChild?(0,eW.T)(this.bodyGroup,this.bodyGroup.firstChild.col>0?this.table.getColsWidth(null!=(e=this.table.frozenColCount)?e:0,this.bodyGroup.firstChild.col-1):0):0,a=(0,eW.T)(this.rightFrozenGroup.childrenCount>0?this.rightFrozenGroup:this.rightTopCornerGroup,0);this.bottomFrozenGroup.hasChildNodes()&&this.bottomFrozenGroup.firstChild&&(0,eW.T)(this.bottomFrozenGroup,this.bottomFrozenGroup.firstChild.col>0?this.table.getColsWidth(null!=(o=this.table.frozenColCount)?o:0,this.bottomFrozenGroup.firstChild.col-1):0),(0,eW.T)(this.leftBottomCornerGroup,0),(0,eW.T)(this.rightTopCornerGroup,0),(0,eW.T)(this.rightBottomCornerGroup,0),this.cornerHeaderGroup.setDeltaWidth(l-this.cornerHeaderGroup.attribute.width),this.leftBottomCornerGroup.setDeltaWidth(l-this.leftBottomCornerGroup.attribute.width),this.colHeaderGroup.setDeltaWidth(i-this.colHeaderGroup.attribute.width),this.rowHeaderGroup.setDeltaWidth(r-this.rowHeaderGroup.attribute.width),this.bottomFrozenGroup.setDeltaWidth(i-this.bottomFrozenGroup.attribute.width),this.rightFrozenGroup.setDeltaWidth(a-this.rightFrozenGroup.attribute.width),this.rightTopCornerGroup.setDeltaWidth(a-this.rightTopCornerGroup.attribute.width),this.rightBottomCornerGroup.setDeltaWidth(a-this.rightBottomCornerGroup.attribute.width),this.bodyGroup.setDeltaWidth(n-this.bodyGroup.attribute.width),this.colHeaderGroup.setAttribute("x",this.cornerHeaderGroup.attribute.width),this.bottomFrozenGroup.setAttribute("x",this.table.getFrozenColsWidth()),this.bodyGroup.setAttribute("x",this.rowHeaderGroup.attribute.width)}updateContainerAttrHeightAndY(){var t,e,o;for(let t=0;t<this.cornerHeaderGroup.children.length;t++)(0,eW.I)(this.cornerHeaderGroup.children[t],0);for(let t=0;t<this.colHeaderGroup.children.length;t++)(0,eW.I)(this.colHeaderGroup.children[t],0);for(let t=0;t<this.rightTopCornerGroup.children.length;t++)(0,eW.I)(this.rightTopCornerGroup.children[t],0);for(let e=0;e<this.rowHeaderGroup.children.length;e++)this.rowHeaderGroup.children[e].firstChild&&(0,eW.I)(this.rowHeaderGroup.children[e],this.rowHeaderGroup.children[e].firstChild.row>0?this.table.getRowsHeight(null!=(t=this.table.frozenRowCount)?t:0,this.rowHeaderGroup.children[e].firstChild.row-1):0);for(let t=0;t<this.bodyGroup.children.length;t++)this.bodyGroup.children[t].firstChild&&(0,eW.I)(this.bodyGroup.children[t],this.bodyGroup.children[t].firstChild.row>0?this.table.getRowsHeight(null!=(e=this.table.frozenRowCount)?e:0,this.bodyGroup.children[t].firstChild.row-1):0);for(let t=0;t<this.rightFrozenGroup.children.length;t++)this.rightFrozenGroup.children[t].firstChild&&(0,eW.I)(this.rightFrozenGroup.children[t],this.rightFrozenGroup.children[t].firstChild.row>0?this.table.getRowsHeight(null!=(o=this.table.frozenRowCount)?o:0,this.rightFrozenGroup.children[t].firstChild.row-1):0);for(let t=0;t<this.leftBottomCornerGroup.children.length;t++)(0,eW.I)(this.leftBottomCornerGroup.children[t],0);for(let t=0;t<this.bottomFrozenGroup.children.length;t++)(0,eW.I)(this.bottomFrozenGroup.children[t],0);for(let t=0;t<this.rightBottomCornerGroup.children.length;t++)(0,eW.I)(this.rightBottomCornerGroup.children[t],0)}updateContainer(t={async:!1,needUpdateCellY:!1}){var e;t.async?this._needUpdateContainer||(this._needUpdateContainer=!0,setTimeout(()=>{var e;this.updateContainerSync(null!=(e=t.needUpdateCellY)&&e)},0)):(this._needUpdateContainer=!0,this.updateContainerSync(null!=(e=t.needUpdateCellY)&&e))}updateContainerSync(t=!1){this._needUpdateContainer&&(this._needUpdateContainer=!1,this.updateContainerAttrWidthAndX(),t&&this.updateContainerAttrHeightAndY(),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame())}updateCellContentWhileResize(t,e){var o;let l=(null==(o=this.table.getCellRawRecord(t,e))?void 0:o.vtableMerge)?"text":this.table.isHeader(t,e)?this.table._getHeaderLayoutMap(t,e).headerType:this.table.getBodyColumnType(t,e),r=this.getCell(t,e);"image"!==l&&"video"!==l||(0,c.km)(r,t,e,0,0,this.table)}createFrameBorder(){var t,e,o,l,r;this.updateTableSize();let i=!this.isPivot&&!this.table.internalProps.transpose;(0,O.CY)(this.bodyGroup,this.table.theme.bodyStyle.frameStyle,this.bodyGroup.role,i?[!0,!0,!0,!1]:void 0),(0,O.CY)(this.rowHeaderGroup,this.isPivot||this.table.internalProps.transpose?this.table.theme.rowHeaderStyle.frameStyle:this.table.theme.bodyStyle.frameStyle,this.rowHeaderGroup.role,i?[!0,!1,!0,!0]:void 0),(0,O.CY)(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle,this.colHeaderGroup.role,i?[!0,!0,!0,!1]:void 0),(0,O.CY)(this.cornerHeaderGroup,this.isPivot?this.table.theme.cornerHeaderStyle.frameStyle:this.table.theme.headerStyle.frameStyle,this.cornerHeaderGroup.role,i?[!0,!1,!0,!0]:void 0),(null==(t=this.table.theme.cornerLeftBottomCellStyle)?void 0:t.frameStyle)&&(0,O.CY)(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle.frameStyle,this.leftBottomCornerGroup.role,i?[!0,!1,!0,!0]:void 0),(null==(e=this.table.theme.bottomFrozenStyle)?void 0:e.frameStyle)&&(0,O.CY)(this.bottomFrozenGroup,this.table.theme.bottomFrozenStyle.frameStyle,this.bottomFrozenGroup.role,i?[!0,!0,!0,!1]:void 0),(null==(o=this.table.theme.rightFrozenStyle)?void 0:o.frameStyle)&&(0,O.CY)(this.rightFrozenGroup,this.table.theme.rightFrozenStyle.frameStyle,this.rightFrozenGroup.role,void 0),(null==(l=this.table.theme.cornerRightTopCellStyle)?void 0:l.frameStyle)&&(0,O.CY)(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle.frameStyle,this.rightTopCornerGroup.role,void 0),(null==(r=this.table.theme.cornerRightBottomCellStyle)?void 0:r.frameStyle)&&(0,O.CY)(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle.frameStyle,this.rightBottomCornerGroup.role,void 0),(0,O.CY)(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0)}getResizeColAt(t,e,o){let l,r=this.table.theme.columnResize.resizeHotSpotSize/2;if(!o){let o=this.table.getDrawRange();return e>=o.top&&e<=o.bottom&&(l=this.table.getCellAtRelativePosition(t-r,e)).col===this.table.colCount-1?l:{col:-1,row:-1}}return o.stage?(t<o.globalAABBBounds.x1+r?l={col:o.col-1,row:o.row,x:o.globalAABBBounds.x1}:o.globalAABBBounds.x2-r<t&&(l={col:o.col,row:o.row,x:o.globalAABBBounds.x2}),l&&this.table.rightFrozenColCount>0&&l.col>=this.table.colCount-this.table.rightFrozenColCount-1&&this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()+this.table.scrollLeft<this.bodyGroup.attribute.width&&(l.col=l.col+1,l.rightFrozen=!0),l||{col:-1,row:-1}):{col:-1,row:-1}}getResizeRowAt(t,e,o){let l=this.table.theme.columnResize.resizeHotSpotSize/2;if(o){let t;if(e<o.globalAABBBounds.y1+l?t={col:o.col,row:o.row-1,y:o.globalAABBBounds.y1}:o.globalAABBBounds.y2-l<e&&(t={col:o.col,row:o.row,y:o.globalAABBBounds.y2}),t&&this.table.bottomFrozenRowCount>0&&t.row>=this.table.rowCount-this.table.bottomFrozenRowCount-1&&this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()+this.table.scrollTop<this.bodyGroup.attribute.height&&(t.row=t.row+1,t.bottomFrozen=!0),t)return t}return{col:-1,row:-1}}updateFrozen(){this.clear||(this.resetFrozen(),this.component.updateScrollBar())}updateRowFrozen(){this.clear||(this.resetRowFrozen(),this.component.updateScrollBar())}dealWidthRightFrozen(t){this.clear?this.table.internalProps.rightFrozenColCount=t:function(t,e){let{table:o,proxy:l,rightTopCornerGroup:r,rightFrozenGroup:i,rightBottomCornerGroup:n,bottomFrozenGroup:a,bodyGroup:h,colHeaderGroup:s}=e,u=e.table.rightFrozenColCount;if(t>u){for(let l=o.colCount-u-1;l>=o.colCount-t;l--)ez(i,e.getColGroup(l),i.firstChild),ez(r,e.getColGroup(l,!0),r.firstChild),ez(n,e.getColGroupInBottom(l),n.firstChild);let l=0;i.forEachChildren(t=>{t.setAttribute("x",l),l+=t.attribute.width}),l=0,r.forEachChildren(t=>{t.setAttribute("x",l),l+=t.attribute.width}),l=0,n.forEachChildren(t=>{t.setAttribute("x",l),l+=t.attribute.width})}else if(t<u){for(let l=o.colCount-u;l<o.colCount-t;l++){let t=e.getColGroup(l);t.setAttribute("x",h.lastChild.attribute.x+o.getColWidth(h.lastChild.col)),h.appendChild(t);let r=e.getColGroupInRightTopCorner(l);r.setAttribute("x",s.lastChild.attribute.x+o.getColWidth(s.lastChild.col)),s.appendChild(r);let i=e.getColGroupInRightBottomCorner(l);i.setAttribute("x",a.lastChild.attribute.x+o.getColWidth(a.lastChild.col)),a.appendChild(i)}let l=0;i.forEachChildren(t=>{t.setAttribute("x",l),l+=t.attribute.width}),l=0,r.forEachChildren(t=>{t.setAttribute("x",l),l+=t.attribute.width}),l=0,n.forEachChildren(t=>{t.setAttribute("x",l),l+=t.attribute.width})}i.setAttribute("width",o.getColsWidth(o.colCount-t,o.colCount-1)),r.setAttribute("width",o.getColsWidth(o.colCount-t,o.colCount-1)),n.setAttribute("width",o.getColsWidth(o.colCount-t,o.colCount-1)),o.internalProps.rightFrozenColCount=t,e.updateContainer(),e.component.updateScrollBar(),e.updateNextFrame()}(t,this)}dealWidthBottomFrozen(t){this.clear?this.table.internalProps.bottomFrozenRowCount=t:function(t,e){let{table:o,proxy:l,bottomFrozenGroup:r,leftBottomCornerGroup:i,rightBottomCornerGroup:n}=e;r.childrenCount||(l.table.isPivotChart()||(tQ(i,0,0,0,o.frozenColCount-1,0,-1,"rowHeader",o),tQ(n,0,0,o.colCount-o.rightFrozenColCount,o.colCount-1,0,-1,"body",o)),tQ(r,0,0,l.colStart,l.colEnd,0,-1,"body",o));let a=e.table.bottomFrozenRowCount;if(t>a){for(let l=0;l<o.frozenColCount;l++){let r=e.getColGroupInLeftBottomCorner(l);for(let i=o.rowCount-a-1;i>=o.rowCount-t;i--)ez(r,e.getCell(l,i,!0),r.firstChild);let i=0;r.forEachChildren(t=>{t.setAttribute("y",i),i+=o.getRowHeight(t.row)})}for(let r=l.colStart;r<=l.colEnd;r++){let l=e.getColGroupInBottom(r);for(let i=o.rowCount-a-1;i>=o.rowCount-t;i--)ez(l,e.getCell(r,i,!0),l.firstChild);let i=0;l.forEachChildren(t=>{t.setAttribute("y",i),i+=o.getRowHeight(t.row)})}if(o.rightFrozenColCount>0)for(let l=o.colCount-o.rightFrozenColCount;l<o.colCount;l++){let r=e.getColGroupInRightBottomCorner(l);for(let i=o.rowCount-a-1;i>=o.rowCount-t;i--)ez(r,e.getCell(l,i,!0),r.firstChild);let i=0;r.forEachChildren(t=>{t.setAttribute("y",i),i+=o.getRowHeight(t.row)})}}else if(t<a){for(let l=0;l<o.rowHeaderLevelCount;l++){let r=e.getColGroup(l);for(let i=o.rowCount-a;i<o.rowCount-t;i++){let t=e.getCell(l,i,!0);t.setAttribute("y",r.lastChild.attribute.y+o.getRowHeight(r.lastChild.row)),r.appendChild(t)}let i=e.getColGroupInLeftBottomCorner(l),n=0;i.forEachChildren(t=>{t.setAttribute("y",n),n+=o.getRowHeight(t.row)})}for(let r=l.colStart;r<=l.colEnd;r++){let l=e.getColGroup(r);for(let i=o.rowCount-a;i<o.rowCount-t;i++){let t=e.getCell(r,i,!0);t.setAttribute("y",l.lastChild.attribute.y+o.getRowHeight(l.lastChild.row)),l.appendChild(t)}let i=e.getColGroupInBottom(r),n=0;i.forEachChildren(t=>{t.setAttribute("y",n),n+=o.getRowHeight(t.row)})}if(o.rightFrozenColCount>0)for(let l=o.colCount-o.rightFrozenColCount;l<o.colCount;l++){let r=e.getColGroup(l);for(let i=o.rowCount-a;i<o.rowCount-t;i++){let t=e.getCell(l,i,!0);t.setAttribute("y",r.lastChild.attribute.y+o.getRowHeight(r.lastChild.row)),r.appendChild(t)}let i=e.getColGroupInRightBottomCorner(l),n=0;i.forEachChildren(t=>{t.setAttribute("y",n),n+=o.getRowHeight(t.row)})}}r.setAttribute("height",o.getRowsHeight(o.rowCount-t,o.rowCount-1)),i.setAttribute("height",o.getRowsHeight(o.rowCount-t,o.rowCount-1)),n.setAttribute("height",o.getRowsHeight(o.rowCount-t,o.rowCount-1)),o.internalProps.bottomFrozenRowCount=t,e.updateContainer(),e.component.updateScrollBar(),e.updateNextFrame()}(t,this)}updateBorderSizeAndPosition(){this.bodyGroup.border&&(this.bodyGroup.appendChild(this.bodyGroup.border),(0,O.Hp)(this.bodyGroup),this.rowHeaderGroup.attribute.width,(0,O.Hc)(this.bodyGroup,this.table.theme.bodyStyle.frameStyle)),this.colHeaderGroup.border&&(this.colHeaderGroup.appendChild(this.colHeaderGroup.border),(0,O.Hp)(this.colHeaderGroup),this.cornerHeaderGroup.attribute.width,(0,O.Hc)(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle)),this.rowHeaderGroup.border&&(this.rowHeaderGroup.appendChild(this.rowHeaderGroup.border),(0,O.Hp)(this.rowHeaderGroup)),this.cornerHeaderGroup.border&&(this.cornerHeaderGroup.appendChild(this.cornerHeaderGroup.border),(0,O.Hp)(this.cornerHeaderGroup)),this.leftBottomCornerGroup.border&&(this.leftBottomCornerGroup.appendChild(this.leftBottomCornerGroup.border),(0,O.Hp)(this.leftBottomCornerGroup)),this.bottomFrozenGroup.border&&(this.bottomFrozenGroup.appendChild(this.bottomFrozenGroup.border),(0,O.Hp)(this.bottomFrozenGroup)),this.rightFrozenGroup.border&&(this.rightFrozenGroup.appendChild(this.rightFrozenGroup.border),(0,O.Hp)(this.rightFrozenGroup)),this.rightTopCornerGroup.border&&(this.rightTopCornerGroup.appendChild(this.rightTopCornerGroup.border),(0,O.Hp)(this.rightTopCornerGroup)),this.rightBottomCornerGroup.border&&(this.rightBottomCornerGroup.appendChild(this.rightBottomCornerGroup.border),(0,O.Hp)(this.rightBottomCornerGroup)),(0,O.A7)(this.table)}sortCell(){this.isPivot||(this.table.transpose?this.proxy.sortCellHorizontal():this.proxy.sortCellVertical())}getCellOverflowText(t,e){let o=this.getCell(t,e).getChildByName("text",!0);if(o&&"text"===o.type){if(o.attribute.moreThanMaxCharacters||o.cliped)return this.table.getCellValue(t,e)}else if(o&&"richtext"===o.type&&o.attribute.ellipsis&&o._frameCache&&o.attribute.height<o._frameCache.actualHeight)return o.attribute.textConfig.find(t=>t.text),this.table.getCellValue(t,e);return null}updateDrill(t,e,o,l,r){this.component.drillIcon.update(t,e,o,l,r,this)}updateCellContent(t,e,o=!1){if(!this.clear)return(0,g.wW)(t,e,this.table,void 0,void 0,o)}setPixelRatio(t){this.stage.disableDirtyBounds(),this.stage.window.setDpr(t),this.stage.render(),this.stage.enableDirtyBounds()}updateRow(t,e,o=[],l=!0,r){this.table.internalProps.layoutMap.clearCellRangeMap(),this.table.internalProps.useOneRowHeightFillAll=!1;let i=(0,ep.oM)(e.map(t=>t.row)).sort((t,e)=>t-e),n=(0,ep.oM)(o.map(t=>t.row)).sort((t,e)=>t-e),a=this.table.getAllRowsHeight()-[...i,...n].reduce((t,e)=>t+this.table.getRowHeight(e),0)<=this.table.tableNoFrameHeight;if(function(t,e,o,l,r){let i,n;(0,eh.F9)(l)&&(0,eh.Ji)(l);let a=l.scenegraph,s=(0,ep.oM)(t.map(t=>t.row)).sort((t,e)=>e-t),u=(0,ep.oM)(e.map(t=>t.row)).sort((t,e)=>t-e),d=(0,ep.oM)(o.map(t=>t.row)).sort((t,e)=>t-e);if(d.length&&(i=em(d[0]-1,d[d.length-1]+1,a)),u.length){let t=em(u[0]-1,u[u.length-1]+1,a);i=(0,N.Z)(i)?(0,N.Z)(t)?Math.min(i,t):i:t}if(s.length){let t=em(s[0]-1,s[s.length-1]+1,a);i=(0,N.Z)(i)?(0,N.Z)(t)?Math.min(i,t):i:t}s.forEach(t=>{var e=t,o=a,l=r;let i=o.proxy;if(e>=i.rowStart&&e<=i.rowEnd&&(ef(e,o),i.rowEnd--,i.currentRow--),!l){i.bodyBottomRow--;let t=Math.min(i.rowLimit,i.bodyBottomRow-i.bodyTopRow+1);i.totalActualBodyRowCount=t,i.totalRow=Math.min(i.table.rowCount-1,i.rowStart+t-1)}});let c=l.rowHeightsMap;if(s.forEach(t=>{c.delete(t)}),s.length){var b,p,C=a;function f(t,e){t.row=e;let o=(0,h.Z)(C.table,t.col,t.row);o?(t.mergeStartCol=o.start.col,t.mergeEndCol=o.end.col,t.mergeStartRow=o.start.row,t.mergeEndRow=o.end.row):(t.mergeStartCol=void 0,t.mergeEndCol=void 0,t.mergeStartRow=void 0,t.mergeEndRow=void 0)}C.bodyGroup.forEachChildren(t=>{let e=C.bodyRowStart;null==t||t.forEachChildren(t=>{f(t,e),e++})}),C.rowHeaderGroup.forEachChildren(t=>{let e=C.bodyRowStart;null==t||t.forEachChildren(t=>{f(t,e),e++})}),C.rightFrozenGroup.forEachChildren(t=>{let e=C.bodyRowStart;null==t||t.forEachChildren(t=>{f(t,e),e++})}),C.bottomFrozenGroup.forEachChildren(t=>{let e=C.table.rowCount-C.table.bottomFrozenRowCount;null==t||t.forEachChildren(t=>{f(t,e),e++})}),C.leftBottomCornerGroup.forEachChildren(t=>{let e=C.table.rowCount-C.table.bottomFrozenRowCount;null==t||t.forEachChildren(t=>{f(t,e),e++})}),C.rightBottomCornerGroup.forEachChildren(t=>{let e=C.table.rowCount-C.table.bottomFrozenRowCount;null==t||t.forEachChildren(t=>{f(t,e),e++})});let t=ew(s[s.length-1]-1,s[0]-s.length+1,a);i=(0,N.Z)(i)?(0,N.Z)(t)?Math.min(i,t):i:t}if(a.table._clearRowRangeHeightsMap(),function(t){let e=t.proxy,{rowStart:o,rowEnd:l,rowLimit:r,totalRow:i}=e;if(o>l)return e.rowStart=t.table.columnHeaderLevelCount,e.rowEnd=Math.min(i,e.rowStart+r-1),e.currentRow=0;if(o+r-1>i){let o=e.rowStart,l=Math.max(t.table.columnHeaderLevelCount,i-r+1);if(l===o)return;e.rowStart=l,e.rowEnd=Math.min(i,l+r-1),e.currentRow=e.rowEnd+1;let n=o-e.rowStart;for(let o=0;o<n;o++)eC(e.rowStart+o,t);e.rowUpdatePos=e.rowStart}}(a),u.forEach(t=>{let e=function(t,e,o){let l=e.proxy;if(!o){l.bodyBottomRow++;let t=Math.min(l.rowLimit,l.bodyBottomRow-l.bodyTopRow+1);l.totalActualBodyRowCount=t,l.totalRow=l.rowStart+t-1}if(!(t<l.rowStart))return t>l.rowEnd?l.rowEnd-l.rowStart+1<l.rowLimit?(l.rowEnd++,l.currentRow++,eC(t,e),t):void 0:(l.rowEnd-l.rowStart+1<l.rowLimit&&(l.rowEnd++,l.currentRow++,eC(t,e)),t)}(t,a,r);n=null!=n?n:e,c.insert(t)}),function(t){function e(e,o,l){e.row=o,e.setAttribute("y",l);let r=(0,h.Z)(t.table,e.col,e.row);r?(e.mergeStartCol=r.start.col,e.mergeEndCol=r.end.col,e.mergeStartRow=r.start.row,e.mergeEndRow=r.end.row):(e.mergeStartCol=void 0,e.mergeEndCol=void 0,e.mergeStartRow=void 0,e.mergeEndRow=void 0)}t.bodyGroup.forEachChildren(o=>{let l=t.bodyRowStart,r=t.getCellGroupY(l);null==o||o.forEachChildren(t=>{e(t,l,r),l++,r+=t.attribute.height})}),t.rowHeaderGroup.forEachChildren(o=>{let l=t.bodyRowStart,r=t.getCellGroupY(l);null==o||o.forEachChildren(t=>{e(t,l,r),l++,r+=t.attribute.height})}),t.rightFrozenGroup.forEachChildren(o=>{let l=t.bodyRowStart,r=t.getCellGroupY(l);null==o||o.forEachChildren(t=>{e(t,l,r),l++,r+=t.attribute.height})}),t.bottomFrozenGroup.forEachChildren(o=>{let l=t.table.rowCount-t.table.bottomFrozenRowCount,r=0;null==o||o.forEachChildren(t=>{e(t,l,r),l++,r+=t.attribute.height})}),t.leftBottomCornerGroup.forEachChildren(o=>{let l=t.table.rowCount-t.table.bottomFrozenRowCount,r=0;null==o||o.forEachChildren(t=>{e(t,l,r),l++,r+=t.attribute.height})}),t.rightBottomCornerGroup.forEachChildren(o=>{let l=t.table.rowCount-t.table.bottomFrozenRowCount,r=0;null==o||o.forEachChildren(t=>{e(t,l,r),l++,r+=t.attribute.height})})}(a),u.length){let t=ew(u[0]-1,u[u.length-1]+1,a);i=(0,N.Z)(i)?(0,N.Z)(t)?Math.min(i,t):i:t}let w=new Set;for(let t=0;t<l.colCount;t++)d.forEach(e=>{if(e<l.frozenRowCount){let o=(0,h.Z)(a.table,t,e);if(o)for(let t=o.start.col;t<=o.end.col;t++)for(let e=o.start.row;e<=o.end.row;e++){let o=`${t}-${e}`;w.has(o)||((0,g.wW)(t,e,a.table,!1),w.add(o))}else(0,g.wW)(t,e,a.table,!1)}else if(e>l.rowCount-1||e<a.table.rowCount-a.table.bottomFrozenRowCount&&(e<a.proxy.rowStart||e>a.proxy.rowEnd))ef(e,a);else{let o=(0,h.Z)(a.table,t,e);if(o)for(let t=o.start.col;t<=o.end.col;t++)for(let e=o.start.row;e<=o.end.row;e++){let o=`${t}-${e}`;w.has(o)||((0,g.wW)(t,e,a.table,!1),w.add(o))}else(0,g.wW)(t,e,a.table,!1)}});if(d.length){let t=ew(d[0]-1,d[d.length-1]+1,a);i=(0,N.Z)(i)?(0,N.Z)(t)?Math.min(i,t):i:t}if((0,t$.Z)(n)){for(let t=0;t<Math.max(l.colCount,null!=(b=l.internalProps._oldColCount)?b:l.colCount);t++)for(let e=n;e<Math.max(l.rowCount,null!=(p=l.internalProps._oldRowCount)?p:l.rowCount);e++){let o=a.highPerformanceGetCell(t,e,!0);o&&(o.needUpdate=!0)}i=(0,N.Z)(i)?(0,N.Z)(n)?Math.min(i,n):i:n}if((0,t$.Z)(i)&&(a.proxy.rowUpdatePos=Math.min(a.proxy.rowUpdatePos,i)),u.length){if(!(0,t$.Z)(n)){let t=Math.min(...u);a.proxy.rowUpdatePos=Math.min(t,a.proxy.rowUpdatePos)}a.proxy.rowUpdateDirection="up",a.proxy.updateCellGroups(2*a.proxy.screenRowCount),y()}else s.length&&(function(t,e){if(e.table.isHasSeriesNumber())for(let o=t;o<=e.table.rowCount-1;o++)(0,g.wW)(0,o,e.table,!1)}(s[s.length-1],a),a.proxy.updateCellGroups(2*a.proxy.screenRowCount),y());a.proxy.progress();let m=l.getRowsHeight(l.frozenRowCount,l.rowCount-1-l.bottomFrozenRowCount);function y(){if((null==u?void 0:u[(null==u?void 0:u.length)-1])>=l.rowCount-l.bottomFrozenRowCount||(null==d?void 0:d[(null==d?void 0:d.length)-1])>=l.rowCount-l.bottomFrozenRowCount||(null==s?void 0:s[0])>=l.rowCount-l.bottomFrozenRowCount){for(let t=0;t<l.colCount;t++)for(let e=l.rowCount-l.bottomFrozenRowCount;e<l.rowCount;e++){let o=a.highPerformanceGetCell(t,e,!0);o&&(o.needUpdate=!0)}a.proxy.updateBottomFrozenCellGroups()}}a.updateContainerHeight(a.table.frozenRowCount,m-a.bodyGroup.attribute.height)}(t,e,o,this.table,r),l&&this.recalculateColWidths(),"adaptive"===this.table.heightMode||this.table.autoFillHeight&&(this.table.getAllRowsHeight()<=this.table.tableNoFrameHeight||a))this.table.scenegraph.recalculateRowHeights();else if(this.table.isAutoRowHeight(this.table.columnHeaderLevelCount))for(let t=0;t<n.length;t++){let e=n[t],o=this.table.rowHeightsMap.get(e),l=(0,w.P)(e,0,this.table.colCount-1,this.table);(e>=this.proxy.rowStart&&e<=this.proxy.rowEnd||e>=this.table.rowCount-this.table.bottomFrozenRowCount&&e<=this.table.rowCount-1)&&this.table.scenegraph.updateRowHeight(e,l-o)}this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCol(t,e,o=[]){(function(t,e,o,l){var r,i;let n;(0,eh.F9)(l)&&(0,eh.Ji)(l);let a=l.scenegraph,s=eI(t.map(t=>t.col)).sort((t,e)=>e-t),u=eI(e.map(t=>t.col)).sort((t,e)=>t-e),d=eI(o.map(t=>t.col)).sort((t,e)=>t-e);s.forEach(t=>{!function(t,e){let o=e.proxy;if(t>=e.table.rowHeaderLevelCount)if(t>=e.table.colCount-e.table.rightFrozenColCount);else{let o=e.getColGroup(t,!1);o&&o.parent===e.bodyGroup&&e.bodyGroup.removeChild(o);let l=e.getColGroupInBottom(t);l&&l.parent===e.bottomFrozenGroup&&e.bottomFrozenGroup.removeChild(l);let r=e.getColGroup(t,!0);r&&r.parent===e.colHeaderGroup&&e.colHeaderGroup.removeChild(r)}t>=o.colStart&&t<=o.colEnd&&(o.colEnd--,o.currentCol--),o.bodyRightCol--;let l=Math.min(o.colLimit,o.bodyRightCol-o.bodyLeftCol+1);o.totalActualBodyColCount=l,o.totalCol=o.colStart+l-1}(t,a)});let c=l.colWidthsMap;s.forEach(t=>{c.delAndReorder(t)}),s.length&&eD(a),a.table._clearColRangeWidthsMap(),u.forEach(t=>{let e=function(t,e){let o=e.proxy;o.bodyRightCol++;let l=Math.min(o.colLimit,o.bodyRightCol-o.bodyLeftCol+1);if(o.totalActualBodyColCount=l,o.totalCol=o.colStart+l-1,!(t<o.colStart))return t>o.colEnd?o.colEnd-o.colStart+1<o.colLimit?(o.colEnd++,o.currentCol++,eN(t,e),t):void 0:(o.colEnd-o.colStart+1<o.colLimit&&(o.colEnd++,o.currentCol++,eN(t,e)),t)}(t,a);eD(a),n=null!=n?n:e,c.addAndReorder(t)}),function(t){let e=t.bodyColStart,o=t.getCellGroupX(e);function l(o){o.col=e;let l=(0,h.Z)(t.table,o.col,o.row);l&&(o.mergeStartCol=l.start.col,o.mergeStartCol=l.start.col,o.mergeEndCol=l.end.col,o.mergeEndCol=l.end.col),o.role}t.bodyGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{l(t)}),t.setAttribute("x",o),o+=t.attribute.width,e++}),e=t.bodyColStart,o=t.getCellGroupX(e),t.colHeaderGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{l(t)}),t.setAttribute("x",o),o+=t.attribute.width,e++}),e=t.bodyColStart,o=t.getCellGroupX(e),t.bottomFrozenGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{l(t)}),t.setAttribute("x",o),o+=t.attribute.width,e++}),e=t.table.colCount-t.table.rightFrozenColCount,o=0,t.rightFrozenGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{l(t)}),t.setAttribute("x",o),o+=t.attribute.width,e++}),e=t.table.colCount-t.table.rightFrozenColCount,o=0,t.rightTopCornerGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{l(t)}),t.setAttribute("x",o),o+=t.attribute.width,e++}),e=t.table.colCount-t.table.rightFrozenColCount,o=0,t.rightBottomCornerGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{l(t)}),t.setAttribute("x",o),o+=t.attribute.width,e++})}(a);let b=new Set;if(d.forEach(t=>{for(let e=0;e<l.rowCount;e++){let o=(0,h.Z)(a.table,t,e);if(o)for(let t=o.start.col;t<=o.end.col;t++)for(let t=o.start.col;t<=o.end.col;t++){let o=`${t}-${e}`;b.has(o)||((0,g.wW)(t,e,a.table,!1),b.add(o))}else(0,g.wW)(t,e,a.table,!1)}}),(0,t$.Z)(n)){for(let t=n;t<Math.max(l.colCount,null!=(r=l.internalProps._oldColCount)?r:l.colCount);t++)for(let e=0;e<Math.max(l.rowCount,null!=(i=l.internalProps._oldRowCount)?i:l.rowCount);e++){let o=a.highPerformanceGetCell(t,e,!0);o&&(o.needUpdate=!0)}a.proxy.colUpdatePos=n}if(u.length){if(!(0,t$.Z)(n)){let t=Math.min(...u);a.proxy.colUpdatePos=t}a.proxy.colUpdateDirection="left",a.proxy.updateColGroups(2*a.proxy.screenColCount),C(),a.proxy.progress()}else s.length&&(a.proxy.updateColGroups(2*a.proxy.screenColCount),C(),a.proxy.progress());let p=l.getColsWidth(l.frozenColCount,l.colCount-1);function C(){if((null==u?void 0:u[(null==u?void 0:u.length)-1])>=l.colCount-l.rightFrozenColCount||(null==d?void 0:d[(null==d?void 0:d.length)-1])>=l.colCount-l.rightFrozenColCount||(null==s?void 0:s[0])>=l.colCount-l.rightFrozenColCount){for(let t=l.colCount-l.rightFrozenColCount;t<l.colCount;t++)for(let e=0;e<l.rowCount;e++){let o=a.highPerformanceGetCell(t,e,!0);o&&(o.needUpdate=!0)}a.proxy.updateRightFrozenCellGroups()}}a.updateContainerWidth(a.table.frozenColCount,p-a.bodyGroup.attribute.width)})(t,e,o,this.table),this.recalculateColWidths(),this.recalculateRowHeights(),this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCornerHeaderCells(){for(let t=0;t<this.table.frozenColCount;t++)for(let e=0;e<this.table.frozenRowCount;e++)(0,g.wW)(t,e,this.table,!1)}updateRowHeaderCells(){for(let t=0;t<this.table.frozenColCount;t++)for(let e=this.table.frozenRowCount;e<this.table.rowCount;e++)(0,g.wW)(t,e,this.table,!1)}updateColumnHeaderCells(){for(let t=0;t<this.table.frozenRowCount;t++)for(let e=this.table.frozenColCount;e<this.table.colCount;e++)(0,g.wW)(e,t,this.table,!1)}getColumnGroupX(t){return t<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,t-1):t<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,t-1):t<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.bottomFrozenRowCount,t-1):0}getCellGroupY(t){return t<this.table.frozenRowCount?this.table.getRowsHeight(0,t-1):t<this.table.rowCount-this.table.bottomFrozenRowCount?this.table.getRowsHeight(this.table.columnHeaderLevelCount,t-1):t<this.table.rowCount?this.table.getRowsHeight(this.table.rowCount-this.table.bottomFrozenRowCount,t-1):0}getCellGroupX(t){return t<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,t-1):t<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,t-1):t<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.rightFrozenColCount,t-1):0}updateDomContainer(){(0,ev.V5)(this.table)}setLoadingHierarchyState(t,e){let o=this.getCell(t,e),l=o.getChildByName("collapse",!0)||o.getChildByName("expand",!0);if(l){let o=P.U2()[a.up.loadingIconName];o&&(0,f.Bg)(o,l,t,e)}}temporarilyUpdateSelectRectStyle(t){let{selectedRangeComponents:e}=this;e.forEach((e,o)=>{e.rect.setAttributes(t)}),this.updateNextFrame()}resetSelectRectStyle(){this.recreateAllSelectRangeComponents()}}},540321:function(t,e,o){o.d(e,{E:()=>r,y:()=>i});var l=o(669860);function r(t,e,o,r,n,a,h,s){var u,d,c,g,b,p,C,f,w;let m,y=!!(null==(u=t.table.options.excelOptions)?void 0:u.fillHandle);if((null==(d=t.table.stateManager.select.ranges)?void 0:d.length)>1)y=!1,t.removeFillHandleFromSelectComponents();else if(1===(null==(c=t.table.stateManager.select.ranges)?void 0:c.length)){let e=Math.max(t.table.stateManager.select.ranges[0].start.row,t.table.stateManager.select.ranges[0].end.row),o=Math.max(t.table.stateManager.select.ranges[0].start.col,t.table.stateManager.select.ranges[0].end.col);t.table.isHeader(o,e)&&(y=!1)}Array.isArray(s)&&(!1===s[1]||!1===s[2])&&(y=!1);let v=Math.min(e,r),x=Math.min(o,n),R=Math.max(e,r),A=Math.max(o,n),H=t.highPerformanceGetCell(v,x).globalAABBBounds,G=t.highPerformanceGetCell(R,A).globalAABBBounds,S=t.table.theme,z=null==(g=S.selectionStyle)?void 0:g.cellBorderColor,B=null==(b=S.selectionStyle)?void 0:b.cellBorderLineWidth,F=(0,l.f)({pickable:!1,fill:"replace"!==(null==(p=S.selectionStyle)?void 0:p.selectionFillMode)&&(null!=(f=null==(C=S.selectionStyle)?void 0:C.cellBgColor)?f:"rgba(0, 0, 255,0.1)"),lineWidth:B,stroke:s.map(t=>!!t&&z),x:H.x1-t.tableGroup.attribute.x,y:H.y1-t.tableGroup.attribute.y,width:0,height:0,visible:!0,cornerRadius:i(a,null==(w=t.table.theme.frameStyle)?void 0:w.cornerRadius,e,o,r,n,t.table)});y&&(m=(0,l.f)({pickable:!1,fill:z,stroke:z,x:G.x2-3,y:G.y2-3,width:6,height:6,visible:!0})),t.lastSelectId=h,t.selectingRangeComponents.set(`${v}-${x}-${R}-${A}-${h}`,{rect:F,fillhandle:m,role:a}),t.tableGroup.insertAfter(F,"body"===a?t.bodyGroup:"columnHeader"===a?t.colHeaderGroup:"rowHeader"===a?t.rowHeaderGroup:"cornerHeader"===a?t.cornerHeaderGroup:"rightTopCorner"===a?t.rightTopCornerGroup:"rightFrozen"===a?t.rightFrozenGroup:"leftBottomCorner"===a?t.leftBottomCornerGroup:"bottomFrozen"===a?t.bottomFrozenGroup:t.rightBottomCornerGroup),y&&t.tableGroup.insertAfter(m,"body"===a?t.bodyGroup:"columnHeader"===a?t.colHeaderGroup:"rowHeader"===a?t.rowHeaderGroup:"cornerHeader"===a?t.cornerHeaderGroup:"rightTopCorner"===a?t.rightTopCornerGroup:"rightFrozen"===a?t.rightFrozenGroup:"leftBottomCorner"===a?t.leftBottomCornerGroup:"bottomFrozen"===a?t.bottomFrozenGroup:t.rightBottomCornerGroup)}function i(t,e,o,l,r,i,n){if(!e)return;let a=Array.isArray(e)?e:[e,e,e,e],h=n.colCount-1,s=n.rowCount-1,u=[0,0,0,0],d=!1;return 0===o&&0===l?(u[0]=a[0],d=!0):r===h&&i===s?(u[2]=a[2],d=!0):0===o&&i===s?(u[3]=a[3],d=!0):r===h&&0===l&&(u[1]=a[1],d=!0),d?u:void 0}},636989:function(t,e,o){function l(t){t.selectedRangeComponents.forEach((e,o)=>{var l;o.split("-")[4]===t.lastSelectId&&(e.rect.delete(),null==(l=e.fillhandle)||l.delete(),t.selectedRangeComponents.delete(o))})}function r(t){t.selectedRangeComponents.forEach((t,e)=>{var o;t.rect.delete(),null==(o=t.fillhandle)||o.delete()}),t.selectedRangeComponents=new Map}function i(t){t.selectingRangeComponents.forEach((t,e)=>{var o;t.rect.delete(),null==(o=t.fillhandle)||o.delete()}),t.selectingRangeComponents=new Map}function n(t){t.selectedRangeComponents.forEach((t,e)=>{var o;null==(o=t.fillhandle)||o.delete(),t.fillhandle=void 0})}o.d(e,{$0:()=>i,UC:()=>n,gW:()=>r,q8:()=>l})},106108:function(t,e,o){o.d(e,{K:()=>n});var l=o(549360),r=o(669860),i=o(540321);function n(t,e,o){let r=t.table,i=e.start.col,n=e.start.row,h=e.end.col,s=e.end.row,u=(e.skipBodyMerge,Math.max(Math.min(h,i),0)),d=Math.max(Math.min(s,n),0),c=Math.min(Math.max(h,i),r.colCount-1),g=Math.min(Math.max(s,n),r.rowCount-1),{needRowHeader:b,needRightRowHeader:p,needColumnHeader:C,needBottomColumnHeader:f,needBody:w,needCornerHeader:m,needRightTopCornerHeader:y,needLeftBottomCornerHeader:v,needRightBottomCornerHeader:x}=(0,l.L)(u,d,c,g,r);if(m&&a(t,u,d,Math.min(c,r.frozenColCount-1),Math.min(g,r.frozenRowCount-1),"cornerHeader",`${u}${d}${c}${g}`,[!0,!C,!b,!0],o),y&&a(t,Math.max(u,r.colCount-r.rightFrozenColCount),d,c,Math.min(g,r.frozenRowCount-1),"rightTopCorner",`${u}${d}${c}${g}`,[!0,!0,!p,!C],o),v){let e=Math.min(c,r.frozenColCount-1);a(t,u,Math.max(d,r.rowCount-r.bottomFrozenRowCount),e,g,"leftBottomCorner",`${u}${d}${c}${g}`,[!b,!f,!0,!0],o)}if(x&&a(t,Math.max(u,r.colCount-r.rightFrozenColCount),Math.max(d,r.rowCount-r.bottomFrozenRowCount),c,g,"rightBottomCorner",`${u}${d}${c}${g}`,[!p,!0,!0,!f],o),C&&a(t,Math.max(u,r.frozenColCount),d,Math.min(c,r.colCount-r.rightFrozenColCount-1),Math.min(g,r.frozenRowCount-1),"columnHeader",`${u}${d}${c}${g}`,[!0,!y,!w,!m],o),f){let e=Math.max(u,r.frozenColCount),l=Math.min(c,r.colCount-r.rightFrozenColCount-1);a(t,e,Math.max(d,r.rowCount-r.bottomFrozenRowCount),l,g,"bottomFrozen",`${u}${d}${c}${g}`,[!w,!x,!0,!v],o)}if(b){let e=Math.max(d,r.frozenRowCount),l=Math.min(g,r.rowCount-r.bottomFrozenRowCount-1);a(t,u,e,Math.min(c,r.frozenColCount-1),l,"rowHeader",`${u}${d}${c}${g}`,[!m,!w,!v,!0],o)}if(p){let e=Math.max(d,r.frozenRowCount),l=Math.min(g,r.rowCount-r.bottomFrozenRowCount-1);a(t,Math.max(u,r.colCount-r.rightFrozenColCount),e,c,l,"rightFrozen",`${u}${d}${c}${g}`,[!y,!0,!x,!w],o)}w&&a(t,Math.max(u,r.frozenColCount),Math.max(d,r.frozenRowCount),Math.min(c,r.colCount-r.rightFrozenColCount-1),Math.min(g,r.rowCount-r.bottomFrozenRowCount-1),"body",`${u}${d}${c}${g}`,[!C,!p,!f,!b],o)}function a(t,e,o,l,n,a,h,s,u){var d,c,g,b;let p=Math.min(e,l),C=Math.min(o,n),f=Math.max(e,l),w=Math.max(o,n),m=t.highPerformanceGetCell(p,C).globalAABBBounds,y=(0,r.f)({pickable:!1,fill:null!=(d=u.cellBgColor)&&d,lineWidth:null!=(c=u.cellBorderLineWidth)?c:0,lineDash:null!=(g=u.cellBorderLineDash)?g:[],stroke:s.map(t=>!!t&&u.cellBorderColor),x:m.x1-t.tableGroup.attribute.x,y:m.y1-t.tableGroup.attribute.y,width:0,height:0,visible:!0,cornerRadius:(0,i.y)(a,null==(b=t.table.theme.frameStyle)?void 0:b.cornerRadius,e,o,l,n,t.table)});t.customSelectedRangeComponents.set(`${p}-${C}-${f}-${w}-${h}`,{rect:y,role:a}),t.tableGroup.insertAfter(y,"body"===a?t.bodyGroup:"columnHeader"===a?t.colHeaderGroup:"rowHeader"===a?t.rowHeaderGroup:"cornerHeader"===a?t.cornerHeaderGroup:"rightTopCorner"===a?t.rightTopCornerGroup:"rightFrozen"===a?t.rightFrozenGroup:"leftBottomCorner"===a?t.leftBottomCornerGroup:"bottomFrozen"===a?t.bottomFrozenGroup:t.rightBottomCornerGroup)}},300434:function(t,e,o){o.d(e,{Iy:()=>n,Re:()=>u,eo:()=>h,pP:()=>s});var l=o(727594),r=o(549360),i=o(657198);function n(t){t.customSelectedRangeComponents.forEach((e,o)=>{a(e,o,t)}),t.selectingRangeComponents.forEach((e,o)=>{a(e,o,t)}),t.selectedRangeComponents.forEach((e,o)=>{a(e,o,t)})}function a(t,e,o){var l,r,n,a,h,s,u,d,c,g;let b=o.table,[p,C,f,w]=e.split("-"),m=parseInt(p,10),y=parseInt(C,10),v=parseInt(f,10),x=parseInt(w,10),R,A=m,H=y,G=v,S=x;switch(t.role){case"rowHeader":(R=b.getBodyVisibleRowRange())&&(H=Math.max(y,R.rowStart-1),S=Math.min(x,R.rowEnd+1));break;case"columnHeader":case"bottomFrozen":(R=b.getBodyVisibleCellRange())&&(A=Math.max(m,R.colStart-1),G=Math.min(v,R.colEnd+1));break;case"cornerHeader":case"rightTopCorner":case"leftBottomCorner":case"rightBottomCorner":break;case"rightFrozen":(R=b.getBodyVisibleCellRange())&&(H=Math.max(y,R.rowStart-1),S=Math.min(x,R.rowEnd+1));break;default:(R=b.getBodyVisibleCellRange())&&(H=Math.max(y,R.rowStart-1),S=Math.min(x,R.rowEnd+1),A=Math.max(m,R.colStart-1),G=Math.min(v,R.colEnd+1))}let z=b.getColsWidth(A,G),B=b.getRowsHeight(H,S),F=o.highPerformanceGetCell(A,H).globalAABBBounds;if(t.rect.setAttributes({x:F.x1-o.tableGroup.attribute.x,y:F.y1-o.tableGroup.attribute.y,width:z,height:B,visible:!0}),b.hasListeners(i.B.AFTER_UPDATE_SELECT_BORDER_HEIGHT)&&b.fireListeners(i.B.AFTER_UPDATE_SELECT_BORDER_HEIGHT,{startRow:H,endRow:S,currentHeight:B,selectComp:t}),t.fillhandle){let e=null==(l=o.table.options.excelOptions)?void 0:l.fillHandle,i,n=!0;"function"==typeof e&&(n=e({selectRanges:o.table.stateManager.select.ranges,table:o.table})),i=v<b.colCount-1?o.highPerformanceGetCell(v,x).globalAABBBounds.x2-o.tableGroup.attribute.x-3:0===m?o.highPerformanceGetCell(0,x).globalAABBBounds.x1-o.tableGroup.attribute.x:o.highPerformanceGetCell(m-1,x).globalAABBBounds.x2-o.tableGroup.attribute.x-3;let a=(x<b.rowCount-1?o.highPerformanceGetCell(v,x).globalAABBBounds:o.highPerformanceGetCell(v,y-1).globalAABBBounds).y2-o.tableGroup.attribute.y-3;null==(r=t.fillhandle)||r.setAttributes({x:i,y:a,width:6,height:6,visible:n})}let M=!!b.frozenColCount&&m===b.frozenColCount;!M&&b.frozenColCount&&b.scrollLeft>0&&m>=b.frozenColCount&&b.getColsWidth(0,m-1)-b.scrollLeft<b.getFrozenColsWidth()&&(M=!0);let W=!!b.rightFrozenColCount&&b.rightFrozenColCount>0&&v===b.colCount-b.rightFrozenColCount-1;!W&&b.rightFrozenColCount&&v<b.colCount-b.rightFrozenColCount&&b.getColsWidth(0,v)-b.scrollLeft>b.tableNoFrameWidth-b.getRightFrozenColsWidth()&&(W=!0);let k=!b.frozenRowCount||y===b.frozenRowCount;!k&&b.frozenRowCount&&b.scrollTop>0&&y>=b.frozenRowCount&&b.getRowsHeight(0,y-1)-b.scrollTop<b.getFrozenRowsHeight()&&(k=!0);let P=!!b.bottomFrozenRowCount&&x===b.rowCount-b.bottomFrozenRowCount-1;!P&&b.bottomFrozenRowCount&&x<b.rowCount-b.bottomFrozenRowCount&&b.getRowsHeight(0,x)-b.scrollTop>b.tableNoFrameHeight-b.getBottomFrozenRowsHeight()&&(P=!0);let{dynamicUpdateSelectionSize:_}=b.theme.selectionStyle;if(M&&(t.rect.attribute.stroke[3]||_)||W&&(t.rect.attribute.stroke[1]||_)||k&&(t.rect.attribute.stroke[0]||_)||P&&(t.rect.attribute.stroke[2]||_)){if(M&&t.rect.attribute.stroke[3]&&o.tableGroup.insertAfter(t.rect,"columnHeader"===t.role?o.cornerHeaderGroup:"bottomFrozen"===t.role?o.leftBottomCornerGroup:o.rowHeaderGroup),P&&t.rect.attribute.stroke[2]&&o.tableGroup.insertAfter(t.rect,"rowHeader"===t.role?o.leftBottomCornerGroup:"rightFrozen"===t.role?o.rightBottomCornerGroup:o.bottomFrozenGroup),k&&t.rect.attribute.stroke[0]&&o.tableGroup.insertAfter(t.rect,"rowHeader"===t.role?o.cornerHeaderGroup:"rightFrozen"===t.role?o.rightTopCornerGroup:o.colHeaderGroup),W&&t.rect.attribute.stroke[1]&&o.tableGroup.insertAfter(t.rect,"columnHeader"===t.role?o.rightTopCornerGroup:"bottomFrozen"===t.role?o.rightBottomCornerGroup:o.rightFrozenGroup),t.rect.attribute.x<b.getFrozenColsWidth()&&b.scrollLeft>0&&("body"===t.role||"columnHeader"===t.role||"bottomFrozen"===t.role)){let e=t.rect.attribute.width-(b.getFrozenColsWidth()-t.rect.attribute.x);t.rect.setAttributes({x:t.rect.attribute.x+(b.getFrozenColsWidth()-t.rect.attribute.x),width:e>0?e:0}),null==(n=t.fillhandle)||n.setAttributes({visible:e>0})}if(b.getRightFrozenColsWidth()>0&&o.rightFrozenGroup.attribute.height>0&&t.rect.attribute.x+t.rect.attribute.width>o.rightFrozenGroup.attribute.x&&("body"===t.role||"columnHeader"===t.role||"bottomFrozen"===t.role)){let e=o.rightFrozenGroup.attribute.x-t.rect.attribute.x;t.rect.setAttributes({x:t.rect.attribute.x,width:e>0?e:0}),null==(a=t.fillhandle)||a.setAttributes({visible:e-z>0})}if(t.rect.attribute.y<o.colHeaderGroup.attribute.height&&b.scrollTop>0&&("body"===t.role||"rowHeader"===t.role||"rightFrozen"===t.role)){let e=t.rect.attribute.height-(o.colHeaderGroup.attribute.height-t.rect.attribute.y);t.rect.setAttributes({y:t.rect.attribute.y+(o.colHeaderGroup.attribute.height-t.rect.attribute.y),height:e>0?e:0}),null==(h=t.fillhandle)||h.setAttributes({visible:e>0})}if(o.bottomFrozenGroup.attribute.width>0&&o.bottomFrozenGroup.attribute.height>0&&t.rect.attribute.y+t.rect.attribute.height>o.bottomFrozenGroup.attribute.y&&("body"===t.role||"rowHeader"===t.role||"rightFrozen"===t.role)){let e=o.bottomFrozenGroup.attribute.y-t.rect.attribute.y;t.rect.setAttributes({y:t.rect.attribute.y,height:e>0?e:0}),null==(s=t.fillhandle)||s.setAttributes({visible:e-B>0})}}else o.tableGroup.insertAfter(t.rect,"body"===t.role?o.bodyGroup:"columnHeader"===t.role?o.colHeaderGroup:"rowHeader"===t.role?o.rowHeaderGroup:"cornerHeader"===t.role?o.cornerHeaderGroup:"rightTopCorner"===t.role?o.rightTopCornerGroup:"rightFrozen"===t.role?o.rightFrozenGroup:"leftBottomCorner"===t.role?o.leftBottomCornerGroup:"bottomFrozen"===t.role?o.bottomFrozenGroup:o.rightBottomCornerGroup);let L=0;"number"==typeof t.rect.attribute.lineWidth&&(L=Math.ceil(t.rect.attribute.lineWidth/2)),v===b.colCount-1&&(Array.isArray(t.rect.attribute.lineWidth)&&(L=Math.ceil((null!=(u=t.rect.attribute.lineWidth[1])?u:0)/2)),t.rect.setAttributes({width:t.rect.attribute.width-L})),0===m&&(Array.isArray(t.rect.attribute.lineWidth)&&(L=Math.ceil((null!=(d=t.rect.attribute.lineWidth[3])?d:0)/2)),t.rect.setAttributes({x:t.rect.attribute.x+L,width:t.rect.attribute.width-L})),x===b.rowCount-1&&(Array.isArray(t.rect.attribute.lineWidth)&&(L=Math.ceil((null!=(c=t.rect.attribute.lineWidth[2])?c:0)/2)),t.rect.setAttributes({height:t.rect.attribute.height-L})),0===y&&(Array.isArray(t.rect.attribute.lineWidth)&&(L=Math.ceil((null!=(g=t.rect.attribute.lineWidth[0])?g:0)/2)),t.rect.setAttributes({y:t.rect.attribute.y+L,height:t.rect.attribute.height-L}))}function h(t,e,o=!0){let i=t.table,n=e.start.col,a=e.start.row,s=e.end.col,u=e.end.row,d=e.skipBodyMerge,c=Math.max(Math.min(s,n),0),g=Math.max(Math.min(u,a),0),b=Math.min(Math.max(s,n),i.colCount-1),p=Math.min(Math.max(u,a),i.rowCount-1),C=()=>{let t=!1;for(let e=c;e<=b;e++){if(e===c)for(let o=g;o<=p;o++){if(!i.isHeader(e,o)&&d)continue;let r=(0,l.Z)(i,e,o);if(r&&r.start.col<c){c=r.start.col,t=!0;break}}if(!t&&e===b)for(let o=g;o<=p;o++){if(!i.isHeader(e,o)&&d)continue;let r=(0,l.Z)(i,e,o);if(r&&Math.min(r.end.col,i.colCount-1)>b){b=r.end.col,t=!0;break}}if(t)break}if(!t)for(let e=g;e<=p;e++){if(e===g)for(let o=c;o<=b;o++){if(!i.isHeader(o,e)&&d)continue;let r=(0,l.Z)(i,o,e);if(r&&r.start.row<g){g=r.start.row,t=!0;break}}if(!t&&e===p)for(let o=c;o<=b;o++){if(!i.isHeader(o,e)&&d)continue;let r=(0,l.Z)(i,o,e);if(r&&Math.min(r.end.row,i.rowCount-1)>p){p=r.end.row,t=!0;break}}if(t)break}t&&C()};o&&(C(),e.start.col>e.end.col?(e.start.col=Math.max(c,b),e.end.col=Math.min(c,b)):(e.start.col=Math.min(c,b),e.end.col=Math.max(c,b)),e.start.row>e.end.row?(e.start.row=Math.max(g,p),e.end.row=Math.min(g,p)):(e.start.row=Math.min(g,p),e.end.row=Math.max(g,p))),t.selectingRangeComponents.forEach((t,e)=>{var o;t.rect.delete(),null==(o=t.fillhandle)||o.delete()}),t.selectingRangeComponents=new Map;let{needRowHeader:f,needRightRowHeader:w,needColumnHeader:m,needBottomColumnHeader:y,needBody:v,needCornerHeader:x,needRightTopCornerHeader:R,needLeftBottomCornerHeader:A,needRightBottomCornerHeader:H}=(0,r.L)(c,g,b,p,i);if(x){let e=Math.min(b,i.frozenColCount-1),o=Math.min(p,i.frozenRowCount-1);t.createCellSelectBorder(c,g,e,o,"cornerHeader",`${c}${g}${b}${p}`,[!0,!m,!f,!0])}if(R){let e=Math.max(c,i.colCount-i.rightFrozenColCount),o=Math.min(p,i.frozenRowCount-1);t.createCellSelectBorder(e,g,b,o,"rightTopCorner",`${c}${g}${b}${p}`,[!0,!0,!w,!m])}if(A){let e=Math.min(b,i.frozenColCount-1),o=Math.max(g,i.rowCount-i.bottomFrozenRowCount);t.createCellSelectBorder(c,o,e,p,"leftBottomCorner",`${c}${g}${b}${p}`,[!f,!y,!0,!0])}if(H){let e=Math.max(c,i.colCount-i.rightFrozenColCount),o=Math.max(g,i.rowCount-i.bottomFrozenRowCount);t.createCellSelectBorder(e,o,b,p,"rightBottomCorner",`${c}${g}${b}${p}`,[!w,!0,!0,!y])}if(m){let e=Math.max(c,i.frozenColCount),o=Math.min(b,i.colCount-i.rightFrozenColCount-1),l=Math.min(p,i.frozenRowCount-1);t.createCellSelectBorder(e,g,o,l,"columnHeader",`${c}${g}${b}${p}`,[!0,!R,!v,!x])}if(y){let e=Math.max(c,i.frozenColCount),o=Math.min(b,i.colCount-i.rightFrozenColCount-1),l=Math.max(g,i.rowCount-i.bottomFrozenRowCount);t.createCellSelectBorder(e,l,o,p,"bottomFrozen",`${c}${g}${b}${p}`,[!v,!H,!0,!A])}if(f){let e=Math.max(g,i.frozenRowCount),o=Math.min(p,i.rowCount-i.bottomFrozenRowCount-1),l=Math.min(b,i.frozenColCount-1);t.createCellSelectBorder(c,e,l,o,"rowHeader",`${c}${g}${b}${p}`,[!x,!v,!A,!0])}if(w){let e=Math.max(g,i.frozenRowCount),o=Math.min(p,i.rowCount-i.bottomFrozenRowCount-1),l=Math.max(c,i.colCount-i.rightFrozenColCount);t.createCellSelectBorder(l,e,b,o,"rightFrozen",`${c}${g}${b}${p}`,[!R,!0,!H,!v])}if(v){let e=Math.max(c,i.frozenColCount),o=Math.max(g,i.frozenRowCount),l=Math.min(b,i.colCount-i.rightFrozenColCount-1),r=Math.min(p,i.rowCount-i.bottomFrozenRowCount-1);t.createCellSelectBorder(e,o,l,r,"body",`${c}${g}${b}${p}`,[!m,!w,!y,!f])}}function s(t){t.selectingRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",0)}),t.selectedRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",0)})}function u(t){t.selectingRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",1)}),t.selectedRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",1)})}}}]);