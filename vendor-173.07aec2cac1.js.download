"use strict";(window.webpackChunkweb=window.webpackChunkweb||[]).push([["23939"],{540559:function(e,t,l){let i,n,o,r,a,s,h,d,u,c,g,p;l.d(t,{T:()=>lJ});var f=l(936781),C=l(94980),v=l(364776),m=l(695723),b=l(720307),y=l(809032);let w={CHANGE_STYLE:"change_style"};class _ extends y.R{static get EVENT_TYPE(){return w}static get DEFAULT(){return i||(i=new _)}constructor(e={},t={}){var l,i,n,o,r,a,s,h,d,u,c,g,p,f,C,v,m,b,y,w,_,M,S,R,x,E,P,A,T,H,L;super(),this._defaultPadding=[10,16,10,16],this._textAlign=null!=(l=null==e?void 0:e.textAlign)?l:null==t?void 0:t.textAlign,this._textBaseline=null!=(i=null==e?void 0:e.textBaseline)?i:null==t?void 0:t.textBaseline,this._color=null!=(n=null==e?void 0:e.color)?n:null==t?void 0:t.color,this._strokeColor=null!=(o=null==e?void 0:e.strokeColor)?o:null==t?void 0:t.strokeColor,this._fontSize=null!=(r=e.fontSize)?r:null==t?void 0:t.fontSize,this._fontFamily=null!=(a=e.fontFamily)?a:null==t?void 0:t.fontFamily,this._fontWeight=null!=(s=e.fontWeight)?s:null==t?void 0:t.fontWeight,this._fontVariant=null!=(h=e.fontVariant)?h:null==t?void 0:t.fontVariant,this._fontStyle=null!=(d=e.fontStyle)?d:null==t?void 0:t.fontStyle,this._padding=null!=(c=null!=(u=null==e?void 0:e.padding)?u:null==t?void 0:t.padding)?c:this._defaultPadding,this._borderColor=null!=(g=null==e?void 0:e.borderColor)?g:null==t?void 0:t.borderColor,this._textOverflow=null!=(p=null==e?void 0:e.textOverflow)?p:null==t?void 0:t.textOverflow,this._textStick=null!=(C=null!=(f=e.textStick)?f:null==t?void 0:t.textStick)&&C,this._textStickBaseOnAlign=null!=(m=null!=(v=e.textStickBaseOnAlign)?v:null==t?void 0:t.textStickBaseOnAlign)&&m,this._bgColor=null!=(b=null==e?void 0:e.bgColor)?b:null==t?void 0:t.bgColor,this._lineHeight=null!=(y=null==e?void 0:e.lineHeight)?y:null==t?void 0:t.lineHeight,this._underline=null!=(w=null==e?void 0:e.underline)?w:null==t?void 0:t.underline,this._underlineColor=null!=(_=null==e?void 0:e.underlineColor)?_:null==t?void 0:t.underlineColor,this._underlineDash=null!=(M=null==e?void 0:e.underlineDash)?M:null==t?void 0:t.underlineDash,this._underlineOffset=null!=(S=null==e?void 0:e.underlineOffset)?S:null==t?void 0:t.underlineOffset,this._lineThrough=null!=(R=null==e?void 0:e.lineThrough)?R:null==t?void 0:t.lineThrough,this._lineThroughColor=null!=(x=null==e?void 0:e.lineThroughColor)?x:null==t?void 0:t.lineThroughColor,this._lineThroughDash=null!=(E=null==e?void 0:e.lineThroughDash)?E:null==t?void 0:t.lineThroughDash,this._linkColor=null!=(P=null==e?void 0:e.linkColor)?P:null==t?void 0:t.linkColor,this._cursor=null!=(A=e.cursor)?A:null==t?void 0:t.cursor,this._borderLineWidth=null!=(T=e.borderLineWidth)?T:null==t?void 0:t.borderLineWidth,this._borderLineDash=null!=(H=e.borderLineDash)?H:null==t?void 0:t.borderLineDash,this._marked=null!=(L=e.marked)?L:null==t?void 0:t.marked}get color(){return this._color}set color(e){this._color=e}get strokeColor(){return this._strokeColor}set strokeColor(e){this._strokeColor=e}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize=e}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e}get padding(){return this._padding}set padding(e){this._padding=e}get textOverflow(){return this._textOverflow}set textOverflow(e){this._textOverflow=e}get bgColor(){return this._bgColor}set bgColor(e){this._bgColor=e}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e}get textStick(){return this._textStick}set textStick(e){this._textStick=e}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(e){this._textStickBaseOnAlign=e}get textAlign(){return this._textAlign}set textAlign(e){this._textAlign=e}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e}get underline(){return this._underline}set underline(e){this._underline=e}get underlineColor(){return this._underlineColor}set underlineColor(e){this._underlineColor=e}get underlineDash(){return this._underlineDash}set underlineDash(e){this._underlineDash=e}get underlineOffset(){return this._underlineOffset}set underlineOffset(e){this._underlineOffset=e}get lineThrough(){return this._lineThrough}set lineThrough(e){this._lineThrough=e}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(e){this._lineThroughColor=e}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(e){this._lineThroughDash=e}get linkColor(){return this._linkColor}set linkColor(e){this._linkColor=e}get cursor(){return this._cursor}set cursor(e){this._cursor=e}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(e){this._borderLineWidth=e}get borderLineDash(){return this._borderLineDash}set borderLineDash(e){this._borderLineDash=e}get marked(){return this._marked}set marked(e){this._marked=e}clone(){return new _(this,null)}}class M extends _{static get DEFAULT(){return n||(n=new M)}constructor(e={},t={},l={}){var i,n,o,r,a,s,h,d,u,c,g,p,f,C,v,m,b,y,w,_,M,S;super(e,t),this._size=(null!=(n=null!=(i=null==e?void 0:e.size)?i:null==t?void 0:t.size)?n:null==l?void 0:l.size)||14,this._spaceBetweenTextAndIcon=(null!=(r=null!=(o=null==e?void 0:e.spaceBetweenTextAndIcon)?o:null==t?void 0:t.spaceBetweenTextAndIcon)?r:null==l?void 0:l.spaceBetweenTextAndIcon)||8,this._defaultFill=null!=(s=null==(a=null==e?void 0:e.checkboxStyle)?void 0:a.defaultFill)?s:null==l?void 0:l.defaultFill,this._defaultStroke=null!=(d=null==(h=null==e?void 0:e.checkboxStyle)?void 0:h.defaultStroke)?d:null==l?void 0:l.defaultStroke,this._disableFill=null!=(c=null==(u=null==e?void 0:e.checkboxStyle)?void 0:u.disableFill)?c:null==l?void 0:l.disableFill,this._checkedFill=null!=(p=null==(g=null==e?void 0:e.checkboxStyle)?void 0:g.checkedFill)?p:null==l?void 0:l.checkedFill,this._checkedStroke=null!=(C=null==(f=null==e?void 0:e.checkboxStyle)?void 0:f.checkedStroke)?C:null==l?void 0:l.checkedStroke,this._disableCheckedFill=null!=(m=null==(v=null==e?void 0:e.checkboxStyle)?void 0:v.disableCheckedFill)?m:null==l?void 0:l.disableCheckedFill,this._disableCheckedStroke=null!=(y=null==(b=null==e?void 0:e.checkboxStyle)?void 0:b.disableCheckedStroke)?y:null==l?void 0:l.disableCheckedStroke,this._checkIconImage=null!=(_=null==(w=null==e?void 0:e.checkboxStyle)?void 0:w.checkIconImage)?_:null==l?void 0:l.checkIconImage,this._indeterminateIconImage=null!=(S=null==(M=null==e?void 0:e.checkboxStyle)?void 0:M.indeterminateIconImage)?S:null==l?void 0:l.indeterminateIconImage}get size(){return this._size}set size(e){this._size=e}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(e){this._spaceBetweenTextAndIcon=e}get defaultFill(){return this._defaultFill}set defaultFill(e){this._defaultFill=e}get defaultStroke(){return this._defaultStroke}set defaultStroke(e){this._defaultStroke=e}get disableFill(){return this._disableFill}set disableFill(e){this._disableFill=e}get checkedFill(){return this._checkedFill}set checkedFill(e){this._checkedFill=e}get checkedStroke(){return this._checkedStroke}set checkedStroke(e){this._checkedStroke=e}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(e){this._disableCheckedFill=e}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(e){this._disableCheckedStroke=e}get checkIconImage(){return this._checkIconImage}set checkIconImage(e){this._checkIconImage=e}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(e){this._indeterminateIconImage=e}getStyle(e){return new M(e,this)}clone(){return new M(this)}}class S extends _{static get DEFAULT(){return o||(o=new S)}constructor(e={},t={},l={}){var i,n,o,r,a,s,h,d,u,c,g,p,f,C,v,m,b,y,w,_,M,S,R,x;super(e,t),this._size=(null!=(n=null!=(i=null==e?void 0:e.size)?i:null==t?void 0:t.size)?n:null==l?void 0:l.size)||14,this._spaceBetweenTextAndIcon=(null!=(r=null!=(o=null==e?void 0:e.spaceBetweenTextAndIcon)?o:null==t?void 0:t.spaceBetweenTextAndIcon)?r:null==l?void 0:l.spaceBetweenTextAndIcon)||8,this._spaceBetweenRadio=(null!=(s=null!=(a=null==e?void 0:e.spaceBetweenRadio)?a:null==t?void 0:t.spaceBetweenRadio)?s:null==l?void 0:l.spaceBetweenRadio)||2,this._innerRadius=null!=(d=null==(h=null==e?void 0:e.radioStyle)?void 0:h.innerRadius)?d:null==l?void 0:l.innerRadius,this._outerRadius=null!=(c=null==(u=null==e?void 0:e.radioStyle)?void 0:u.outerRadius)?c:null==l?void 0:l.outerRadius,this._defaultFill=null!=(p=null==(g=null==e?void 0:e.radioStyle)?void 0:g.defaultFill)?p:null==l?void 0:l.defaultFill,this._defaultStroke=null!=(C=null==(f=null==e?void 0:e.radioStyle)?void 0:f.defaultStroke)?C:null==l?void 0:l.defaultStroke,this._disableFill=null!=(m=null==(v=null==e?void 0:e.radioStyle)?void 0:v.disableFill)?m:null==l?void 0:l.disableFill,this._checkedFill=null!=(y=null==(b=null==e?void 0:e.radioStyle)?void 0:b.checkedFill)?y:null==l?void 0:l.checkedFill,this._checkedStroke=null!=(_=null==(w=null==e?void 0:e.radioStyle)?void 0:w.checkedStroke)?_:null==l?void 0:l.checkedStroke,this._disableCheckedFill=null!=(S=null==(M=null==e?void 0:e.radioStyle)?void 0:M.disableCheckedFill)?S:null==l?void 0:l.disableCheckedFill,this._disableCheckedStroke=null!=(x=null==(R=null==e?void 0:e.radioStyle)?void 0:R.disableCheckedStroke)?x:null==l?void 0:l.disableCheckedStroke}get size(){return this._size}set size(e){this._size=e}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(e){this._spaceBetweenTextAndIcon=e}get spaceBetweenRadio(){return this._spaceBetweenRadio}set spaceBetweenRadio(e){this._spaceBetweenRadio=e}get innerRadius(){return this._innerRadius}set innerRadius(e){this._innerRadius=e}get outerRadius(){return this._outerRadius}set outerRadius(e){this._outerRadius=e}get defaultFill(){return this._defaultFill}set defaultFill(e){this._defaultFill=e}get defaultStroke(){return this._defaultStroke}set defaultStroke(e){this._defaultStroke=e}get disableFill(){return this._disableFill}set disableFill(e){this._disableFill=e}get checkedFill(){return this._checkedFill}set checkedFill(e){this._checkedFill=e}get checkedStroke(){return this._checkedStroke}set checkedStroke(e){this._checkedStroke=e}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(e){this._disableCheckedFill=e}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(e){this._disableCheckedStroke=e}getStyle(e){return new S(e,this)}clone(){return new S(this)}}class R extends _{static get DEFAULT(){return r||(r=new R)}constructor(e={},t={},l={}){var i,n,o,r,a,s,h,d,u,c,g,p,f,C,v,m,b,y;super(e,t),this._spaceBetweenTextAndCircle=(null!=(n=null!=(i=null==e?void 0:e.spaceBetweenTextAndCircle)?i:null==t?void 0:t.spaceBetweenTextAndCircle)?n:null==l?void 0:l.spaceBetweenTextAndCircle)||6,this._circleRadius=(null!=(r=null==(o=null==e?void 0:e.switchStyle)?void 0:o.circleRadius)?r:null==l?void 0:l.circleRadius)||8,this._boxWidth=(null!=(s=null==(a=null==e?void 0:e.switchStyle)?void 0:a.boxWidth)?s:null==l?void 0:l.boxWidth)||40,this._boxHeight=(null!=(d=null==(h=null==e?void 0:e.switchStyle)?void 0:h.boxHeight)?d:null==l?void 0:l.boxHeight)||24,this._checkedFill=(null!=(c=null==(u=null==e?void 0:e.switchStyle)?void 0:u.checkedFill)?c:null==l?void 0:l.checkedFill)||"#165DFF",this._uncheckedFill=(null!=(p=null==(g=null==e?void 0:e.switchStyle)?void 0:g.uncheckedFill)?p:null==l?void 0:l.uncheckedFill)||"#c9cdd4",this._disableCheckedFill=(null!=(C=null==(f=null==e?void 0:e.switchStyle)?void 0:f.disableCheckedFill)?C:null==l?void 0:l.disableCheckedFill)||"#94bfff",this._disableUncheckedFill=(null!=(m=null==(v=null==e?void 0:e.switchStyle)?void 0:v.disableUncheckedFill)?m:null==l?void 0:l.disableUncheckedFill)||"#f2f3f5",this._circleFill=(null!=(y=null==(b=null==e?void 0:e.switchStyle)?void 0:b.circleFill)?y:null==l?void 0:l.circleFill)||"#FFF"}get spaceBetweenTextAndCircle(){return this._spaceBetweenTextAndCircle}set spaceBetweenTextAndCircle(e){this._spaceBetweenTextAndCircle=e}get circleRadius(){return this._circleRadius}set circleRadius(e){this._circleRadius=e}get boxWidth(){return this._boxWidth}set boxWidth(e){this._boxWidth=e}get boxHeight(){return this._boxHeight}set boxHeight(e){this._boxHeight=e}get checkedFill(){return this._checkedFill}set checkedFill(e){this._checkedFill=e}get uncheckedFill(){return this._uncheckedFill}set uncheckedFill(e){this._uncheckedFill=e}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(e){this._disableCheckedFill=e}get disableUncheckedFill(){return this._disableUncheckedFill}set disableUncheckedFill(e){this._disableUncheckedFill=e}get circleFill(){return this._circleFill}set circleFill(e){this._circleFill=e}getStyle(e){return new R(e,this)}clone(){return new R(this)}}class x extends _{static get DEFAULT(){return a||(a=new x)}constructor(e={},t={},l={}){var i,n,o,r,a,s,h,d,u,c,g,p,f,C,v,m,b,y,w,_,M,S;super(e,t),this._buttonColor=(null!=(n=null==(i=null==e?void 0:e.buttonStyle)?void 0:i.buttonColor)?n:null==l?void 0:l.buttonColor)||"#165DFF",this._buttonBorderColor=(null!=(r=null==(o=null==e?void 0:e.buttonStyle)?void 0:o.buttonBorderColor)?r:null==l?void 0:l.buttonBorderColor)||"#165DFF",this._buttonLineWidth=(null!=(s=null==(a=null==e?void 0:e.buttonStyle)?void 0:a.buttonLineWidth)?s:null==l?void 0:l.buttonLineWidth)||1,this._buttonBorderRadius=(null!=(d=null==(h=null==e?void 0:e.buttonStyle)?void 0:h.buttonBorderRadius)?d:null==l?void 0:l.buttonBorderRadius)||2,this._buttonHoverColor=(null!=(c=null==(u=null==e?void 0:e.buttonStyle)?void 0:u.buttonHoverColor)?c:null==l?void 0:l.buttonHoverColor)||"#4080FF",this._buttonHoverBorderColor=(null!=(p=null==(g=null==e?void 0:e.buttonStyle)?void 0:g.buttonHoverBorderColor)?p:null==l?void 0:l.buttonHoverBorderColor)||"#4080FF",this._buttonTextHoverColor=null!=(C=null==(f=null==e?void 0:e.buttonStyle)?void 0:f.buttonTextHoverColor)?C:null==l?void 0:l.buttonTextHoverColor,this._buttonDisableColor=(null!=(m=null==(v=null==e?void 0:e.buttonStyle)?void 0:v.buttonDisableColor)?m:null==l?void 0:l.buttonDisableColor)||"#94bfff",this._buttonDisableBorderColor=(null!=(y=null==(b=null==e?void 0:e.buttonStyle)?void 0:b.buttonDisableBorderColor)?y:null==l?void 0:l.buttonDisableBorderColor)||"#94bfff",this._buttonTextDisableColor=null!=(_=null==(w=null==e?void 0:e.buttonStyle)?void 0:w.buttonTextDisableColor)?_:null==l?void 0:l.buttonTextDisableColor,this._buttonPadding=(null!=(S=null==(M=null==e?void 0:e.buttonStyle)?void 0:M.buttonPadding)?S:null==l?void 0:l.buttonPadding)||10}get buttonColor(){return this._buttonColor}set buttonColor(e){this._buttonColor=e}get buttonBorderColor(){return this._buttonBorderColor}set buttonBorderColor(e){this._buttonBorderColor=e}get buttonLineWidth(){return this._buttonLineWidth}set buttonLineWidth(e){this._buttonLineWidth=e}get buttonBorderRadius(){return this._buttonBorderRadius}set buttonBorderRadius(e){this._buttonBorderRadius=e}get buttonHoverColor(){return this._buttonHoverColor}set buttonHoverColor(e){this._buttonHoverColor=e}get buttonHoverBorderColor(){return this._buttonHoverBorderColor}set buttonHoverBorderColor(e){this._buttonHoverBorderColor=e}get buttonTextHoverColor(){return this._buttonTextHoverColor}set buttonTextHoverColor(e){this._buttonTextHoverColor=e}get buttonDisableColor(){return this._buttonDisableColor}set buttonDisableColor(e){this._buttonDisableColor=e}get buttonDisableBorderColor(){return this._buttonDisableBorderColor}set buttonDisableBorderColor(e){this._buttonDisableBorderColor=e}get buttonTextDisableColor(){return this._buttonTextDisableColor}set buttonTextDisableColor(e){this._buttonTextDisableColor=e}get buttonTextHoverBorderColor(){return this._buttonTextHoverBorderColor}set buttonTextHoverBorderColor(e){this._buttonTextHoverBorderColor=e}get buttonPadding(){return this._buttonPadding}set buttonPadding(e){this._buttonPadding=e}getStyle(e){return new x(e,this)}clone(){return new x(this)}}let{EVENT_TYPE:E}=_;function P(e,t,l,i=_,n,o){var r,a,s,h;return e||t?e instanceof _?e:"function"==typeof e?P(e(l),t,l,i,n,o):(e||(e={}),n&&!(0,v.Z)(e.autoWrapText)&&(e.autoWrapText=!0),i===M?new M(null!=e?e:{},null!=t?t:{},null!=(r=o.checkboxStyle)?r:{}):i===S?new S(null!=e?e:{},null!=t?t:{},null!=(a=o.radioStyle)?a:{}):i===R?new R(null!=e?e:{},null!=t?t:{},null!=(s=o.switchStyle)?s:{}):i===x?new x(null!=e?e:{},null!=t?t:{},null!=(h=o.buttonStyle)?h:{}):new i(null!=e?e:{},null!=t?t:{})):i.DEFAULT}var A=l(974882),T=l(31864),H=l(426902),L=l(135759),F=l(657198),B=l(757886);let I=1;class k{constructor(e,t,l){var i;if(this.resizeTime=100,this.lastSize={width:0,height:0},this.mutationResize=()=>{this.onResize()},this.callBack=()=>{let e=this.getSize(),t=!1;e.width===this.lastSize.width&&e.height===this.lastSize.height&&(t=!0),this.lastSize=e,this.cb&&this.cb(Object.assign(Object.assign({},this.lastSize),{windowSizeNotChange:t}))},this.onResize=()=>{this.callBackDebounce()},this.element=e,this.cb=t,this.lastSize=this.getSize(),l&&(this.resizeTime=Math.max(l,16)),this.callBackDebounce=(0,B.D)(this.callBack,this.resizeTime),null==window||window.addEventListener("resize",this.onResize),"ResizeObserver"in window){let e=window.ResizeObserver;this.observer=new e(this.mutationResize),null==(i=this.observer)||i.observe(this.element)}else"MutationObserver"in window&&(this.observer=new MutationObserver(this.mutationResize),this.observer.observe(this.element,{attributes:!0,attributeFilter:["style"]}))}disConnect(){window.removeEventListener("resize",this.onResize),this.observer&&(this.observer.disconnect(),this.observer=void 0)}setSize(e){this.lastSize=e}checkSize(){let e=this.getSize();return e.width!==this.lastSize.width||e.height!==this.lastSize.height}getSize(){return this.element?{width:Math.floor(this.element.clientWidth),height:Math.floor(this.element.clientHeight)}:Object.assign({},this.lastSize)}}class D{constructor(){this.listeners={},this.reseizeListeners={}}on(e,t,l,...i){if("node"===A.X.mode)return -1;let n=I++;if(null==e?void 0:e.addEventListener)if("resize"!==t||e===window)null==e||e.addEventListener(t,l,...i);else{let t=new k(e,l,this.resizeTime);this.reseizeListeners[n]=t}return this.listeners[n]={target:e,type:t,listener:l,options:i},n}once(e,t,l,...i){if("node"===A.X.mode)return -1;let n=this.on(e,t,(...e)=>{this.off(n),l(...e)},...i);return n}off(e){var t;if("node"===A.X.mode||null===e)return;let l=null==(t=this.listeners)?void 0:t[e];l&&(delete this.listeners[e],l.target.removeEventListener&&l.target.removeEventListener(l.type,l.listener,...l.options))}fire(e,t,...l){if("node"!==A.X.mode)for(let i in this.listeners){let n=this.listeners[i];n.target===e&&n.type===t&&n.listener.call(n.target,...l)}}hasListener(e,t){if("node"===A.X.mode)return!1;let l=!1;for(let i in this.listeners){let n=this.listeners[i];n.target===e&&n.type===t&&(l=!0)}return l}clear(){if("node"!==A.X.mode){for(let e in this.listeners){let t=this.listeners[e];t.target.removeEventListener&&t.target.removeEventListener(t.type,t.listener,...t.options)}for(let e in this.reseizeListeners){let t=this.reseizeListeners[e];null==t||t.disConnect()}this.listeners={}}}release(){"node"!==A.X.mode&&(this.clear(),this.listeners={})}}var O=l(453803),z=l(177629),W=l(75665),N=l(210547),V=l(200063),Z=l(824906),U=l(505850),G=l(474702),j=l(796241),K=l(951130),X=l(115240);function $(e){if(!e.eventManager.bindSparklineHoverEvent)(e.isPivotTable()?e.internalProps.layoutMap.indicatorsDefine.some(e=>"string"!=typeof e&&"sparkline"===e.cellType):e.internalProps.layoutMap.columnObjects.some(e=>"sparkline"===e.cellType||"function"==typeof e.cellType))&&(e.eventManager.bindSparklineHoverEvent=!0,e.on(F.B.MOUSEMOVE_CELL,t=>{let{col:l,row:i,x:n,y:o}=t;"sparkline"!==e.getBodyColumnType(l,i)&&e.stateManager.updateSparklineHoverPose(-1,-1,0,0),e.stateManager.updateSparklineHoverPose(l,i,n,o)}),e.on(F.B.MOUSELEAVE_TABLE,t=>{e.stateManager.updateSparklineHoverPose(-1,-1,0,0)}))}var Y=l(675876),J=l(86380),q=l(839818),Q=l(170559),ee=l(153685),et=l(727594);function el(e,t,l=!0){var i,n,o;let{deltaX:r,deltaY:a}=e;e.shiftKey&&e.deltaY&&(r=a,a=0);let[s,h]=function(e,t,l){var i,n;let o=Math.abs(e/t);return[Math.ceil((o<=.5?0:e)*(null!=(i=l.horizontal)?i:0)),Math.ceil((o>2?0:t)*(null!=(n=l.vertical)?n:0))]}(r,a,{horizontal:1,vertical:1});(s||h)&&t.interactionState!==H.F.scrolling&&t.updateInteractionState(H.F.scrolling);let d="scrolling"===(null==(n=null==(i=t.table.options.theme)?void 0:i.scrollStyle)?void 0:n.visible);s&&(t.setScrollLeft(t.scroll.horizontalBarPos+s,e),t.showHorizontalScrollBar(d)),h&&(t.setScrollTop(t.scroll.verticalBarPos+h,e),t.showVerticalScrollBar(d)),l&&t.resetInteractionState(t.interactionStateBeforeScroll),(null==(o=e.nativeEvent)?void 0:o.cancelable)&&("none"===t.table.internalProps.overscrollBehavior&&(a&&eo(t)||r&&er(t))||Math.abs(a)>=Math.abs(r)&&0!==a&&ei(a,t)||Math.abs(a)<=Math.abs(r)&&0!==r&&en(r,t))&&e.nativeEvent.preventDefault()}function ei(e,t){var l,i;return 0!=t.table.getAllRowsHeight()-t.table.scenegraph.height&&(l=e,0==(i=t).table.getAllRowsHeight()-i.table.scenegraph.height||!(l<=0)||!(i.scroll.verticalBarPos<1))&&!function(e,t){var l;let i=+(null!=(l=t.table.options.customConfig)&&!!l._disableColumnAndRowSizeRound),n=t.table.getAllRowsHeight()-t.table.scenegraph.height;return 0!==n&&e>=0&&Math.abs(t.scroll.verticalBarPos-n)<1+i}(e,t)}function en(e,t){var l,i;return 0!=t.table.getAllColsWidth()-t.table.scenegraph.width&&(l=e,0==(i=t).table.getAllColsWidth()-i.table.scenegraph.width||!(l<=0)||!(i.scroll.horizontalBarPos<1))&&!function(e,t){var l;let i=+(null!=(l=t.table.options.customConfig)&&!!l._disableColumnAndRowSizeRound),n=t.table.getAllColsWidth()-t.table.scenegraph.width;return 0!==n&&e>=0&&Math.abs(t.scroll.horizontalBarPos-n)<1+i}(e,t)}function eo(e){return!(e.table.getAllRowsHeight()-e.table.scenegraph.height<=0)}function er(e){return!(e.table.getAllColsWidth()-e.table.scenegraph.width<=0)}class ea{constructor(e){this.stateManager=e}setScrollHandle(e){this.scrollHandle=e}startInertia(e,t,l){this.lastTime=Date.now(),this.speedX=e,this.speedY=t,this.friction=l,this.runingId||(this.runingId=G.rF.getRequestAnimationFrame()(this.inertia.bind(this)))}inertia(){var e;let t=Date.now(),l=t-this.lastTime,i=!0,n=Math.pow(this.friction,l/16),o=n*this.speedX,r=n*this.speedY,a=0,s=0;Math.abs(o)>.05&&(i=!1,a=(this.speedX+o)/2*l),Math.abs(r)>.05&&(i=!1,s=(this.speedY+r)/2*l),null==(e=this.scrollHandle)||e.call(this,a,s),i?this.runingId=null:(this.lastTime=t,this.speedX=o,this.speedY=r,this.runingId=G.rF.getRequestAnimationFrame()(this.inertia.bind(this)))}endInertia(){G.rF.getCancelAnimationFrame()(this.runingId),this.runingId=null}isInertiaScrolling(){return!!this.runingId}}function es(e,t,l){var i,n,o,r,a,s,h,d;if(t&&-1!==(null==(i=e.stateManager.columnMove)?void 0:i.colSource)&&-1!==(null==(n=e.stateManager.columnMove)?void 0:n.rowSource)&&-1!==(null==(o=e.stateManager.columnMove)?void 0:o.colTarget)&&-1!==(null==(r=e.stateManager.columnMove)?void 0:r.rowTarget)){if(e.hasListeners(F.B.CHANGE_HEADER_POSITION)){let{colSource:t,rowSource:i,colTarget:n,rowTarget:o,movingColumnOrRow:r}=e.stateManager.columnMove,h=null!=(a=e.stateManager.columnMove.rowSourceSize)?a:0,d=null!=(s=e.stateManager.columnMove.rowTargetSize)?s:0;e.fireListeners(F.B.CHANGE_HEADER_POSITION,{target:{col:n,row:o+d-h},source:{col:t,row:i},movingColumnOrRow:r,event:l})}}else if(!t&&e.hasListeners(F.B.CHANGE_HEADER_POSITION_FAIL)){let t=null!=(h=e.stateManager.columnMove.rowSourceSize)?h:0,i=null!=(d=e.stateManager.columnMove.rowTargetSize)?d:0;e.fireListeners(F.B.CHANGE_HEADER_POSITION_FAIL,{target:{col:e.stateManager.columnMove.colTarget,row:e.stateManager.columnMove.rowTarget+i-t},source:{col:e.stateManager.columnMove.colSource,row:e.stateManager.columnMove.rowSource},movingColumnOrRow:e.stateManager.columnMove.movingColumnOrRow,event:l})}}function eh(e){e.stateManager.endResizeCol();let t=[];for(let l=0;l<e.colCount;l++)t.push(e.getColWidth(l));e.fireListeners(F.B.RESIZE_COLUMN_END,{col:e.stateManager.columnResize.col,colWidths:t})}function ed(e){e.stateManager.endResizeRow(),e.fireListeners(F.B.RESIZE_ROW_END,{row:e.stateManager.rowResize.row,rowHeight:e.getRowHeight(e.stateManager.rowResize.row)})}var eu=l(938850),ec=l(859582),eg=function(e,t,l,i){return new(l||(l=Promise))(function(n,o){function r(e){try{s(i.next(e))}catch(e){o(e)}}function a(e){try{s(i.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?n(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(r,a)}s((i=i.apply(e,t||[])).next())})};function ep(e){return!!e.changedTouches}var ef=l(957426);function eC(e,t,l){if(l.indicatorsAsCol){if(l.hasTopIndicatorAxis&&t===l.columnHeaderLevelCount-1&&e>=l.rowHeaderLevelCount&&e<l.colCount-l.rightFrozenColCount)return"top";if(t===l.rowCount-l.bottomFrozenRowCount&&e>=l.rowHeaderLevelCount&&e<l.colCount-l.rightFrozenColCount)return"bottom";if(e===l.rowHeaderLevelCount-1&&t>=l.rowHeaderLevelCount&&t<l.rowCount-l.bottomFrozenRowCount)return"left"}else{if(e===l.rowHeaderLevelCount-1&&t>=l.columnHeaderLevelCount&&t<l.rowCount-l.bottomFrozenRowCount)return"left";if(e===l.colCount-l.rightFrozenColCount&&t>=l.columnHeaderLevelCount&&t<l.rowCount-l.bottomFrozenRowCount)return"right";t===l.rowCount-l.bottomFrozenRowCount&&e>=l.rowHeaderLevelCount&&(l.colCount,l.rightFrozenColCount)}return"bottom"}var ev=l(704654),em=l(876659);function eb(e,t,l,i,n,o,r){var a;let s=r||"_vtable_rowSeries_number",h=t+1;for(;(0,m.Z)(i[h])&&(null==(a=i[h])?void 0:a.length)>l.length;){let t=n.columnHeaderLevelCount+h;n.stateManager.setCheckedState(o,t,s,e),(0,em.r5)(o,t,e,n),h++}}function ey(e,t,l,i,n,o){var r;let a=t.length-1;if(a>0){let t=e-1;for(;a>0&&t>=0;)((0,m.Z)(l[t])&&(null==(r=l[t])?void 0:r.length)===a||1===a&&(0,ev.Z)(l[t]))&&(function(e,t,l,i,n){let{checkedState:o}=i.stateManager,r=l.toString(),a=n||"_vtable_rowSeries_number";(0,m.Z)(l)&&l.length;let s=!1,h=[],d=Array.from(o.keys()).sort((e,t)=>{var l,i;let n=e.split(","),o=t.split(","),r=Math.max(n.length,o.length);for(let e=0;e<r;e++){let t=null!=(l=Number(n[e]))?l:0,r=null!=(i=Number(o[e]))?i:0;if(t!==r)return t-r}return 0}),u=d.map(e=>o.get(e)),c=d.filter(e=>e.startsWith(r+",")&&e!==r);if(u.forEach((e,t)=>{let l=d[t],i=c.includes(l);s&&(i?h.push(e[a]):s=!1),l===r&&(s=!0)}),0===h.length)return;let g=h.every(e=>!!e),p=h.every(e=>!e);g?(i.stateManager.setCheckedState(e,t,a,!0),(0,em.r5)(e,t,!0,i)):p?(i.stateManager.setCheckedState(e,t,a,!1),(0,em.r5)(e,t,!1,i)):(i.stateManager.setCheckedState(e,t,a,"indeterminate"),(0,em.r5)(e,t,"indeterminate",i))}(n,i.columnHeaderLevelCount+t,l[t],i,o),a--),t--}}function ew(e,t,l,i){let{checkedState:n}=l.stateManager,o=t.toString();(0,m.Z)(t)&&t.length;let r=!1,a=Array.from(n.keys()).sort((e,t)=>{var l,i;let n=e.split(","),o=t.split(","),r=Math.max(n.length,o.length);for(let e=0;e<r;e++){let t=null!=(l=Number(n[e]))?l:0,r=null!=(i=Number(o[e]))?i:0;if(t!==r)return t-r}return 0}),s=a.filter(e=>e.startsWith(o+",")&&e!==o);a.map(e=>n.get(e)).forEach((t,l)=>{let n=a[l],h=0!==s.length&&s.includes(n);r&&(h?t[i]=e:r=!1),n===o&&(r=!0)})}function e_(e,t,l){let i=e.getRecordShowIndexByCell(t,l);return e.dataSource.getHierarchyState(i)}var eM=function(e,t,l,i){return new(l||(l=Promise))(function(n,o){function r(e){try{s(i.next(e))}catch(e){o(e)}}function a(e){try{s(i.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?n(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(r,a)}s((i=i.apply(e,t||[])).next())})};class eS{constructor(e){this.isDown=!1,this.isDraging=!1,this.globalEventListeners=[],this._enableTableScroll=!0,this.cutWaitPaste=!1,this.clipboardCheckTimer=null,this.cutOperationTime=0,this.lastClipboardContent="",this.cutCellRange=null,this.copySourceRange=null,this.table=e,this.handleTextStickBindId=[],this.inertiaScroll=new ea(e.stateManager),"node"===A.X.mode||e.options.disableInteraction||(this.bindOuterEvent(),setTimeout(()=>{this.bindSelfEvent()},0))}bindOuterEvent(){(function(e){let t=e.table,l=t.stateManager;t.scenegraph.tableGroup.addEventListener("pointermove",i=>{var n,o,r,a,s,h,d,u,c,g,p,f,C,m,b,y,w,_;let M=null!=(o=null==(n=t.eventManager.LastPointerXY)?void 0:n.x)?o:i.x,S=null!=(a=null==(r=t.eventManager.LastPointerXY)?void 0:r.y)?a:i.y;t.eventManager.LastPointerXY={x:i.x,y:i.y},e.touchSetTimeout&&(clearTimeout(e.touchSetTimeout),e.touchSetTimeout=void 0);let R=(0,Q.RJ)(i);if(R.eventArgs&&t.hasListeners(F.B.MOUSEMOVE_TABLE)&&t.fireListeners(F.B.MOUSEMOVE_TABLE,{col:R.eventArgs.col,row:R.eventArgs.row,x:R.abstractPos.x,y:R.abstractPos.y,event:i.nativeEvent,target:null==(s=null==R?void 0:R.eventArgs)?void 0:s.target,mergeCellInfo:null==(h=R.eventArgs)?void 0:h.mergeInfo}),l.interactionState===H.F.grabing)return void(Math.abs(M-i.x)+Math.abs(S-i.y)>=1&&(l.isResizeCol()||l.isResizeRow()||l.isMoveCol()||(l.isFillHandle()?e.dealFillSelect(R,!0):(null==(d=t.options.select)?void 0:d.disableDragSelect)||e.dealTableSelect(R,!0))));!(null==(u=t.options.select)?void 0:u.disableDragSelect)&&t.eventManager.isDraging&&l.isSelecting()&&!(null==(c=t.editorManager)?void 0:c.editingEditor)&&e.dealTableSelect(R,!0);let x=i.path.find(e=>"cell"===e.role);if(t.hasListeners(F.B.MOUSELEAVE_CELL)&&(-1===t.stateManager.hover.cellPos.col||-1===t.stateManager.hover.cellPos.row||(null==x?void 0:x.col)===t.stateManager.hover.cellPos.col&&(null==x?void 0:x.row)===t.stateManager.hover.cellPos.row||t.fireListeners(F.B.MOUSELEAVE_CELL,{col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row,cellRange:t.getCellRangeRelativeRect({col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:i.nativeEvent,target:null==(g=null==R?void 0:R.eventArgs)?void 0:g.target})),t.hasListeners(F.B.MOUSEENTER_CELL)&&"cell"===(null==x?void 0:x.role)&&(0,v.Z)(x.col)&&(0,v.Z)(x.row)&&(x.col!==t.stateManager.hover.cellPos.col||x.row!==t.stateManager.hover.cellPos.row)&&(x.col!==(null==(p=t.stateManager.hover.cellPosContainHeader)?void 0:p.col)||x.row!==(null==(f=t.stateManager.hover.cellPosContainHeader)?void 0:f.row))&&t.fireListeners(F.B.MOUSEENTER_CELL,{col:x.col,row:x.row,cellRange:t.getCellRangeRelativeRect({col:x.col,row:x.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:i.nativeEvent,target:null==(C=null==R?void 0:R.eventArgs)?void 0:C.target,mergeCellInfo:null==(m=R.eventArgs)?void 0:m.mergeInfo}),e.dealIconHover(R),e.dealTableHover(R),t.theme.columnResize.visibleOnHover&&e.checkColumnResize(R,!0),R.eventArgs&&t.hasListeners(F.B.MOUSEMOVE_CELL)){let e,l;if(null==(b=R.eventArgs)?void 0:b.target){let t=(0,ee.T)(null==(y=R.eventArgs)?void 0:y.target);t&&(e=t.icon,l=t.position)}t.fireListeners(F.B.MOUSEMOVE_CELL,{col:R.eventArgs.col,row:R.eventArgs.row,x:R.abstractPos.x,y:R.abstractPos.y,event:i.nativeEvent,targetIcon:e?{name:e.name,position:l,funcType:e.attribute.funcType}:void 0,target:null==(w=null==R?void 0:R.eventArgs)?void 0:w.target,mergeCellInfo:null==(_=R.eventArgs)?void 0:_.mergeInfo})}}),t.scenegraph.tableGroup.addEventListener("pointerout",t=>{var l;let i=(0,Q.RJ)(t),n=null==(l=null==i?void 0:i.eventArgs)?void 0:l.target;"table"===(null==n?void 0:n.role)&&e.dealTableHover()}),t.scenegraph.tableGroup.addEventListener("pointerover",e=>{var l,i;let n=(0,Q.RJ)(e),o=null==(l=null==n?void 0:n.eventArgs)?void 0:l.target;if(o&&t.hasListeners(F.B.MOUSEOVER_CHART_SYMBOL)&&"symbol"===o.type){let l=e.composedPath().find(e=>"cell"===e.roll);if(l){let{col:o,row:r}=l,a={col:o,row:r,field:t.getHeaderField(o,r),value:t.getCellValue(o,r),dataValue:t.getCellOriginValue(o,r),cellHeaderPaths:t.internalProps.layoutMap.getCellHeaderPaths(o,r),title:t.getBodyColumnDefine(o,r).title,cellRange:t.getCellRelativeRect(o,r),event:e.nativeEvent,sparkline:{pointData:void 0},scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,target:null==(i=null==n?void 0:n.eventArgs)?void 0:i.target};t.fireListeners(F.B.MOUSEOVER_CHART_SYMBOL,a)}}}),t.scenegraph.tableGroup.addEventListener("pointerenter",e=>{(t.theme.scrollStyle.horizontalVisible&&"focus"===t.theme.scrollStyle.horizontalVisible||!t.theme.scrollStyle.horizontalVisible&&"focus"===t.theme.scrollStyle.visible)&&l.showHorizontalScrollBar(),(t.theme.scrollStyle.verticalVisible&&"focus"===t.theme.scrollStyle.verticalVisible||!t.theme.scrollStyle.verticalVisible&&"focus"===t.theme.scrollStyle.visible)&&l.showVerticalScrollBar(),t.hasListeners(F.B.MOUSEENTER_TABLE)&&t.fireListeners(F.B.MOUSEENTER_TABLE,{event:e.nativeEvent})}),t.scenegraph.tableGroup.addEventListener("pointerleave",i=>{l.isResizeCol()||l.isResizeRow()||l.isMoveCol()||l.isSelecting()||(l.updateInteractionState(H.F.default),l.updateCursor()),(t.theme.scrollStyle.horizontalVisible&&"focus"===t.theme.scrollStyle.horizontalVisible||!t.theme.scrollStyle.horizontalVisible&&"focus"===t.theme.scrollStyle.visible)&&l.hideHorizontalScrollBar(),(t.theme.scrollStyle.verticalVisible&&"focus"===t.theme.scrollStyle.verticalVisible||!t.theme.scrollStyle.verticalVisible&&"focus"===t.theme.scrollStyle.visible)&&l.hideVerticalScrollBar(),t.hasListeners(F.B.MOUSELEAVE_CELL)&&-1!==t.stateManager.hover.cellPos.col&&-1!==t.stateManager.hover.cellPos.row&&t.fireListeners(F.B.MOUSELEAVE_CELL,{col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row,cellRange:t.getCellRangeRelativeRect({col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:i.nativeEvent,target:void 0}),e.dealTableHover();let n=i.target;n&&!n.isDescendantsOf(t.scenegraph.tableGroup)&&t.fireListeners(F.B.MOUSELEAVE_TABLE,{event:i.nativeEvent})}),t.scenegraph.tableGroup.addEventListener("pointerdown",i=>{var n,o,r,a,s;if(t.hasListeners(F.B.MOUSEDOWN_TABLE)&&t.fireListeners(F.B.MOUSEDOWN_TABLE,{event:i.nativeEvent}),(0,A.u)(),t.eventManager.isDown=!0,t.eventManager.LastBodyPointerXY={x:i.x,y:i.y},t.eventManager.LastPointerXY={x:i.x,y:i.y},0!==i.button)return;let h=(0,Q.RJ)(i);if(e.downIcon=void 0,l.interactionState!==H.F.default||(t.isPivotChart()&&"chart"!==(null==(n=null==h?void 0:h.eventArgs)?void 0:n.target.type)&&t.scenegraph.updateChartState(null),(null==(o=h.eventArgs)?void 0:o.target)!==(null==(r=l.residentHoverIcon)?void 0:r.icon)&&l.hideMenu(),"chart"===(null==(a=null==h?void 0:h.eventArgs)?void 0:a.target.type)))return;let d=null==(s=t.editorManager)?void 0:s.completeEdit(i.nativeEvent);(0,L.NC)(d,n=>{var o,r,a,s,d,u,c,g,p,f,C,m;if(!(null==(o=t.options.customConfig)?void 0:o.selectCellWhenCellEditorNotExists)&&!1===n)return;let b=(null==(s=null==(a=null==(r=null==h?void 0:h.eventArgs)?void 0:r.target)?void 0:a.role)?void 0:s.startsWith("icon"))?h.eventArgs.target:(null==(d=i.target.role)?void 0:d.startsWith("icon"))?i.target:void 0;if(e.downIcon=b,b&&!1!==b.attribute.interactive)b.attribute.funcType===q.cI.dragReorder&&(l.startMoveCol(h.eventArgs.col,h.eventArgs.row,h.abstractPos.x,h.abstractPos.y,null==(C=null==(f=h.eventArgs)?void 0:f.event)?void 0:C.nativeEvent),l.updateInteractionState(H.F.grabing));else{if(e.cellIsHeaderCheck(h))return;if("touch"===i.pointerType){if(e.touchEnd=!1,e.touchSetTimeout=setTimeout(()=>{e.isTouchdown=!1,e.isLongTouch=!0,!e.touchEnd&&(e.checkColumnResize(h,!0)||e.checkRowResize(h,!0))||!e.touchEnd&&e.checkColumnMover(h)?l.updateInteractionState(H.F.grabing):e.dealTableSelect(h)&&!e.touchEnd&&l.updateInteractionState(H.F.grabing)},500),t.hasListeners(F.B.MOUSEENTER_CELL)){let e=i.path.find(e=>"cell"===e.role);"cell"===(null==e?void 0:e.role)&&(0,v.Z)(e.col)&&(0,v.Z)(e.row)&&(e.col!==t.stateManager.hover.cellPos.col||e.row!==t.stateManager.hover.cellPos.row)&&(e.col!==(null==(u=t.stateManager.hover.cellPosContainHeader)?void 0:u.col)||e.row!==(null==(c=t.stateManager.hover.cellPosContainHeader)?void 0:c.row))&&t.fireListeners(F.B.MOUSEENTER_CELL,{col:e.col,row:e.row,cellRange:t.getCellRangeRelativeRect({col:e.col,row:e.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:i.nativeEvent,target:null==(g=null==h?void 0:h.eventArgs)?void 0:g.target,mergeCellInfo:null==(p=h.eventArgs)?void 0:p.mergeInfo})}e.dealTableHover(h)}else{if(!e.checkCellFillhandle(h)&&(e.checkColumnResize(h,!0)||e.checkRowResize(h,!0)))return t.scenegraph.updateChartState(null),void l.updateInteractionState(H.F.grabing);if(e.checkColumnMover(h)||e.checkCellFillhandle(h,!0)&&e.dealFillSelect(h))return void l.updateInteractionState(H.F.grabing);e.dealTableSelect(h)&&l.updateInteractionState(H.F.grabing)}}if(t.hasListeners(F.B.MOUSEDOWN_CELL)){let e=(0,Q.RJ)(i);e.eventArgs&&t.fireListeners(F.B.MOUSEDOWN_CELL,{col:e.eventArgs.col,row:e.eventArgs.row,event:i.nativeEvent,target:null==(m=null==e?void 0:e.eventArgs)?void 0:m.target,mergeCellInfo:e.eventArgs.mergeInfo})}})}),t.scenegraph.tableGroup.addEventListener("pointerup",i=>{var n,o,r,a,s,h,d,u;if(0===i.button){if("grabing"===l.interactionState){if(l.updateInteractionState(H.F.default),l.isResizeCol())eh(t);else if(l.isResizeRow())ed(t);else if(l.isMoveCol()){let e=t.stateManager.endMoveCol();es(t,e,i.nativeEvent)}else if(l.isSelecting()){t.stateManager.endSelectCells(),t.stateManager.isFillHandle()&&t.stateManager.endFillSelect();let e=(0,Q.RJ)(i);if(t.eventManager.isDraging&&e.eventArgs&&t.hasListeners(F.B.DRAG_SELECT_END)){let l={event:i.nativeEvent,cells:[],col:e.eventArgs.target.col,row:e.eventArgs.target.row,scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,target:null==(n=null==e?void 0:e.eventArgs)?void 0:n.target,mergeCellInfo:null==(o=e.eventArgs)?void 0:o.mergeInfo};l.cells=t.getSelectedCellInfos(),t.fireListeners(F.B.DRAG_SELECT_END,l)}}}else l.interactionState===H.F.scrolling&&l.updateInteractionState(H.F.default);if(!t.eventManager.isDraging){let l=(0,Q.RJ)(i);if(!e.isTouchMove&&0===i.button&&l.eventArgs&&t.hasListeners(F.B.CLICK_CELL)){let e,n,{col:o,row:d}=l.eventArgs,u=t.getCellInfo(o,d);if(null==(r=l.eventArgs)?void 0:r.target){let t=(0,ee.T)(null==(a=l.eventArgs)?void 0:a.target);t&&(e=t.icon,n=t.position)}let c=Object.assign(Object.assign({},u),{event:i.nativeEvent,federatedEvent:i,cells:[],targetIcon:e?{name:e.name,position:n,funcType:e.attribute.funcType}:void 0,target:null==(s=null==l?void 0:l.eventArgs)?void 0:s.target,mergeCellInfo:null==(h=l.eventArgs)?void 0:h.mergeInfo});t.fireListeners(F.B.CLICK_CELL,c)}}if(t.hasListeners(F.B.MOUSEUP_CELL)){let e=(0,Q.RJ)(i);e.eventArgs&&t.fireListeners(F.B.MOUSEUP_CELL,{col:e.eventArgs.col,row:e.eventArgs.row,event:i.nativeEvent,target:null==(d=null==e?void 0:e.eventArgs)?void 0:d.target,mergeCellInfo:null==(u=e.eventArgs)?void 0:u.mergeInfo})}setTimeout(()=>{e.isDown=!1,e.isTouchdown=!1,e.isTouchMove=!1,e.isDraging=!1,e.touchMovePoints=[]},0)}}),t.scenegraph.tableGroup.addEventListener("rightdown",e=>{var i,n,o,r,a,s,h;let d=(0,Q.RJ)(e);if(d.eventArgs){l.triggerContextMenu(d.eventArgs.col,d.eventArgs.row,d.abstractPos.x,d.abstractPos.y);let{col:u,row:c}=d.eventArgs;if(u>=0&&c>=0){let l=t.getSelectedCellRanges(),g=!1;if(l.length>0)for(let e=0;e<l.length;e++){let t=l[e],i=t.start.col,n=t.end.col,o=t.start.row,r=t.end.row;if(u>=i&&u<=n&&c>=o&&c<=r||u>=n&&u<=i&&c>=r&&c<=o||u>=i&&u<=n&&c>=r&&c<=o||u>=n&&u<=i&&c>=o&&c<=r){g=!0;break}}let p=null==(i=t.options.select)?void 0:i.disableSelectOnContextMenu;if(g||p||t.selectCell(u,c),t.hasListeners(F.B.CONTEXTMENU_CELL)){let l,i,g=t.getCellInfo(u,c);if(null==(n=d.eventArgs)?void 0:n.target){let e=(0,ee.T)(null==(o=d.eventArgs)?void 0:o.target);e&&(l=e.icon,i=e.position)}let p=Object.assign(Object.assign({},g),{event:e.nativeEvent,cells:[],targetIcon:l?{name:l.name,position:i,funcType:l.attribute.funcType}:void 0,target:null==(r=null==d?void 0:d.eventArgs)?void 0:r.target,mergeCellInfo:null==(a=d.eventArgs)?void 0:a.mergeInfo});(null==(h=null==(s=t.options.eventOptions)?void 0:s.contextmenuReturnAllSelectedCells)||h)&&((0,L.yD)(t.stateManager.select.ranges,u,c)?p.cells=t.getSelectedCellInfos():p.cells=[[g]]),t.fireListeners(F.B.CONTEXTMENU_CELL,p)}}}}),t.scenegraph.tableGroup.addEventListener("pointertap",i=>{var n;if(t.stateManager.columnResize.resizing)return;let o=(0,Q.RJ)(i);if(!t.stateManager.columnResize.resizing&&!t.stateManager.columnMove.moving&&(e.dealIconClick(i,o),(null==o?void 0:o.eventArgs)&&e.touchSetTimeout&&"touch"===i.pointerType)){let t=(0,Q.RJ)(i);if(e.touchSetTimeout){clearTimeout(e.touchSetTimeout);let i=!!(null==(n=l.select.ranges)?void 0:n.length);e.dealTableSelect(t),l.endSelectCells(!0,i),e.touchSetTimeout=void 0}}}),t.scenegraph.stage.addEventListener("pointerdown",i=>{var n,o,r,a;let s=(0,Q.RJ)(i);(null==(n=s.eventArgs)?void 0:n.target)&&(null==(o=s.eventArgs)?void 0:o.target)===(null==(r=l.residentHoverIcon)?void 0:r.icon)||l.hideMenu();let h=!1,d=i.target;d===t.scenegraph.tableGroup||d.isDescendantsOf(t.scenegraph.tableGroup)||(h=null==(a=t.editorManager)?void 0:a.completeEdit(i.nativeEvent)),(0,L.NC)(h,n=>{var o,r;if(!(null==(o=t.options.customConfig)?void 0:o.selectCellWhenCellEditorNotExists)&&!1===n)return;let a=(null==(r=i.target.role)?void 0:r.startsWith("icon"))?i.target:void 0;if(e.downIcon=a,"touch"===i.pointerType||a||e.checkCellFillhandle(s)||l.columnResize.resizing||!e.checkColumnResize(s,!0));else{t.scenegraph.updateChartState(null),l.updateInteractionState(H.F.grabing);let{eventArgs:e}=s;!(null==e?void 0:e.targetCell)&&t.getCellAt(s.abstractPos.x-t.theme.columnResize.resizeHotSpotSize/2,s.abstractPos.y)&&t.hasListeners(F.B.MOUSEDOWN_TABLE)&&t.fireListeners(F.B.MOUSEDOWN_TABLE,{event:i.nativeEvent})}})}),t.scenegraph.stage.addEventListener("pointerup",e=>{"grabing"===l.interactionState&&(l.updateInteractionState(H.F.default),l.isResizeCol()?eh(t):l.isResizeRow()&&ed(t))}),t.scenegraph.stage.addEventListener("pointertap",i=>{var n,o,r,a,s;let h=i.target;if(t.eventManager.isDraging||!h||!h.isDescendantsOf(t.scenegraph.stage)&&h.stage!==h||h.isDescendantsOf(t.scenegraph.tableGroup))t.eventManager.isDraging&&l.isSelecting()&&l.endSelectCells();else{l.updateInteractionState(H.F.default),e.dealTableHover();let h=!!(null==(n=l.select.ranges)?void 0:n.length);(null==(o=t.options.customConfig)?void 0:o.cancelSelectCellHook)?(null==(r=t.options.customConfig)?void 0:r.cancelSelectCellHook(i))&&e.dealTableSelect():(null==(s=null==(a=t.options.select)?void 0:a.blankAreaClickDeselect)||s)&&e.dealTableSelect(),l.endSelectCells(!0,h),l.updateCursor(),t.scenegraph.updateChartState(null)}}),t.scenegraph.stage.addEventListener("pointermove",i=>{var n,o,r;let a=(0,Q.RJ)(i);null!=(r=null==(o=null==(n=i.target)?void 0:n.isDescendantsOf)?void 0:o.call(n,t.scenegraph.tableGroup))&&r&&(l.isResizeCol()||e.checkColumnResize(a)?t.stateManager.select&&e.checkCellFillhandle(a)?l.updateCursor("crosshair"):l.updateCursor("col-resize"):l.isResizeRow()||e.checkRowResize(a)?t.stateManager.select&&e.checkCellFillhandle(a)?l.updateCursor("crosshair"):l.updateCursor("row-resize"):l.isMoveCol()||l.updateCursor())}),t.scenegraph.tableGroup.addEventListener("checkbox_state_change",e=>{var l,i;let n=(0,Q.RJ)(e),{col:o,row:r}=n.eventArgs,a=t.getCellInfo(o,r),s=(0,et.Z)(t,o,r);if(s)for(let l=s.start.col;l<=s.end.col;l++)for(let i=s.start.row;i<=s.end.row;i++)t.scenegraph.getCell(l,i).forEachChildren(t=>{"checkbox"===t.name&&t.setAttributes({checked:e.target.attribute.checked,indeterminate:e.target.attribute.indeterminate})});let h=Object.assign(Object.assign({},a),{event:e.nativeEvent,target:null==(l=null==n?void 0:n.eventArgs)?void 0:l.target,mergeCellInfo:null==(i=null==n?void 0:n.eventArgs)?void 0:i.mergeInfo,checked:e.detail.checked});if(t.isHeader(o,r))t.stateManager.setHeaderCheckedState(a.field,e.detail.checked),t.internalProps.enableHeaderCheckboxCascade&&"checkbox"===t.getCellType(o,r)&&t.scenegraph.updateCheckboxCellState(o,r,e.detail.checked);else if(t.stateManager.setCheckedState(o,r,a.field,e.detail.checked),t.internalProps.enableCheckboxCascade&&"checkbox"===t.getCellType(o,r)){let e=t.stateManager.headerCheckedState[a.field],l=t.stateManager.updateHeaderCheckedState(a.field,o,r);e!==l&&t.scenegraph.updateHeaderCheckboxCellState(o,r,l)}t.fireListeners(F.B.CHECKBOX_STATE_CHANGE,h),t.scenegraph.updateNextFrame()}),t.scenegraph.tableGroup.addEventListener("radio_checked",e=>{var l,i,n;let o=(0,Q.RJ)(e),{col:r,row:a,target:s}=o.eventArgs,h=t.getCellInfo(r,a),d=null==(l=Q.xD.exec(s.id))?void 0:l[1],u=(0,et.Z)(t,r,a);if(u)for(let e=u.start.col;e<=u.end.col;e++)for(let l=u.start.row;l<=u.end.row;l++)t.scenegraph.getCell(e,l).forEachChildren(e=>{"radio"===e.name&&e.id===s.id&&e.setAttributes({checked:!0})});let c=t.getBodyColumnDefine(r,a).radioCheckType||"column";if("cell"===c)if(u)for(let e=u.start.col;e<=u.end.col;e++)for(let l=u.start.row;l<=u.end.row;l++)t.scenegraph.getCell(e,l).forEachChildren(e=>{"radio"===e.name&&e.id!==s.id&&e.setAttributes({checked:!1})});else t.scenegraph.getCell(r,a).forEachChildren(e=>{"radio"===e.name&&e.id!==s.id&&e.setAttributes({checked:!1})});else"column"===c&&t.scenegraph.getColGroup(r).forEachChildren(e=>{e.forEachChildren(e=>{"radio"===e.name&&e.id!==s.id&&e.setAttributes({checked:!1})})});let g=d?Number(d):void 0;t.stateManager.setRadioState(r,a,h.field,c,g);let p=Object.assign(Object.assign({},h),{event:e.nativeEvent,target:null==(i=null==o?void 0:o.eventArgs)?void 0:i.target,mergeCellInfo:null==(n=null==o?void 0:o.eventArgs)?void 0:n.mergeInfo,radioIndexInCell:g});t.fireListeners(F.B.RADIO_STATE_CHANGE,p),t.scenegraph.updateNextFrame()}),t.scenegraph.tableGroup.addEventListener("switch_state_change",e=>{var l,i;let n=(0,Q.RJ)(e),{col:o,row:r,target:a}=n.eventArgs,s=t.getCellInfo(o,r),h=(0,et.Z)(t,o,r);if(h)for(let l=h.start.col;l<=h.end.col;l++)for(let i=h.start.row;i<=h.end.row;i++)t.scenegraph.getCell(l,i).forEachChildren(t=>{"switch"===t.name&&t.setAttributes({checked:e.target.attribute.checked})});let d=Object.assign(Object.assign({},s),{event:e.nativeEvent,target:null==(l=null==n?void 0:n.eventArgs)?void 0:l.target,mergeCellInfo:null==(i=null==n?void 0:n.eventArgs)?void 0:i.mergeInfo,checked:e.detail.checked});t.stateManager.setCheckedState(o,r,s.field,e.detail.checked),t.fireListeners(F.B.SWITCH_STATE_CHANGE,d),t.scenegraph.updateNextFrame()}),t.scenegraph.stage.addEventListener("wheel",e=>{var i;e.path.find(e=>"legend"===e.name)||(null==(i=t.editorManager)||i.completeEdit(),t.eventManager._enableTableScroll&&el(e,l))})})(this),function(e){let t=e.table,l=t.stateManager,i=t.internalProps.handler;function n(e){var l;if(t.hasListeners(F.B.KEYDOWN)){let i={keyCode:null!=(l=e.keyCode)?l:e.which,code:e.code,event:e,scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth};t.fireListeners(F.B.KEYDOWN,i)}}i.on(t.getElement(),"blur",l=>{var i;let n=l.relatedTarget;if(n){let e=t.stateManager.select.ranges,l=1===e.length&&e[0].start.col===e[0].end.col&&e[0].start.row===e[0].end.row&&t.getEditor(t.stateManager.select.cellPos.col,t.stateManager.select.cellPos.row);if((null==(i=null==l?void 0:l.getInputElement)?void 0:i.call(l))===n)return}e.dealTableHover()}),i.on(t.getElement(),"keydown",i=>{var o,r,a,s,h,d,u,c,g,p,f,C,v,m,b,y,w,_,M,S,R,x,E,P,A,T,H,L,B,I,k,D,O,z;let W={keyCode:null!=(o=i.keyCode)?o:i.which,code:i.code,event:i};if(t.fireListeners(F.B.BEFORE_KEYDOWN,W),"a"===i.key&&(i.ctrlKey||i.metaKey))(null==(r=t.keyboardOptions)?void 0:r.selectAllOnCtrlA)&&(i.preventDefault(),e.deelTableSelectAll());else if(l.select.cellPos.col>=0&&l.select.cellPos.row>=0&&("ArrowUp"===i.key||"ArrowDown"===i.key||"ArrowLeft"===i.key||"ArrowRight"===i.key)){let e,n;if((null==(s=null==(a=t.options.keyboardOptions)?void 0:a.moveEditCellOnArrowKeys)||!s)&&(null==(h=t.editorManager)?void 0:h.editingEditor)||!1===(null==(d=t.options.keyboardOptions)?void 0:d.moveSelectedCellOnArrowKeys)||(i.preventDefault(),i.stopPropagation(),"ArrowUp"===i.key?i.ctrlKey||i.metaKey?(e=l.select.cellPos.col,n=0):(i.shiftKey,e=l.select.cellPos.col,n=Math.min(t.rowCount-1,Math.max(0,l.select.cellPos.row-1))):"ArrowDown"===i.key?i.ctrlKey||i.metaKey?(e=l.select.cellPos.col,n=t.rowCount-1):(i.shiftKey,e=l.select.cellPos.col,n=Math.min(t.rowCount-1,Math.max(0,l.select.cellPos.row+1))):"ArrowLeft"===i.key?i.ctrlKey||i.metaKey?(e=0,n=l.select.cellPos.row):(i.shiftKey,n=l.select.cellPos.row,e=Math.min(t.colCount-1,Math.max(0,l.select.cellPos.col-1))):"ArrowRight"===i.key&&(i.ctrlKey||i.metaKey?(e=t.colCount-1,n=l.select.cellPos.row):(i.shiftKey,n=l.select.cellPos.row,e=Math.min(t.colCount-1,Math.max(0,l.select.cellPos.col+1)))),(0,ec.wP)(t,e,n)))return;let o=!!(null==(u=t.editorManager)?void 0:u.editingEditor);null==(c=t.editorManager)||c.completeEdit(),t.getElement().focus();let r=null==(p=null==(g=t.options.keyboardOptions)?void 0:g.shiftMultiSelect)||p;t.selectCell(e,n,i.shiftKey&&r),null!=(C=null==(f=t.options.keyboardOptions)?void 0:f.moveEditCellOnArrowKeys)&&C&&o&&t.getEditor(e,n)&&(null==(v=t.editorManager)||v.startEditCell(e,n))}else if("Escape"===i.key)null==(m=t.editorManager)||m.cancelEdit(),t.getElement().focus();else if("Enter"===i.key){if(null==(b=t.editorManager)?void 0:b.editingEditor){if(n(i),null==(y=t.editorManager)||y.completeEdit(),t.getElement().focus(),!0===(null==(w=t.options.keyboardOptions)?void 0:w.moveFocusCellOnEnter)){let e=l.select.cellPos.col,n=Math.min(t.rowCount-1,Math.max(0,l.select.cellPos.row+1));if((0,ec.wP)(t,e,n))return;let o=null==(M=null==(_=t.options.keyboardOptions)?void 0:_.shiftMultiSelect)||M;t.selectCell(e,n,i.shiftKey&&o)}return}if(!0===(null==(S=t.options.keyboardOptions)?void 0:S.moveFocusCellOnEnter)){let e=l.select.cellPos.col,n=Math.min(t.rowCount-1,Math.max(0,l.select.cellPos.row+1));if((0,ec.wP)(t,e,n))return;let o=null==(x=null==(R=t.options.keyboardOptions)?void 0:R.shiftMultiSelect)||x;t.selectCell(e,n,i.shiftKey&&o)}else if((null==(P=null==(E=t.options.keyboardOptions)?void 0:E.editCellOnEnter)||P)&&1===(null!=(T=null==(A=t.stateManager.select.ranges)?void 0:A.length)?T:0)){let e=t.stateManager.select.ranges[0].start.col,l=t.stateManager.select.ranges[0].start.row,i=t.stateManager.select.ranges[0].end.col,n=t.stateManager.select.ranges[0].end.row;e===i&&l===n&&t.getEditor(e,l)&&(null==(H=t.editorManager)||H.startEditCell(e,l))}}else if("Tab"===i.key){if((null==(B=null==(L=t.options.keyboardOptions)?void 0:L.moveFocusCellOnTab)||B)&&l.select.cellPos.col>=0&&l.select.cellPos.row>=0){let e,n;if(l.select.cellPos.col===t.colCount-1&&l.select.cellPos.row===t.rowCount-1||(i.preventDefault(),l.select.cellPos.col===t.colCount-1?(n=Math.min(t.rowCount-1,l.select.cellPos.row+1),e=t.rowHeaderLevelCount):(n=l.select.cellPos.row,e=l.select.cellPos.col+1),(0,ec.wP)(t,e,n)))return;let o=!!(null==(I=t.editorManager)?void 0:I.editingEditor);null==(k=t.editorManager)||k.completeEdit(),t.getElement().focus(),t.selectCell(e,n),o&&t.getEditor(e,n)&&(null==(D=t.editorManager)||D.startEditCell(e,n))}}else if(!i.ctrlKey&&!i.metaKey){let e=t.options.editCellTrigger,n=t.stateManager.select.ranges;1===n.length&&n[0].start.col===n[0].end.col&&n[0].start.row===n[0].end.row&&("keydown"===e||Array.isArray(e)&&e.includes("keydown"))&&!(null==(O=t.editorManager)?void 0:O.editingEditor)&&i.key.match(/^[a-zA-Z0-9+\-*\/%=.,\s]$/)&&(t.editorManager&&(t.editorManager.beginTriggerEditCellMode="keydown"),null==(z=t.editorManager)||z.startEditCell(l.select.cellPos.col,l.select.cellPos.row,""))}n(i)}),i.on(t.getElement(),"copy",l=>eg(this,void 0,void 0,function*(){var i;(null==(i=t.keyboardOptions)?void 0:i.copySelected)&&e.handleCopy(l)})),i.on(t.getElement(),"cut",l=>eg(this,void 0,void 0,function*(){var i;(null==(i=t.keyboardOptions)?void 0:i.cutSelected)&&e.handleCut(l)})),i.on(t.getElement(),"paste",l=>eg(this,void 0,void 0,function*(){var i;(null==(i=t.keyboardOptions)?void 0:i.pasteValueToCell)&&e.handlePaste(l)})),i.on(t.getElement(),"contextmenu",e=>{var l;!1!==(null==(l=t.eventOptions)?void 0:l.preventDefaultContextMenu)?e.preventDefault():r(e)}),t.options.canvas||i.on(t.getContainer(),"resize",e=>{var l;t.isReleased||0===e.width&&0===e.height||((t.autoFillWidth||t.autoFillHeight||"adaptive"===t.widthMode||"adaptive"===t.heightMode)&&(null==(l=t.editorManager)||l.completeEdit()),(0,v.Z)(t.options.pixelRatio)||t.setPixelRatio((0,eu.m)()),e.windowSizeNotChange||t.resize())});let o=i=>{var n;if(t.isReleased)return;t.eventManager.LastBodyPointerXY={x:i.x,y:i.y},t.eventManager.isDown=!0;let o=i.target;if(!t.getElement().contains(o)&&!t.internalProps.menuHandler.containElement(o)){let o=null==(n=t.editorManager)?void 0:n.completeEdit(i);(0,L.NC)(o,i=>{var n,o;if(!1!==i&&(null==(n=t.options.select)?void 0:n.outsideClickDeselect)){let t=!!(null==(o=l.select.ranges)?void 0:o.length);e.dealTableSelect(),l.endSelectCells(!0,t)}})}};e.globalEventListeners.push({name:"pointerdown",env:"vglobal",callback:o}),G.rF.addEventListener("pointerdown",o);let r=i=>{var n,o;if(t.isReleased)return;let r=i.target;if(r!==t.canvas&&(e=>{var i,n;if(l.menu.isShow&&setTimeout(()=>{t.internalProps.menuHandler.pointInMenuElement(e.clientX,e.clientY)||l.menu.isShow&&l.hideMenu()},0),l.isResizeCol())eh(t);else if(l.isResizeRow())ed(t);else if(l.isMoveCol()){let l=t.stateManager.endMoveCol();es(t,l,e)}else if(l.isSelecting()&&(null==(n=null==(i=t.stateManager.select)?void 0:i.ranges)?void 0:n.length)){let l=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].end.col,i=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].end.row;if(t.stateManager.endSelectCells(),t.hasListeners(F.B.DRAG_SELECT_END)){let n={event:e,cells:[],col:l,row:i,scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,target:void 0};n.cells=t.getSelectedCellInfos(),t.fireListeners(F.B.DRAG_SELECT_END,n)}}})(i),t.eventManager.LastBodyPointerXY=null,t.eventManager.isDown=!1,t.eventManager.isDraging=!1,t.eventManager.inertiaScroll.endInertia(),"grabing"===l.interactionState&&l.isResizeCol())eh(t);else if("grabing"===l.interactionState&&l.isResizeRow())ed(t);else if(l.isMoveCol()){let e=t.stateManager.endMoveCol();es(t,e,i)}else if((null==(n=t.editorManager)?void 0:n.editingEditor)&&!t.getElement().contains(r)){let n=null==(o=t.editorManager)?void 0:o.completeEdit(i);(0,L.NC)(n,t=>{!1!==t&&(l.updateInteractionState(H.F.default),e.dealTableHover())})}l.updateInteractionState(H.F.default)};e.globalEventListeners.push({name:"pointerup",env:"vglobal",callback:r}),G.rF.addEventListener("pointerup",r);let a=i=>{var n,o,r,a,s;if(t.eventManager.isDown&&t.eventManager.LastBodyPointerXY){let e=null!=(o=null==(n=t.eventManager.LastBodyPointerXY)?void 0:n.x)?o:i.x,l=null!=(a=null==(r=t.eventManager.LastBodyPointerXY)?void 0:r.y)?a:i.y;(Math.abs(e-i.x)>1||Math.abs(l-i.y)>1)&&(t.eventManager.isDraging=!0)}let{x:h,y:d}=t._getMouseAbstractPoint(i);l.interactionState===H.F.grabing&&(l.isResizeCol()?(e.dealColumnResize(h,d),t.hasListeners(F.B.RESIZE_COLUMN)&&t.fireListeners(F.B.RESIZE_COLUMN,{col:t.stateManager.columnResize.col,colWidth:t.getColWidth(t.stateManager.columnResize.col)})):l.isResizeRow()?(e.dealRowResize(h,d),t.hasListeners(F.B.RESIZE_ROW)&&t.fireListeners(F.B.RESIZE_ROW,{row:t.stateManager.rowResize.row,rowHeight:t.getRowHeight(t.stateManager.rowResize.row)})):l.isMoveCol()&&e.dealColumnMover(h,d,i));let u=t.stateManager.isSelecting();if(e._enableTableScroll&&e.isDraging&&u&&(null==(s=t.stateManager.select.ranges)?void 0:s.length)>0){let e=t.getDrawRange(),l=t.getFrozenRowsHeight(),i=t.getBottomFrozenRowsHeight(),n=t.getFrozenColsWidth(),o=t.getRightFrozenColsWidth(),r=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].start;if(t.isSeriesNumber(r.col,r.row))return;let a=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].end,s=(!1===t.isFrozenRow(r.row)||!1===t.isFrozenRow(a.row))&&t.getAllRowsHeight()>t.tableNoFrameHeight,u=(!1===t.isFrozenColumn(r.col)||!1===t.isFrozenColumn(a.col))&&t.getAllColsWidth()>t.tableNoFrameWidth;if((d>e.bottom-i||d<e.top+l)&&s||(h>e.right-o||h<e.left+n)&&u){t.eventManager.scrollXSpeed=0,t.eventManager.scrollYSpeed=0;let r=!1,a=!1,c=!1,g=!1;d>e.bottom-i&&s&&t.scrollTop+t.tableNoFrameHeight<t.getAllRowsHeight()?(r=!0,t.eventManager.scrollYSpeed=-(d-e.bottom+i)/50):d<e.top+l&&s&&t.scrollTop>0&&(a=!0,t.eventManager.scrollYSpeed=-(d-e.top-l)/50),h>e.right-o&&u&&t.scrollLeft+t.tableNoFrameWidth<t.getAllColsWidth()?(c=!0,t.eventManager.scrollXSpeed=-(h-e.right+o)/50):h<e.left+n&&u&&t.scrollLeft>0&&(g=!0,t.eventManager.scrollXSpeed=-(h-e.left-n)/50),t.eventManager.inertiaScroll.startInertia(t.eventManager.scrollXSpeed,t.eventManager.scrollYSpeed,1),t.eventManager.inertiaScroll.setScrollHandle((s,u)=>{var p;let f,C;el({deltaX:-s,deltaY:-u},t.stateManager,!1),r?C=t.scrollTop+e.height-i-20:a&&(C=t.scrollTop+l+20),c?f=t.scrollLeft+e.width-o-20:g&&(f=t.scrollLeft+n+20);let m=!1,b=!1;c||g||(h>t.tableNoFrameWidth-t.getRightFrozenColsWidth()&&h<t.tableNoFrameWidth||h>0&&h<t.getFrozenColsWidth()?(f=h,b=!0):f=t.scrollLeft+h),r||a||(d>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight()&&d<t.tableNoFrameHeight||d>0&&d<t.getFrozenRowsHeight()?(C=d,m=!0):C=t.scrollTop+d),t.stateManager.updateInteractionState(H.F.grabing);let y=t.getTargetColAtConsiderRightFrozen(f,b),w=t.getTargetRowAtConsiderBottomFrozen(C,m);!(null==(p=t.options.select)?void 0:p.disableDragSelect)&&(0,v.Z)(y)&&(0,v.Z)(w)&&t.stateManager.updateSelectPos("row"===t.stateManager.select.selectInline?t.colCount-1:y.col,"col"===t.stateManager.select.selectInline?t.rowCount-1:w.row,!1,!1,!1,!1)})}else t.eventManager.inertiaScroll.isInertiaScrolling()?t.eventManager.inertiaScroll.endInertia():t.eventManager.scrollYSpeed=0}};e.globalEventListeners.push({name:"pointermove",env:"vglobal",callback:a}),G.rF.addEventListener("pointermove",a)}(this),function(e){let t=e.table,l=t.stateManager,i=t.scenegraph;i.component.vScrollBar.addEventListener("pointerover",e=>{l.showVerticalScrollBar()}),i.component.hScrollBar.addEventListener("pointerover",e=>{l.showHorizontalScrollBar()}),i.component.vScrollBar.addEventListener("pointerout",e=>{l.interactionState!==H.F.scrolling&&l.hideVerticalScrollBar()}),i.component.hScrollBar.addEventListener("pointerout",e=>{l.interactionState!==H.F.scrolling&&l.hideHorizontalScrollBar()}),i.component.vScrollBar.addEventListener("pointermove",e=>{i.table.stateManager.updateCursor("default"),e.stopPropagation()}),i.component.vScrollBar.addEventListener("pointerdown",e=>{e.stopPropagation(),i.table.hasListeners(F.B.MOUSEDOWN_TABLE)&&i.table.fireListeners(F.B.MOUSEDOWN_TABLE,{event:e.nativeEvent})}),i.component.vScrollBar.addEventListener("scrollDown",e=>{var t;i.table.eventManager.LastBodyPointerXY={x:e.x,y:e.y},i.table.eventManager.isDown=!0,l.interactionState!==H.F.scrolling&&l.updateInteractionState(H.F.scrolling),i.table.stateManager.hideMenu(),null==(t=i.table.editorManager)||t.completeEdit(),i.table.hasListeners(F.B.MOUSEDOWN_TABLE)&&i.table.fireListeners(F.B.MOUSEDOWN_TABLE,{event:e.nativeEvent})}),i.component.vScrollBar.addEventListener("pointerup",()=>{l.fastScrolling=!1,i.table.eventManager.isDraging=!1,l.interactionState===H.F.scrolling&&l.updateInteractionState(H.F.default)}),i.component.vScrollBar.addEventListener("pointerupoutside",()=>{l.fastScrolling=!1,l.interactionState===H.F.scrolling&&l.updateInteractionState(H.F.default)}),i.component.vScrollBar.addEventListener("scrollUp",e=>{i.table.eventManager.isDraging=!1}),i.component.hScrollBar.addEventListener("pointermove",e=>{i.table.stateManager.updateCursor(),e.stopPropagation()}),i.component.hScrollBar.addEventListener("pointerdown",e=>{e.stopPropagation(),i.table.hasListeners(F.B.MOUSEDOWN_TABLE)&&i.table.fireListeners(F.B.MOUSEDOWN_TABLE,{event:e.nativeEvent})}),i.component.hScrollBar.addEventListener("scrollDown",e=>{var t;i.table.eventManager.LastBodyPointerXY={x:e.x,y:e.y},i.table.eventManager.isDown=!0,l.interactionState!==H.F.scrolling&&l.updateInteractionState(H.F.scrolling),i.table.stateManager.hideMenu(),null==(t=i.table.editorManager)||t.completeEdit(),i.table.hasListeners(F.B.MOUSEDOWN_TABLE)&&i.table.fireListeners(F.B.MOUSEDOWN_TABLE,{event:e.nativeEvent})}),i.component.hScrollBar.addEventListener("pointerup",()=>{l.fastScrolling=!1,i.table.eventManager.isDraging=!1,l.interactionState===H.F.scrolling&&l.updateInteractionState(H.F.default)}),i.component.hScrollBar.addEventListener("pointerupoutside",()=>{l.fastScrolling=!1,l.interactionState===H.F.scrolling&&l.updateInteractionState(H.F.default)}),i.component.hScrollBar.addEventListener("scrollUp",e=>{i.table.eventManager.isDraging=!1});let n=(0,W.P2)(l.updateVerticalScrollBar,20),o=(0,W.P2)(l.updateHorizontalScrollBar,20);i.component.vScrollBar.addEventListener("scrollDrag",e=>{i.table.eventManager.isDown&&(i.table.eventManager.isDraging=!0),l.fastScrolling=!0,l.interactionState!==H.F.scrolling&&l.updateInteractionState(H.F.scrolling),n(e.detail.value[0]/(1-e.detail.value[1]+e.detail.value[0]),e)}),i.component.hScrollBar.addEventListener("scrollDrag",e=>{i.table.eventManager.isDown&&(i.table.eventManager.isDraging=!0),l.fastScrolling=!0,l.interactionState!==H.F.scrolling&&l.updateInteractionState(H.F.scrolling),o(e.detail.value[0]/(1-e.detail.value[1]+e.detail.value[0]))})}(this),function(e){let t=e.table,l=t.stateManager,i=t.scenegraph;if(!1===G.rF.envContribution.supportsTouchEvents)return;G.rF.addEventListener("contextmenu",e=>{e.stopPropagation(),e.preventDefault()},{capture:!0}),e.touchMovePoints=[],t.scenegraph.tableGroup.addEventListener("touchstart",l=>{var n,o,r,a,s,h,d,u;if(l.target.isChildOf(i.component.vScrollBar)||l.target.isChildOf(i.component.vScrollBar))return;e.isTouchdown=!0;let c=l.nativeEvent;e.touchMovePoints.push({x:t.rotateDegree?null!=(r=null==(o=null==(n=c.changedTouches)?void 0:n[0])?void 0:o._canvasX)?r:null==(a=l.canvas)?void 0:a.x:l.page.x,y:t.rotateDegree?null!=(d=null==(h=null==(s=c.changedTouches)?void 0:s[0])?void 0:h._canvasY)?d:null==(u=l.canvas)?void 0:u.y:l.page.y,timestamp:Date.now()})});let n=i=>{var n,o;if(e.isLongTouch&&i.preventDefault(),e.isTouchdown&&ep(i)){if(e.isTouchMove=!0,(null==(o=null==(n=e.downIcon)?void 0:n.attribute)?void 0:o.funcType)===q.cI.dragReorder)i.preventDefault();else if(e.touchMovePoints.length>4&&e.touchMovePoints.shift(),e.touchMovePoints.push({x:t.rotateDegree?i.changedTouches[0]._canvasX:i.changedTouches[0].pageX,y:t.rotateDegree?i.changedTouches[0]._canvasY:i.changedTouches[0].pageY,timestamp:Date.now()}),e._enableTableScroll){let n=-e.touchMovePoints[e.touchMovePoints.length-1].x+e.touchMovePoints[e.touchMovePoints.length-2].x,o=-e.touchMovePoints[e.touchMovePoints.length-1].y+e.touchMovePoints[e.touchMovePoints.length-2].y;el({deltaX:n,deltaY:o},l),i.cancelable&&("none"===t.internalProps.overscrollBehavior&&(o&&eo(l)||n&&er(l))||Math.abs(o)>=Math.abs(n)&&0!==o&&ei(o,l)||Math.abs(o)<=Math.abs(n)&&0!==n&&en(n,l))&&i.preventDefault()}}};G.rF.addEventListener("touchmove",n,{passive:!1}),e.globalEventListeners.push({name:"touchmove",env:"vglobal",callback:n});let o=l=>{var i,n,o,r;if(e.touchEnd=!0,e.isLongTouch=!1,e.isTouchdown&&ep(l)){if((null==(n=null==(i=e.downIcon)?void 0:i.attribute)?void 0:n.funcType)===q.cI.dragReorder)l.preventDefault();else if((null==(o=e.touchMovePoints)?void 0:o.length)&&(e.touchMovePoints.length>4&&e.touchMovePoints.shift(),e.touchMovePoints.push({x:t.rotateDegree?l.changedTouches[0]._canvasX:l.changedTouches[0].pageX,y:t.rotateDegree?l.changedTouches[0]._canvasY:l.changedTouches[0].pageY,timestamp:Date.now()}),e._enableTableScroll)){let l=e.touchMovePoints[0],i=e.touchMovePoints[(null==(r=e.touchMovePoints)?void 0:r.length)-1],n=(i.x-l.x)/(i.timestamp-l.timestamp),o=(i.y-l.y)/(i.timestamp-l.timestamp);e.inertiaScroll.startInertia(n,o,.95),t.eventManager.inertiaScroll.setScrollHandle((e,l)=>{el({deltaX:-e,deltaY:-l},t.stateManager)})}e.isTouchdown=!1,e.isTouchMove=!1,e.isDraging=!1,e.touchMovePoints=[]}};G.rF.addEventListener("touchend",o),e.globalEventListeners.push({name:"touchend",env:"vglobal",callback:o});let r=t=>{e.touchEnd=!0,e.isLongTouch=!1,e.isTouchdown&&(e.isTouchdown=!1,e.isTouchMove=!1,e.touchMovePoints=[],e.isDraging=!1)};G.rF.addEventListener("touchcancel",r),e.globalEventListeners.push({name:"touchcancel",env:"vglobal",callback:r})}(this),function(e){let t=e.table;e.gesture=new J.o(t.scenegraph.tableGroup,{tap:{interval:300}}),e.gesture.on("doubletap",e=>{!function(e,t){var l,i,n,o,r,a;let s=(0,Q.RJ)(e),h=-1,d=-1;s.eventArgs&&(h=s.eventArgs.col,d=s.eventArgs.row);let u=t.getCellValue(h,d),c=null==(i=null==(l=s.eventArgs)?void 0:l.targetCell)?void 0:i.globalAABBBounds;if(c&&t.internalProps.focusControl.setFocusRect(new z.U(c.x1+t.scrollLeft,c.y1+t.scrollTop,c.x2-c.x1,c.y2-c.y1),u),t.hasListeners(F.B.DBLCLICK_CELL)){let l,i,u=t.getCellInfo(h,d);if(null==(n=s.eventArgs)?void 0:n.target){let e=(0,ee.T)(null==(o=s.eventArgs)?void 0:o.target);e&&(l=e.icon,i=e.position)}let c=Object.assign(Object.assign({},u),{event:e.nativeEvent,federatedEvent:e,cells:[],targetIcon:l?{name:l.name,position:i,funcType:l.attribute.funcType}:void 0,target:null==(r=null==s?void 0:s.eventArgs)?void 0:r.target,mergeCellInfo:null==(a=null==s?void 0:s.eventArgs)?void 0:a.mergeInfo});t.fireListeners(F.B.DBLCLICK_CELL,c)}}(e,t)})}(this)}updateEventBinder(){setTimeout(()=>{var e;this.table.isReleased||((0,Y.F9)(this.table)&&0===(null==(e=this.handleTextStickBindId)?void 0:e.length)?(this.handleTextStickBindId.push(this.table.on(F.B.SCROLL,e=>{(0,Y.pu)(this.table)})),this.handleTextStickBindId.push(this.table.on(F.B.RESIZE_COLUMN_END,e=>{(0,Y.pu)(this.table)})),this.handleTextStickBindId.push(this.table.on(F.B.RESIZE_ROW_END,e=>{(0,Y.pu)(this.table)}))):!(0,Y.F9)(this.table)&&this.handleTextStickBindId&&(this.handleTextStickBindId.forEach(e=>{this.table.off(e)}),this.handleTextStickBindId=[]),$(this.table))},0)}bindSelfEvent(){var e,t,l,i,n,o,r,a,s,h,d;this.table.isReleased||((e=this.table).on(F.B.ICON_CLICK,t=>{var l;let{col:i,row:n,x:o,y:r,funcType:a,icon:s,event:h}=t,{stateManager:d}=e;if(a===q.cI.dropDown)d.triggerDropDownMenu(i,n,o,r,h);else if(a===q.cI.sort)d.triggerSort(i,n,s,h);else if(a===q.cI.frozen)d.triggerFreeze(i,n,s);else if(a===q.cI.drillDown)e.fireListeners(X.z.DRILLMENU_CLICK,e.stateManager.drill);else if(a===q.cI.collapse||a===q.cI.expand){let t=!!(null==(l=d.select.ranges)?void 0:l.length);d.updateSelectPos(-1,-1),d.endSelectCells(!0,t),e.toggleHierarchyState(i,n)}}),(t=this.table).on(F.B.DROPDOWN_MENU_CLICK,()=>{t.stateManager.hideMenu()}),t.on(F.B.SCROLL,()=>{t.stateManager.hideMenu()}),this.updateEventBinder(),l=this.table,"browser"===A.X.mode&&l.on(F.B.CLICK_CELL,e=>{let t,{col:i,row:n}=e;if("image"===e.target.type&&e.target.role&&e.target.role.startsWith("icon"))return;t=l.internalProps.layoutMap.isHeader(i,n)?l.isPivotTable()?l._getHeaderLayoutMap(i,n).headerType:l.getHeaderDefine(i,n).headerType:l.getBodyColumnType(i,n);let o=l.isHeader(i,n)?l.getHeaderDefine(i,n):l.getBodyColumnDefine(i,n),r=l.getCellValue(i,n),a=l.getCellOriginValue(i,n);if("link"===t){let e=(0,L.vi)(o.linkJump,{col:i,row:n,table:l,value:r,dataValue:a,cellHeaderPaths:void 0});if(!(e=!1!==e))return;let t=o.templateLink,s,h=(0,L.vi)(o.linkDetect,{col:i,row:n,table:l,value:r,dataValue:a,cellHeaderPaths:void 0});if(h=!1!==h,t){let e=l.getCellOriginRecord(i,n);if(e&&e.vtableMerge)return;let o=Object.assign({__value:r,__dataValue:a},e);s=(0,j.Z)(t)?t(o,i,n,l):t.replace(/\{\s*(\S+?)\s*\}/g,(e,t)=>o[t])}else if(h){if(!K.tP.test(r))return;s=r}else s=r;if(!s)return;let d=o.linkTarget,u=o.linkWindowFeatures;window.open(s,d,u)}else if("image"===t){let{clickToPreview:e}=o;if(!1===e)return;let t=document.createElement("div");t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.backgroundColor="rgba(30, 30, 30, 0.4)",t.style.display="flex",t.style.justifyContent="center",t.style.alignItems="center",t.style.overflow="hidden",t.style.zIndex="9999",t.addEventListener("click",e=>{e.target===t&&document.body.removeChild(t)});let l=new Image;l.src=r,l.style.maxWidth="80%",l.style.maxHeight="80%",t.appendChild(l),document.body.appendChild(t)}else if("video"===t){let{clickToPreview:e}=o;if(!1===e)return;let t=document.createElement("div");t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.backgroundColor="rgba(30, 30, 30, 0.4)",t.style.display="flex",t.style.justifyContent="center",t.style.alignItems="center",t.style.overflow="hidden",t.style.zIndex="9999",t.addEventListener("click",e=>{e.target===t&&document.body.removeChild(t)});let l=document.createElement("video");l.src=r,l.style.maxWidth="80%",l.style.maxHeight="80%",l.setAttribute("preload","auto"),l.setAttribute("controls","true"),t.appendChild(l),document.body.appendChild(t)}}),(i=this.table).on(F.B.DBLCLICK_CELL,e=>{var t,l,n;if(e.federatedEvent){let o=(0,Q.RJ)(e.federatedEvent),r=i.scenegraph.getResizeColAt(o.abstractPos.x,o.abstractPos.y,null==(t=o.eventArgs)?void 0:t.targetCell),a=null!=(l=i.options.disableDblclickAutoResizeColWidth)?l:null==(n=i.options.resize)?void 0:n.disableDblclickAutoResizeColWidth;if(i.eventManager.checkCellFillhandle(o))i.fireListeners(F.B.DBLCLICK_FILL_HANDLE,{});else if(i._canResizeColumn(r.col,r.row)&&r.col>=0&&!a){i.scenegraph.updateAutoColWidth(r.col),i.internalProps._widthResizedColMap.add(r.col),i.scenegraph.updateChartSizeForResizeColWidth(r.col);let e=i.stateManager;!(e.columnResize.col<e.table.frozenColCount)||e.table.isPivotTable()||e.table.transpose||e.table.scenegraph.component.setFrozenColumnShadow(e.table.frozenColCount-1,e.columnResize.isRightFrozen),(e.columnResize.col>=e.table.colCount-e.table.rightFrozenColCount&&!e.table.isPivotTable()&&!e.table.transpose||e.table.options.rightFrozenColCount)&&e.table.scenegraph.component.setRightFrozenColumnShadow(e.table.colCount-e.table.rightFrozenColCount);let t=[];for(let e=0;e<i.colCount;e++)t.push(i.getColWidth(e));i.fireListeners(F.B.RESIZE_COLUMN_END,{col:r.col,colWidths:t})}}}),this.table.isPivotTable()&&function(e){let t=e.internalProps.layoutMap.rowsDefine,l=e.internalProps.layoutMap.columnsDefine;for(let e=0;e<t.length;e++){let l=t[e];if("string"!=typeof l&&(l.drillDown||l.drillUp))return!0}for(let e=0;e<l.length;e++){let t=l[e];if("string"!=typeof t&&(t.drillDown||t.drillUp))return!0}return!1}(this.table)&&((n=this.table).on(F.B.MOUSEENTER_CELL,e=>{let{col:t,row:l}=e;if(-1===t||-1===l)return;let i=n.internalProps.layoutMap.getHeaderDimension(t,l);(null==i?void 0:i.drillDown)||(null==i?void 0:i.drillUp)?n.stateManager.updateDrillState(i.dimensionKey,i.title,i.drillDown,i.drillUp,t,l):n.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1)}),n.on(F.B.MOUSELEAVE_TABLE,e=>{n.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1)})),$(this.table),(o=this.table).isPivotChart()&&o.scenegraph.tableGroup.addEventListener("click",e=>{var t;if(!o.stateManager.columnMove.moving&&!o.stateManager.columnResize.resizing)if("axis-label"===e.target.name){let t,l,{col:i,row:n}=(0,Q.RJ)(e).eventArgs,r=o.internalProps.layoutMap;r.indicatorsAsCol?(t=r.getDimensionKeyInChartSpec(r.rowHeaderLevelCount,n),l=r.getCellHeaderPaths(r.rowHeaderLevelCount-2,n).rowHeaderPaths):(t=r.getDimensionKeyInChartSpec(i,r.columnHeaderLevelCount),l=r.getCellHeaderPaths(i,r.columnHeaderLevelCount-1).colHeaderPaths);let a=l.map(e=>({key:e.dimensionKey,value:e.value})).filter(e=>e.key);if(a.push({key:t,value:e.target.attribute.text}),o._selectedDimensionInChart.length&&function(e,t){if(e.length!==t.length)return!1;for(let l=0;l<e.length;l++)if(e[l].key!==t[l].key||e[l].value!==t[l].value)return!1;return!0}(o._selectedDimensionInChart,a))return;o._selectedDimensionInChart=a,r.updateDataStateToChartInstance(),(0,ef.RW)(o.scenegraph),o.scenegraph.updateNextFrame()}else(null==(t=o._selectedDimensionInChart)?void 0:t.length)&&(o._selectedDimensionInChart.length=0,o.internalProps.layoutMap.updateDataStateToChartInstance(),(0,ef.RW)(o.scenegraph),o.scenegraph.updateNextFrame())}),(r=this.table).isPivotChart()&&(r.on(F.B.MOUSEENTER_CELL,e=>{r.scenegraph.getCell(e.col,e.row).forEachChildren(t=>{if("axis"===t.name){let t=eC(e.col,e.row,r.internalProps.layoutMap);e.axisPosition=t,r.fireListeners(F.B.MOUSEENTER_AXIS,e)}})}),r.on(F.B.MOUSELEAVE_CELL,e=>{r.scenegraph.getCell(e.col,e.row).forEachChildren(t=>{if("axis"===t.name){let t=eC(e.col,e.row,r.internalProps.layoutMap);e.axisPosition=t,r.fireListeners(F.B.MOUSELEAVE_AXIS,e)}})})),(a=this.table).on("checkbox_state_change",e=>{var t;let{col:l,row:i,checked:n,field:o}=e;if(!a.internalProps.layoutMap.isSeriesNumber(l,i)||!0!==a.internalProps.enableCheckboxCascade||a.isHeader(l,i))return;let r=a.getCellOriginRecord(l,i),s=a.dataSource.currentPagerIndexedData,h=a.getRecordShowIndexByCell(l,i),d=s[h];if((0,ev.Z)(d)&&(d=[d]),r.vtableMerge||(null==(t=r.children)?void 0:t.length))if(n)e_(a,l,i)===f.g.collapse?ew(!0,d,a,o):eb(!0,h,d,s,a,l),ey(h,d,s,a,l);else{e_(a,l,i)===f.g.collapse?ew(!1,d,a,o):eb(!1,h,d,s,a,l),ey(h,d,s,a,l);let e=a.stateManager.headerCheckedState._vtable_rowSeries_number,t=a.stateManager.updateHeaderCheckedState("_vtable_rowSeries_number",l,i);e!==t&&a.scenegraph.updateHeaderCheckboxCellState(l,i,t)}else ey(h,d,s,a,l)}),(s=this.table).on("checkbox_state_change",e=>{var t;if(!0!==s.internalProps.enableCheckboxCascade)return;let{col:l,row:i,checked:n,field:o}=e,r=s.internalProps.columns.some(e=>e.tree);if(s.internalProps.enableCheckboxCascade,!r||s.isHeader(l,i))return;let a=s.getCellOriginRecord(l,i),h=s.dataSource.currentPagerIndexedData,d=s.getRecordShowIndexByCell(l,i),u=h[d];if((0,ev.Z)(u)&&(u=[u]),a.vtableMerge||(null==(t=a.children)?void 0:t.length))if(n)e_(s,l,i)===f.g.collapse?ew(!0,u,s,o):eb(!0,d,u,h,s,l,o),ey(d,u,h,s,l,o);else{e_(s,l,i)===f.g.collapse?ew(!1,u,s,o):eb(!1,d,u,h,s,l,o),ey(d,u,h,s,l,o);let e=s.stateManager.headerCheckedState._vtable_rowSeries_number,t=s.stateManager.updateHeaderCheckedState(o,l,i);e!==t&&s.scenegraph.updateHeaderCheckboxCellState(l,i,t)}else ey(d,u,h,s,l,o)}),(h=this.table).on("checkbox_state_change",e=>{if(!0!==h.internalProps.enableHeaderCheckboxCascade)return;let{col:t,row:l,checked:i,field:n}=e;if(h.isHeader(t,l))h.stateManager.setHeaderCheckedState(n,i),"checkbox"===h.getCellType(t,l)&&h.scenegraph.updateCheckboxCellState(t,l,i);else if(h.stateManager.setCheckedState(t,l,n,i),"checkbox"===h.getCellType(t,l)){let e=h.stateManager.headerCheckedState[n],i=h.stateManager.updateHeaderCheckedState(n,t,l);e!==i&&h.scenegraph.updateHeaderCheckboxCellState(t,l,i)}}),(d=this.table).on(F.B.CLICK_CELL,e=>{let{col:t,row:l,target:i}=e;"button"!==i.name||i.attribute.disable||d.hasListeners(F.B.BUTTON_CLICK)&&d.fireListeners(F.B.BUTTON_CLICK,{col:t,row:l,event:e.event})}))}dealTableHover(e){if(!e)return void this.table.stateManager.updateHoverPos(-1,-1);let{eventArgs:t}=e;t?this.table.stateManager.updateHoverPos(t.col,t.row):this.table.stateManager.updateHoverPos(-1,-1)}dealIconHover(e){let{eventArgs:t}=e;t?this.table.stateManager.updateHoverIcon(t.col,t.row,t.target,t.targetCell):this.table.stateManager.updateHoverIcon(-1,-1,void 0,void 0)}dealMenuHover(e){}dealTableSelect(e,t){var l,i,n,o,r,a,s,h,d;if(!e)return this.table.stateManager.updateSelectPos(-1,-1),!1;let{eventArgs:u}=e;if(u){if("checkbox"===u.target.name||"radio"===u.target.name||"switch"===u.target.name||"button"===u.target.name)return!1;if(this.table.isHeader(u.col,u.row)&&(0,ec.wP)(this.table,u.col,u.row))return t||this.table.stateManager.updateSelectPos(-1,-1),!1;if(!this.table.isHeader(u.col,u.row)&&(0,ec.wP)(this.table,u.col,u.row)){if(!t){let e=!!(null==(l=this.table.stateManager.select.ranges)?void 0:l.length);this.table.stateManager.updateSelectPos(-1,-1),e&&this.table.stateManager.endSelectCells(!0,e)}return!1}if(this.table.isPivotChart()&&("axis-label"===(null==(i=null==e?void 0:e.eventArgs)?void 0:i.target.name)||"chart"===(null==(n=null==e?void 0:e.eventArgs)?void 0:n.target.type)))return this.table.stateManager.updateSelectPos(-1,-1),!1;let c=null==(r=null==(o=this.table.keyboardOptions)?void 0:o.shiftMultiSelect)||r,g=null==(s=null==(a=this.table.keyboardOptions)?void 0:a.ctrlMultiSelect)||s;return this.table.stateManager.updateSelectPos("row"===this.table.stateManager.select.selectInline?this.table.colCount-1:u.col,"col"===this.table.stateManager.select.selectInline?this.table.rowCount-1:u.row,u.event.shiftKey&&c,(u.event.ctrlKey||u.event.metaKey)&&g,!1,!t&&(null==(d=null==(h=this.table.options.select)?void 0:h.makeSelectCellVisible)||d)),!0}return!1}dealFillSelect(e,t){var l,i,n,o,r,a,s,h;let{eventArgs:d}=e;if(d){if((null==(i=null==(l=this.table.stateManager.select)?void 0:l.ranges)?void 0:i.length)&&this.table.stateManager.isFillHandle()){let l,i,r=this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1];t&&((0,v.Z)(this.table.stateManager.fillHandle.directionRow)||(Math.abs(this.table.stateManager.fillHandle.startY-e.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-e.abstractPos.x)?this.table.stateManager.fillHandle.directionRow=!0:this.table.stateManager.fillHandle.directionRow=!1),Math.abs(this.table.stateManager.fillHandle.startY-e.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-e.abstractPos.x)?this.table.stateManager.fillHandle.startY-e.abstractPos.y>0?this.table.stateManager.fillHandle.direction="top":this.table.stateManager.fillHandle.direction="bottom":this.table.stateManager.fillHandle.startX-e.abstractPos.x>0?this.table.stateManager.fillHandle.direction="left":this.table.stateManager.fillHandle.direction="right",this.table.stateManager.fillHandle.directionRow?(l=d.row,i=r.end.col):(l=r.end.row,i=d.col));let a=null==(o=null==(n=this.table.keyboardOptions)?void 0:n.ctrlMultiSelect)||o;this.table.stateManager.updateSelectPos(t?i:r.end.col,t?l:r.end.row,!0,(d.event.ctrlKey||d.event.metaKey)&&a,!1,!t)}else{let e=null==(a=null==(r=this.table.keyboardOptions)?void 0:r.shiftMultiSelect)||a,l=null==(h=null==(s=this.table.keyboardOptions)?void 0:s.ctrlMultiSelect)||h;this.table.stateManager.updateSelectPos(d.col,d.row,d.event.shiftKey&&e,(d.event.ctrlKey||d.event.metaKey)&&l,!1,!t)}return!0}return!1}deelTableSelectAll(){this.table.stateManager.updateSelectPos(-1,-1,!1,!1,!0),this.table.fireListeners(F.B.SELECTED_CELL,{ranges:this.table.stateManager.select.ranges,col:0,row:0})}dealMenuSelect(e){}checkColumnResize(e,t){let{eventArgs:l}=e;if(this.table.internalProps.enableTreeStickCell&&!l)return!1;let i=this.table.scenegraph.getResizeColAt(e.abstractPos.x,e.abstractPos.y,null==l?void 0:l.targetCell),n=!0;return this.table.internalProps.canResizeColumn&&!this.table.internalProps.canResizeColumn(i.col,i.row,this.table)&&(n=!1),n&&this.table._canResizeColumn(i.col,i.row)&&i.col>=0?(t&&this.table.stateManager.startResizeCol(i.col,e.abstractPos.x,e.abstractPos.y,i.rightFrozen),!0):(this.table.stateManager.isResizeCol()&&this.table.stateManager.endResizeCol(),!1)}checkRowResize(e,t){let{eventArgs:l}=e;if(l){let i=this.table.scenegraph.getResizeRowAt(e.abstractPos.x,e.abstractPos.y,l.targetCell);if(this.table._canResizeRow(i.col,i.row)&&i.row>=0)return t&&this.table.stateManager.startResizeRow(i.row,e.abstractPos.x,e.abstractPos.y,i.bottomFrozen),!0}return!1}cellIsHeaderCheck(e,t){let{eventArgs:l}=e,{col:i,row:n,target:o}=l;return!!this.table.isHeader(i,n)&&"checkbox"===this.table.getCellType(l.col,l.row)&&"checkbox"===o.name}checkCellFillhandle(e,t){var l,i,n,o,r;if("function"==typeof(null==(l=this.table.options.excelOptions)?void 0:l.fillHandle)?this.table.options.excelOptions.fillHandle({selectRanges:this.table.stateManager.select.ranges,table:this.table}):null==(i=this.table.options.excelOptions)?void 0:i.fillHandle){let{eventArgs:l}=e;if(l&&(null==(o=null==(n=this.table.stateManager.select)?void 0:n.ranges)?void 0:o.length)){let l,i,n=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.col,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.col),o=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.row,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.row),a=Math.min(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.col,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.col),s=Math.min(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.row,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.row);l=n<this.table.colCount-1?this.table.scenegraph.highPerformanceGetCell(n,o).globalAABBBounds.x2:0===a?this.table.scenegraph.highPerformanceGetCell(0,o).globalAABBBounds.x1:this.table.scenegraph.highPerformanceGetCell(a-1,o).globalAABBBounds.x2;let h=Math.abs(e.abstractPos.x-l);i=o<this.table.rowCount-1?this.table.scenegraph.highPerformanceGetCell(n,o).globalAABBBounds.y2:this.table.scenegraph.highPerformanceGetCell(n,s-1).globalAABBBounds.y2;let d=Math.abs(e.abstractPos.y-i);if((null==(r=this.table.stateManager.fillHandle)?void 0:r.isFilling)||h<=9&&d<=9)return t&&this.table.stateManager.startFillSelect(e.abstractPos.x,e.abstractPos.y),!0}}return!1}dealColumnResize(e,t){this.table.stateManager.updateResizeCol(e,t)}dealRowResize(e,t){this.table.stateManager.updateResizeRow(e,t)}checkColumnMover(e){var t;let{eventArgs:l}=e;return!(!l||!this.table._canDragHeaderPosition(l.col,l.row))&&(this.table.stateManager.startMoveCol(l.col,l.row,e.abstractPos.x,e.abstractPos.y,null==(t=null==l?void 0:l.event)?void 0:t.nativeEvent),!0)}dealColumnMover(e,t,l){let i=this.table.getColAtRelativePosition(e),n=this.table.getRowAtRelativePosition(t);-1===i&&"row"===this.table.stateManager.columnMove.movingColumnOrRow&&(i=0),-1===n&&"column"===this.table.stateManager.columnMove.movingColumnOrRow&&(n=0),(0,v.Z)(i)&&(0,v.Z)(n)&&this.table.stateManager.updateMoveCol(i,n,e,t,l)}startColumnResize(e){}dealIconClick(e,t){let{eventArgs:l}=t,{target:i,event:n,col:o,row:r}=l||{target:e.target,event:e,col:-1,row:-1};if(i.role&&i.role.startsWith("icon-"))return this.table.fireListeners(F.B.ICON_CLICK,{name:i.name,x:(i.globalAABBBounds.x1+i.globalAABBBounds.x2)/2,y:i.globalAABBBounds.y2,col:o,row:r,funcType:i.attribute.funcType,icon:i,event:n}),!0;if(i instanceof U.H){let e=i.pickIcon(n.global);if(e)return this.table.fireListeners(F.B.ICON_CLICK,{name:e.attribute.id,x:e.globalX+e.globalAABBBounds.width()/2,y:e.globalY+e.AABBBounds.height(),col:o,row:r,funcType:e.attribute.funcType,icon:e,event:n}),!0}return!1}release(){var e;null==(e=this.gesture)||e.release(),this.globalEventListeners.forEach(e=>{"document"===e.env?document.removeEventListener(e.name,e.callback):"body"===e.env?document.body.removeEventListener(e.name,e.callback):"window"===e.env?window.removeEventListener(e.name,e.callback):"vglobal"===e.env&&G.rF.removeEventListener(e.name,e.callback)}),this.globalEventListeners=[]}enableScroll(){this._enableTableScroll=!0}disableScroll(){this._enableTableScroll=!1}handleCopy(e,t=!1){var l,i,n,o,r,a;return eM(this,void 0,void 0,function*(){let s=this.table;t||(this.cutWaitPaste=!1),this.copySourceRange=null;let h=s.stateManager.select.ranges;if(h&&1===h.length){let e=h[0];this.copySourceRange={startCol:Math.min(e.start.col,e.end.col),startRow:Math.min(e.start.row,e.end.row)}}else if(!(null==h?void 0:h.length))return void(this.copySourceRange=null);let d=this.table.getCopyValue(null==(i=null==(l=s.options.keyboardOptions)?void 0:l.getCopyCellValue)?void 0:i.value);if((0,v.Z)(d)){e.preventDefault();let l=s.getElement();l&&l!==document.activeElement&&(l.focus(),yield new Promise(e=>setTimeout(e,10)));try{if(navigator.clipboard&&navigator.clipboard.writeText){let t=!0;if(navigator.permissions&&navigator.permissions.query)try{t="granted"===(yield navigator.permissions.query({name:"clipboard-write"})).state}catch(e){t=!0}if(t)try{if(window.ClipboardItem){let e=d;1===s.stateManager.select.ranges.length&&(null==(o=null==(n=s.options.keyboardOptions)?void 0:n.getCopyCellValue)?void 0:o.html)&&(e=this.table.getCopyValue(null==(r=s.options.keyboardOptions)?void 0:r.getCopyCellValue.html));let t=(0,Q.r5)(e);yield navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([t],{type:"text/html"}),"text/plain":new Blob([d],{type:"text/plain"})})])}else yield navigator.clipboard.writeText(d)}catch(t){this.fallbackCopyToClipboard(d,e)}else this.fallbackCopyToClipboard(d,e)}else this.fallbackCopyToClipboard(d,e);s.fireListeners(F.B.COPY_DATA,{cellRange:s.stateManager.select.ranges,copyData:d,isCut:t})}catch(t){this.fallbackCopyToClipboard(d,e)}}(null==(a=s.keyboardOptions)?void 0:a.showCopyCellBorder)&&((0,T.NR)(s),s.clearSelected())})}fallbackCopyToClipboard(e,t){try{if(t.clipboardData)return void t.clipboardData.setData("text/plain",e);document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur();let l=document.createElement("textarea");l.value=e,l.style.position="fixed",l.style.left="-999999px",l.style.top="-999999px",l.style.opacity="0",l.setAttribute("readonly",""),l.setAttribute("aria-hidden","true"),document.body.appendChild(l),l.focus(),l.select(),l.setSelectionRange(0,e.length);try{document.execCommand("copy")}catch(e){}finally{document.body.removeChild(l)}}catch(e){}}handleCut(e){return eM(this,void 0,void 0,function*(){this.handleCopy(e,!0),this.cutWaitPaste=!0,this.cutCellRange=this.table.getSelectedCellInfos(),this.clipboardCheckTimer&&clearTimeout(this.clipboardCheckTimer),this.clipboardCheckTimer=window.setTimeout(()=>{this.cutWaitPaste&&(this.cutWaitPaste=!1,this.cutCellRange=null,this.clipboardCheckTimer=null)},3e4),this.saveClipboardContent()})}handlePaste(e){this.cutWaitPaste?this.checkClipboardChanged().then(t=>{this.executePaste(e),t||this.clearCutArea(this.table),this.cutWaitPaste&&(this.cutWaitPaste=!1,this.cutCellRange=null,this.clipboardCheckTimer&&(clearTimeout(this.clipboardCheckTimer),this.clipboardCheckTimer=null))}).catch(()=>{this.executePaste(e),this.cutWaitPaste&&(this.cutWaitPaste=!1,this.cutCellRange=null,this.clipboardCheckTimer&&(clearTimeout(this.clipboardCheckTimer),this.clipboardCheckTimer=null))}):this.executePaste(e)}executePaste(e){var t,l,i;return eM(this,void 0,void 0,function*(){let n=this.table;if(!(null==(t=n.editorManager)?void 0:t.editingEditor)){if(n.changeCellValues&&(null==(l=n.stateManager.select.ranges)?void 0:l.length)>0)try{if(navigator.clipboard&&navigator.clipboard.read)try{let t=yield navigator.clipboard.read(),l=!1;for(let e of t){if(e.types.includes("text/html")){yield this.pasteHtmlToTable(e),l=!0;break}if(e.types.includes("text/plain")){yield this.pasteTextToTable(e),l=!0;break}}l||(yield this.fallbackPasteFromClipboard(e))}catch(t){yield this.fallbackPasteFromClipboard(e)}else yield this.fallbackPasteFromClipboard(e)}catch(t){yield this.fallbackPasteFromClipboard(e)}(null==(i=n.keyboardOptions)?void 0:i.showCopyCellBorder)&&(0,T.Z7)(n)}})}fallbackPasteFromClipboard(e){return eM(this,void 0,void 0,function*(){let t=this.table,l=t.stateManager.select.ranges,i=Math.min(l[0].start.col,l[0].end.col),n=Math.min(l[0].start.row,l[0].end.row);try{let l=t.getElement();l&&l!==document.activeElement&&(l.focus(),yield new Promise(e=>setTimeout(e,10)));let o=e.clipboardData||window.clipboardData||window.Clipboard;if(o){let e=o.getData("text")||o.getData("Text");if(e)return void(yield this.processPastedText(e,i,n))}}catch(e){}})}processPastedText(e,t,l){var i;return eM(this,void 0,void 0,function*(){let n,o=this.table,r=e.split("\n"),a=[];r.forEach(function(e){let t=e.split("	"),l=[];a.push(l),t.forEach(function(e,i){i===t.length-1&&(e=e.trim()),l.push(e)})}),(null==(i=o.options.keyboardOptions)?void 0:i.processFormulaBeforePaste)&&this.copySourceRange&&(n=o.options.keyboardOptions.processFormulaBeforePaste(a,this.copySourceRange.startCol,this.copySourceRange.startRow,t,l));let s=yield o.changeCellValues(t,l,n||a,!0);o.hasListeners(F.B.PASTED_DATA)&&o.fireListeners(F.B.PASTED_DATA,{col:t,row:l,pasteData:n||a,changedCellResults:s})})}clearCutArea(e){try{let t=this.cutCellRange;if(!t||0===t.length)return;for(let l=0;l<t.length;l++)for(let i=0;i<t[l].length;i++)t[l][i]&&e.changeCellValue(t[l][i].col,t[l][i].row,void 0)}catch(e){}}checkClipboardChanged(){return eM(this,void 0,void 0,function*(){if(!navigator.clipboard||!navigator.clipboard.readText)return!1;try{return(yield navigator.clipboard.readText())!==this.lastClipboardContent}catch(e){return!1}})}saveClipboardContent(){navigator.clipboard&&navigator.clipboard.readText&&setTimeout(()=>{navigator.clipboard.readText().then(e=>{this.lastClipboardContent=e}).catch(e=>{})},50)}pasteHtmlToTable(e){let t=/<tr[^>]*>([\s\S]*?)<\/tr>/g,l=/<td[^>]*>([\s\S]*?)<\/td>/g,i=this.table,n=i.stateManager.select.ranges,o=n.length,r=Math.min(n[o-1].start.col,n[o-1].end.col),a=Math.min(n[o-1].start.row,n[o-1].end.row),s=Math.max(n[o-1].start.col,n[o-1].end.col),h=Math.max(n[o-1].start.row,n[o-1].end.row),d=0,u=0,c=[];e.getType("text/html").then(e=>{e.text().then(e=>eM(this,void 0,void 0,function*(){var n,o,g;if(e&&/(<table)|(<TABLE)/g.test(e)){let p;for(let i of Array.from(e.matchAll(t))){let e=Array.from(i[1].matchAll(l)).map(e=>e[1].replace(/(<(?!br)([^>]+)>)/gi,"").replace(/<br(\s*|\/)>[\r\n]?/gim,"\n").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#9;/gi,"	").replace(/&nbsp;/g," "));c.push(e),d=Math.max(d,null!=(n=null==e?void 0:e.length)?n:0)}u=null!=(o=c.length)?o:0,c=this.handlePasteValues(c,u,d,h-a+1,s-r+1),(null==(g=i.options.keyboardOptions)?void 0:g.processFormulaBeforePaste)&&this.copySourceRange&&(p=i.options.keyboardOptions.processFormulaBeforePaste(c,this.copySourceRange.startCol,this.copySourceRange.startRow,r,a));let f=yield i.changeCellValues(r,a,p||c,!0);i.hasListeners(F.B.PASTED_DATA)&&i.fireListeners(F.B.PASTED_DATA,{col:r,row:a,pasteData:p||c,changedCellResults:f})}else navigator.clipboard.read().then(e=>{for(let t of e)t.types.includes("text/plain")&&t.getType("text/plain").then(e=>{e.text().then(e=>this._pasteValue(e))})})}))})}_pasteValue(e){var t,l;return eM(this,void 0,void 0,function*(){let i,n=this.table,o=n.stateManager.select.ranges,r=o.length,a=Math.min(o[r-1].start.col,o[r-1].end.col),s=Math.min(o[r-1].start.row,o[r-1].end.row),h=Math.max(o[r-1].start.col,o[r-1].end.col),d=Math.max(o[r-1].start.row,o[r-1].end.row),u=0,c=0,g=[];e.split("\n").forEach(function(e,t){var l;let i=e.split("	"),n=[];g.push(n),i.forEach(function(e,t){t===i.length-1&&(e=e.trim()),n.push(e)}),u=Math.max(u,null!=(l=null==n?void 0:n.length)?l:0)}),c=null!=(t=g.length)?t:0,g=this.handlePasteValues(g,c,u,d-s+1,h-a+1),(null==(l=n.options.keyboardOptions)?void 0:l.processFormulaBeforePaste)&&this.copySourceRange&&(i=n.options.keyboardOptions.processFormulaBeforePaste(g,this.copySourceRange.startCol,this.copySourceRange.startRow,a,s));let p=yield n.changeCellValues(a,s,i||g,!0);n.hasListeners(F.B.PASTED_DATA)&&n.fireListeners(F.B.PASTED_DATA,{col:a,row:s,pasteData:i||g,changedCellResults:p})})}pasteTextToTable(e){return eM(this,void 0,void 0,function*(){let t=this.table,l=t.stateManager.select.ranges,i=l.length,n=Math.min(l[i-1].start.col,l[i-1].end.col),o=Math.min(l[i-1].start.row,l[i-1].end.row),r=Math.max(l[i-1].start.col,l[i-1].end.col),a=Math.max(l[i-1].start.row,l[i-1].end.row);try{let l=yield e.getType("text/plain"),i=yield l.text(),s=this.parsePastedData(i),h=s.length,d=Math.max(...s.map(e=>e.length),0),u=this.handlePasteValues(s,h,d,a-o+1,r-n+1),c=yield t.changeCellValues(n,o,u,!0);t.hasListeners(F.B.PASTED_DATA)&&t.fireListeners(F.B.PASTED_DATA,{col:n,row:o,pasteData:u,changedCellResults:c})}catch(e){}})}parsePastedData(e){let t=e.replace(/\r(?!\n)/g,"\r\n").split("\r\n"),l=[];return t.length>1&&""===t[t.length-1]&&t.pop(),t.forEach(e=>{let t=e.split("	").map(e=>this.processCellValue(e));l.push(t)}),l}processCellValue(e){e.includes("\n")&&(e=e.replace(/^"(.*)"$/,"$1").replace(/["]*/g,e=>Array(Math.floor(e.length/2)).fill('"').join("")));let t=Number(e);return isNaN(t)?e:t}handlePasteValues(e,t,l,i,n){if((n>l||i>t)&&n%l==0&&i%t==0){let o=[];for(let r=0;r<i;r++){let i=[];o.push(i);for(let o=0;o<n;o++){let n=r%t,a=o%l;i.push(e[n][a])}}return o}return e}}var eR=l(501800);class ex extends _{static get DEFAULT(){return s||(s=new ex)}constructor(e={},t={}){var l,i;super(e,t),this._autoWrapText=null!=(l=null==e?void 0:e.autoWrapText)?l:null==t?void 0:t.autoWrapText,this._lineClamp=null!=(i=null==e?void 0:e.lineClamp)?i:null==t?void 0:t.lineClamp}clone(){return new ex(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(e){this._lineClamp=e}get autoWrapText(){return this._autoWrapText}set autoWrapText(e){this._autoWrapText=e}}let eE=e=>{let t=e.value;return Number(t)>80?"#20a8d8":Number(t)>50?"#4dbd74":Number(t)>20?"#ffc107":"#f86c6b"};class eP extends _{static get DEFAULT(){return h||(h=new eP)}constructor(e={},t={}){var l,i,n,o,r,a,s,h,d,u,c,g,p,f,C,v;super(e,t),this._showBar=null==(l=e.showBar)||l,this._barColor=null!=(i=e.barColor)?i:eE,this._barPositiveColor=null!=(n=e.barPositiveColor)?n:"#4dbd74",this._barNegativeColor=null!=(o=e.barNegativeColor)?o:"#f86c6b",this._barAxisColor=null!=(r=e.barAxisColor)?r:"black",this._barBgColor=e.barBgColor,this._barHeight=null!=(a=e.barHeight)?a:3,this._barHeight=null!=(s=e.barHeight)?s:3,this._barBottom=null!=(h=e.barBottom)?h:0,this._barPadding=null!=(d=e.barPadding)?d:[0,0,0,0],this._showBarMark=null!=(u=e.showBarMark)&&u,this._barMarkPositiveColor=null!=(c=e.barMarkPositiveColor)?c:"#4dbd74",this._barMarkNegativeColor=null!=(g=e.barMarkNegativeColor)?g:"#f86c6b",this._barMarkWidth=null!=(p=e.barMarkWidth)?p:2,this._barMarkPosition=null!=(f=e.barMarkPosition)?f:"right",this._barRightToLeft=null!=(C=e.barRightToLeft)&&C,this._barMarkInBar=null==(v=e.barMarkInBar)||v}get showBar(){return this._showBar}set showBar(e){this._showBar=e}get barColor(){return this._barColor}set barColor(e){this._barColor=e}get barBgColor(){return this._barBgColor}set barBgColor(e){this._barBgColor=e}get barHeight(){return this._barHeight}set barHeight(e){this._barHeight=e}get barBottom(){return this._barBottom}set barBottom(e){this._barBottom=e}get barPositiveColor(){return this._barPositiveColor}set barPositiveColor(e){this._barPositiveColor=e}get barNegativeColor(){return this._barNegativeColor}set barNegativeColor(e){this._barNegativeColor=e}get barAxisColor(){return this._barAxisColor}set barAxisColor(e){this._barAxisColor=e}get barPadding(){return this._barPadding}set barPadding(e){this._barPadding=e}get showBarMark(){return this._showBarMark}set showBarMark(e){this._showBarMark=e}get barMarkPositiveColor(){return this._barMarkPositiveColor}set barMarkPositiveColor(e){this._barMarkPositiveColor=e}get barMarkNegativeColor(){return this._barMarkNegativeColor}set barMarkNegativeColor(e){this._barMarkNegativeColor=e}get barMarkWidth(){return this._barMarkWidth}set barMarkWidth(e){this._barMarkWidth=e}get barMarkPosition(){return this._barMarkPosition}set barMarkPosition(e){this._barMarkPosition=e}get barRightToLeft(){return this._barRightToLeft}set barRightToLeft(e){this._barRightToLeft=e}get barMarkInBar(){return this._barMarkInBar}set barMarkInBar(e){this._barMarkInBar=e}clone(){return new eP(this,null)}}class eA extends _{static get DEFAULT(){return d||(d=new eA)}constructor(e={},t={}){super(e,t)}clone(){return new eA(this,null)}}var eT=l(48170);class eH{constructor(e){this._table=e;let t=eR.U2();this.expandIcon=t[q.up.expandIconName],this.collapseIcon=t[q.up.collapseIconName]}getIcons(e,t,l,i,n){let o=[],r=this.getHierarchyIcon(e,t);r&&o.push(r);let{icon:a}=this._table.getBodyColumnDefine(e,t);if(a){let n;n="function"==typeof a?a({col:e,row:t,value:l,dataValue:i,table:this._table}):a;let r=eR.U2(),s=e=>{let t;(t="string"==typeof e?r[e]:e)&&o.push(t)};Array.isArray(n)?n.forEach((e,t)=>{s(e)}):s(n)}return n&&o.forEach((l,i)=>{(l.content||l.src)&&(o[i]=this.getCellIconFromRecordValue(l,e,t))}),o}getStyleClass(e){switch(e){case"text":case"link":break;case"image":case"video":return eA;case"chart":case"sparkline":return _;case"progressbar":return eP;case"checkbox":return M;case"radio":return S;case"switch":return R;case"button":return x}return ex}getCellIconFromRecordValue(e,t,l){if(Array.isArray(e))return e.map(e=>this.getCellIconFromRecordValue(e,t,l));if(!L.j6.isObject(e)||"function"==typeof e)return this._table.getFieldData(e,t,l);let i={};return eT.D.forEach(n=>{var o,r;if(void 0!==e[n]){let a=this._table.getFieldData(e[n],t,l);(0,v.Z)(a)?i[n]=a:(null==(r=(o=this._table)._hasField)?void 0:r.call(o,e[n],t,l))||(i[n]=e[n])}}),i}getHierarchyIcon(e,t){let l=this._table.getHierarchyState(e,t);return l===f.g.expand?this.expandIcon:l===f.g.collapse?this.collapseIcon:void 0}getHierarchyIconWidth(){var e,t;return this.expandIcon.width+(null!=(e=this.expandIcon.marginLeft)?e:0)+(null!=(t=this.expandIcon.marginRight)?t:0)}}var eL=l(437106);!function(){if("node"===A.X.mode)return;let e=document.createElement("style");e.id="vtable-menu-styleSheet",e.textContent="\n@keyframes vtable__menu-element--shown-animation {\n	0% {\n		opacity: 0;\n	}\n	100% {\n		opacity: 1;\n	}\n}\n.vtable__menu-element {\n	position: absolute;\n	box-sizing: border-box;\n	border-radius: 4px;\n	background-color: #fff;\n	padding: 6px 0;\n	/* pointer-events: none; */\n	user-select: none;\n	color: #000;\n	max-width: 300px;\n	z-index: 99999;\n	border: #CCC 0.5px solid;\n	cursor: default;\n	width: max-content;\n	box-shadow: 0px 8px 16px rgba(27, 31, 35, 0.12);\n  max-height: 100%;\n  overflow-y: auto;\n}\n.vtable__menu-element--hidden {\n	opacity: 0;\n	/* transform: translate(-50%, -50%); */\n	transition: opacity 75ms linear;\n	z-index: -9999;\n}\n.vtable__menu-element--shown {\n	opacity: 1;\n	/* transform: translate(-50%, -50%); */\n	animation: vtable__menu-element--shown-animation 150ms ease-out;\n}\n.vtable__menu-element__content {\n	font-family: Roboto;\n	font-size: 12px;\n	overflow: hidden;\n	display: inline-block;\n	/* height: 100%; */\n	line-height: 30px;\n}\n.vtable__menu-element__item {\n	height: 32px;\n	padding: 0px 12px;\n	cursor: pointer;\n	position: relative;\n	display: flex;\n	align-items: center;\n	justify-content: flex-start;\n}\n.vtable__menu-element__item:hover {\n	background-color: rgba(27, 31, 35, 0.06);\n}\n.vtable__menu-element__icon{\n	/* vertical-align: top; */\n	display: flex;\n	/* line-height: 30px; */\n	margin-right: 6px;\n}\n.vtable__menu-element__no-event {\n	pointer-events: none;\n}\n.vtable__menu-element--select {\n	color: #2E68CF;\n}\n.vtable__menu-element--normal {\n	color: rgba(20, 20, 20, 0.9);;\n}\n.vtable__menu-element__item-disabled {\n    color: rgba(0, 0, 0, 0.25);\n    cursor: not-allowed;\n	  background-color: #fff;\n}\n.vtable__menu-element__item-disabled:hover {\n	  background-color: #fff;\n}\n.vtable__menu-element__split {\n	height: 0px;\n	border: 1px solid rgb(209, 213, 218);\n	margin: 5px 0;\n}\n.vtable__menu-element__title {\n	color: rgb(149, 149, 149);\n}\n.vtable__menu-element__arrow {\n	position: absolute;\n	right: 3px;\n	font-weight: bold;\n	margin-top: 1px;\n}\n.vtable__menu-element__item-text {\n	margin-right: 15px;\n}\n",document.head.appendChild(e)}();let eF="vtable__menu-element",eB=`${eF}__item`,eI=`${eF}__content`,ek=`${eF}--hidden`,eD=`${eF}--shown`,eO=`${eF}--normal`,ez=`${eF}--select`,eW=`${eF}__icon`,eN=`${eF}__split`,eV=`${eF}__title`,eZ=`${eF}__arrow`,eU=`${eF}__no-event`,eG=`${eF}__item-text`,ej=`${eF}__item-disabled`;function eK(){return(0,eL.a)("div",[eF,ek])}function eX(e,t,l,i,n,o){let r=e.getCellRange(i,n);for(let i=0;i<t.length;i++){let n=t[i],{col:o,row:a}=n,{field:s,menuKey:h}=n;if("number"!=typeof o||"number"!=typeof a)if(e.isPivotTable()&&(Array.isArray(s),1)){let t=e.internalProps.layoutMap.getPivotCellAdress(s);if(!t)continue;o=t.col,a=t.row}else{let t=e.internalProps.layoutMap.getHeaderCellAddressByField(s);if(!t)continue;o=t.col,a=t.row}if((0,v.Z)(o)&&(0,v.Z)(a)&&(0,L._Z)(r,o,a)&&l===h)return!0}return!1}class e${constructor(e){var t,l,i,n,o,r,a,s,h,d,u;this._handler=new D,this._rootElement=eK(),this._secondElement=eK(),this._secondElement.sub=!0,this._showChildrenIndex=-1,this._rootElement.addEventListener("wheel",e=>{e.stopPropagation()}),null==(t=this._rootElement)||t.addEventListener("mousedown",e=>{e.stopPropagation(),e.preventDefault()}),null==(l=this._rootElement)||l.addEventListener("contextmenu",e=>{e.stopPropagation(),e.preventDefault()}),null==(i=this._rootElement)||i.addEventListener("touchend",t=>{if(t.stopPropagation(),t.preventDefault(),t.target.classList.contains(ej)||this._rootElement.classList.contains(ek))return;let{col:l,row:i,dropDownIndex:n,menuKey:o,text:r,hasChildren:a}=t.target;if("number"!=typeof n||a)return void t.stopPropagation();let s=e.isPivotTable()?e.internalProps.layoutMap.getPivotDimensionInfo(l,i):e.getHeaderField(l,i),h=e._dropDownMenuIsHighlight(l,i,n);e.fireListeners(F.B.DROPDOWN_MENU_CLICK,{col:l,row:i,field:s,menuKey:o,text:r,highlight:h,cellLocation:e.getCellLocation(l,i),event:t}),e.fireListeners(F.B.DROPDOWN_MENU_CLEAR,null),e.fireListeners(F.B.HIDE_MENU,null),t.stopPropagation()}),null==(n=this._rootElement)||n.addEventListener("click",t=>{if(t.stopPropagation(),t.preventDefault(),t.target.classList.contains(ej)||this._rootElement.classList.contains(ek))return;let{col:l,row:i,dropDownIndex:n,menuKey:o,text:r,hasChildren:a}=t.target;if("number"!=typeof n||a)return void t.stopPropagation();let s=e.isPivotTable()?e.internalProps.layoutMap.getPivotDimensionInfo(l,i):e.getHeaderField(l,i),h=e._dropDownMenuIsHighlight(l,i,n);e.fireListeners(F.B.DROPDOWN_MENU_CLICK,{col:l,row:i,field:s,menuKey:o,text:r,highlight:h,cellLocation:e.getCellLocation(l,i),event:t}),e.fireListeners(F.B.DROPDOWN_MENU_CLEAR,null),e.fireListeners(F.B.HIDE_MENU,null),t.stopPropagation()}),null==(o=this._rootElement)||o.addEventListener("mousemove",t=>{var l,i;if(this._rootElement.classList.contains(ek))return;t.stopPropagation();let{hasChildren:n,dropDownIndex:o,col:r,row:a,sub:s}=t.target;if(n){this._showChildrenIndex=o;let i=this._secondElement;null==i||i.classList.remove(ek),null==i||i.classList.add(eD),i.innerHTML="";let n=null==(l=this._menuInstanceInfo.content[o])?void 0:l.children;for(let t=0;t<n.length;t++){let l=n[t],o=eY(l,!!e.stateManager.menu.dropDownMenuHighlight&&eX(e,e.stateManager.menu.dropDownMenuHighlight,"object"==typeof l?(null==l?void 0:l.menuKey)||(null==l?void 0:l.text):l,r,a,t));o.col=r,o.row=a,o.dropDownIndex=t,"string"==typeof l?(o.text=l,o.menuKey=l):"object"==typeof l&&(o.text=l.text,o.menuKey=l.menuKey||l.text),o.sub=!0,o.sub=!0,i.appendChild(o)}let s=t.target.getBoundingClientRect();this._bindSecondElement(e,r,a,s.right,s.top)}else if(n&&this._showChildrenIndex===o){let e=this._secondElement;null==e||e.classList.remove(ek),null==e||e.classList.add(eD)}else!s&&(null==(i=this._secondElement)?void 0:i.classList.contains(eD))&&setTimeout(()=>{if(!0!==this._mouseEnterSecondElement){this._showChildrenIndex=-1;let e=this._secondElement;null==e||e.classList.remove(eD),null==e||e.classList.add(ek)}},300)}),null==(r=this._secondElement)||r.addEventListener("wheel",e=>{e.stopPropagation()}),null==(a=this._secondElement)||a.addEventListener("mousemove",e=>{this._rootElement.classList.contains(ek)||e.stopPropagation()}),null==(s=this._secondElement)||s.addEventListener("mouseenter",e=>{this._mouseEnterSecondElement=!0}),null==(h=this._secondElement)||h.addEventListener("mouseleave",e=>{this._mouseEnterSecondElement=!1}),null==(d=this._secondElement)||d.addEventListener("mousedown",e=>{e.stopPropagation(),e.preventDefault()}),null==(u=this._secondElement)||u.addEventListener("click",t=>{if(t.stopPropagation(),t.preventDefault(),t.target.classList.contains(ej)||this._secondElement.classList.contains(ek))return;let{col:l,row:i,dropDownIndex:n,menuKey:o,text:r,hasChildren:a}=t.target;if("number"!=typeof n||a)return void t.stopPropagation();let s=e.isPivotTable()?e.internalProps.layoutMap.getPivotDimensionInfo(l,i):e.getHeaderField(l,i),h=!1;this._menuInstanceInfo.content.forEach((t,n)=>{if("object"==typeof t&&t.children&&t.children.length)for(let n=0;n<t.children.length;n++){let r=t.children[n];if(eX(e,e.stateManager.menu.dropDownMenuHighlight,"object"==typeof r?null==r?void 0:r.menuKey:r,l,i,-1)&&o===("object"==typeof r?null==r?void 0:r.menuKey:r))return void(h=!0)}}),e.fireListeners(F.B.DROPDOWN_MENU_CLICK,{col:l,row:i,field:s,cellHeaderPaths:e.isPivotTable()?e.getCellHeaderPaths(l,i):void 0,menuKey:o,text:r,highlight:h,cellLocation:e.getCellLocation(l,i),event:t}),e.fireListeners(F.B.DROPDOWN_MENU_CLEAR,null),e.fireListeners(F.B.HIDE_MENU,null),t.stopPropagation()})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();let e=this._rootElement;(null==e?void 0:e.parentElement)&&e.parentElement.removeChild(e),this._handler.release(),delete this._rootElement}bindToCell(e,t,l,i){var n,o;let r=this._rootElement,a=this._secondElement;if(this._menuInstanceInfo=i,null==r||r.classList.remove(eD),null==r||r.classList.add(ek),null==a||a.classList.remove(eD),null==a||a.classList.add(ek),this._canBindToCell(e,t,l)){if(r.innerHTML="",Array.isArray(i.content)){let a=i.content;for(let i=0;n=i<(null==a?void 0:a.length),n;i++){let n=a[i],s=!!e.stateManager.menu.dropDownMenuHighlight&&eX(e,e.stateManager.menu.dropDownMenuHighlight,"object"==typeof n?(null==n?void 0:n.menuKey)||(null==n?void 0:n.text):n,t,l,i);if(e.stateManager.menu.dropDownMenuHighlight&&"object"==typeof n&&Array.isArray(n.children)&&n.children.length)for(let i=0;i<n.children.length;i++){let o=n.children[i];if(eX(e,e.stateManager.menu.dropDownMenuHighlight,"object"==typeof o?(null==o?void 0:o.menuKey)||(null==o?void 0:o.text):o,t,l,i)){s=!0;break}}let h=eY(n,s);h.col=t,h.row=l,h.dropDownIndex=i,"string"==typeof n?(h.text=n,h.menuKey=n):"object"==typeof n&&(h.text=n.text,h.menuKey=n.menuKey||n.text,(null==(o=n.children)?void 0:o.length)&&(h.hasChildren=!0)),r.appendChild(h)}}if(this._bindToCell(e,t,l,i.position,i.referencePosition))return null==r||r.classList.add(eD),null==r||r.classList.remove(ek),!0}else this.unbindFromCell();return!1}unbindFromCell(){let e=this._rootElement,t=this._secondElement;this._menuInstanceInfo=void 0,(null==e?void 0:e.parentElement)&&(e.classList.remove(eD),e.classList.add(ek)),(null==t?void 0:t.parentElement)&&(t.classList.remove(eD),t.classList.add(ek))}_canBindToCell(e,t,l){var i;let n=e.getCellRangeRelativeRect({col:t,row:l}),o=null!=(i=e.internalProps.menu.parentElement)?i:e.getElement(),{top:r,bottom:a,left:s,right:h}=n;if(-1===t&&-1===l||e.isFrozenCell(t,l))return!0;if(a<e.getFrozenRowsHeight()||h<e.getFrozenColsWidth()||s>e.tableNoFrameWidth-e.getRightFrozenColsWidth()||r>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight())return!1;let{offsetHeight:d,offsetWidth:u}=o;return!(d<r)&&!(u<s)}_bindToCell(e,t,l,i,n){var o;let r=this._rootElement,a=null!=(o=e.internalProps.menu.parentElement)?o:e.getElement(),{width:s,height:h,left:d,top:u}=a.getBoundingClientRect();if(r){let t,l;r.parentElement!==a&&a.appendChild(r),r.style.left="0px",r.style.maxWidth=`${.8*s}px`;let o=r.offsetWidth,c=r.offsetHeight;i?(t=i.x,l=i.y):n&&(t=n.rect.right-o,l=n.rect.bottom);let g=a.getBoundingClientRect(),p=g.width/a.offsetWidth,f=g.height/a.offsetHeight;l*f+c>h&&(l=(h-c)/f),l<0&&(l/=2);let C=0,v=0;if(e.getElement()!==a){let{left:t,top:l}=e.getElement().getBoundingClientRect();C=l-u,v=t-d}return r.style.top=`${l+C}px`,t<0?t=0:t*p+o>s&&(t=(s-o)/p),r.style.left=`${t+v}px`,!0}return!1}_bindSecondElement(e,t,l,i,n){var o;let r=this._secondElement,a=this._rootElement,s=null!=(o=e.internalProps.menu.parentElement)?o:e.getElement(),{width:h,height:d,left:u,top:c}=s.getBoundingClientRect(),{x:g,y:p,width:f,height:C}=a.getBoundingClientRect();if(r){r.parentElement!==s&&s.appendChild(r),r.style.left="0px",r.style.maxWidth=`${.8*h}px`;let e=r.clientWidth,t=r.clientHeight,l=n-4-c;l+t>d&&(l=l-t+r.firstElementChild.clientHeight+4),r.style.top=`${l}px`;let o=i-u;return o+e>h?o=o-e-f:o+=4,r.style.left=`${o}px`,!0}return!1}pointInMenuElement(e,t){let{x:l,y:i,width:n,height:o}=this._rootElement.getBoundingClientRect();if(e>l-5&&e<l+n+5&&t>i-5&&t<i+o+5)return!0;let r=this._secondElement;if(r){let{x:l,y:i,width:n,height:o}=r.getBoundingClientRect();if(e>l-5&&e<l+n+5&&t>i-5&&t<i+o+5)return!0}return!1}}function eY(e,t){var l,i,n;let o=(0,eL.a)("div",[eB,t?ez:eO]);if("object"==typeof e&&e.disabled&&o.classList.add(ej),"string"==typeof e){let t=(0,eL.a)("span",[eI,eU,eG]);t.innerHTML=e,o.appendChild(t)}else if("object"==typeof e){let r=null!=(l=e.type)?l:"item";if("split"===r)return null==o||o.classList.add(eN),o;if(null==(i=null==e?void 0:e.icon)?void 0:i.svg)if(K.tP.test(e.icon.svg)){let t=new Image;e.icon.width?t.style.width=e.icon.width.toString()+"px":t.style.width="16px",e.icon.height?t.style.height=e.icon.height.toString()+"px":t.style.height="16px",t.src=e.icon.svg,o.appendChild(t)}else{let l=(0,eL.a)("span",[eW,eU]);l.innerHTML=t&&e.selectedIcon&&e.selectedIcon.svg?e.selectedIcon.svg:e.icon.svg,e.icon.width&&l.children[0].setAttribute("width",e.icon.width.toString()),e.icon.height&&l.children[0].setAttribute("height",e.icon.height.toString()),o.appendChild(l)}let a=(0,eL.a)("span",[eI,eU,eG]);if(a.innerHTML=e.text,o.appendChild(a),"title"===r)null==o||o.classList.add(eU,eV);else if(null==(n=null==e?void 0:e.children)?void 0:n.length){let e=(0,eL.a)("span",[eI,eU,eZ]);e.innerHTML=t?'<svg width="8" height="12" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: baseline"><path d="M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z" fill="#2E68CF" fill-opacity="0.65"></path></svg>':'<svg width="8" height="12" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: baseline"><path d="M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z" fill="#141414" fill-opacity="0.65"></path></svg>',o.appendChild(e)}}return o}let eJ={CHANGE_STYLE:"change_style"};class eq extends y.R{static get EVENT_TYPE(){return eJ}static get DEFAULT(){return u||(u=new eq)}constructor(e={},t={}){var l,i,n,o,r,a,s,h,d,u,c,g,p,f,C,v,m,b,y,w,_,M,S,R,x,E,P,A,T,H,L,F;super(),this._defaultPadding=[10,16,10,16],this._color=null!=(l=e.color)?l:null==t?void 0:t.color,this._strokeColor=null!=(i=null==e?void 0:e.strokeColor)?i:null==t?void 0:t.strokeColor,this._fontSize=null!=(n=e.fontSize)?n:null==t?void 0:t.fontSize,this._fontFamily=null!=(o=e.fontFamily)?o:null==t?void 0:t.fontFamily,this._fontWeight=null!=(r=e.fontWeight)?r:null==t?void 0:t.fontWeight,this._fontVariant=null!=(a=e.fontVariant)?a:null==t?void 0:t.fontVariant,this._fontStyle=null!=(s=e.fontStyle)?s:null==t?void 0:t.fontStyle,this._textOverflow=(null!=(h=e.textOverflow)?h:null==t?void 0:t.textOverflow)||"ellipsis",this._textStick=null!=(u=null!=(d=e.textStick)?d:null==t?void 0:t.textStick)&&u,this._textStickBaseOnAlign=null!=(g=null!=(c=e.textStickBaseOnAlign)?c:null==t?void 0:t.textStickBaseOnAlign)&&g,this._marked=null!=(f=null!=(p=e.marked)?p:null==t?void 0:t.marked)&&f,this._textAlign=(null!=(C=e.textAlign)?C:null==t?void 0:t.textAlign)||"left",this._textBaseline=(null!=(v=e.textBaseline)?v:null==t?void 0:t.textBaseline)||"middle",this._bgColor=null!=(m=e.bgColor)?m:null==t?void 0:t.bgColor,this._padding=null!=(y=null!=(b=e.padding)?b:null==t?void 0:t.padding)?y:this._defaultPadding,this._borderColor=null!=(w=e.borderColor)?w:null==t?void 0:t.borderColor,this._lineHeight=null!=(_=e.lineHeight)?_:null==t?void 0:t.lineHeight,this._underline=null!=(M=e.underline)?M:null==t?void 0:t.underline,this._underlineColor=null!=(S=e.underlineColor)?S:null==t?void 0:t.underlineColor,this._underlineDash=null!=(R=e.underlineDash)?R:null==t?void 0:t.underlineDash,this._underlineOffset=null!=(x=e.underlineOffset)?x:null==t?void 0:t.underlineOffset,this._lineThrough=null!=(E=e.lineThrough)?E:null==t?void 0:t.lineThrough,this._lineThroughColor=null!=(P=e.lineThroughColor)?P:null==t?void 0:t.lineThroughColor,this._lineThroughDash=null!=(A=e.lineThroughDash)?A:null==t?void 0:t.lineThroughDash,this._linkColor=null!=(T=e.linkColor)?T:null==t?void 0:t.linkColor,this._cursor=null!=(H=e.cursor)?H:null==t?void 0:t.cursor,this._borderLineWidth=null!=(L=e.borderLineWidth)?L:null==t?void 0:t.borderLineWidth,this._borderLineDash=null!=(F=e.borderLineDash)?F:null==t?void 0:t.borderLineDash}get bgColor(){return this._bgColor}set bgColor(e){this._bgColor=e}get color(){return this._color}set color(e){this._color=e}get strokeColor(){return this._strokeColor}set strokeColor(e){this._strokeColor=e}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize=e}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e}get textOverflow(){return this._textOverflow}set textOverflow(e){this._textOverflow=e}get padding(){var e;return null!=(e=this._padding)?e:this._defaultPadding}set padding(e){this._padding=e}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e}get textStick(){return this._textStick}set textStick(e){this._textStick=e}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(e){this._textStickBaseOnAlign=e}get marked(){return this._marked}set marked(e){this._marked=e}get textAlign(){return this._textAlign}set textAlign(e){this._textAlign=e}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e}get underline(){return this._underline}set underline(e){this._underline=e}get underlineColor(){return this._underlineColor}set underlineColor(e){this._underlineColor=e}get underlineDash(){return this._underlineDash}set underlineDash(e){this._underlineDash=e}get underlineOffset(){return this._underlineOffset}set underlineOffset(e){this._underlineOffset=e}get lineThrough(){return this._lineThrough}set lineThrough(e){this._lineThrough=e}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(e){this._lineThroughColor=e}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(e){this._lineThroughDash=e}get linkColor(){return this._linkColor}set linkColor(e){this._linkColor=e}get cursor(){return this._cursor}set cursor(e){this._cursor=e}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(e){this._borderLineWidth=e}get borderLineDash(){return this._borderLineDash}set borderLineDash(e){this._borderLineDash=e}clone(){return new eq(this)}}class eQ extends eq{static get DEFAULT(){return c||(c=new eQ)}constructor(e={},t={}){var l;super(e,t),this.textAlign=(null!=(l=e.textAlign)?l:null==t?void 0:t.textAlign)||"center"}clone(){return new eQ(this)}}class e0 extends eq{static get DEFAULT(){return g||(g=new e0)}constructor(e={},t=null){var l,i;super(e,t),this._autoWrapText=null!=(l=null==e?void 0:e.autoWrapText)?l:null==t?void 0:t.autoWrapText,this._lineClamp=null!=(i=null==e?void 0:e.lineClamp)?i:null==t?void 0:t.lineClamp}clone(){return new e0(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(e){this._lineClamp=e}get autoWrapText(){return this._autoWrapText}set autoWrapText(e){this._autoWrapText=e}}class e1 extends eq{static get DEFAULT(){return p||(p=new e1)}constructor(e={},t={},l={}){var i,n,o,r,a,s,h,d,u,c,g,p,f,C,v,m,b,y,w,_,M,S;super(e,t),this._size=(null!=(n=null!=(i=null==e?void 0:e.size)?i:null==t?void 0:t.size)?n:null==l?void 0:l.size)||14,this._spaceBetweenTextAndIcon=(null!=(r=null!=(o=null==e?void 0:e.spaceBetweenTextAndIcon)?o:null==t?void 0:t.spaceBetweenTextAndIcon)?r:null==l?void 0:l.spaceBetweenTextAndIcon)||8,this._defaultFill=null!=(s=null==(a=null==e?void 0:e.checkboxStyle)?void 0:a.defaultFill)?s:null==l?void 0:l.defaultFill,this._defaultStroke=null!=(d=null==(h=null==e?void 0:e.checkboxStyle)?void 0:h.defaultStroke)?d:null==l?void 0:l.defaultStroke,this._disableFill=null!=(c=null==(u=null==e?void 0:e.checkboxStyle)?void 0:u.disableFill)?c:null==l?void 0:l.disableFill,this._checkedFill=null!=(p=null==(g=null==e?void 0:e.checkboxStyle)?void 0:g.checkedFill)?p:null==l?void 0:l.checkedFill,this._checkedStroke=null!=(C=null==(f=null==e?void 0:e.checkboxStyle)?void 0:f.checkedStroke)?C:null==l?void 0:l.checkedStroke,this._disableCheckedFill=null!=(m=null==(v=null==e?void 0:e.checkboxStyle)?void 0:v.disableCheckedFill)?m:null==l?void 0:l.disableCheckedFill,this._disableCheckedStroke=null!=(y=null==(b=null==e?void 0:e.checkboxStyle)?void 0:b.disableCheckedStroke)?y:null==l?void 0:l.disableCheckedStroke,this._checkIconImage=null!=(_=null==(w=null==e?void 0:e.checkboxStyle)?void 0:w.checkIconImage)?_:null==l?void 0:l.checkIconImage,this._indeterminateIconImage=null!=(S=null==(M=null==e?void 0:e.checkboxStyle)?void 0:M.indeterminateIconImage)?S:null==l?void 0:l.indeterminateIconImage}get size(){return this._size}set size(e){this._size=e}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(e){this._spaceBetweenTextAndIcon=e}get defaultFill(){return this._defaultFill}set defaultFill(e){this._defaultFill=e}get defaultStroke(){return this._defaultStroke}set defaultStroke(e){this._defaultStroke=e}get disableFill(){return this._disableFill}set disableFill(e){this._disableFill=e}get checkedFill(){return this._checkedFill}set checkedFill(e){this._checkedFill=e}get checkedStroke(){return this._checkedStroke}set checkedStroke(e){this._checkedStroke=e}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(e){this._disableCheckedFill=e}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(e){this._disableCheckedStroke=e}get checkIconImage(){return this._checkIconImage}set checkIconImage(e){this._checkIconImage=e}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(e){this._indeterminateIconImage=e}getStyle(e){return new e1(e,this)}clone(){return new e1(this)}}class e2{constructor(e){this._table=e;let t=eR.U2();this.freezeIcon=t[q.up.freezeIconName],this.frozenIcon=t[q.up.frozenIconName],this.frozenCurrentIcon=t[q.up.frozenCurrentIconName],this.normalIcon=t[q.up.normalIconName],this.upIcon=t[q.up.upwardIconName],this.downIcon=t[q.up.downwardIconName],this.dropDownAbsoluteIcon=t[q.up.dropdownIconName],this.expandIcon=t[q.up.expandIconName],this.collapseIcon=t[q.up.collapseIconName]}getIcons(e,t){let l=[];if(this._table.isPivotTable()){let{showSort:i,sort:n}=this._table.internalProps.layoutMap.getHeader(e,t);if("function"==typeof i?i({col:e,row:t,table:this._table}):i){let i=this._table.getPivotSortState(e,t);i&&(i=i.toUpperCase());let n="ASC"===i?this.upIcon:"DESC"===i?this.downIcon:this.normalIcon;n&&l.push(n)}else if(n){let i=this.getSortIconForPivotTable(this._table.getPivotSortState(e,t),this._table,e,t);i&&l.push(i)}}else{let i,n=this._table.sortState;i=void 0;let o=this._table.getCellRange(e,t);if(n)if(Array.isArray(n))for(let e=0;e<n.length;e++){let t=n[e],l=this._table._getHeaderCellBySortState(t);if(l&&(0,L._Z)(o,l.col,l.row)){({order:i}=t);break}}else{let e=this._table._getHeaderCellBySortState(n);e&&(0,L._Z)(o,e.col,e.row)&&({order:i}=n)}let r=this.getSortIcon(i,this._table,e,t);r&&l.push(r)}if(this._table.showFrozenIcon&&e<this._table.allowFrozenColCount){let i=this.getFrozenIcon(e,t);i&&l.push(i)}if(this.checkDropDownIcon(this._table,e,t)){let e=this.dropDownAbsoluteIcon;l.push(e)}let i=this.getDropDownStateIcons(this._table,e,t);i.length&&l.push(...i);let{headerIcon:n}=this._table._getHeaderLayoutMap(e,t),o=this.getHierarchyIcon(e,t);if(o&&l.push(o),n){let i;i="function"==typeof n?n({col:e,row:t,value:this._table.getCellValue(e,t),dataValue:this._table.getCellOriginValue(e,t),table:this._table}):n;let o=eR.U2(),r=e=>{let t;(t="string"==typeof e?o[e]:e)&&l.push(t)};Array.isArray(i)?i.forEach((e,t)=>{r(e)}):r(i)}return l}getFrozenIcon(e,t){if(this._table.isPivotTable()||this._table.transpose||this._table.rightFrozenColCount&&e>=this._table.colCount-this._table.rightFrozenColCount)return null;let l=this._table.getHeaderDefine(e,t);if(l.columns&&l.columns.length>0)return null;let i=this.freezeIcon;return this._table.options.frozenColCount-1>e?i=this.frozenIcon:this._table.options.frozenColCount-1===e&&(i=this.frozenCurrentIcon),i}getSortIcon(e,t,l,i){let n,o="asc"===e?this.upIcon:"desc"===e?this.downIcon:this.normalIcon,r=t.getHeaderDefine(l,i);return r&&(n="function"==typeof r.showSort?r.showSort({col:l,row:i,table:this._table}):r.showSort),r&&!1!==n&&((0,v.Z)(n)||r.sort)&&(!r.columns||!(r.columns.length>0))?o:null}getSortIconForPivotTable(e,t,l,i){let n,o=t.getHeaderDefine(l,i);return(o&&(n="function"==typeof o.showSort?o.showSort({col:l,row:i,table:this._table}):o.showSort),o&&!1!==n&&((0,v.Z)(n)||o.sort)&&(!o.columns||!(o.columns.length>0)))?"ASC"===(null==e?void 0:e.toUpperCase())?this.upIcon:"DESC"===(null==e?void 0:e.toUpperCase())?this.downIcon:this.normalIcon:null}getDropDownStateIcons(e,t,l){var i,n,o;let r=e.getHeaderDefine(t,l),{dropDownMenu:a}=e._getHeaderLayoutMap(t,l);"function"==typeof a&&(a=a({row:l,col:t,table:e}));let s=e.globalDropDownMenu;"function"==typeof s&&(s=s({row:l,col:t,table:e}));let h=[];if(Array.isArray(a)&&a.length||Array.isArray(s)&&s.length&&!(null==(i=null==r?void 0:r.columns)?void 0:i.length)){let i=a||s,r=-1,d=-1;for(let a=0;a<i.length;a++){let s=i[a];if("object"==typeof s&&s.children&&s.children.length)for(let i=0;i<s.children.length;i++){let h=s.children[i];if((null==(n=e.stateManager.menu)?void 0:n.dropDownMenuHighlight)&&eX(e,null==(o=e.stateManager.menu)?void 0:o.dropDownMenuHighlight,"object"==typeof h?null==h?void 0:h.menuKey:h,t,l,a)){r=a,d=i;break}}if(e._dropDownMenuIsHighlight(t,l,a)){r=a;break}}if(-1!==r){let e;(e=-1!==d?i[r].children[d]:i[r]).stateIcon&&(e.stateIcon.svg?h.push({type:"svg",name:e.stateIcon.src||e.stateIcon.svg,width:e.stateIcon.width||22,height:e.stateIcon.height||22,svg:e.stateIcon.svg,positionType:q.q0.right,marginRight:0,funcType:q.cI.dropDownState,interactive:!1}):e.stateIcon.src&&h.push({type:"image",name:e.stateIcon.src||e.stateIcon.svg,width:e.stateIcon.width||22,height:e.stateIcon.height||22,src:e.stateIcon.src,positionType:q.q0.right,marginRight:0,funcType:q.cI.dropDownState,interactive:!1}))}}return h}getDropDownIconRect(e,t,l){var i,n,o,r,a,s,h,d;let u,c=null!=(r=null!=(n=null==(i=this.downIcon.hover)?void 0:i.width)?n:null==(o=this.downIcon)?void 0:o.width)?r:0,g=null!=(d=null!=(s=null==(a=this.downIcon.hover)?void 0:a.height)?s:null==(h=this.downIcon)?void 0:h.height)?d:0,p=e.right-2-c;return{left:p,right:e.right-2,top:u="middle"===l?e.top+e.height/2-c/2:"top"===l?e.top+t/2:"bottom"===l?e.bottom-2*t:e.top,bottom:g+u,width:c,height:g}}getHierarchyIcon(e,t){let{hierarchyState:l}=this._table._getHeaderLayoutMap(e,t);if(l){if(l===f.g.expand)return this.expandIcon;if(l===f.g.collapse)return this.collapseIcon}}getHierarchyIconWidth(){var e,t;return this.expandIcon.width+(null!=(e=this.expandIcon.marginLeft)?e:0)+(null!=(t=this.expandIcon.marginRight)?t:0)}checkDropDownIcon(e,t,l){var i;if(e.isPivotTable()){let i=e._getHeaderLayoutMap(t,l).dropDownMenu;if("function"==typeof i&&(i=i({row:l,col:t,table:e})),Array.isArray(i)&&i.length)return!0}else{let n=e.getHeaderDefine(t,l),o=n.dropDownMenu,r=e.globalDropDownMenu;if("function"==typeof r&&(r=r({row:l,col:t,table:e})),Array.isArray(o)&&o.length||(!Array.isArray(n.dropDownMenu)||0!==n.dropDownMenu.length)&&Array.isArray(r)&&r.length&&!(null==(i=null==n?void 0:n.columns)?void 0:i.length))return!0}return!1}getStyleClass(e){switch(e){case"text":case"link":return e0;case"image":case"video":return eQ;case"checkbox":return e1}}setTableColumnsEditor(){let e=(t,l)=>{null==t||t.forEach((t,i)=>{t.editor&&(l[i].editor=t.editor),t.columns&&e(t.columns,l[i].columns)})};e(this._table.options.columns,this._table.internalProps.columns)}}var e3=l(863778),e9=l(551976),e4=l(263401),e5=l(908429),e6=l(297);class e8 extends EventTarget{constructor(e,t){if(super(),this._table=e,"node"===A.X.mode)return;let l=document.createElement("div");l.style.opacity="0",l.dataset.vtable="vtable",l.style.pointerEvents="none",l.classList.add("input-container");let i=this._input=document.createElement("input");l.appendChild(i),i.classList.add("table-focus-control"),i.dataset.vtable="vtable",i.readOnly=!0,t.appendChild(l),this._container=l}focus(){this._input.focus({preventScroll:!0})}setFocusRect(e,t){let l=this._input;l.value=t,l.select();let i=e.top-this._table.scrollTop,n=e.left-this._table.scrollLeft;l.style.top=`${i.toFixed()}px`,l.style.left=`${n.toFixed()}px`,l.style.width=`${e.width.toFixed()}px`,l.style.height=`${e.height.toFixed()}px`}get input(){return this._input}release(){var e;null==(e=this._container.parentElement)||e.removeChild(this._container)}}var e7=l(434399),te=l(330089);class tt{constructor(e){this._table=e;let t=eR.U2();this.dragReorderIconName=t[q.up.dragReorderIconName]}getIcons(e,t){return[this.dragReorderIconName]}}var tl=l(300434),ti=l(26249),tn=l(520829),to=l(254833);function tr(e,t){var l;return(0,b.ke)(t,e)||(null!=(l=th(e,t))?l:{top:-1,row:-1,bottom:-1,height:-1})}function ta(e,t){var l;return(0,b.sQ)(t,e)||(null!=(l=ts(e,t))?l:{left:-1,col:-1,right:-1,width:1})}function ts(e,t){if(0===e)return{left:0,col:0,right:0,width:0};let l=function(e,t){if(t._colRangeWidthsMap.get("$0$"+(t.colCount-1))){let l=0,i=t.colCount-1;for(;i-l>1;){let n=Math.floor((l+i)/2);if(e<t._colRangeWidthsMap.get(`$0$${n}`))i=n;else{if(!(e>t._colRangeWidthsMap.get(`$0$${n}`)))return n;l=n}}return i}return Math.min(Math.ceil(e/t.internalProps.defaultColWidth),t.colCount-1)}(e,t),i=t.getColsWidth(0,l);return e>=i?((l,i)=>{let n=i-t.getColWidth(l),{colCount:o}=t.internalProps;for(let i=l;i<o;i++){let l=t.getColWidth(i),o=n+l;if(Math.round(n)<=e&&e<Math.round(o))return{left:n,col:i,right:o,width:l};n=o}return null})(l,i):((l,i)=>{let n=i;for(let i=l;i>=0;i--){let l=t.getColWidth(i),o=n-l;if(Math.round(o)<=e&&e<Math.round(n))return{left:o,col:i,right:n,width:l};n=o}return null})(l,i)}function th(e,t){var l,i,n;let o;if(0===e)return{top:0,row:0,bottom:0,height:0};let r=!0===(null==(l=t.options.customConfig)?void 0:l._disableColumnAndRowSizeRound)?Math.floor:Math.round,a=(i=e,o=(n=t).defaultRowHeight,n._rowRangeHeightsMap.get("$0$"+(n.rowCount-1))&&(o=n._rowRangeHeightsMap.get("$0$"+(n.rowCount-1))/n.rowCount),Math.min(Math.ceil(i/o),n.rowCount-1)),s=t.getRowsHeight(0,a);return e>=s?((l,i)=>{let n=i-t.getRowHeight(l),{rowCount:o}=t.internalProps;for(let i=l;i<o;i++){let l=t.getRowHeight(i),o=n+l;if(r(n)<=r(e)&&r(e)<r(o))return{top:n,row:i,bottom:o,height:l};n=o}return null})(a,s):((l,i)=>{let n=i;for(let i=l;i>=0;i--){let l=t.getRowHeight(i),o=n-l;if(r(o)<=r(e)&&r(e)<r(n))return{top:o,row:i,bottom:n,height:l};n=o}return null})(a,s)}function td(e,t,l){if(0===e)return{left:0,col:0,right:0,width:0};if(e-=l.tableX,t&&e>l.tableNoFrameWidth-l.getRightFrozenColsWidth()&&e<l.tableNoFrameWidth&&e<=l.getAllColsWidth()){for(let t=0;t<l.rightFrozenColCount;t++)if(e>l.tableNoFrameWidth-l.getColsWidth(l.colCount-t-1,l.colCount-1))return{col:l.colCount-t-1,left:void 0,right:void 0,width:void 0}}return ts(e,l)}function tu(e,t,l){if(0===e)return{top:0,row:0,bottom:0,height:0};if(e-=l.tableY,t&&e>l.tableNoFrameHeight-l.getBottomFrozenRowsHeight()&&e<l.tableNoFrameHeight){for(let t=0;t<l.rightFrozenColCount;t++)if(e>l.tableNoFrameHeight-l.getRowsHeight(l.rowCount-t-1,l.rowCount-1))return{row:l.rowCount-t-1,top:void 0,bottom:void 0,height:void 0}}return th(e,l)}var tc=l(255685);function tg(e,t,l,i,n,o){var r;return e||t?e instanceof eq?e:"function"==typeof e?tg(e(l),t,l,i,n,o):(e||(e={}),n&&!(0,v.Z)(e.autoWrapText)&&(e.autoWrapText=!0),i===e1?new e1(null!=e?e:{},null!=t?t:{},null!=(r=o.checkboxStyle)?r:{}):new i(null!=e?e:{},null!=t?t:{})):i.DEFAULT}var tp=l(593666);let tf={};var tC=l(289761),tv=l(661506),tm=l(841400),tb=l(523173),ty=l(669860),tw=l(767008),t_=l(203922);function tM(e){return Math.floor(e)===e}class tS extends tv.rd{onUpdate(e,t,l){if(this.from.x!==this.to.x){let l=e?this.to.x:this.from.x+Math.floor((this.to.x-this.from.x)*t);this.params.table.scrollLeft=l}if(this.from.y!==this.to.y){let l=e?this.to.y:this.from.y+Math.floor((this.to.y-this.from.y)*t);this.params.table.scrollTop=l}}}class tR{constructor(e){this.table=e,this.timeline=new tm.L,this.ticker=new tb.H(this.table.scenegraph.stage),this.ticker.addTimeline(this.timeline),this.ticker.setFPS(60),this.tempGraphic=(0,ty.f)({})}scrollTo(e,t){var l,i;let n={x:this.table.scrollLeft,y:this.table.scrollTop},{col:o,row:r}=e,a,s,h=o,d=r;(0,ev.Z)(o)&&!tM(o)&&(h=Math.floor(o),a=o-h),(0,ev.Z)(r)&&!tM(r)&&(d=Math.floor(r),s=r-d);let u=this.table.getCellRect(null!=h?h:0,null!=d?d:0),{left:c,top:g}=u;a&&(c+=a*u.width),s&&(g+=s*u.height);let p={x:(0,ev.Z)(o)?c-this.table.getFrozenColsWidth():this.table.scrollLeft,y:(0,ev.Z)(r)?g-this.table.getFrozenRowsHeight():this.table.scrollTop},f=(0,e3.Z)(t)?3e3*!!t:null!=(l=null==t?void 0:t.duration)?l:3e3,C=(0,e3.Z)(t)?t?"linear":"":null!=(i=null==t?void 0:t.easing)?i:"linear";new tw.r(t_.R.GenAutoIncrementId(),this.timeline).bind(this.tempGraphic).play(new tS(n,p,f,C,{graphic:this.tempGraphic,table:this.table})),this.ticker.start()}clear(){this.timeline.clear(),this.ticker.stop()}}var tx=l(93947);function tE(e){return(0,j.Z)(e)?e:(0,m.Z)(e)?(t,l)=>e.find(e=>e.range.start.col<=t&&e.range.end.col>=t&&e.range.start.row<=l&&e.range.end.row>=l):void 0}var tP=l(473178);let{toBoxArray:tA}=L.oB,{isTouchEvent:tT}=L.B,tH=/^\$(\d+)\$(\d+)$/;!function(){if("node"===A.X.mode)return;let e=document.createElement("style");e.id="vtable-style-styleSheet",e.textContent="\n.vtable .input-container {\n	position: absolute;\n	top:0px;\n}\n.vtable .table-scrollable {\n	position: absolute;\n	overflow: scroll;\n}\n.vtable .table-scrollable::-webkit-scrollbar-button{\n	background-color: transparent;\n}\n.vtable .table-scrollable::-webkit-scrollbar-track-piece{\n	background-color: transparent;\n}\n.vtable .table-scrollable::-webkit-scrollbar-corner {\n	background-color: transparent;\n}\n.vtable .table-scrollable::-webkit-scrollbar-thumb {\n	border-radius      : 4px;\n	background-color   : rgba(100, 100, 100, .5);\n}\n\n.vtable .table-scroll-end-point {\n	opacity: 0;\n	position: relative;\n}\n.vtable {\n	/* \u8BBE\u7F6Eoverflow: auto \u5E94\u8BE5\u662F\u4E3A\u4E86\u6EDA\u52A8\u6761\u7684\u67D0\u4E2A\u95EE\u9898 \u4F46\u8BBE\u7F6E\u4E86auto\u4E4B\u540E dom\u7684\u4E0B\u62C9\u83DC\u5355\u53EA\u80FD\u663E\u793A\u5728vtable\u8282\u70B9\u4E2D \u8D85\u51FA\u4F1A\u622A\u65AD;\u73B0\u5728\u53BB\u6389auto \u6682\u65F6\u6EDA\u52A8\u6761\u7684\u95EE\u9898\u6CA1\u6709\u53D1\u73B0 */\n	/* overflow: auto; */\n	position: relative;\n	width: 100%;\n	height: 100%;\n	text-align: left;\n  -webkit-font-smoothing:auto;\n\n  overflow: hidden; // for react-vtable dom custom element\n}\n\n.vtable-gantt {\n	/* \u8BBE\u7F6Eoverflow: auto \u5E94\u8BE5\u662F\u4E3A\u4E86\u6EDA\u52A8\u6761\u7684\u67D0\u4E2A\u95EE\u9898 \u4F46\u8BBE\u7F6E\u4E86auto\u4E4B\u540E dom\u7684\u4E0B\u62C9\u83DC\u5355\u53EA\u80FD\u663E\u793A\u5728vtable\u8282\u70B9\u4E2D \u8D85\u51FA\u4F1A\u622A\u65AD;\u73B0\u5728\u53BB\u6389auto \u6682\u65F6\u6EDA\u52A8\u6761\u7684\u95EE\u9898\u6CA1\u6709\u53D1\u73B0 */\n	/* overflow: auto; */\n	position: absolute;\n	width: 100%;\n	height: 100%;\n	text-align: left;\n  -webkit-font-smoothing:auto;\n\n  overflow: hidden; // for react-vtable dom custom element\n}\n.vtable .table-component-container {\n  pointer-events: none;\n  overflow: hidden;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n}\n.vtable > canvas {\n	position: absolute;\n	width: 0;\n	height: 0;\n}\n.vtable .table-focus-control {\n	position: relative !important;\n	width: 1px;\n	height: 1px;\n	opacity: 0;\n	padding: 0;\n	margin: 0;\n	box-sizing: border-box;\n	pointer-events: none;\n	max-width: 500px;\n	max-height: 500px;\n	float: none !important;\n}\n.vtable input.table-focus-control::-ms-clear {\n	visibility: hidden;\n}\n.vtable input.table-focus-control.composition {\n	opacity: 1;\n	max-width: none;\n	max-height: none;\n}\n",document.head.appendChild(e)}();class tL extends y.R{static get EVENT_TYPE(){return F.B}constructor(e,t={}){var l,i,n,o,r,a,s,h,d,u,c,g,p,C,m,y,w,_,M,S,R,x,E,P;if(super(),this.showFrozenIcon=!0,this.version="1.22.11",this.id=`VTable${Date.now()}`,this.isReleased=!1,this._chartEventMap={},this.throttleInvalidate=(0,W.E5)(this.render.bind(this),200),"node"===A.X.mode?(t=e,e=null):e instanceof HTMLElement||(t=e,e=e.container?e.container:null),!e&&"node"!==t.mode&&!t.canvas)throw Error("vtable's container is undefined");this.pluginManager=new tP.Q(this,t),this.fireListeners(F.B.BEFORE_INIT,{options:t,container:e}),e=t.container&&t.container instanceof HTMLElement?t.container:e,!1===(null==(l=t.customConfig)?void 0:l.imageAnonymous)&&(G.rF.isImageAnonymous=!1);let{frozenColCount:T=0,unfreezeAllOnExceedsMaxWidth:H,frozenRowCount:L,defaultRowHeight:B=40,defaultHeaderRowHeight:I,defaultColWidth:k=80,defaultHeaderColWidth:z,widthMode:U="standard",heightMode:j="standard",autoFillWidth:K=!1,autoFillHeight:X=!1,containerFit:$={width:!1,height:!1},widthAdaptiveMode:Y="only-body",heightAdaptiveMode:J="only-body",keyboardOptions:q,eventOptions:Q,rowSeriesNumber:ee,enableCheckboxCascade:et,enableHeaderCheckboxCascade:el,columnResizeMode:ei,rowResizeMode:en="none",resize:eo,dragHeaderMode:er,dragOrder:ea,showFrozenIcon:es,allowFrozenColCount:eh,padding:ed,hover:ec,menu:eg,select:ep,customRender:ef,pixelRatio:eC=eu.V,renderChartAsync:em,renderChartAsyncBatchCount:eb,mode:ey,modeParams:ew,canvasWidth:e_,canvasHeight:eM,contentOffsetX:ex,contentOffsetY:eE,overscrollBehavior:eP,limitMinWidth:eA,limitMinHeight:eT,clearDOM:eL=!0}=t,{groupConfig:eF,groupBy:eB,groupTitleFieldFormat:eI,groupTitleCustomLayout:ek,enableTreeStickCell:eD}=t;this.container=e,this.options=t,this._widthMode=U,this._heightMode=j,this._widthAdaptiveMode=Y,this._heightAdaptiveMode=J,this._autoFillWidth=K,this._autoFillHeight=X,void 0!==$&&(this._containerFit="boolean"==typeof $?{width:$,height:$}:$&&"object"==typeof $?{width:null==(i=$.width)||i,height:null==(n=$.height)||n}:{width:!1,height:!1}),this.customRender=ef,this.padding={top:0,right:0,left:0,bottom:0},ed&&("number"==typeof ed?(this.padding.top=ed,this.padding.left=ed,this.padding.bottom=ed,this.padding.right=ed):(ed.top&&(this.padding.top=ed.top),ed.bottom&&(this.padding.bottom=ed.bottom),ed.left&&(this.padding.left=ed.left),ed.right&&(this.padding.right=ed.right))),((0,v.Z)(eM)||(0,v.Z)(e_))&&(this.canvasSizeSeted=!0),this.tableNoFrameWidth=0,this.tableNoFrameHeight=0,this.contentOffsetX=null!=ex?ex:0,this.contentOffsetY=null!=eE?eE:0,this.canvasWidth=(0,ev.Z)(e_)?e_:void 0,this.canvasHeight=(0,ev.Z)(eM)?eM:void 0,this.columnWidthComputeMode=null!=(o=t.columnWidthComputeMode)?o:"normal";let eO=this.internalProps={};void 0!==es&&(this.showFrozenIcon=es),"number"==typeof eh&&eh<=0&&(this.showFrozenIcon=!1),this.options.canvas?("node"!==A.X.mode&&(eO.element=this.options.canvas.parentElement,eO.element.style.position="relative"),eO.focusControl=new e8(this,eO.element),eO.canvas=this.options.canvas,eO.context=eO.canvas.getContext("2d")):"node"!==A.X.mode&&(eO.element=(0,b._I)(this.padding),eO.focusControl=new e8(this,eO.element),eO.canvas=document.createElement("canvas"),eO.element.appendChild(eO.canvas),eO.context=eO.canvas.getContext("2d"),(null==(r=t.customConfig)?void 0:r.createReactContainer)&&(0,tC.gw)(this)),eO.handler=new D,(0,ev.Z)(this.options.resizeTime)&&(eO.handler.resizeTime=this.options.resizeTime),eO.pixelRatio=eC,eO.frozenColCount=T,eO.frozenRowCount=L,eO.unfreezeAllOnExceedsMaxWidth=null==H||H,eO.defaultRowHeight=B,eO.defaultHeaderRowHeight=null!=I?I:B,eO.defaultColWidth=k,eO.defaultHeaderColWidth=null!=z?z:k,eO.keyboardOptions=q,eO.eventOptions=Q,eO.rowSeriesNumber=ee,eO.enableCheckboxCascade=null==(a=null!=et?et:null==ee?void 0:ee.enableTreeCheckbox)||a,eO.enableHeaderCheckboxCascade=et||null==el||el,eO.columnResizeMode=null!=(s=null==eo?void 0:eo.columnResizeMode)?s:ei,eO.canResizeColumn=null==eo?void 0:eo.canResizeColumn,eO.rowResizeMode=null!=(h=null==eo?void 0:eo.rowResizeMode)?h:en,eO.dragHeaderMode=null!=(u=null!=(d=null==ea?void 0:ea.dragHeaderMode)?d:er)?u:"none",eO.renderChartAsync=em,(0,e7.Ry)(eb),eO.overscrollBehavior=null!=eP?eP:"auto",eO.groupBy=null!=(c=null==eF?void 0:eF.groupBy)?c:eB,eO.groupTitleCheckbox=null!=(g=null==eF?void 0:eF.titleCheckbox)?g:!!(null==ee?void 0:ee.enableTreeCheckbox),eO.groupTitleFieldFormat=null!=(p=null==eF?void 0:eF.titleFieldFormat)?p:eI,eO.groupTitleCustomLayout=null!=(C=null==eF?void 0:eF.titleCustomLayout)?C:ek,eO.enableTreeStickCell=null!=(m=null==eF?void 0:eF.enableTreeStickCell)?m:eD,eO._rowHeightsMap=new te.y(this),eO._rowRangeHeightsMap=new Map,eO._colRangeWidthsMap=new Map,eO._widthResizedColMap=new Set,eO._heightResizedRowMap=new Set,this.colWidthsMap=new O.B,this.colContentWidthsMap=new O.B,this.colWidthsLimit={};let ez=this;if(eO.calcWidthContext={_:eO,get full(){var eW,eN;return"node"===A.X.mode?ez.canvasWidth/(null!=eC?eC:1):this._.canvas.width/(null!=(eN=null!=(eW=this._.context.pixelRatio)?eW:ez.internalProps.pixelRatio)?eN:window.devicePixelRatio)}},eO.cellTextOverflows={},eO.focusedTable=!1,eO.theme=N.ZP.of(null!=(y=t.theme)?y:N.ZP.DEFAULT),eO.theme.isPivot=this.isPivotTable(),(0,eR.E6)(eO.theme.functionalIconsStyle),e&&(eL&&(e.innerHTML=""),e.appendChild(eO.element)),this._updateSize(),eO.bodyHelper=new eH(this),eO.headerHelper=new e2(this),eO.rowSeriesNumberHelper=new tt(this),eO.autoWrapText=t.autoWrapText,eO.enableLineBreak=t.enableLineBreak,eO.allowFrozenColCount=null!=(w=t.allowFrozenColCount)?w:0,eO.limitMaxAutoWidth=null!=(_=t.limitMaxAutoWidth)?_:450,eO.limitMinWidth=null!=eA?"number"==typeof eA?eA:10*!!eA:10,eO.limitMinHeight=null!=eT?"number"==typeof eT?eT:10*!!eT:10,this.scenegraph=new V.Y(this),this.stateManager=new Z.O(this),this.eventManager=new eS(this),this.animationManager=new tR(this),t.legends){eO.legends=[];let e=to.F.getFunction("createLegend");if(Array.isArray(t.legends)){for(let l=0;l<t.legends.length;l++)eO.legends.push(e(t.legends[l],this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}else eO.legends.push(e(t.legends,this)),this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}if(eO.tooltip=Object.assign({parentElement:this.getElement(),renderMode:"html",isShowOverflowTextTooltip:!1,confine:!0,position:f.u.bottom},t.tooltip),"html"===eO.tooltip.renderMode){let e=to.F.getComponent("tooltipHandler");e&&(eO.tooltipHandler=new e(this,eO.tooltip.confine))}eO.menu=Object.assign({renderMode:"html"},t.menu),Array.isArray(null==(M=t.menu)?void 0:M.dropDownMenuHighlight)&&this.setDropDownMenuHighlight(null==(S=t.menu)?void 0:S.dropDownMenuHighlight),(Array.isArray(null==(R=t.menu)?void 0:R.defaultHeaderMenuItems)||"function"==typeof(null==(x=t.menu)?void 0:x.defaultHeaderMenuItems))&&(this.globalDropDownMenu=t.menu.defaultHeaderMenuItems),"html"===eO.menu.renderMode&&(eO.menuHandler=new(to.F.getComponent("menuHandler"))(this)),this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyMergeTitleCache=new Map,this.bodyBottomStyleCache=new Map,eO.stick={changedCells:new Map},eO.customMergeCell=tE(t.customMergeCell);let eV=to.F.getComponent("customCellStylePlugin");eV&&(this.customCellStylePlugin=new eV(this,null!=(E=t.customCellStyle)?E:[],null!=(P=t.customCellStyleArrangement)?P:[])),this._adjustCanvasSizeByOption()}_adjustCanvasSizeByOption(){"auto"!==this.options.canvasHeight&&"auto"!==this.options.canvasWidth||setTimeout(()=>{var e,t,l,i,n,o,r,a,s,h,d,u,c,g,p,f,C,v,m,b,y,w,_,M;let S,R;if("auto"===this.options.canvasHeight){let c=0;if(null==(e=this.theme.frameStyle)?void 0:e.innerBorder)c+=null!=(i=tA(null!=(l=null==(t=this.internalProps.theme.frameStyle)?void 0:t.shadowBlur)?l:[0])[1])?i:0;else if(this.theme.frameStyle){let e=tA(null!=(o=null==(n=this.internalProps.theme.frameStyle)?void 0:n.borderLineWidth)?o:[null]),t=tA(null!=(a=null==(r=this.internalProps.theme.frameStyle)?void 0:r.shadowBlur)?a:[0]);c+=(null!=(s=e[0])?s:0)+(null!=(h=t[0])?h:0)+((null!=(d=e[2])?d:0)+(null!=(u=t[2])?u:0))}R=Math.min(this.options.maxCanvasHeight?this.options.maxCanvasHeight-c:2e4,this.getAllRowsHeight())+c}else R=this.canvasHeight;if("auto"===this.options.canvasWidth){let e=0;if(null==(c=this.theme.frameStyle)?void 0:c.innerBorder)e+=null!=(f=tA(null!=(p=null==(g=this.internalProps.theme.frameStyle)?void 0:g.shadowBlur)?p:[0])[2])?f:0;else if(this.theme.frameStyle){let t=tA(null!=(v=null==(C=this.internalProps.theme.frameStyle)?void 0:C.borderLineWidth)?v:[null]),l=tA(null!=(b=null==(m=this.internalProps.theme.frameStyle)?void 0:m.shadowBlur)?b:[0]);e+=(null!=(y=t[1])?y:0)+(null!=(w=l[1])?w:0)+((null!=(_=t[3])?_:0)+(null!=(M=l[3])?M:0))}S=Math.min(this.options.maxCanvasWidth?this.options.maxCanvasWidth-e:2e4,this.getAllColsWidth())+e}else S=this.canvasWidth;this.setCanvasSize(S,R)},0)}getContainer(){return this.container}getElement(){return this.internalProps.element}get canvas(){return this.internalProps.canvas}setCanvasSize(e,t){this.canvasWidth=e,this.canvasHeight=t,this.options.canvasHeight=t,this.options.canvasWidth=e,this.resize()}setContentInsetXY(e,t){this.contentOffsetX=e,this.contentOffsetY=t,this.options.contentOffsetX=e,this.options.contentOffsetY=t,this.resize()}resize(){var e;this._updateSize(),null==(e=this.internalProps.legends)||e.forEach(e=>{null==e||e.resize()}),this.internalProps.title&&this.internalProps.title.resize(),this.internalProps.emptyTip&&this.internalProps.emptyTip.resize(),this.scenegraph.resize()}get rowCount(){return this.internalProps.rowCount}set rowCount(e){this.internalProps.rowCount=e}get colCount(){var e;return null!=(e=this.internalProps.colCount)?e:0}set colCount(e){this.internalProps.colCount=e}get frozenColCount(){var e,t,l,i,n;return null!=(n=null!=(l=null==(t=null==(e=this.internalProps)?void 0:e.layoutMap)?void 0:t.frozenColCount)?l:null==(i=this.internalProps)?void 0:i.frozenColCount)?n:0}set frozenColCount(e){e>=this.colCount&&(e=0),this.internalProps.frozenColCount=e,this.options.frozenColCount=e;let t=this._getMaxFrozenWidth();if(this.getColsWidth(0,e-1)>t)if(this.internalProps.unfreezeAllOnExceedsMaxWidth)this.internalProps.frozenColCount=0;else{let t=this._getComputedFrozenColCount(e);this.internalProps.frozenColCount=t}this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}setFrozenColCount(e){e>=this.colCount&&(e=0),this.internalProps.frozenColCount=e,this.options.frozenColCount=e;let t=this._getMaxFrozenWidth();if(this.getColsWidth(0,e-1)>t)if(this.internalProps.unfreezeAllOnExceedsMaxWidth)this.internalProps.frozenColCount=0;else{let t=this._getComputedFrozenColCount(e);this.internalProps.frozenColCount=t}this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}_setFrozenColCount(e){e>=this.colCount&&(e=0),this.internalProps.frozenColCount=e}_resetFrozenColCount(){this.options.frozenColCount&&(this.tableNoFrameWidth-this.getColsWidth(0,this.options.frozenColCount-1)<=120?this._setFrozenColCount(0):this.frozenColCount!==this.options.frozenColCount&&this._setFrozenColCount(this.options.frozenColCount))}get frozenRowCount(){var e,t,l,i,n;return null!=(n=null!=(l=null==(t=null==(e=this.internalProps)?void 0:e.layoutMap)?void 0:t.frozenRowCount)?l:null==(i=this.internalProps)?void 0:i.frozenRowCount)?n:0}set frozenRowCount(e){this.internalProps.frozenRowCount=e,this.options.frozenRowCount=e,this.stateManager.setFrozenRow(this.internalProps.frozenRowCount)}_setFrozenRowCount(e){this.internalProps.frozenRowCount=e,this.stateManager.setFrozenRow(this.internalProps.frozenRowCount)}get rightFrozenColCount(){var e,t,l,i,n;return null!=(n=null!=(l=null==(t=null==(e=this.internalProps)?void 0:e.layoutMap)?void 0:t.rightFrozenColCount)?l:null==(i=this.internalProps)?void 0:i.rightFrozenColCount)?n:0}set rightFrozenColCount(e){this.scenegraph.dealWidthRightFrozen(e)}get bottomFrozenRowCount(){var e,t,l,i,n;return null!=(n=null!=(l=null==(t=null==(e=this.internalProps)?void 0:e.layoutMap)?void 0:t.bottomFrozenRowCount)?l:null==(i=this.internalProps)?void 0:i.bottomFrozenRowCount)?n:0}set bottomFrozenRowCount(e){this.scenegraph.dealWidthBottomFrozen(e)}get defaultRowHeight(){return(0,ev.Z)(this.internalProps.defaultRowHeight)?this.internalProps.defaultRowHeight:40}set defaultRowHeight(e){this.internalProps.defaultRowHeight=e,this.options.defaultRowHeight=e}get defaultHeaderRowHeight(){return this.internalProps.defaultHeaderRowHeight}set defaultHeaderRowHeight(e){this.internalProps.defaultHeaderRowHeight=e,this.options.defaultHeaderRowHeight=e}get defaultColWidth(){return this.internalProps.defaultColWidth}set defaultColWidth(e){this.internalProps.defaultColWidth=e,this.options.defaultColWidth=e}get defaultHeaderColWidth(){return this.internalProps.defaultHeaderColWidth}set defaultHeaderColWidth(e){this.internalProps.defaultHeaderColWidth=e,this.options.defaultHeaderColWidth=e}get colWidthsMap(){return this.internalProps._colWidthsMap}set colWidthsMap(e){this.internalProps._colWidthsMap=e}get colContentWidthsMap(){return this.internalProps._colContentWidthsMap}set colContentWidthsMap(e){this.internalProps._colContentWidthsMap=e}get _colRangeWidthsMap(){return this.internalProps._colRangeWidthsMap}set _colRangeWidthsMap(e){this.internalProps._colRangeWidthsMap=e}get _rowRangeHeightsMap(){return this.internalProps._rowRangeHeightsMap}set _rowRangeHeightsMap(e){this.internalProps._rowRangeHeightsMap=e}get rowHeightsMap(){return this.internalProps._rowHeightsMap}set rowHeightsMap(e){this.internalProps._rowHeightsMap=e}get colWidthsLimit(){return this.internalProps._colWidthsLimit}set colWidthsLimit(e){this.internalProps._colWidthsLimit=e}get keyboardOptions(){var e;return null!=(e=this.internalProps.keyboardOptions)?e:null}set keyboardOptions(e){this.internalProps.keyboardOptions=null!=e?e:void 0}get eventOptions(){var e;return null!=(e=this.internalProps.eventOptions)?e:null}set eventOptions(e){this.internalProps.eventOptions=null!=e?e:void 0}get widthMode(){return this._widthMode}set widthMode(e){e!==this._widthMode&&(this._widthMode=e,this.options.widthMode=e)}get heightMode(){return this._heightMode}set heightMode(e){e!==this._heightMode&&(this._heightMode=e,this.options.heightMode=e)}get autoFillWidth(){return this._autoFillWidth}set autoFillWidth(e){e!==this._autoFillWidth&&(this._autoFillWidth=e)}get autoFillHeight(){return this._autoFillHeight}set autoFillHeight(e){e!==this._autoFillHeight&&(this._autoFillHeight=e)}get widthAdaptiveMode(){return this._widthAdaptiveMode}set widthAdaptiveMode(e){e!==this._widthAdaptiveMode&&(this._widthAdaptiveMode=e)}get heightAdaptiveMode(){return this._heightAdaptiveMode}set heightAdaptiveMode(e){e!==this._heightAdaptiveMode&&(this._heightAdaptiveMode=e)}_colWidthDefineToPxWidth(e){return"auto"===e?0:(0,b.qf)(this,e)}_getMaxFrozenWidth(){var e;let t=null!=(e=this.options.maxFrozenWidth)?e:"80%";return(0,b.qf)(this,t)}_getComputedFrozenColCount(e){let t=this._getMaxFrozenWidth(),l=e;for(;this.getColsWidth(0,l-1)>t&&!(--l<=0););return l}_getColWidthLimits(e){let t=this.colWidthsLimit[e];if(!t)return null;let l={};return t.min&&(l.min=(0,b.qf)(this,t.min),l.minDef=t.min),t.max&&(l.max=(0,b.qf)(this,t.max),l.maxDef=t.max),l}_adjustColWidth(e,t){let l=this._getColWidthLimits(e);return Math.max((0,b.AS)(l,t),0)}get pixelRatio(){return this.internalProps.pixelRatio}setPixelRatio(e){var t;if(e!==(null==(t=this.internalProps)?void 0:t.pixelRatio)){this.internalProps.pixelRatio=e;let t=this,n=this.canvasWidth;this.internalProps.calcWidthContext={_:this.internalProps,get full(){var l,i;return"node"===A.X.mode?n/(null!=e?e:1):this._.canvas.width/(null!=(i=null!=(l=this._.context.pixelRatio)?l:t.internalProps.pixelRatio)?i:window.devicePixelRatio)}},this.scenegraph.setPixelRatio(e)}}_updateSize(){var e,t,l,i,n,o,r,a,s,h,d,u,c,g,p,f,C,m,b,y,w,_,M,S,R,x,E,P,H,L;let{padding:F}=this,B=0,I=0;if(this.tableX=this.contentOffsetX,this.tableY=this.contentOffsetY,this.options.canvas&&this.options.viewBox)B=this.options.viewBox.x2-this.options.viewBox.x1,I=this.options.viewBox.y2-this.options.viewBox.y1,(null==(e=null==this?void 0:this.scenegraph)?void 0:e.stage)&&(this.options.viewBox?this.scenegraph.stage.setViewBox(this.options.viewBox,!1):this.scenegraph.stage.resize(B,I));else if("browser"===A.X.mode){let e=this.getElement(),d=0,u=0,c=(0,v.Z)(this.canvasWidth),g=(0,v.Z)(this.canvasHeight);if(this.canvasSizeSeted&&(c&&(d=this.canvasWidth),g&&(u=this.canvasHeight)),(!c||!g)&&e.parentElement){let t=e.parentElement.style||window.getComputedStyle(e.parentElement);c||(d=e.parentElement.offsetWidth-(parseInt(t.paddingLeft,10)||0)-(parseInt(t.paddingRight,10)||0)),g||(u=e.parentElement.offsetHeight-parseInt(t.paddingTop||"0px",10)-parseInt(t.paddingBottom||"0px",20)),d=(null!=d?d:1)-!!this.options.tableSizeAntiJitter,u=(null!=u?u:1)-!!this.options.tableSizeAntiJitter}e.style.width=d&&d-F.left-F.right+"px"||"0px",e.style.height=u&&u-F.top-F.bottom+"px"||"0px";let{canvas:p}=this.internalProps;B=(null!=(l=null==(t=p.parentElement)?void 0:t.offsetWidth)?l:1)-!!this.options.tableSizeAntiJitter,I=(null!=(n=null==(i=p.parentElement)?void 0:i.offsetHeight)?n:1)-!!this.options.tableSizeAntiJitter,(null==(o=null==this?void 0:this.scenegraph)?void 0:o.stage)?(null==(r=this.options)?void 0:r.viewBox)&&!(null==(a=this.options)?void 0:a.canvas)&&this.scenegraph.stage.resize(B,I):(p.style.width="",p.style.height="",p.width=B,p.height=I,p.style.width=`${B}px`,p.style.height=`${I}px`),(null==(s=this.options)?void 0:s.viewBox)&&(B=this.options.viewBox.x2-this.options.viewBox.x1,I=this.options.viewBox.y2-this.options.viewBox.y1),(null==(h=null==this?void 0:this.scenegraph)?void 0:h.stage)&&(this.options.viewBox?this.scenegraph.stage.setViewBox(this.options.viewBox,!1):this.scenegraph.stage.resize(B,I))}else"node"===A.X.mode&&(B=this.canvasWidth-1,I=this.canvasHeight-1);let k=this.getTheme().scrollStyle,D=0,O=0;D=this.shouldVScrollBarWidthShow(B,I,k)?T.Iv(k):0,O=this.shouldHScrollBarWidthShow(B,I,k)?T.vP(k):0;let z=Math.floor(B-D),W=Math.floor(I-O);if(null==(d=this.internalProps.theme)?void 0:d.frameStyle){let e=tA(null!=(c=null==(u=this.internalProps.theme.frameStyle)?void 0:u.borderLineWidth)?c:[null]),t=tA(null!=(p=null==(g=this.internalProps.theme.frameStyle)?void 0:g.shadowBlur)?p:[0]);if(null==(f=this.theme.frameStyle)?void 0:f.innerBorder)this.tableX+=this.contentOffsetX,this.tableY+=this.contentOffsetY,this.tableNoFrameWidth=z-(null!=(C=t[1])?C:0)-this.contentOffsetX,this.tableNoFrameHeight=W-(null!=(m=t[2])?m:0)-this.contentOffsetY;else{this.tableX+=(null!=(b=e[3])?b:0)+(null!=(y=t[3])?y:0),this.tableY+=(null!=(w=e[0])?w:0)+(null!=(_=t[0])?_:0);let l=(null!=(M=e[1])?M:0)+(null!=(S=t[1])?S:0);this.tableNoFrameWidth=z-(l>D?l-D:0)-((null!=(R=e[3])?R:0)+(null!=(x=t[3])?x:0))-this.contentOffsetX;let i=(null!=(E=e[2])?E:0)+(null!=(P=t[2])?P:0);this.tableNoFrameHeight=W-(i>O?i-O:0)-((null!=(H=e[0])?H:0)+(null!=(L=t[0])?L:0))-this.contentOffsetY}}this._clearColRangeWidthsMap(),this._clearRowRangeHeightsMap()}shouldVScrollBarWidthShow(e,t,l){if(l.hoverOn||"none"===l.visible)return!1;let i=this.getAllRowsHeight(),n=l.visible?T.vP(l):0;if(i>t-n&&i<=t){let t=this.getAllColsWidth(),i=l.visible?T.Iv(l):0;if(t>e-i&&t<=e)return!1;if(t>e)return!0;if(t<=e-i)return!1}return!(i<=t-n)}shouldHScrollBarWidthShow(e,t,l){if(l.hoverOn||"none"===l.visible)return!1;let i=this.getAllColsWidth(),n=l.visible?T.Iv(l):0;if(i>e-n&&i<=e){let e=this.getAllRowsHeight(),i=l.visible?T.vP(l):0;if(e>t-i&&e<=t)return!1;if(e>t)return!0;if(e<=t-i)return!1}return!(i<=e-n)}updateViewBox(e){var t,l,i,n,o,r,a,s,h,d,u,c;let g=(null!=(i=null==(l=null==(t=this.options)?void 0:t.viewBox)?void 0:l.x2)?i:0)-(null!=(r=null==(o=null==(n=this.options)?void 0:n.viewBox)?void 0:o.x1)?r:0),p=(null!=(h=null==(s=null==(a=this.options)?void 0:a.viewBox)?void 0:s.y2)?h:0)-(null!=(c=null==(u=null==(d=this.options)?void 0:d.viewBox)?void 0:u.y1)?c:0),f=e.x2-e.x1,C=e.y2-e.y1;this.options.viewBox=e,g!==f||p!==C?this.resize():this.scenegraph.stage.setViewBox(this.options.viewBox,!0)}setViewBoxTransform(e,t,l,i,n,o){this.internalProps.modifiedViewBoxTransform=!0,this.scenegraph.stage.window.setViewBoxTransform(e,t,l,i,n,o)}get rowHierarchyType(){return this.dataSource.rowHierarchyType}getColsWidth(e,t){var l;if(e>t)return 0;e=Math.max(e,0),t=Math.min(t,(null!=(l=this.colCount)?l:1/0)-1);let i=this._colRangeWidthsMap.get(`$${e}$${t}`);if(null!=i)return i;let n=this._colRangeWidthsMap.get(`$${e}$${t-1}`);if(null!=n){let l=n+this.getColWidth(t);return this.rightFrozenColCount>0&&t===this.colCount-this.rightFrozenColCount&&(l=this._getRangeSizeForContainerFit(e,t,l,"col")),e>=0&&t>=0&&!Number.isNaN(l)&&this._colRangeWidthsMap.set(`$${e}$${t}`,Math.round(l)),Math.round(l)}let o=0;for(let l=e;l<=t;l++)o+=this.getColWidth(l);return o=this._getRangeSizeForContainerFit(e,t,o,"col"),e>=0&&t>=0&&this._colRangeWidthsMap.set(`$${e}$${t}`,Math.round(o)),Math.round(o)}getRowHeight(e){var t;if((0,v.Z)(this.rowHeightsMap.get(e))){if(null==(t=this.options.customConfig)?void 0:t._disableColumnAndRowSizeRound){let t=this.rowHeightsMap.get(e);return Number.isInteger(Number((e<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,e):e>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(e,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,e)).toFixed(2)))?Math.ceil(t):Math.floor(t)}return this.rowHeightsMap.get(e)}let l=this.getDefaultRowHeight(e);return(0,ev.Z)(l)?l:this.defaultRowHeight}getDefaultColumnWidth(e){var t,l;return this.isRowHeader(e,0)||this.isCornerHeader(e,0)?Array.isArray(this.defaultHeaderColWidth)?null!=(t=this.defaultHeaderColWidth[e])?t:this.defaultColWidth:this.defaultHeaderColWidth:this.isRightFrozenColumn(e,this.columnHeaderLevelCount)&&this.isPivotTable()?Array.isArray(this.defaultHeaderColWidth)?null!=(l=this.defaultHeaderColWidth[this.rowHeaderLevelCount-this.rightFrozenColCount])?l:this.defaultColWidth:this.defaultHeaderColWidth:this.defaultColWidth}getDefaultRowHeight(e){var t,l;return this.isColumnHeader(0,e)||this.isCornerHeader(0,e)||this.isSeriesNumberInHeader(0,e)?Array.isArray(this.defaultHeaderRowHeight)?null!=(t=this.defaultHeaderRowHeight[e])?t:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.isBottomFrozenRow(e)?Array.isArray(this.defaultHeaderRowHeight)?null!=(l=this.defaultHeaderRowHeight[this.columnHeaderLevelCount>0?this.columnHeaderLevelCount-this.bottomFrozenRowCount:0])?l:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.internalProps.defaultRowHeight}_setRowHeight(e,t,l){var i;this.rowHeightsMap.put(e,(null==(i=this.options.customConfig)?void 0:i._disableColumnAndRowSizeRound)?t:Math.round(t)),l&&this._clearRowRangeHeightsMap(e)}setRowHeight(e,t){this.scenegraph.setRowHeight(e,t),this.scenegraph.updateChartSizeForResizeRowHeight(e),this.internalProps._heightResizedRowMap.add(e)}getRowsHeight(e,t){var l,i,n;if(e>t||0===this.rowCount)return 0;e=Math.max(e,0),t=Math.min(t,(null!=(l=this.rowCount)?l:1/0)-1);let o=0,r="auto"===this.options.defaultRowHeight;if("standard"!==this.heightMode||this.options.customComputeRowHeight||this.autoFillHeight||!this.internalProps.layoutMap||this.hasAutoImageColumn()||r||0!==this.internalProps._heightResizedRowMap.size){if(null==(i=this.options.customConfig)?void 0:i._disableColumnAndRowSizeRound){let l=this.rowHeightsMap.getSumInRange(e,t);return Number.isInteger(Number((t<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,t):t>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(t,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,t)).toFixed(2)))?Math.ceil(l):Math.floor(l)}o=this.rowHeightsMap.getSumInRange(e,t)}else{let l=this.rowCount-this.bottomFrozenRowCount;for(let l=e;l<Math.min(t+1,this.columnHeaderLevelCount);l++)o+=this.getRowHeight(l);t>=this.columnHeaderLevelCount&&(o+=this.defaultRowHeight*(Math.min(t,l-1)-Math.max(this.columnHeaderLevelCount,e)+1));let i=0;for(let e=l;e<t+1;e++)i+=this.getRowHeight(e);o=this._getRangeSizeForContainerFit(e,t,o+i,"row")}return(null==(n=this.options.customConfig)?void 0:n._disableColumnAndRowSizeRound)?o:Math.round(o)}_getRangeSizeForContainerFit(e,t,l,i="col"){var n;if(!isFinite(e)||!isFinite(t))return l;let o="col"===i?{totalCount:"colCount",frozenCount:"rightFrozenColCount",fitType:"width",tableSize:"tableNoFrameWidth",getSize:"getColWidth"}:{totalCount:"rowCount",frozenCount:"bottomFrozenRowCount",fitType:"height",tableSize:"tableNoFrameHeight",getSize:"getRowHeight"},r=this[o.tableSize];if(l>=r)return l;let a=this[o.totalCount]-this[o.frozenCount];if(!isFinite(this[o.totalCount])||this[o.frozenCount]<=0||a<0||e>a||t<a||e===t||!(null==(n=this.containerFit)?void 0:n[o.fitType]))return l;let s=this[o.totalCount]-1,h=r;if(e>0){for(let t=0;t<e;t++)if((h-=this[o.getSize](t))<=0)return l}if(t!==s){for(let e=t+1;e<=s;e++)if((h-=this[o.getSize](e))<=0)return l}return h}getColWidthDefined(e){var t;let{layoutMap:l}=this.internalProps;if("autoWidth"===this.widthMode)return"auto";let{width:i}=null!=(t=null==l?void 0:l.getColumnWidthDefined(e))?t:{};return"number"==typeof i&&i<=0?0:i||this.getDefaultColumnWidth(e)}getColWidthDefinedNumber(e){let t=this.getColWidthDefined(e);return this._adjustColWidth(e,this._colWidthDefineToPxWidth(t))}isAutoRowHeight(e){return"autoHeight"===this.heightMode||!!this.options.customComputeRowHeight||!!this.internalProps.rowHeightConfig||(e>=0&&e<this.columnHeaderLevelCount?"auto"===this.getDefaultRowHeight(e):"auto"===this.internalProps.defaultRowHeight)}getColWidth(e){var t;let l=null!=(t=this.colWidthsMap.get(e))?t:this.getDefaultColumnWidth(e);return"adaptive"===this.widthMode&&"number"==typeof l||this.transpose&&"number"==typeof l?this._colWidthDefineToPxWidth(l):this._adjustColWidth(e,this._colWidthDefineToPxWidth(l))}_setColWidth(e,t,l,i){this.colWidthsMap.put(e,"number"==typeof t?Math.round(t):t),l&&this._clearColRangeWidthsMap(e),i||this.stateManager.checkFrozen()}setColWidth(e,t){this.scenegraph.setColWidth(e,t),this.scenegraph.updateChartSizeForResizeColWidth(e),this.internalProps._widthResizedColMap.add(e)}_clearColRangeWidthsMap(e){if("number"!=typeof e)this._colRangeWidthsMap.clear();else for(let t of this._colRangeWidthsMap.keys()){let l=tH.exec(t);if(l){let i=Number(l[1]),n=Number(l[2]);e>=i&&e<=n&&this._colRangeWidthsMap.delete(t)}}}_clearRowRangeHeightsMap(e){this.rowHeightsMap.clearRange()}_getColContentWidth(e){return Number(this.colContentWidthsMap.get(e))}_setColContentWidth(e,t){this.colContentWidthsMap.put(e,t)}getAllRowsHeight(){var e;return(null==(e=this.internalProps)?void 0:e.rowCount)&&!(this.internalProps.rowCount<=0)?this.getRowsHeight(0,this.internalProps.rowCount-1):0}getAllColsWidth(){var e;return(null==(e=this.internalProps)?void 0:e.colCount)&&!(this.internalProps.colCount<=0)?this.getColsWidth(0,this.internalProps.colCount-1):0}getColsWidths(){let e=this.colCount,t=[];for(let l=0;l<e;l++)t.push(this.getColWidth(l));return t}getMaxColWidth(e){var t;let l=this.colWidthsLimit[e],i=null!=(t=l&&l.max)?t:1/0;return"string"==typeof i&&(i=(0,b.qf)(this,i)),i}setMaxColWidth(e,t){(this.colWidthsLimit[e]||(this.colWidthsLimit[e]={})).max=t}getMinColWidth(e){var t;let l=this.colWidthsLimit[e],i=null!=(t=l&&l.min)?t:0;return"string"==typeof i&&(i=(0,b.qf)(this,i)),i}setMinColWidth(e,t){(this.colWidthsLimit[e]||(this.colWidthsLimit[e]={})).min=t}getCellRect(e,t){var l,i;let n,o,r=this.isFrozenCell(e,t),a=this.getColWidth(e);n=r&&r.col&&this.isRightFrozenColumn(e,t)?this.getAllColsWidth()<=this.tableNoFrameWidth?this.getColsWidth(0,e-1)||0:this.tableNoFrameWidth-(null!=(l=this.getColsWidth(e,this.colCount-1))?l:0):this.getColsWidth(0,e-1)||0;let s=this.getRowHeight(t);return o=r&&r.row&&this.isBottomFrozenRow(e,t)?this.getAllRowsHeight()<=this.tableNoFrameHeight?this.getRowsHeight(0,t-1):this.tableNoFrameHeight-(null!=(i=this.getRowsHeight(t,this.rowCount-1))?i:0):this.getRowsHeight(0,t-1),new z.U(Math.round(n),Math.round(o),Math.round(a),Math.round(s))}getMergeCellRect(e,t){let l=this.getCellRange(e,t),i=this.getColsWidth(0,l.start.col-1)||0,n=this.getColsWidth(l.start.col,l.end.col),o=this.getRowsHeight(0,l.start.row-1)||0,r=this.getRowsHeight(l.start.row,l.end.row);return new z.U(Math.round(i),Math.round(o),Math.round(n),Math.round(r))}getCellRelativeRect(e,t){let l=this.isFrozenCell(e,t),i=!0,n=!0;(null==l?void 0:l.col)&&(null==l?void 0:l.row)?(i=!1,n=!1):(null==l?void 0:l.col)?i=!1:(null==l?void 0:l.row)&&(n=!1);let o=this.getCellRect(e,t);return this._toRelativeRect(o,i,n)}getCellRangeRelativeRect(e){if(e.start){let t=this.isFrozenCell(e.start.col,e.start.row),l=!0,i=!0;return(null==t?void 0:t.col)&&(null==t?void 0:t.row)?(l=!1,i=!1):(null==t?void 0:t.col)?l=!1:(null==t?void 0:t.row)&&(i=!1),this._toRelativeRect(this.getCellsRect(e.start.col,e.start.row,e.end.col,e.end.row),l,i)}let t=this.getCellRange(e.col,e.row),l=this.isFrozenCell(e.col,e.row),i=!0,n=!0;return(null==l?void 0:l.col)&&(null==l?void 0:l.row)?(i=!1,n=!1):(null==l?void 0:l.col)?i=!1:(null==l?void 0:l.row)&&(n=!1),this._toRelativeRect(this.getCellsRect(t.start.col,t.start.row,t.end.col,t.end.row),i,n)}getVisibleCellRangeRelativeRect(e){let t;return t=e.start?e:this.getCellRange(e.col,e.row),this._getVisiableRect(this.getCellRangeRelativeRect(e),t)}_getVisiableRect(e,t){let l=t.start.col>=this.frozenColCount?Math.max(e.left,this.frozenColCount>=1?this.getColsWidth(0,this.frozenColCount-1):0):e.left,i=Math.min(e.right,this.tableNoFrameWidth),n=e.copy();n.left=l,n.right=i;let o=t.start.row>=this.frozenRowCount?Math.max(e.top,this.frozenRowCount>=1?this.getRowsHeight(0,this.frozenRowCount-1):0):e.top,r=Math.min(e.bottom,this.tableNoFrameHeight);return n.top=o,n.bottom=r,n}getCellsRect(e,t,l,i){var n,o,r,a,s,h;let d=this.getColsWidth(0,e-1)||0,u=this.getColsWidth(e,l),c=this.scrollLeft,g=Math.min(this.tableNoFrameWidth,this.getAllColsWidth()),p=Math.min(this.tableNoFrameHeight,this.getAllRowsHeight());this.isLeftFrozenColumn(e)&&this.isRightFrozenColumn(l)?u=this.tableNoFrameWidth-(null!=(n=this.getColsWidth(e+1,this.colCount-1))?n:0)-d:this.isLeftFrozenColumn(e)&&!this.isLeftFrozenColumn(l)?u=Math.max(u-c,this.getColsWidth(e,this.frozenColCount-1)):!this.isRightFrozenColumn(e)&&this.isRightFrozenColumn(l)?(d=Math.min(d-c,g-this.getRightFrozenColsWidth()),u=g-(null!=(o=this.getColsWidth(e+1,this.colCount-1))?o:0)-d):this.isRightFrozenColumn(e)&&(d=g-(null!=(r=this.getColsWidth(e,this.colCount-1))?r:0));let f=this.getRowsHeight(0,t-1),C=this.getRowsHeight(t,i),v=this.scrollTop;return this.isTopFrozenRow(t)&&this.isBottomFrozenRow(i)?C=this.tableNoFrameHeight-(null!=(a=this.getRowsHeight(t+1,this.rowCount-1))?a:0)-f:this.isTopFrozenRow(t)&&!this.isTopFrozenRow(i)?C=Math.max(C-v,this.getRowsHeight(t,this.frozenRowCount-1)):!this.isBottomFrozenRow(t)&&this.isBottomFrozenRow(i)?(f=Math.min(f-v,p-this.getBottomFrozenRowsHeight()),C=p-(null!=(s=this.getRowsHeight(t+1,this.rowCount-1))?s:0)-f):this.isBottomFrozenRow(t)&&(f=p-(null!=(h=this.getRowsHeight(t,this.rowCount-1))?h:0)),new z.U(Math.round(d),Math.round(f),Math.round(u),Math.round(C))}getCellsRectWidth(e,t,l,i){let n=this.isFrozenCell(e,t),o=this.isFrozenCell(l,i),r=this.getColsWidth(e,l);if(n&&n.col){let t=this.scrollLeft;o&&o.col||(r-=t,r=Math.max(r,this.getColsWidth(e,this.frozenColCount-1)))}return r}getCellRangeRect(e){if(e.start)return this.getCellsRect(e.start.col,e.start.row,e.end.col,e.end.row);let t=this.getCellRange(e.col,e.row);return this.getCellsRect(t.start.col,t.start.row,t.end.col,t.end.row)}getCellRangeRectWidth(e){if(e.start)return this.getCellsRectWidth(e.start.col,e.start.row,e.end.col,e.end.row);let t=this.getCellRange(e.col,e.row);return this.getCellsRectWidth(t.start.col,t.start.row,t.end.col,t.end.row)}isFrozenCell(e,t){let l=this.isFrozenRow(t),i=this.isFrozenColumn(e);return l||i?{row:l,col:i}:null}getRowAt(e){return tr(e,this)}getColAt(e){return ta(e,this)}getCellAt(e,t){let{row:l,top:i,bottom:n,height:o}=tr(t,this),{col:r,left:a,right:s,width:h}=ta(e,this);return{row:l,col:r,rect:{left:a,right:s,top:i,bottom:n,width:h,height:o}}}getCellAtRelativePosition(e,t){return function(e,t,l){e-=l.tableX;let i=!1;(t-=l.tableY)>0&&t<l.getFrozenRowsHeight()&&(i=!0);let n=!1;e>0&&e<l.getFrozenColsWidth()&&(n=!0);let o=!1;t>l.tableNoFrameHeight-l.getBottomFrozenRowsHeight()&&t<l.tableNoFrameHeight&&t<=l.getAllRowsHeight()&&(o=!0);let r=!1;e>l.tableNoFrameWidth-l.getRightFrozenColsWidth()&&e<l.tableNoFrameWidth&&e<=l.getAllColsWidth()&&(r=!0);let a=td((n||r?e:e+l.scrollLeft)+l.tableX,r,l),s=tu((i||o?t:t+l.scrollTop)+l.tableY,o,l);if(a&&s){let{row:e,top:t,bottom:l,height:i}=s,{col:n,left:o,right:r,width:h}=a;return{row:e,col:n,rect:{left:o,right:r,top:t,bottom:l,width:h,height:i}}}return{col:-1,row:-1}}(e,t,this)}getColAtRelativePosition(e){return function(e,t){let l=!1;(e-=t.tableX)>0&&e<t.getFrozenColsWidth()&&(l=!0);let i=!1;e>t.tableNoFrameWidth-t.getRightFrozenColsWidth()&&e<t.tableNoFrameWidth&&e<=t.getAllColsWidth()&&(i=!0);let n=td((l||i?e:e+t.scrollLeft)+t.tableX,i,t);if(n){let{col:e}=n;return e}return -1}(e,this)}getRowAtRelativePosition(e){return function(e,t){let l=!1;(e-=t.tableY)>0&&e<t.getFrozenRowsHeight()&&(l=!0);let i=!1;e>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight()&&e<t.tableNoFrameHeight&&e<=t.getAllRowsHeight()&&(i=!0);let n=tu((l||i?e:e+t.scrollTop)+t.tableY,i,t);if(n){let{row:e}=n;return e}return -1}(e,this)}_checkRowCol(e,t){return e>=0&&e<this.colCount&&t>=0&&t<this.rowCount}_makeVisibleCell(e,t){if(this._checkRowCol(e,t)){let l=this.isFrozenCell(e,t);if(l&&l.col&&l.row)return;let i=this.getCellRect(e,t),n=(0,b.VN)(this);!n.contains(i)&&(l&&l.col||this.getColsWidth(0,this.frozenColCount-1)+i.width>this.canvas.width||(i.left<n.left?this.scrollLeft-=n.left-i.left:n.right<i.right&&(this.scrollLeft-=n.right-i.right)),l&&l.row||this.getRowsHeight(0,this.frozenRowCount-1)+i.height>this.canvas.height||(i.top<n.top?this.scrollTop-=n.top-i.top:n.bottom<i.bottom&&(this.scrollTop-=n.bottom-i.bottom)))}}render(){this.scenegraph.renderSceneGraph()}renderAsync(){return this.scenegraph.updateNextFrame(),new Promise((e,t)=>{setTimeout(()=>{e()},0)})}_toRelativeRect(e,t=!0,l=!0){var i,n,o,r;let a=e.copy(),s=this.getVisibleRect();return a.offsetLeft(this.tableX-(t?s.left:0)),a.offsetTop(this.tableY-(l?s.top:0)),a.offsetLeft(null!=(n=null==(i=this.options.viewBox)?void 0:i.x1)?n:0),a.offsetTop(null!=(r=null==(o=this.options.viewBox)?void 0:o.y1)?r:0),a}getVisibleRect(){let{scrollTop:e,scrollLeft:t}=this,l=this.tableNoFrameWidth,i=this.tableNoFrameHeight;return new z.U(t,e,l,i)}get visibleRowCount(){let{frozenRowCount:e}=this,t=this.getVisibleRect(),l=e>0?t.top+this.getRowsHeight(0,e-1):t.top,i=this.getTargetRowAt(l);if(!i)return 0;let n=Math.max(i.top>=l?i.row:i.row+1,e),o=this.getRowsHeight(0,n-1),r=0,{rowCount:a}=this;for(let e=n;e<a;e++){let l=o+this.getRowHeight(e);if(t.bottom<l)break;r++,o=l}return r}getBodyVisibleCellRange(){let{scrollTop:e,scrollLeft:t}=this,l=this.getFrozenRowsHeight(),i=this.getFrozenColsWidth(),n=this.getBottomFrozenRowsHeight(),o=this.getRightFrozenColsWidth(),{row:r}=this.getRowAt(e+l+1),{col:a}=this.getColAt(t+i+1),s=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(e+this.tableNoFrameHeight-1-n).row:this.rowCount-1,h=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(t+this.tableNoFrameWidth-1-o).col:this.colCount-1;return h<0||s<0?null:{rowStart:r,colStart:a,rowEnd:s,colEnd:h}}getBodyVisibleRowRange(e=0,t=0){let{scrollTop:l}=this,i=this.getFrozenRowsHeight(),n=this.getBottomFrozenRowsHeight(),{row:o}=this.getRowAt(l+i+1+e),r=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(l+this.tableNoFrameHeight-1-n+t).row:this.rowCount-1;return r<0?null:{rowStart:o,rowEnd:r}}getBodyVisibleColRange(e=0,t=0){let{scrollLeft:l}=this,i=this.getFrozenColsWidth(),n=this.getRightFrozenColsWidth(),{col:o}=this.getColAt(l+i+1+e),r=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(l+this.tableNoFrameWidth-1-n+t).col:this.colCount-1;return r<0?null:{colStart:o,colEnd:r}}get visibleColCount(){let{frozenColCount:e}=this,t=this.getVisibleRect(),l=e>0?t.left+this.getColsWidth(0,e-1):t.left,i=this.getTargetColAt(l);if(!i)return 0;let n=Math.max(i.left>=l?i.col:i.col+1,e),o=this.getColsWidth(0,n-1),r=0,{colCount:a}=this;for(let e=n;e<a;e++){let l=o+this.getColWidth(e);if(t.right<l)break;r++,o=l}return r}get scrollTop(){return this.stateManager.scroll.verticalBarPos}set scrollTop(e){this.stateManager.setScrollTop(e)}get scrollLeft(){return this.stateManager.scroll.horizontalBarPos}set scrollLeft(e){this.stateManager.setScrollLeft(e)}getScrollLeft(){return this.scrollLeft}getScrollTop(){return this.scrollTop}setScrollLeft(e){this.scrollLeft=Math.ceil(e)}setScrollTop(e){this.scrollTop=Math.ceil(e)}getCellOverflowText(e,t){return this.scenegraph.getCellOverflowText(e,t)}addReleaseObj(e){if(!e||!e.release||"function"!=typeof e.release)throw Error("not releaseObj!");(this.internalProps.releaseList=this.internalProps.releaseList||[]).push(e)}dispose(){this.release()}release(){var e,t,l,i,n,o,r,a,s,h,d,u,c,g,p,f,C;let v=this.internalProps;if(this.isReleased)return;null==(t=null==(e=v.tooltipHandler)?void 0:e.release)||t.call(e),null==(i=null==(l=v.menuHandler)?void 0:l.release)||i.call(l),null==(n=super.release)||n.call(this),this.pluginManager.release(),null==(r=null==(o=v.handler)?void 0:o.release)||r.call(o),this.eventManager.release(),null==(s=null==(a=v.focusControl)?void 0:a.release)||s.call(a),null==(h=v.legends)||h.forEach(e=>{null==e||e.release()}),null==(d=v.title)||d.release(),v.title=null,null==(u=v.emptyTip)||u.release(),v.emptyTip=null,v.layoutMap.release(),v.releaseList&&(v.releaseList.forEach(e=>{var t;return null==(t=null==e?void 0:e.release)?void 0:t.call(e)}),v.releaseList=null),this.scenegraph.stage.release(),this.scenegraph.proxy.release();let m=null==(c=v.element)?void 0:c.parentElement;m&&!this.options.canvas&&m.removeChild(v.element),null==(f=null==(p=null==(g=this.editorManager)?void 0:g.editingEditor)?void 0:p.onEnd)||f.call(p),this.isReleased=!0,this.scenegraph=null,this.internalProps=null,null==(C=this.reactCustomLayout)||C.clearCache(),(0,e7.H6)()}fireListeners(e,t){return super.fireListeners(e,t)}updateOption(e,t={clearColWidthCache:!0,clearRowHeightCache:!0}){var l,i,n,o,r,a,s,h,d,u,c,g,p,C,v,m,y,w,_,M,S,R,x,E,P,T;this.fireListeners(F.B.BEFORE_UPDATE_OPTION,{options:e,container:this.container}),null==(l=this.editorManager)||l.cancelEdit(),this.options=e,this._hasAutoImageColumn=void 0;let{frozenColCount:H=0,unfreezeAllOnExceedsMaxWidth:L,defaultRowHeight:B=40,defaultHeaderRowHeight:I,defaultColWidth:k=80,defaultHeaderColWidth:D=80,keyboardOptions:z,eventOptions:W,rowSeriesNumber:V,enableCheckboxCascade:Z,enableHeaderCheckboxCascade:U,columnResizeMode:G,rowResizeMode:j="none",resize:K,dragHeaderMode:X,dragOrder:$,showFrozenIcon:Y,allowFrozenColCount:J,padding:q,hover:Q,menu:ee,select:et,pixelRatio:el,widthMode:ei,heightMode:en,autoFillWidth:eo,autoFillHeight:er,containerFit:ea,widthAdaptiveMode:es,heightAdaptiveMode:eh,customRender:ed,renderChartAsync:eu,renderChartAsyncBatchCount:ec,canvasWidth:eg,canvasHeight:ep,contentOffsetX:ef=0,contentOffsetY:eC=0,overscrollBehavior:em,limitMinWidth:eb,limitMinHeight:ey}=e,{groupConfig:ew,groupBy:e_,groupTitleFieldFormat:eM,groupTitleCustomLayout:eS,enableTreeStickCell:ex}=e;el&&el!==this.internalProps.pixelRatio&&(this.internalProps.pixelRatio=el),q&&("number"==typeof q?(this.padding.top=q,this.padding.left=q,this.padding.bottom=q,this.padding.right=q):(q.top&&(this.padding.top=q.top),q.bottom&&(this.padding.bottom=q.bottom),q.left&&(this.padding.left=q.left),q.right&&(this.padding.right=q.right))),this.showFrozenIcon="boolean"!=typeof Y||Y,"number"==typeof J&&J<=0&&(this.showFrozenIcon=!1),this.widthMode=null!=ei?ei:"standard",this.heightMode=null!=en?en:"standard",this._widthAdaptiveMode=null!=es?es:"only-body",this._heightAdaptiveMode=null!=eh?eh:"only-body",this.autoFillWidth=null!=eo&&eo,this.autoFillHeight=null!=er&&er,void 0!==ea&&(this._containerFit="boolean"==typeof ea?{width:ea,height:ea}:ea&&"object"==typeof ea?{width:null==(i=ea.width)||i,height:null==(n=ea.height)||n}:{width:!1,height:!1}),this.customRender=ed,this.contentOffsetX=null!=ef?ef:0,this.contentOffsetY=null!=eC?eC:0,this.canvasWidth=(0,ev.Z)(eg)?eg:void 0,this.canvasHeight=(0,ev.Z)(ep)?ep:void 0;let eE=this.internalProps;if("node"===A.X.mode||e.canvas||(0,b.gX)(eE.element,this.padding),this.columnWidthComputeMode=null!=(o=e.columnWidthComputeMode)?o:"normal",eE.frozenColCount=H,eE.unfreezeAllOnExceedsMaxWidth=null==L||L,eE.defaultRowHeight=B,eE.defaultHeaderRowHeight=null!=I?I:B,eE.defaultColWidth=k,eE.defaultHeaderColWidth=null!=D?D:k,eE.keyboardOptions=z,eE.eventOptions=W,eE.rowSeriesNumber=V,eE.enableCheckboxCascade=null==(r=null!=Z?Z:null==V?void 0:V.enableTreeCheckbox)||r,eE.enableHeaderCheckboxCascade=Z||null==U||U,eE.columnResizeMode=null!=(a=null==K?void 0:K.columnResizeMode)?a:G,eE.canResizeColumn=null==K?void 0:K.canResizeColumn,eE.rowResizeMode=null!=(s=null==K?void 0:K.rowResizeMode)?s:j,eE.dragHeaderMode=null!=(d=null!=(h=null==$?void 0:$.dragHeaderMode)?h:X)?d:"none",eE.renderChartAsync=eu,(0,e7.Ry)(ec),eE.overscrollBehavior=null!=em?em:"auto",eE.cellTextOverflows={},eE.groupBy=null!=(u=null==ew?void 0:ew.groupBy)?u:e_,eE.groupTitleCheckbox=null==ew?void 0:ew.titleCheckbox,eE.groupTitleFieldFormat=null!=(c=null==ew?void 0:ew.titleFieldFormat)?c:eM,eE.groupTitleCustomLayout=null!=(g=null==ew?void 0:ew.titleCustomLayout)?g:eS,eE.enableTreeStickCell=null!=(p=null==ew?void 0:ew.enableTreeStickCell)?p:ex,(null==t?void 0:t.clearColWidthCache)&&(eE._widthResizedColMap.clear(),this.colWidthsMap=new O.B,this.colContentWidthsMap=new O.B,this.colWidthsLimit={}),(null==t?void 0:t.clearRowHeightCache)&&(eE._heightResizedRowMap.clear(),eE._rowHeightsMap=new te.y(this),eE._rowRangeHeightsMap=new Map,eE._colRangeWidthsMap=new Map),eE.stick.changedCells.clear(),eE.theme=N.ZP.of(null!=(C=e.theme)?C:N.ZP.DEFAULT),eE.theme.isPivot=this.isPivotTable(),(0,eR.E6)(eE.theme.functionalIconsStyle),this.scenegraph.updateStageBackground(),eE.autoWrapText=e.autoWrapText,eE.enableLineBreak=e.enableLineBreak,eE.allowFrozenColCount=null!=(v=e.allowFrozenColCount)?v:0,eE.limitMaxAutoWidth=null!=(m=e.limitMaxAutoWidth)?m:450,eE.limitMinWidth=null!=eb?"number"==typeof eb?eb:10*!!eb:10,eE.limitMinHeight=null!=ey?"number"==typeof ey?ey:10*!!ey:10,null==(y=eE.legends)||y.forEach(e=>{null==e||e.release()}),null==(w=eE.title)||w.release(),eE.title=null,null==(_=eE.emptyTip)||_.release(),eE.emptyTip=null,eE.layoutMap.release(),(0,e7.H6)(),this.scenegraph.clearCells(),this.scenegraph.updateComponent(),this.stateManager.updateOptionSetState(),this._updateSize(),this.eventManager.updateEventBinder(),e.legends){eE.legends=[];let t=to.F.getFunction("createLegend");if(Array.isArray(e.legends)){for(let l=0;l<e.legends.length;l++)eE.legends.push(t(e.legends[l],this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}else eE.legends.push(t(e.legends,this)),this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}eE.tooltip=Object.assign({parentElement:this.getElement(),renderMode:"html",isShowOverflowTextTooltip:!1,confine:!0,position:f.u.bottom},e.tooltip),"html"!==eE.tooltip.renderMode||eE.tooltipHandler||(eE.tooltipHandler=new(to.F.getComponent("tooltipHandler"))(this,eE.tooltip.confine)),eE.menu=Object.assign({renderMode:"html"},e.menu),Array.isArray(null==(M=e.menu)?void 0:M.dropDownMenuHighlight)&&this.setDropDownMenuHighlight(null==(S=e.menu)?void 0:S.dropDownMenuHighlight),(Array.isArray(null==(R=e.menu)?void 0:R.defaultHeaderMenuItems)||"function"==typeof(null==(x=e.menu)?void 0:x.defaultHeaderMenuItems))&&(this.globalDropDownMenu=e.menu.defaultHeaderMenuItems),"html"!==eE.menu.renderMode||eE.menuHandler||(eE.menuHandler=new(to.F.getComponent("menuHandler"))(this)),this.clearCellStyleCache(),(null==t?void 0:t.clearColWidthCache)&&this.clearColWidthCache(),(null==t?void 0:t.clearRowHeightCache)&&this.clearRowHeightCache(),eE.customMergeCell=tE(e.customMergeCell),null==(E=this.customCellStylePlugin)||E.updateCustomCell(null!=(P=e.customCellStyle)?P:[],null!=(T=e.customCellStyleArrangement)?T:[]),this._adjustCanvasSizeByOption()}renderWithRecreateCells(){this.internalProps.stick.changedCells.clear();let e={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(e.col,e.row),this.render()}getFrozenRowsHeight(){return this.getRowsHeight(0,this.frozenRowCount-1)}getFrozenColsWidth(){return this.getColsWidth(0,this.frozenColCount-1)}getBottomFrozenRowsHeight(){if(this.bottomFrozenRowCount>0){let e=0;for(let t=this.rowCount-this.bottomFrozenRowCount;t<=this.rowCount-1;t++)e+=this.getRowHeight(t);return e}return 0}getRightFrozenColsWidth(){if(this.rightFrozenColCount>0){let e=0;for(let t=this.colCount-this.rightFrozenColCount;t<=this.colCount-1;t++)e+=this.getColWidth(t);return e}return 0}getDrawRange(){var e,t;let l=(null==(e=this.containerFit)?void 0:e.width)?this.tableNoFrameWidth:Math.min(this.tableNoFrameWidth,this.getAllColsWidth()),i=(null==(t=this.containerFit)?void 0:t.height)?this.tableNoFrameHeight:Math.min(this.tableNoFrameHeight,this.getAllRowsHeight());return new z.U(this.tableX,this.tableY,l,i)}_getMouseAbstractPoint(e){var t,l,i,n,o,r,a,s;let h;if(!e)return{inTable:!1,x:void 0,y:void 0};let d=(h=tT(e)?e.changedTouches[0]:e).clientX||h.pageX+window.scrollX,u=h.clientY||h.pageY+window.scrollY,c=this.internalProps.canvas.getBoundingClientRect(),g=!0;c.right<=d&&(g=!1),c.bottom<=u&&(g=!1);let p=c.width,f=p/((90===this.rotateDegree?this.canvas.offsetHeight:this.canvas.offsetWidth)||p),C=c.height,v=C/((90===this.rotateDegree?this.canvas.offsetWidth:this.canvas.offsetHeight)||C),m=this.pluginManager.getPluginByName("Rotate Table");if(m&&90===this.rotateDegree){let e={x:d/f-(null!=(l=null==(t=this.options.viewBox)?void 0:t.x1)?l:0),y:u/v-(null!=(n=null==(i=this.options.viewBox)?void 0:i.y1)?n:0),inTable:g};return m.matrix.transformPoint(e,e),e}let b={x:(d-c.left)/f-(null!=(r=null==(o=this.options.viewBox)?void 0:o.x1)?r:0),y:(u-c.top)/v-(null!=(s=null==(a=this.options.viewBox)?void 0:a.y1)?s:0),inTable:g};return this.internalProps.modifiedViewBoxTransform&&this.scenegraph.stage.window.getViewBoxTransform()&&this.scenegraph.stage.window.getViewBoxTransform().transformPoint(b,b),b}getTheme(){return this.internalProps.theme}getTargetColAt(e){return ts(e,this)}getTargetRowAt(e){let t=th(e,this);return t&&(t.row=Math.min(t.row,this.rowCount-1)),t}getTargetColAtConsiderRightFrozen(e,t){return td(e,t,this)}getTargetRowAtConsiderBottomFrozen(e,t){return tu(e,t,this)}clearSelected(){this.stateManager.updateSelectPos(-1,-1)}selectCell(e,t,l,i,n,o=!1){var r,a,s;let h=!!(null==(r=this.stateManager.select.ranges)?void 0:r.length);this.stateManager.updateSelectPos(e,t,l,i,!1,null==(s=null!=n?n:null==(a=this.options.select)?void 0:a.makeSelectCellVisible)||s,o),this.stateManager.endSelectCells(!0,h)}selectCells(e){let{scrollLeft:t,scrollTop:l}=this;e.forEach((e,t)=>{var l,i,n,o,r,a;let s=e.start.row,h=e.start.col,d=e.end.row,u=e.end.col;h===u&&s===d?this.stateManager.updateSelectPos(h,s,!1,t>=1,!1,null==(i=null==(l=this.options.select)?void 0:l.makeSelectCellVisible)||i,!0):(this.stateManager.updateSelectPos(h,s,!1,t>=1,!1,null==(o=null==(n=this.options.select)?void 0:n.makeSelectCellVisible)||o,!0),this.stateManager.updateInteractionState(H.F.grabing),this.stateManager.updateSelectPos(u,d,!1,t>=1,!1,null==(a=null==(r=this.options.select)?void 0:r.makeSelectCellVisible)||a,!0)),this.stateManager.endSelectCells(!1,!1),this.stateManager.updateInteractionState(H.F.default)}),this.setScrollTop(l),this.setScrollLeft(t)}selectRow(e,t,l){let i=this.stateManager.select.ranges;if(t)i.push({start:{col:0,row:e},end:{col:this.colCount-1,row:e}}),this.selectCells(i);else if(l){let t=i[i.length-1];t&&(t.end.row=e),this.selectCells(i)}else this.selectCells([{start:{col:0,row:e},end:{col:this.colCount-1,row:e}}])}selectCol(e,t,l){let i=this.stateManager.select.ranges;if(t)i.push({start:{col:e,row:0},end:{col:e,row:this.rowCount-1}}),this.selectCells(i);else if(l){let t=i[i.length-1];t&&(t.end.col=e),this.selectCells(i)}else this.selectCells([{start:{col:e,row:0},end:{col:e,row:this.rowCount-1}}])}startDragSelectCol(e,t,l){var i,n,o,r,a,s;let h=this.stateManager.select.ranges[this.stateManager.select.ranges.length-1],d=l&&(null==(i=null==h?void 0:h.start)?void 0:i.col)?null==(n=null==h?void 0:h.start)?void 0:n.col:e,u=this.rowCount-1;this.stateManager.updateSelectPos(d,0,l,t,!1,null==(r=null==(o=this.options.select)?void 0:o.makeSelectCellVisible)||r,!0),this.stateManager.updateInteractionState(H.F.grabing),this.stateManager.updateSelectPos(e,u,l,t,!1,null==(s=null==(a=this.options.select)?void 0:a.makeSelectCellVisible)||s,!0),this.stateManager.select.selecting=!1}dragSelectCol(e,t){var l,i;let n=this.stateManager.select.ranges,o=n[n.length-1];o&&(o.end.col=e),this.stateManager.updateSelectPos(e,this.rowCount-1,!1,t,!1,null==(i=null==(l=this.options.select)?void 0:l.makeSelectCellVisible)||i,!0),this.stateManager.select.selecting=!1}endDragSelect(){this.stateManager.updateInteractionState(H.F.default)}startDragSelectRow(e,t,l){var i,n,o,r,a,s;let h=this.stateManager.select.ranges[this.stateManager.select.ranges.length-1],d=l&&(null==(i=null==h?void 0:h.start)?void 0:i.row)?null==(n=null==h?void 0:h.start)?void 0:n.row:e,u=this.colCount-1;this.stateManager.updateSelectPos(0,d,l,t,!1,null==(r=null==(o=this.options.select)?void 0:o.makeSelectCellVisible)||r,!0),this.stateManager.updateInteractionState(H.F.grabing),this.stateManager.updateSelectPos(u,e,l,t,!1,null==(s=null==(a=this.options.select)?void 0:a.makeSelectCellVisible)||s,!0),this.stateManager.select.selecting=!1}dragSelectRow(e,t){var l,i;let n=this.stateManager.select.ranges,o=n[n.length-1];o&&(o.end.row=e),this.stateManager.updateSelectPos(this.colCount-1,e,!1,t,!1,null==(i=null==(l=this.options.select)?void 0:l.makeSelectCellVisible)||i,!0),this.stateManager.select.selecting=!1}get recordsCount(){var e;return null==(e=this.records)?void 0:e.length}get allowFrozenColCount(){return this.internalProps.allowFrozenColCount}get rowHeaderLevelCount(){return this.internalProps.layoutMap.rowHeaderLevelCount}get columnHeaderLevelCount(){return this.internalProps.layoutMap.columnHeaderLevelCount}get records(){return this.internalProps.records}get dataSource(){return this.internalProps.dataSource}set dataSource(e){this.scenegraph.clearCells(),(0,b.x6)(this,e),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()}get autoWrapText(){return this.internalProps.autoWrapText}set autoWrapText(e){this.internalProps.autoWrapText=e,this.options.autoWrapText=e}get enableLineBreak(){return this.internalProps.enableLineBreak}set enableLineBreak(e){this.internalProps.enableLineBreak=e,this.options.enableLineBreak=e}updateAutoWrapText(e){this.internalProps.autoWrapText!==e&&(this.internalProps.autoWrapText=e,this.options.autoWrapText=e,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.render())}get theme(){return this.internalProps.theme}set theme(e){this.internalProps.theme=N.ZP.of(null!=e?e:N.ZP.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),this.options.theme=e,(0,eR.E6)(this.internalProps.theme.functionalIconsStyle)}updateTheme(e){let t={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.theme=N.ZP.of(null!=e?e:N.ZP.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),(0,eR.E6)(this.internalProps.theme.functionalIconsStyle),this.options.theme=e,this.scenegraph.updateComponent(),this.scenegraph.updateStageBackground(),this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(t.col,t.row),this.render()}getBodyField(e,t){return this.internalProps.layoutMap.getBody(e,t).field}getBodyColumnDefine(e,t){let l=this.internalProps.layoutMap.getBody(e,t);return null==l?void 0:l.define}getBodyColumnType(e,t){var l,i;let n=null!=(i=null==(l=this.internalProps.layoutMap.getBody(e,t))?void 0:l.cellType)?i:"text";return(0,e6.WJ)("cellType",{cellType:n},e,t,this)}getCellType(e,t){let l;return this.isSeriesNumberInHeader(e,t)?this.internalProps.layoutMap.getSeriesNumberHeader(e,t).cellType:(l=this.isHeader(e,t)?this.internalProps.layoutMap.getHeader(e,t).headerType:this.internalProps.layoutMap.getBody(e,t).cellType,(0,e6.WJ)("cellType",{cellType:l},e,t,this))}getHeaderField(e,t){return this.internalProps.layoutMap.getHeaderField(e,t)}getHeaderDefine(e,t){let l=this.internalProps.layoutMap.getHeader(e,t);return null==l?void 0:l.define}getCellLocation(e,t){return this.internalProps.layoutMap.getCellLocation(e,t)}getCellHeaderPaths(e,t){return this.internalProps.layoutMap.getCellHeaderPaths(e,t)}getHeadersDefine(e,t){let l=[];for(;;){let i=this.getHeaderDefine(e,t);if(!i||!i.field&&!i.columns)break;l.push(i),t++}return l}_getHeaderLayoutMap(e,t){return this.internalProps.layoutMap.getHeader(e,t)}_getBodyLayoutMap(e,t){return this.internalProps.layoutMap.getBody(e,t)}getContext(){return this.internalProps.context}getRecordByCell(e,t){if(!this.internalProps.layoutMap.isHeader(e,t))return this.getCellOriginRecord(e,t)}getRecordByRowCol(e,t){return this.getRecordByCell(e,t)}getRecordStartRowByRecordIndex(e){return this.internalProps.layoutMap.getRecordStartRowByRecordIndex(e)}_getHeaderCellBySortState(e){let{layoutMap:t}=this.internalProps,l=t.headerObjects.find(t=>t&&t.field===e.field);if(l)return t.getHeaderCellAdressById(l.id)}getCellRange(e,t){var l;if(this.internalProps.customMergeCell){let l=this.internalProps.customMergeCell(e,t,this);if(l&&l.range&&((0,v.Z)(l.text)||l.customLayout||l.customRender))return{start:{col:Math.max(l.range.start.col,0),row:Math.max(l.range.start.row,0)},end:{col:Math.min(l.range.end.col,this.colCount-1),row:Math.min(l.range.end.row,this.rowCount-1)},isCustom:!0}}return null==(l=this.internalProps.layoutMap)?void 0:l.getCellRange(e,t)}hasCustomMerge(){return!!this.internalProps.customMergeCell}getCustomMerge(e,t){if(this.internalProps.customMergeCell){let l=this.internalProps.customMergeCell(e,t,this);if(l&&l.range&&((0,v.Z)(l.text)||l.customLayout||this.customRender)){if(l.style){let i=this.internalProps.bodyHelper.getStyleClass("text"),n=P(l.style,this.theme.bodyStyle,{col:e,row:t,table:this,value:l.text,dataValue:this.getCellOriginValue(e,t),cellHeaderPaths:this.getCellHeaderPaths(e,t)},i,this.options.autoWrapText,this.theme);l.style=n}return l.range={start:{col:Math.max(l.range.start.col,0),row:Math.max(l.range.start.row,0)},end:{col:Math.min(l.range.end.col,this.colCount-1),row:Math.min(l.range.end.row,this.rowCount-1)},isCustom:!0},l}}}isCellRangeEqual(e,t,l,i){return this.internalProps.layoutMap.isCellRangeEqual(e,t,l,i)}_getLayoutCellId(e,t){return this.internalProps.layoutMap.getCellId(e,t)}getHeaderDescription(e,t){var l;let i=this._getHeaderLayoutMap(e,t),n=null==i?void 0:i.define,o=null!=(l=null==n?void 0:n.description)?l:null==i?void 0:i.description;return"function"==typeof o?o({col:e,row:t,value:this.getCellValue(e,t),dataValue:this.getCellOriginValue(e,t)}):o}setDropDownMenuHighlight(e){this.stateManager.setDropDownMenuHighlight(e)}_dropDownMenuIsHighlight(e,t,l){return this.stateManager.dropDownMenuIsHighlight(e,t,l)}isSeriesNumberInBody(e,t){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInBody(e,t)}isSeriesNumberInHeader(e,t){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInHeader(e,t)}isHeader(e,t){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isHeader(e,t)}isColumnHeader(e,t){var l;return null==(l=this.internalProps.layoutMap)?void 0:l.isColumnHeader(e,t)}isRowHeader(e,t){var l;return null==(l=this.internalProps.layoutMap)?void 0:l.isRowHeader(e,t)}isCornerHeader(e,t){var l;return null==(l=this.internalProps.layoutMap)?void 0:l.isCornerHeader(e,t)}isFrozenColumn(e,t){return this.isLeftFrozenColumn(e,t)||this.isRightFrozenColumn(e,t)}isLeftFrozenColumn(e,t){var l;return null==(l=this.internalProps.layoutMap)?void 0:l.isFrozenColumn(e,t)}isRightFrozenColumn(e,t){var l;return null==(l=this.internalProps.layoutMap)?void 0:l.isRightFrozenColumn(e,t)}isFrozenRow(e,t){return this.isTopFrozenRow(e,t)||this.isBottomFrozenRow(e,t)}isTopFrozenRow(e,t){var l;return null==(l=this.internalProps.layoutMap)?void 0:l.isFrozenRow(e,t)}isBottomFrozenRow(e,t){var l;return null==(l=this.internalProps.layoutMap)?void 0:l.isBottomFrozenRow(e,t)}getCellInfo(e,t){if(e>=0&&t>=0){let l=this.isHeader(e,t)?this.getHeaderDefine(e,t):this.getBodyColumnDefine(e,t);return{col:e,row:t,field:this.getHeaderField(e,t),cellHeaderPaths:this.internalProps.layoutMap.getCellHeaderPaths(e,t),title:null==l?void 0:l.title,cellType:this.getCellType(e,t),originData:this.getCellOriginRecord(e,t),cellRange:this.getCellRangeRelativeRect({col:e,row:t}),value:this.getCellValue(e,t),dataValue:this.getCellOriginValue(e,t),cellLocation:this.getCellLocation(e,t),scaleRatio:this.canvas.getBoundingClientRect().width/this.canvas.offsetWidth}}}_hasField(e,t,l){var i;if(null===e||this.internalProps.layoutMap.isHeader(t,l))return!1;let n=this.getRecordShowIndexByCell(t,l);return null==(i=this.internalProps.dataSource)?void 0:i.hasField(n,e)}_getCellStyle(e,t){return function(e,t,l){var i,n,o,r,a,s,h,d,u,c;let g,p,f,C=null==(i=l.customCellStylePlugin)?void 0:i.getCustomCellStyle(e,t),{layoutMap:v}=l.internalProps;if(v.isHeader(e,t)){let i,s;if(!l.isPivotTable()||l.isBottomFrozenRow(t)||l.isRightFrozenColumn(e))i=`${e}-${t}`;else{let n=l.getHeaderDefine(e,t),o=l.isCornerHeader(e,t);i=(null==n?void 0:n.dimensionKey)?o?`dim-cor-${n.dimensionKey}`:`dim-${n.dimensionKey}`:(null==n?void 0:n.indicatorKey)?`ind-${n.indicatorKey}`:`${e}-${t}`}let h=l.headerStyleCache.get(i);if(h)return C?(0,tp.wh)(h,C):h;let d=v.getHeader(e,t);if(l.isPivotChart()&&(0,tc.Vp)(e,t,v)&&v.isAxisCell(e,t)?s=null!=(o=null==(n=v.getBody(e,l.rowHeaderLevelCount).style)?void 0:n.padding)?o:l.theme.bodyStyle.padding:l.isPivotChart()&&(0,tc.iN)(e,t,v)&&v.isAxisCell(e,t)&&(s=null!=(a=null==(r=v.getBody(l.columnHeaderLevelCount,t).style)?void 0:r.padding)?a:l.theme.bodyStyle.padding),(!d||d.isEmpty)&&(v.isLeftBottomCorner(e,t)||v.isRightBottomCorner(e,t)||v.isCornerHeader(e,t)||v.isRightTopCorner(e,t)))return tf;let u=l.internalProps.headerHelper.getStyleClass((null==d?void 0:d.headerType)||"text");if(v.isBottomFrozenRow(e,t)&&l.theme.bottomFrozenStyle)h=tg(s?{padding:s}:{},l.theme.bottomFrozenStyle,{col:e,row:t,table:l,value:l.getCellValue(e,t),dataValue:l.getCellOriginValue(e,t),cellHeaderPaths:l.getCellHeaderPaths(e,t)},u,l.options.autoWrapText,l.theme);else if(v.isRightFrozenColumn(e,t)&&l.theme.rightFrozenStyle)h=tg(s?{padding:s}:{},l.theme.rightFrozenStyle,{col:e,row:t,table:l,value:l.getCellValue(e,t),dataValue:l.getCellOriginValue(e,t),cellHeaderPaths:l.getCellHeaderPaths(e,t)},u,l.options.autoWrapText,l.theme);else{let i=(null==d?void 0:d.style)||{};s&&(i.padding=s),h=tg(i,v.isColumnHeader(e,t)||v.isBottomFrozenRow(e,t)?l.theme.headerStyle:v.isRowHeader(e,t)||v.isRightFrozenColumn(e,t)?l.theme.rowHeaderStyle:l.theme.cornerHeaderStyle,{col:e,row:t,table:l,value:l.getCellValue(e,t),dataValue:l.getCellOriginValue(e,t),cellHeaderPaths:l.getCellHeaderPaths(e,t)},u,l.options.autoWrapText,l.theme)}return l.headerStyleCache.set(i,h),C?(0,tp.wh)(h,C):h}(null==(h=null==(s=l.internalProps)?void 0:s.dataConfig)?void 0:h.mappingRules)&&!l.isHeader(e,t)&&(null==(c=null==(u=null==(d=l.internalProps)?void 0:d.dataConfig)?void 0:u.mappingRules)||c.forEach((i,n)=>{i.bgColor&&l.internalProps.layoutMap.getIndicatorKey(e,t)===i.bgColor.indicatorKey&&(g=i.bgColor.mapping)}));let m=l.getCellType(e,t),b=l.getCellOriginRecord(e,t);if(p=(null==b?void 0:b.vtableMerge)?"merge-title":l.isSeriesNumberInBody(e,t)?`${e}-series-`+m:l.isListTable()&&!l.transpose||l.isPivotTable()&&l.internalProps.layoutMap.indicatorsAsCol?e+m:t+m,f=(null==b?void 0:b.vtableMerge)?l.bodyMergeTitleCache.get(p):v.isBottomFrozenRow(t)?l.bodyBottomStyleCache.get(p):l.bodyStyleCache.get(p))return C?(0,tp.wh)(f,C):f;let y=v.getBody(e,t),w=l.internalProps.bodyHelper.getStyleClass(l.getCellType(e,t)),_=null==y?void 0:y.style;return f=P(_,(null==b?void 0:b.vtableMerge)&&l.theme.groupTitleStyle?l.theme.groupTitleStyle:v.isBottomFrozenRow(t)&&l.theme.bottomFrozenStyle?l.theme.bottomFrozenStyle:v.isRightFrozenColumn(e)&&l.theme.rightFrozenStyle?l.theme.rightFrozenStyle:l.theme.bodyStyle,{col:e,row:t,table:l,value:l.getCellValue(e,t),dataValue:l.getCellOriginValue(e,t),cellHeaderPaths:l.getCellHeaderPaths(e,t)},w,l.options.autoWrapText,l.theme),g&&(f=(0,tp.wh)(f,{bgColor:g})),(0,j.Z)(_)||(v.isBottomFrozenRow(t)?l.bodyBottomStyleCache.set(p,f):l.bodyStyleCache.set(p,f)),C?(0,tp.wh)(f,C):f}(e,t,this)}clearCellStyleCache(){this.headerStyleCache.clear(),this.bodyStyleCache.clear(),this.bodyMergeTitleCache.clear(),this.bodyBottomStyleCache.clear()}clearRowHeightCache(){this.internalProps._rowHeightsMap.clear(),this._clearRowRangeHeightsMap()}clearColWidthCache(){this.internalProps._colWidthsMap.clear(),this._clearColRangeWidthsMap()}_canResizeColumn(e,t){if(!(e>=0&&t>=0)||this.isCellRangeEqual(e,t,e+1,t)||"none"===this.internalProps.columnResizeMode)return!1;if("header"===this.internalProps.columnResizeMode){if(!this.isHeader(e,t))return!1}else if("body"===this.internalProps.columnResizeMode&&this.isHeader(e,t))return!1;let l=this.colWidthsLimit[e];return!(l&&l.min&&l.max)||l.max!==l.min}_canResizeRow(e,t){if(!(e>=0&&t>=0)||this.isCellRangeEqual(e,t,e,t+1)||"none"===this.internalProps.rowResizeMode)return!1;if("header"===this.internalProps.rowResizeMode){if(!this.isHeader(e,t))return!1}else if("body"===this.internalProps.rowResizeMode&&this.isHeader(e,t))return!1;return!0}_canDragHeaderPosition(e,t){var l;if(this.isHeader(e,t)&&(this.stateManager.isSelected(e,t)||"body"===(null==(l=this.options.select)?void 0:l.headerSelectMode)&&(0,tx.i)(e,t,[this.getCellRange(this.stateManager.select.cellPos.col,this.stateManager.select.cellPos.row)])||(0,ec.wP)(this,e,t))){if("disabled"===this.internalProps.frozenColDragHeaderMode&&this.isFrozenColumn(e))return!1;if(this.stateManager.isSelected(e,t)){let l=this.stateManager.select.ranges[0];if(this.isColumnHeader(e,t)){if(l.end.row!==this.rowCount-1)return!1}else if(!this.isRowHeader(e,t)||l.end.col!==this.colCount-1)return!1}let l=this.getHeaderDefine(e,t);if(!l)return!1;if(void 0===l.dragHeader){if("all"===this.internalProps.dragHeaderMode)return!0;if("column"===this.internalProps.dragHeaderMode){if(this.isColumnHeader(e,t))return!0}else if("row"===this.internalProps.dragHeaderMode&&this.isRowHeader(e,t))return!0;return!1}return l.dragHeader}return!1}getCellIcons(e,t){var l,i,n;let o;if(this.isHeader(e,t))o=this.internalProps.headerHelper.getIcons(e,t);else if(this.internalProps.layoutMap.isSeriesNumber(e,t)){this.internalProps.groupBy&&(null==(l=this.getCellRawRecord(e,t))?void 0:l.vtableMerge)||null==(n=null==(i=this.internalProps.layoutMap.getSeriesNumberBody(e,t))?void 0:i.define)||!n.dragOrder||(o=this.internalProps.rowSeriesNumberHelper.getIcons(e,t));let r=this.getCellValue(e,t),a=this.getCellOriginValue(e,t),s=this.internalProps.context,h=this.internalProps.bodyHelper.getIcons(e,t,r,a,s);(null==o?void 0:o.length)>0?o=o.concat(h):(null==h?void 0:h.length)>0&&(o=h)}else{let l=this.getCellValue(e,t),i=this.getCellOriginValue(e,t),n=this.internalProps.context;o=this.internalProps.bodyHelper.getIcons(e,t,l,i,n)}return o}showDropDownMenu(e,t,l){let i="dropdown-menu";l&&(i=Array.isArray(l.content)?"dropdown-menu":"container"),"html"===this.internalProps.menu.renderMode&&(this.stateManager.menu.isShow=!0,this.internalProps.menuHandler._bindToCell(e,t,i,l))}showTooltip(e,t,l){"html"===this.internalProps.tooltip.renderMode&&this.internalProps.tooltipHandler._bindToCell(e,t,l)}getCellStyle(e,t){let l=this._getCellStyle(e,t),i=(0,b.RT)(l,this,e,t,e6.WJ).theme,{autoWrapText:n,lineClamp:o,textOverflow:r}=l;return{textAlign:i.text.textAlign,textBaseline:i.text.textBaseline,bgColor:(0,e3.Z)(i.group.fill)?(0,e6.WJ)("bgColor",l,e,t,this):i.group.fill,color:(0,e3.Z)(i.text.fill)?(0,e6.WJ)("color",l,e,t,this):i.text.fill,strokeColor:(0,e3.Z)(i.text.stroke)?(0,e6.WJ)("strokeColor",l,e,t,this):i.text.stroke,fontFamily:i.text.fontFamily,fontSize:i.text.fontSize,fontWeight:i.text.fontWeight,fontVariant:i.text.fontVariant,fontStyle:i.text.fontStyle,lineHeight:i.text.lineHeight,autoWrapText:null!=n&&n,lineClamp:null!=o?o:"auto",textOverflow:r,borderColor:(0,e3.Z)(i.group.stroke)?(0,e6.WJ)("borderColor",l,e,t,this):i.group.stroke,borderLineWidth:i.group.lineWidth,borderLineDash:i.group.lineDash,underline:!!i.text.underline,underlineDash:i.text.underlineDash,underlineOffset:i.text.underlineOffset,lineThrough:!!i.text.lineThrough,padding:i._vtable.padding,underlineWidth:i.text.underline,lineThroughLineWidth:i.text.lineThrough,_strokeArrayWidth:i.group.strokeArrayWidth,_strokeArrayColor:i.group.strokeArrayColor,_linkColor:(0,e6.WJ)("linkColor",l,e,t,this)}}getAllBodyCells(e,t){let l=this.rowHeaderLevelCount,i=this.columnHeaderLevelCount,n=this.colCount-1;return Array(Math.min(null!=t?t:2e3,this.rowCount-1-i+1,this.rowCount)).fill(0).map((t,o)=>Array(Math.min(null!=e?e:2e3,n-l+1,this.colCount)).fill(0).map((e,t)=>this.getCellInfo(t+l,o+i)))}getAllCells(e,t){let l=this.colCount-1;return Array(Math.min(null!=t?t:2e3,this.rowCount-1-0+1,this.rowCount)).fill(0).map((t,i)=>Array(Math.min(null!=e?e:2e3,l-0+1,this.colCount)).fill(0).map((e,t)=>this.getCellInfo(t+0,i+0)))}getAllColumnHeaderCells(){let e=this.rowHeaderLevelCount,t=this.colCount-1;return Array(this.columnHeaderLevelCount-1-0+1).fill(0).map((l,i)=>Array(t-e+1).fill(0).map((t,l)=>this.getCellInfo(l+e,i+0)))}getAllRowHeaderCells(){let e=this.columnHeaderLevelCount,t=this.rowHeaderLevelCount-1;return Array(this.rowCount-1-e+1).fill(0).map((l,i)=>Array(t-0+1).fill(0).map((t,l)=>this.getCellInfo(l+0,i+e)))}getCopyValue(e){var t,l,i;if((null==(l=null==(t=this.stateManager.select)?void 0:t.ranges)?void 0:l.length)>0){let t=this.stateManager.select.ranges,l=Math.min(t[0].start.col,t[0].end.col),n=Math.max(t[0].start.col,t[0].end.col),o=Math.min(t[0].start.row,t[0].end.row),r=Math.max(t[0].start.row,t[0].end.row);t.forEach(e=>{l=Math.min(l,e.start.col,e.end.col),n=Math.max(n,e.start.col,e.end.col),o=Math.min(o,e.start.row,e.end.row),r=Math.max(r,e.start.row,e.end.row)});let a=e=>{let l=!1;return t.forEach(t=>{let i=Math.min(t.start.row,t.end.row),n=Math.max(t.start.row,t.end.row);i<=e&&n>=e&&(l=!0)}),l},s=e=>{let l=!1;return t.forEach(t=>{let i=Math.min(t.start.col,t.end.col),n=Math.max(t.start.col,t.end.col);i<=e&&n>=e&&(l=!0)}),l},h=(e,l)=>{let i;return t.forEach(t=>{let n=Math.min(t.start.row,t.end.row),o=Math.max(t.start.row,t.end.row),r=Math.min(t.start.col,t.end.col),a=Math.max(t.start.col,t.end.col);r<=e&&a>=e&&n<=l&&o>=l&&(i=t)}),i},d=(t,l,i)=>{let n=this.getCellRange(t,l),o=n.start.col,r=n.start.row;if(i){let e=Math.min(i.start.col,i.end.col),t=Math.min(i.start.row,i.end.row);o=Math.max(e,n.start.col),r=Math.max(t,n.start.row)}return o!==t||r!==l?"":e?e(t,l):this.getCellValue(t,l)},u="";for(let e=o;e<=r;e++)if(a(e)){for(let t=l;t<=n;t++)if(s(t)){let l=h(t,e);if(l){let i=d(t,e,l);if("undefined"!=typeof Promise&&i instanceof Promise);else{let e=(0,v.Z)(i)?`${i}`:"";/^\[object .*\]$/.exec(e)||(u+=e)}(t<l.end.col||t<n)&&(u+="	")}else u+="	"}e<r&&(u+="\r\n")}return(null==(i=this.options)?void 0:i.formatCopyValue)&&(u=this.options.formatCopyValue(u)),u}return""}getSelectedCellInfos(){var e;if(!(null==(e=this.stateManager.select)?void 0:e.ranges))return null;let t=this.stateManager.select.ranges;if(!t.length)return[];let l=Math.min(t[0].start.col,t[0].end.col),i=Math.max(t[0].start.col,t[0].end.col),n=Math.min(t[0].start.row,t[0].end.row),o=Math.max(t[0].start.row,t[0].end.row);t.forEach(e=>{l=Math.min(l,e.start.col,e.end.col),i=Math.max(i,e.start.col,e.end.col),n=Math.min(n,e.start.row,e.end.row),o=Math.max(o,e.start.row,e.end.row)});let r=e=>{let l=!1;return t.forEach(t=>{let i=Math.min(t.start.row,t.end.row),n=Math.max(t.start.row,t.end.row);i<=e&&n>=e&&(l=!0)}),l},a=e=>{let l=!1;return t.forEach(t=>{let i=Math.min(t.start.col,t.end.col),n=Math.max(t.start.col,t.end.col);i<=e&&n>=e&&(l=!0)}),l},s=(e,l)=>{let i;return t.forEach(t=>{let n=Math.min(t.start.row,t.end.row),o=Math.max(t.start.row,t.end.row),r=Math.min(t.start.col,t.end.col),a=Math.max(t.start.col,t.end.col);r<=e&&a>=e&&n<=l&&o>=l&&(i=t)}),i},h=[];for(let e=n;e<=o;e++)if(r(e)){let t=[];for(let n=l;n<=i;n++)if(a(n)&&s(n,e)){let l=this.getCellInfo(n,e);t.push(l)}h.push(t)}return h}getSelectedCellRanges(){let e=this.stateManager.select.ranges;return e.length?(0,e9.Z)(e):[]}measureText(e,t){return e5.QC.measureText(e,t)}measureTextBounds(e){return(0,e5.Rc)(e)}getCustomRender(e,t){let l;if("body"!==this.getCellLocation(e,t)){let i=this.getHeaderDefine(e,t);l=null==i?void 0:i.headerCustomRender}else{let i=this.getBodyColumnDefine(e,t);l=(null==i?void 0:i.customRender)||this.customRender}return l}getCustomLayout(e,t){let l;if("body"!==this.getCellLocation(e,t)){let i=this.getHeaderDefine(e,t);l=null==i?void 0:i.headerCustomLayout}else{let i=this.getBodyColumnDefine(e,t);l=null==i?void 0:i.customLayout}return l}hasAutoImageColumn(){return void 0===this._hasAutoImageColumn&&(this._hasAutoImageColumn=(0,tn.N3)(this)),this._hasAutoImageColumn}_getActiveChartInstance(){var e,t,l,i,n,o;let r=this.scenegraph.getCell(null==(t=null==(e=this.stateManager.hover)?void 0:e.cellPos)?void 0:t.col,null==(i=null==(l=this.stateManager.hover)?void 0:l.cellPos)?void 0:i.row);return"chart"===(null==(o=null==(n=null==r?void 0:r.getChildren())?void 0:n[0])?void 0:o.type)?r.getChildren()[0].activeChartInstance:null}cellIsInVisualView(e,t){var l,i,n,o;let r,a,s,h,d=this.getDrawRange(),u=this.getCellRelativeRect(e,t);return!!(e<this.frozenColCount&&t<this.frozenRowCount||(this.frozenRowCount>=1&&(r=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}})),this.frozenColCount>=1&&(a=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.frozenColCount-1,row:this.rowCount-1}})),this.bottomFrozenRowCount>=1&&(s=this.getCellRangeRelativeRect({start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}})),this.rightFrozenColCount>=1&&(h=this.getCellRangeRelativeRect({start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.rowCount-1}})),u.top>=d.top&&u.bottom<=d.bottom&&u.left>=d.left&&u.right<=d.right&&(this.isFrozenCell(e,t)||u.top>=(null!=(l=null==r?void 0:r.bottom)?l:u.top)&&u.left>=(null!=(i=null==a?void 0:a.right)?i:u.left)&&u.bottom<=(null!=(n=null==s?void 0:s.top)?n:u.bottom)&&u.right<=(null!=(o=null==h?void 0:h.left)?o:u.right))))||!1}getCustomMergeValue(e,t){if(this.internalProps.customMergeCell){let l=this.getCustomMerge(e,t);if(l){let{text:e}=l;return e}}}exportImg(){return this.scenegraph.stage.toCanvas().toDataURL()}exportCellImg(e,t,l){var i,n,o,r;let a,s,h=this.cellIsInVisualView(e,t),{scrollTop:d,scrollLeft:u}=this;h||this.scrollToCell({col:e,row:t});let c=this.getCellRelativeRect(e,t);(null==(n=null==(i=this.stateManager.select)?void 0:i.ranges)?void 0:n.length)>0&&(0,tl.pP)(this.scenegraph);let{col:g,row:p}=this.stateManager.hover.cellPos;if(this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.tableGroup.border.setAttribute("visible",!1),null==l?void 0:l.disableBackground){let l=this.scenegraph.getCell(e,t);a=l.attribute.fill,l.setAttribute("fill","transparent")}if(null==l?void 0:l.disableBorder){let l=this.scenegraph.getCell(e,t);s=l.attribute.stroke,l.setAttribute("stroke",!1)}this.scenegraph.renderSceneGraph();let f=0;"bottom-right"===this.theme.cellBorderClipDirection&&(f=1);let C=this.scenegraph.stage.toCanvas(!1,(new e4.FB).set(c.left+this.tableX+1,c.top+this.tableY+1,c.right+this.tableX-f,c.bottom+this.tableY-f));return h||(this.setScrollTop(d),this.setScrollLeft(u)),this.scenegraph.tableGroup.border.setAttribute("visible",!0),a&&this.scenegraph.getCell(e,t).setAttribute("fill",a),s&&this.scenegraph.getCell(e,t).setAttribute("stroke",s),(null==(r=null==(o=this.stateManager.select)?void 0:o.ranges)?void 0:r.length)>0&&(0,tl.Re)(this.scenegraph),this.stateManager.updateHoverPos(g,p),this.scenegraph.updateNextFrame(),C.toDataURL()}exportCellRangeImg(e){var t,l,i,n;let{scrollTop:o,scrollLeft:r}=this,a=Math.min(e.start.col,e.end.col),s=Math.min(e.start.row,e.end.row),h=Math.max(e.start.col,e.end.col),d=Math.max(e.start.row,e.end.row),u=this.cellIsInVisualView(a,s),c=this.cellIsInVisualView(h,d);u&&c||this.scrollToCell({col:a,row:s});let g=this.getCellRangeRelativeRect({start:{col:a,row:s},end:{col:h,row:d}});(null==(l=null==(t=this.stateManager.select)?void 0:t.ranges)?void 0:l.length)>0&&(0,tl.pP)(this.scenegraph);let{col:p,row:f}=this.stateManager.hover.cellPos;this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.renderSceneGraph();let C=this.scenegraph.stage.toCanvas(!1,(new e4.FB).set(g.left+this.tableX+1,g.top+this.tableY+1,g.right+this.tableX,g.bottom+this.tableY)).toDataURL();return u&&c||(this.setScrollTop(o),this.setScrollLeft(r)),(null==(n=null==(i=this.stateManager.select)?void 0:i.ranges)?void 0:n.length)>0&&(0,tl.Re)(this.scenegraph),this.stateManager.updateHoverPos(p,f),C}exportCanvas(){return this.scenegraph.stage.toCanvas()}getImageBuffer(e="image/png"){if("node"!==this.options.mode)return;this.render();let t=this.scenegraph.stage;if(t){let l=this.tableX+this.getAllColsWidth(),i=this.tableY+this.getAllRowsHeight();return(this.internalProps.legends&&this.internalProps.legends.forEach(e=>{"right"===e.orient?l=Math.max(l,e.legendComponent.globalAABBBounds.x2):"bottom"===e.orient&&(i=Math.max(i,e.legendComponent.globalAABBBounds.y2))}),this.internalProps.title&&("right"===this.internalProps.title._titleOption.orient?l=Math.max(l,this.internalProps.title.getComponentGraphic().globalAABBBounds.x2):"bottom"===this.internalProps.title._titleOption.orient&&(i=Math.max(i,this.internalProps.title.getComponentGraphic().globalAABBBounds.y2))),l>=this.canvasWidth&&i>=this.canvasHeight)?(t.render(),t.window.getImageBuffer(e)):this.scenegraph.stage.toCanvas(!1,(new e4.FB).set(0,0,Math.min(this.canvasWidth,l),Math.min(this.canvasHeight,i))).toBuffer(e)}return null}getBodyIndexByTableIndex(e,t){return{col:e-this.rowHeaderLevelCount-this.leftRowSeriesNumberCount,row:t-this.columnHeaderLevelCount}}getTableIndexByBodyIndex(e,t){return{col:e+this.rowHeaderLevelCount+this.leftRowSeriesNumberCount,row:t+this.columnHeaderLevelCount}}onVChartEvent(e,t,l){this._chartEventMap[e]||(this._chartEventMap[e]=[]),"function"==typeof t?this._chartEventMap[e].push({callback:t}):this._chartEventMap[e].push({callback:l,query:t})}offVChartEvent(e,t){this._chartEventMap[e]&&(this._chartEventMap[e]=t?this._chartEventMap[e].filter(e=>e.callback!==t):[])}_bindChartEvent(e){if(e)for(let t in this._chartEventMap)(this._chartEventMap[t]||[]).forEach(l=>{l.query?e.on(t,l.query,l.callback):e.on(t,l.callback)})}changeRecordOrder(e,t){}hasCustomCellStyle(e){var t;return null==(t=this.customCellStylePlugin)?void 0:t.hasCustomCellStyle(e)}registerCustomCellStyle(e,t){var l;null==(l=this.customCellStylePlugin)||l.registerCustomCellStyle(e,t)}arrangeCustomCellStyle(e,t,l){var i;null==(i=this.customCellStylePlugin)||i.arrangeCustomCellStyle(e,t,l)}isSeriesNumber(e,t){return this.internalProps.layoutMap.isSeriesNumber(e,t)}isHasSeriesNumber(){var e;return(null==(e=this.internalProps.layoutMap)?void 0:e.leftRowSeriesNumberColumnCount)>0}get leftRowSeriesNumberCount(){var e,t;return null!=(t=null==(e=this.internalProps.layoutMap)?void 0:e.leftRowSeriesNumberColumnCount)?t:0}setMinMaxLimitWidth(e=!1){var t,l;let i=this.internalProps;for(let n=0;n<i.layoutMap.columnWidths.length;n++){if(this.internalProps._widthResizedColMap.has(n))continue;let{width:o,minWidth:r,maxWidth:a}=null!=(l=null==(t=i.layoutMap.columnWidths)?void 0:t[n])?l:{};e&&o&&("string"==typeof o&&"auto"!==o||"number"==typeof o&&o>0)&&this._setColWidth(n,o),r&&("number"==typeof r&&r>0||"string"==typeof r)&&this.setMinColWidth(n,r),a&&("number"==typeof a&&a>0||"string"==typeof a)&&this.setMaxColWidth(n,a)}}setSortedIndexMap(e,t){var l;null==(l=this.dataSource)||l.setSortedIndexMap(e,t)}checkReactCustomLayout(){this.reactCustomLayout||(this.reactCustomLayout=new ti.Z(this))}get bodyDomContainer(){return this.internalProps.bodyDomContainer}get headerDomContainer(){return this.internalProps.headerDomContainer}get frozenBodyDomContainer(){return this.internalProps.frozenBodyDomContainer}get frozenHeaderDomContainer(){return this.internalProps.frozenHeaderDomContainer}get rightFrozenBodyDomContainer(){return this.internalProps.rightFrozenBodyDomContainer}get rightFrozenHeaderDomContainer(){return this.internalProps.rightFrozenHeaderDomContainer}get frozenBottomDomContainer(){return this.internalProps.frozenBottomDomContainer}get bottomDomContainer(){return this.internalProps.bottomDomContainer}get rightFrozenBottomDomContainer(){return this.internalProps.rightFrozenBottomDomContainer}showMoverLine(e,t){this.scenegraph.component.showMoveCol(e,t,0),this.scenegraph.renderSceneGraph()}hideMoverLine(e,t){this.scenegraph.component.hideMoveCol(),this.scenegraph.renderSceneGraph()}disableScroll(){this.eventManager.disableScroll()}enableScroll(){this.eventManager.enableScroll()}getGroupTitleLevel(e,t){}scrollToRow(e,t){t?this.animationManager.scrollTo({row:e},t):this.scrollToCell({row:e})}scrollToCol(e,t){t?this.animationManager.scrollTo({col:e},t):this.scrollToCell({col:e})}scrollToCell(e,t){if(t)return void this.animationManager.scrollTo(e,t);let l=this.getDrawRange();if((0,v.Z)(e.col)&&e.col>=this.frozenColCount){let t=this.getFrozenColsWidth(),i=this.getColsWidth(0,e.col-1);this.scrollLeft=Math.min(i-t,this.getAllColsWidth()-l.width)}if((0,v.Z)(e.row)&&e.row>=this.frozenRowCount){let t=this.getFrozenRowsHeight(),i=this.getRowsHeight(0,e.row-1);this.scrollTop=Math.min(i-t,this.getAllRowsHeight()-l.height)}this.render()}checkHasColumnAutoWidth(){return(0,b.MO)(this)}get containerFit(){return this._containerFit}set containerFit(e){var t,l;this._containerFit="boolean"==typeof e?{width:e,height:e}:e&&"object"==typeof e?{width:null==(t=e.width)||t,height:null==(l=e.height)||l}:{width:!1,height:!1}}isColumnSelected(e){let t=this.stateManager.select.ranges;for(let l=0;l<=t.length-1;l++){let i=t[l];if(i.start.col<=e&&i.end.col>=e&&0===i.start.row&&i.end.row===this.rowCount-1)return!0}return!1}isRowSelected(e){let t=this.stateManager.select.ranges;for(let l=0;l<=t.length-1;l++){let i=t[l];if(i.start.row<=e&&i.end.row>=e&&0===i.start.col&&i.end.col===this.colCount-1)return!0}return!1}updateCellContent(e,t){this.scenegraph.updateCellContent(e,t)}updateCellContentRange(e,t,l,i){for(let n=e;n<=l;n++)for(let e=t;e<=i;e++)this.scenegraph.updateCellContent(n,e)}updateCellContentRanges(e){for(let t=0;t<e.length;t++){let l=e[t];this.updateCellContentRange(l.start.col,l.start.row,l.end.col,l.end.row)}}}let tF={};class tB{constructor(e){this.isValidatingValue=!1,this.listenersId=[],this.cacheLastSelectedCellEditor={},this.table=e;let{editCellTrigger:t="doubleclick"}=e.options;this.bindEvent(t)}bindEvent(e){let t=this.table,l=t.on(F.B.DBLCLICK_CELL,l=>{var i,n,o;if(!e.includes("doubleclick"))return;let{col:r,row:a}=l,s=(0,Q.RJ)(l.federatedEvent),h=t.scenegraph.getResizeColAt(s.abstractPos.x,s.abstractPos.y,null==(i=s.eventArgs)?void 0:i.targetCell);t._canResizeColumn(h.col,h.row)&&h.col>=0||(null==(o=null==(n=l.target)?void 0:n.attribute)?void 0:o.funcType)||(this.beginTriggerEditCellMode="doubleclick",this.startEditCell(r,a))}),i=t.on(F.B.CLICK_CELL,e=>{var l,i;let{editCellTrigger:n="doubleclick"}=t.options;if("click"===n||Array.isArray(n)&&n.includes("click")){if(null==(i=null==(l=e.target)?void 0:l.attribute)?void 0:i.funcType)return;this.beginTriggerEditCellMode="click";let{col:t,row:n}=e;this.startEditCell(t,n)}else"keydown"===n||Array.isArray(n)&&n.includes("keydown")}),n=t.on(F.B.SELECTED_CHANGED,l=>{let i=t.stateManager.select.ranges;if(1===i.length&&i[0].start.col===i[0].end.col&&i[0].start.row===i[0].end.row&&("keydown"===e||Array.isArray(e)&&e.includes("keydown"))){let{col:e,row:t}=l;this.beginTriggerEditCellMode="keydown";let i=this.table.getCellRangeRelativeRect(this.table.getCellRange(e,t)),n={rect:{left:i.left,top:i.top,width:i.width,height:i.height}};e===this.table.colCount-1?n.rect.width=i.width-1:n.rect.width=i.width+1,t===this.table.rowCount-1?n.rect.height=i.height-1:n.rect.height=i.height+1;let o=this.table.getEditor(e,t);o&&setTimeout(()=>{var l;o&&this.editingEditor!==o&&(null==(l=o.prepareEdit)||l.call(o,{referencePosition:n,container:this.table.getElement(),table:this.table,col:e,row:t}))},10)}});this.listenersId.push(l,i,n)}startEditCell(e,t,l,i){var n,o,r,a,s,h,d,u,c,g;if(this.editingEditor)return;let p=this.table.getEditor(e,t);if(p){if(i&&(null==(n=p.setElement)||n.call(p,i)),this.table.internalProps.layoutMap.isSeriesNumber(e,t))return;if(null==(r=null==(o=this.table.internalProps.layoutMap)?void 0:o.isAggregation)?void 0:r.call(o,e,t)){let e=null==(s=(a=this.table).isPivotTable)?void 0:s.call(a),t=!!e&&(null==(d=null==(h=this.table.internalProps)?void 0:h.dataConfig)?void 0:d.updateAggregationOnEditCell);if(!e||e&&t)return}let f=this.table.getCellRawRecord(e,t);if(null==f?void 0:f.vtableMerge)return;this.editingEditor||(this.editCell={col:e,row:t}),this.table._makeVisibleCell(e,t),this.editingEditor=p;let C=(0,v.Z)(l)?l:this.table.getCellOriginValue(e,t),m=this.table.getCellRangeRelativeRect(this.table.getCellRange(e,t)),b={rect:{left:m.left,top:m.top,width:m.width,height:m.height}};e===this.table.colCount-1?b.rect.width=m.width-1:b.rect.width=m.width+1,t===this.table.rowCount-1?b.rect.height=m.height-1:b.rect.height=m.height+1,p.beginEditing,null==(u=p.beginEditing)||u.call(p,this.table.getElement(),b,C),p.bindSuccessCallback,null==(c=p.bindSuccessCallback)||c.call(p,()=>{this.completeEdit()}),null==(g=p.onStart)||g.call(p,{value:C,endEdit:()=>{this.completeEdit()},referencePosition:b,container:this.table.getElement(),col:e,row:t,table:this.table})}}completeEdit(e){var t,l;if(!this.editingEditor)return!0;if(this.isValidatingValue)return!1;this.cacheLastSelectedCellEditor={};let i=null==e?void 0:e.target,{editingEditor:n}=this;if(i){if(n.targetIsOnEditor){if(n.targetIsOnEditor(i))return!1}else if(!n.isEditorElement||n.isEditorElement(i))return!1}if(this.editingEditor.getValue,this.editingEditor.validateValue){this.isValidatingValue=!0;let i=this.editingEditor.getValue(),n=this.table.getCellOriginValue(this.editCell.col,this.editCell.row),o=null==e?void 0:e.target,r=null==(l=(t=this.editingEditor).validateValue)?void 0:l.call(t,i,n,this.editCell,this.table,!!this.table.getElement().contains(o));return(0,L.tI)(r)?(this.isValidatingValue=!0,new Promise((e,t)=>{r.then(t=>{tI(t,this,n,e)}).catch(e=>{this.isValidatingValue=!1,t(e)})})):tI(r,this,n)}return this.doExit(),!0}doExit(){var e,t,l,i,n,o,r,a;let s=null==(t=(e=this.editingEditor).getValue)?void 0:t.call(e),h=this.table.getCellRange(this.editCell.col,this.editCell.row),d=[];for(let e=h.start.row;e<=h.end.row;e++){let e=[];for(let t=h.start.col;t<=h.end.col;t++)e.push(s);d.push(e)}null==(i=(l=this.editingEditor).beforeEnd)||i.call(l),this.table.changeCellValues(h.start.col,h.start.row,d),this.editingEditor.exit,null==(o=(n=this.editingEditor).exit)||o.call(n),null==(a=(r=this.editingEditor).onEnd)||a.call(r),this.editingEditor=null,this.isValidatingValue=!1,this.beginTriggerEditCellMode=null}cancelEdit(){var e,t,l,i;this.editingEditor&&(null==(t=(e=this.editingEditor).exit)||t.call(e),null==(i=(l=this.editingEditor).onEnd)||i.call(l),this.editingEditor=null)}release(){this.listenersId.forEach(e=>{this.table.off(e)})}}function tI(e,t,l,i){return t.isValidatingValue=!1,"validate-exit"===e?(t.doExit(),null==i||i(!0),!0):"invalidate-exit"===e?(t.editingEditor.setValue(l),t.doExit(),null==i||i(!0),!0):"validate-not-exit"===e||"invalidate-not-exit"===e?(null==i||i(!1),!1):!0===e?(t.doExit(),null==i||i(!0),!0):(null==i||i(!1),!1)}var tk=l(643624),tD=l(301999),tO=l(837982),tz=l(83624);function tW(e,t){return(0,tz.Z)(e)?{groupByRules:[e],addRecordRule:t}:(0,m.Z)(e)?{groupByRules:e.map(e=>(0,tz.Z)(e)?e:e.key),addRecordRule:t}:{addRecordRule:t}}var tN=l(937572),tV=l(201028);function tZ(e){let t=e.sortState;(t=!t||Array.isArray(t)?t:[t])&&(t=t.map(t=>{var l;return t.orderFn=null!=(l=e._getSortFuncFromHeaderOption(void 0,t.field))?l:W.K$,t}),e.dataSource.sort(t))}function tU(e,t,l){let{checkedState:i}=e.stateManager;if(i)if("tree"===e.dataSource.rowHierarchyType){let e,n=(e=(0,ev.Z)(t)?[t]:t).length,o=[];i.forEach((t,i)=>{var r;let a=i.split(",");if(a.length>=e.length)for(let s=0;s<a.length;s++){let h=null!=(r=e[s])?r:-1,d=Number(a[s]);if(!(h===d&&s<a.length-1)){if(h===d&&s===a.length-1||-1===h){o.push({originKey:i,value:t});break}h<d&&s===n-1&&(a[s]=(d-l).toString(),o.push({originKey:i,targetKey:a.toString(),value:t}));break}}}),o.sort((e,t)=>{let l=e.originKey.split(","),i=t.originKey.split(","),n=l.length,o=i.length,r=Math.min(n,o);for(let e=0;e<r;e++){let t=Number(l[e]),n=Number(i[e]);if(t!==n)return t-n}return n-o}),o.forEach(({originKey:e,targetKey:t,value:l})=>{i.delete(e),t&&i.set(t,l)})}else{let e=[],n=[];i.forEach((i,o)=>{let r=Number(o);!isNaN(r)&&r>=t&&(r===t?e.push(o):r>t&&n.push({originKey:o,targetKey:(r-l).toString(),value:i}))}),e.forEach(e=>i.delete(e)),n.forEach(({originKey:e,targetKey:t,value:l})=>{i.delete(e),i.set(t,l)})}}function tG(e,t,l){let{checkedState:i}=e.stateManager;if(i)if("tree"===e.dataSource.rowHierarchyType){let e,n=(e=(0,ev.Z)(t)?[t]:t).length,o=[];i.forEach((t,i)=>{var r;let a=i.split(",");if(a.length>=e.length)for(let s=0;s<a.length;s++){let h=null!=(r=e[s])?r:-1,d=Number(a[s]);if(h===d&&(s===a.length-1||s===n-1)){a[s]=(d+l).toString(),o.push({originKey:i,targetKey:a.toString(),value:t});break}if(!(h===d&&s<a.length-1)){h<d&&s===n-1&&(a[s]=(d+l).toString(),o.push({originKey:i,targetKey:a.toString(),value:t}));break}}}),o.sort((e,t)=>{let l=e.originKey.split(","),i=t.originKey.split(","),n=l.length,o=i.length,r=Math.min(n,o);for(let e=0;e<r;e++){let t=Number(l[e]),n=Number(i[e]);if(t!==n)return-t+n}return-n+o}),o.forEach(({originKey:e,targetKey:t,value:l})=>{i.delete(e),t&&i.set(t,l)})}else for(let e=i.size-1;e>=t;e--){let t=i.get(e.toString());i.delete(e.toString()),i.set((e+l).toString(),t)}}var tj=l(743581),tK=l(733154);class tX extends tL{constructor(e,t){var l,i,n,o,r,a,s,h;super(e,t),this.showHeader=!0,t=this.options;let d=this.internalProps;if(d.frozenColDragHeaderMode=null!=(i=null==(l=t.dragOrder)?void 0:l.frozenColDragHeaderMode)?i:t.frozenColDragHeaderMode,this.pagination=t.pagination,d.sortState=t.sortState,d.multipleSort=!!t.multipleSort,d.dataConfig=this.internalProps.groupBy?tW(this.internalProps.groupBy,t.addRecordRule):{addRecordRule:t.addRecordRule},d.columns=t.columns?(0,tO.u)(t.columns,["children"]):t.header?(0,tO.u)(t.header,["children"]):[],(0,b.rQ)(this),d.enableTreeNodeMerge=null!=(o=null!=(n=t.enableTreeNodeMerge)?n:(0,v.Z)(this.internalProps.groupBy))&&o,this.internalProps.headerHelper.setTableColumnsEditor(),this.showHeader=null==(r=t.showHeader)||r,this.internalProps.columnWidthConfig=t.columnWidthConfig,this.internalProps.rowHeightConfig=t.rowHeightConfig,this.transpose=null!=(a=t.transpose)&&a,"node"!==A.X.mode&&(this.editorManager=new tB(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,t.dataSource?this.dataSource=t.dataSource:t.records?this.setRecords(t.records,{sortState:d.sortState}):this.setRecords([]),t.title&&(d.title=new(to.F.getComponent("title"))(t.title,this)),this.options.emptyTip)if(this.internalProps.emptyTip)null==(s=this.internalProps.emptyTip)||s.resetVisible();else{let e=to.F.getComponent("emptyTip");this.internalProps.emptyTip=new e(this.options.emptyTip,this),null==(h=this.internalProps.emptyTip)||h.resetVisible()}if(this.internalProps.enableTreeStickCell){let e=to.F.getComponent("listTreeStickCellPlugin");this.listTreeStickCellPlugin=new e(this)}setTimeout(()=>{this.isReleased||(this.resize(),this.fireListeners(F.B.INITIALIZED,null))},0)}isListTable(){return!0}isPivotTable(){return!1}isPivotChart(){return!1}get sortState(){return this.internalProps.sortState}get records(){var e;return null==(e=this.dataSource)?void 0:e.records}get recordsCount(){return this.dataSource.records.length}updateColumns(e,t={clearColWidthCache:!1,clearRowHeightCache:!0}){var l,i,n,o;this.scenegraph.clearCells();let r={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.columns=(0,tO.u)(e,["children"]),(0,b.rQ)(this),(null==t?void 0:t.clearColWidthCache)&&this.internalProps._widthResizedColMap.clear(),this.options.columns=e,this.internalProps.headerHelper.setTableColumnsEditor(),this._hasAutoImageColumn=void 0,this.refreshHeader(),null==(i=(l=this.dataSource).updateColumns)||i.call(l,this.internalProps.columns),this.records&&(0,b.bW)(this.internalProps.columns)&&this.dataSource.processRecords(null!=(o=null==(n=this.dataSource.dataSourceObj)?void 0:n.records)?o:this.dataSource.dataSourceObj),this.internalProps.useOneRowHeightFillAll=!1,this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyBottomStyleCache=new Map,this.scenegraph.createSceneGraph(!(null==t?void 0:t.clearRowHeightCache)),this.stateManager.updateHoverPos(r.col,r.row),this.renderAsync(),this.eventManager.updateEventBinder()}_recreateSceneForStateChange(){var e,t;this.scenegraph.clearCells();let l={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this._hasAutoImageColumn=void 0,this.refreshHeader(),this.records&&(0,b.bW)(this.internalProps.columns)&&this.dataSource.processRecords(null!=(t=null==(e=this.dataSource.dataSourceObj)?void 0:e.records)?t:this.dataSource.dataSourceObj),this.internalProps.useOneRowHeightFillAll=!1,this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyBottomStyleCache=new Map,this._updateSize(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(l.col,l.row),this.renderAsync(),this.eventManager.updateEventBinder()}addColumns(e,t,l=!0){var i;let n=this.options.columns;void 0===t?(t=n.length,n.push(...e)):n.splice(t,0,...e);for(let l=0;l<e.length;l++)this.colWidthsMap.addAndReorder(t+l,null!=(i=e[l].width)?i:this.internalProps.defaultColWidth);this.internalProps._colRangeWidthsMap.clear();let o=Array.from(this.internalProps._widthResizedColMap.keys());for(let l=0;l<o.length;l++)o[l]>=t&&(this.internalProps._widthResizedColMap.delete(o[l]),this.internalProps._widthResizedColMap.add(o[l]+e.length));if(l){for(let e=0;e<n.length;e++)n[e].field=e;for(let l=0;l<this.records.length;l++){let i=this.records[l];Array.isArray(i)&&i.splice(t,0,...Array(e.length).fill(void 0))}}this.updateColumns(n,{clearRowHeightCache:!1}),this.fireListeners(F.B.ADD_COLUMN,{columnIndex:t,columnCount:e.length,columns:n})}deleteColumns(e,t=!0){let l=this.options.columns;e.sort((e,t)=>t-e);for(let i=0;i<e.length;i++)if(l.splice(e[i],1),this.colWidthsMap.delAndReorder(e[i]),this.internalProps._widthResizedColMap.delete(e[i]),t)for(let t=0;t<this.records.length;t++){let l=this.records[t];Array.isArray(l)&&l.splice(e[i],1)}this.internalProps._colRangeWidthsMap.clear();let i=Array.from(this.internalProps._widthResizedColMap.keys());for(let t=0;t<i.length;t++)for(let l=0;l<e.length;l++)if(i[t]>e[l]){this.internalProps._widthResizedColMap.delete(i[t]),this.internalProps._widthResizedColMap.add(i[t]-(e.length-l));break}if(t)for(let e=0;e<l.length;e++)l[e].field=e;this.updateColumns(l,{clearRowHeightCache:!1}),this.fireListeners(F.B.DELETE_COLUMN,{deleteColIndexs:e,columns:l})}get columns(){return this.internalProps.layoutMap.columnTree.getCopiedTree()}get header(){return this.internalProps.columns}set header(e){this.internalProps.columns=e,(0,b.rQ)(this),this.options.header=e,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.renderAsync()}get transpose(){var e;return null!=(e=this.internalProps.transpose)&&e}set transpose(e){this.internalProps.transpose!==e&&(this.internalProps.transpose=e,this.internalProps.layoutMap&&(this.internalProps.layoutMap.transpose=e,this.refreshRowColCount(),this._resetFrozenColCount(),this.renderAsync()))}getCellValue(e,t,l){var i;if(-1===e||-1===t)return null;if(!l){let l=this.getCustomMergeValue(e,t);if(l)return l}if(this.internalProps.layoutMap.isSeriesNumber(e,t)){let l;if(this.internalProps.layoutMap.isSeriesNumberInHeader(e,t)){let{title:l}=this.internalProps.layoutMap.getSeriesNumberHeader(e,t);return l}if(this.internalProps.groupBy){let i=this.getCellRawRecord(e,t);if(null==i?void 0:i.vtableMerge)return"";this.internalProps.layoutMap.isAggregation(e,t)||(l=this.dataSource.getGroupSeriesNumber(t-this.columnHeaderLevelCount))}else{let n=this.getBodyColumnDefine(e,t),o=this.getFieldData(n.field,e,t);l=["number","string"].includes(typeof o)?o:(null==o?void 0:o.text)?null!=(i=o.text)?i:"":t-this.columnHeaderLevelCount+1}let{format:n}=this.internalProps.layoutMap.getSeriesNumberBody(e,t);return"function"==typeof n?n(e,t,this,l):l}if(this.internalProps.layoutMap.isHeader(e,t)){let{title:l}=this.internalProps.layoutMap.getHeader(e,t);return"function"==typeof l?l():l}if(this.internalProps.layoutMap.isAggregation(e,t)){if(this.internalProps.layoutMap.isTopAggregation(e,t)){let l=this.internalProps.layoutMap.getAggregatorOnTop(e,t);return(null==l?void 0:l.formatValue)?l.formatValue(e,t,this):""}if(this.internalProps.layoutMap.isBottomAggregation(e,t)){let l=this.internalProps.layoutMap.getAggregatorOnBottom(e,t);return(null==l?void 0:l.formatValue)?l.formatValue(e,t,this):""}}let{field:n,fieldFormat:o}=this.internalProps.layoutMap.getBody(e,t);return this.getFieldData(o||n,e,t)}getCellOriginValue(e,t){if(-1===e||-1===t)return null;if(this.internalProps.layoutMap.isSeriesNumber(e,t)){if(this.internalProps.layoutMap.isSeriesNumberInHeader(e,t)){let{title:l}=this.internalProps.layoutMap.getSeriesNumberHeader(e,t);return l}let{format:l}=this.internalProps.layoutMap.getSeriesNumberBody(e,t);return"function"==typeof l?l(e,t,this):t-this.columnHeaderLevelCount}if(this.internalProps.layoutMap.isHeader(e,t)){let{title:l}=this.internalProps.layoutMap.getHeader(e,t);return"function"==typeof l?l():l}if(this.internalProps.layoutMap.isAggregation(e,t)){if(this.internalProps.layoutMap.isTopAggregation(e,t)){let l=this.internalProps.layoutMap.getAggregatorOnTop(e,t);return null==l?void 0:l.value()}if(this.internalProps.layoutMap.isBottomAggregation(e,t)){let l=this.internalProps.layoutMap.getAggregatorOnBottom(e,t);return null==l?void 0:l.value()}}let{field:l}=this.internalProps.layoutMap.getBody(e,t);return this.getFieldData(l,e,t)}getCellRawValue(e,t){if(-1===e||-1===t)return null;if(this.internalProps.layoutMap.isHeader(e,t)){let{title:l}=this.internalProps.layoutMap.getHeader(e,t);return"function"==typeof l?l():l}let{field:l}=this.internalProps.layoutMap.getBody(e,t);return this.getRawFieldData(l,e,t)}getRecordShowIndexByCell(e,t){let{layoutMap:l}=this.internalProps;return l.getRecordShowIndexByCell(e,t)}getRecordIndexByCell(e,t){let{layoutMap:l}=this.internalProps,i=l.getRecordShowIndexByCell(e,t);return this.dataSource.getRecordIndexPaths(i)}getTableIndexByRecordIndex(e){return this.transpose?this.dataSource.getTableIndex(e)+this.rowHeaderLevelCount:this.dataSource.getTableIndex(e)+this.columnHeaderLevelCount}getTableIndexByField(e){let t=this.internalProps.layoutMap.columnObjects.find(t=>t.field===e);if(!t)return -1;let l=this.internalProps.layoutMap.getBodyLayoutRangeById(t.id);return this.transpose?l.start.row:l.start.col}getCellAddrByFieldRecord(e,t){return this.transpose?{col:this.getTableIndexByRecordIndex(t),row:this.getTableIndexByField(e)}:{col:this.getTableIndexByField(e),row:this.getTableIndexByRecordIndex(t)}}getCellOriginRecord(e,t){let l=this.getRecordShowIndexByCell(e,t);if(l>-1)return this.dataSource.get(l)}getCellRawRecord(e,t){let l=this.getRecordShowIndexByCell(e,t);if(l>-1)return this.dataSource.getRaw(l)}_canResizeColumn(e,t){let l=super._canResizeColumn(e,t);if(l&&!this.transpose){let l=this.internalProps.layoutMap.getBody(e,this.columnHeaderLevelCount),i=this.internalProps.layoutMap.isSeriesNumber(e,t);if((null==l?void 0:l.disableColumnResize)||i&&!0===this.internalProps.rowSeriesNumber.disableColumnResize)return!1}return l}updateOption(e,t={clearColWidthCache:!0,clearRowHeightCache:!0}){var l,i,n,o,r,a,s,h,d;let u=this.internalProps;if(this.pluginManager.removeOrAddPlugins(e.plugins),super.updateOption(e,t),u.frozenColDragHeaderMode=null!=(i=null==(l=e.dragOrder)?void 0:l.frozenColDragHeaderMode)?i:e.frozenColDragHeaderMode,this.pagination=e.pagination,u.sortState=e.sortState,u.dataConfig=this.internalProps.groupBy?tW(this.internalProps.groupBy,e.addRecordRule):{addRecordRule:e.addRecordRule},this.showHeader=null==(n=e.showHeader)||n,u.columns=e.columns?(0,tO.u)(e.columns,["children"]):e.header?(0,tO.u)(e.header,["children"]):[],(0,b.rQ)(this),u.enableTreeNodeMerge=null!=(r=null!=(o=e.enableTreeNodeMerge)?o:(0,v.Z)(this.internalProps.groupBy))&&r,this.internalProps.headerHelper.setTableColumnsEditor(),this.transpose=null!=(a=e.transpose)&&a,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.internalProps.columnWidthConfig=e.columnWidthConfig,this.internalProps.rowHeightConfig=e.rowHeightConfig,u.releaseList)for(let e=u.releaseList.length-1;e>=0;e--){let t=u.releaseList[e];t instanceof tN.o2?t.updateColumns(this.internalProps.columns):(null==(s=null==t?void 0:t.release)||s.call(t),u.releaseList.splice(e,1))}if(e.dataSource&&this.dataSource!==e.dataSource?this.dataSource=e.dataSource:e.records?this.setRecords(e.records,{sortState:e.sortState}):(this.refreshRowColCount(),this._resetFrozenColCount(),this.scenegraph.createSceneGraph(),this.render()),e.title&&(u.title=new(to.F.getComponent("title"))(e.title,this),this.scenegraph.resize()),this.options.emptyTip)if(this.internalProps.emptyTip)null==(h=this.internalProps.emptyTip)||h.resetVisible();else{let e=to.F.getComponent("emptyTip");this.internalProps.emptyTip=new e(this.options.emptyTip,this),null==(d=this.internalProps.emptyTip)||d.resetVisible()}return this.pluginManager.updatePlugins(e.plugins),setTimeout(()=>{this.fireListeners(F.B.UPDATED,null)},0),new Promise(e=>{setTimeout(e,0)})}updatePagination(e){this.pagination&&("number"==typeof e.currentPage&&e.currentPage>=0&&(this.pagination.currentPage=e.currentPage),e.perPageCount&&(this.pagination.perPageCount=e.perPageCount||this.pagination.perPageCount),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.dataSource.updatePagination(this.pagination),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph(),this.renderAsync())}refreshHeader(){var e;let t=this.internalProps,l=this.transpose,i=this.showHeader;(t.layoutMap=new C.N(this,null!=(e=t.columns)?e:[],i,this.options.hierarchyIndent)).transpose=l,l||this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var e,t,l,i,n,o,r,a,s,h,d,u,c,g,p,f,C,v;let{layoutMap:m}=this.internalProps;if(!m)return;let b=null!=(t=null==(e=this.internalProps.dataSource)?void 0:e.length)?t:0;m.recordsCount=b+(b>0||this.options.showAggregationWhenEmpty?m.hasAggregationOnTopCount+m.hasAggregationOnBottomCount:0),this.transpose?(this.rowCount=null!=(l=m.rowCount)?l:0,this.colCount=null!=(i=m.colCount)?i:0,this.internalProps.frozenColCount=Math.max((null!=(n=m.headerLevelCount)?n:0)+m.leftRowSeriesNumberColumnCount,null!=(o=this.options.frozenColCount)?o:0),this.internalProps.frozenRowCount=null!=(r=this.options.frozenRowCount)?r:0,this.bottomFrozenRowCount!==(null!=(a=this.options.bottomFrozenRowCount)?a:0)&&(this.bottomFrozenRowCount=null!=(s=this.options.bottomFrozenRowCount)?s:0),this.rightFrozenColCount!==(null!=(h=this.options.rightFrozenColCount)?h:0)&&(this.rightFrozenColCount=null!=(d=this.options.rightFrozenColCount)?d:0)):(this.colCount=null!=(u=m.colCount)?u:0,this.rowCount=m.recordsCount*m.bodyRowSpanCount+m.headerLevelCount,this.internalProps.frozenColCount=null!=(c=this.options.frozenColCount)?c:0,this.options.frozenColCount>=this.colCount&&(this.internalProps.frozenColCount=0),this._setFrozenRowCount(Math.max(m.headerLevelCount,null!=(g=this.options.frozenRowCount)?g:0)),this.bottomFrozenRowCount!==(null!=(p=this.options.bottomFrozenRowCount)?p:0)&&(this.bottomFrozenRowCount=null!=(f=this.options.bottomFrozenRowCount)?f:0),this.rightFrozenColCount!==(null!=(C=this.options.rightFrozenColCount)?C:0)&&(this.rightFrozenColCount=null!=(v=this.options.rightFrozenColCount)?v:0)),this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}getFieldData(e,t,l){if(null===e||this.internalProps.layoutMap.isHeader(t,l))return null;let i=this.getRecordShowIndexByCell(this.transpose?t-this.internalProps.layoutMap.leftRowSeriesNumberColumnCount:t,l);return this.internalProps.dataSource.getField(i,e,t,l,this)}getRawFieldData(e,t,l){if(null===e||this.internalProps.layoutMap.isHeader(t,l))return null;let i=this.getRecordShowIndexByCell(t,l);return this.internalProps.dataSource.getRawField(i,e,t,l,this)}_moveHeaderPosition(e,t){let l=this.getCellRange(e.col,e.row),i=this.getCellRange(t.col,t.row),n=this.internalProps.layoutMap.moveHeaderPosition(e,t);return n?("column"===n.moveType?(this.colWidthsMap.exchangeOrder(l.start.col,l.end.col-l.start.col+1,i.start.col,i.end.col-i.start.col+1,n.targetIndex),(0,tK.ct)(n,this),this.transpose||(this.colWidthsLimit={},this.setMinMaxLimitWidth())):(n.targetIndex>n.sourceIndex?this.rowHeightsMap.exchangeOrder(n.sourceIndex,n.sourceSize,n.targetIndex+n.sourceSize-n.targetSize,n.targetSize,n.targetIndex):this.rowHeightsMap.exchangeOrder(n.sourceIndex,n.sourceSize,n.targetIndex,n.targetSize,n.targetIndex),(0,tK.J7)(n,this)),n):null}changeRecordOrder(e,t){this.transpose?(e=this.getRecordShowIndexByCell(e,0),t=this.getRecordShowIndexByCell(t,0)):(e=this.getRecordShowIndexByCell(0,e),t=this.getRecordShowIndexByCell(0,t)),this.dataSource.changeOrder(e,t)}getCellAddress(e,t){let l;for(let t=0;t<this.internalProps.records.length;t++){let i=this.internalProps.records[t];if("function"==typeof e)e(i)&&(l=t);else{let n=!0;for(let t in e)if(i[t]!==e[t]){n=!1;break}n&&(l=t)}if((0,v.Z)(l))break}let i=this.getCellRangeByField(t,l);if(i)return{row:i.start.row,col:i.start.col}}getCellRangeByField(e,t){let{layoutMap:l}=this.internalProps,i=l.columnObjects.find(t=>t.field===e);if(i){let e,n=l.getBodyLayoutRangeById(i.id);return(0,v.Z)(t)&&(e=l.getRecordStartRowByRecordIndex(t)),this.transpose?{start:{row:n.start.row,col:(0,v.Z)(e)?e+n.start.col:void 0},end:{row:n.end.row,col:(0,v.Z)(e)?e+n.end.col:void 0}}:{start:{col:n.start.col,row:(0,v.Z)(e)?e+n.start.row:void 0},end:{col:n.end.col,row:(0,v.Z)(e)?e+n.end.row:void 0}}}return null}getHierarchyState(e,t){var l;if(this.isHeader(e,t))return null==(l=this._getHeaderLayoutMap(e,t))?void 0:l.hierarchyState;if((!this.internalProps.groupBy||(0,m.Z)(this.internalProps.groupBy)&&0===this.internalProps.groupBy.length)&&!this.getBodyColumnDefine(e,t).tree)return f.g.none;let i=this.getRecordShowIndexByCell(e,t);return this.dataSource.getHierarchyState(i)}getRecordHierarchyState(e,t){let l;return this.transpose?this.getRecordShowIndexByCell(e,0):l=this.getRecordShowIndexByCell(0,t),this.dataSource.getHierarchyState(l)}toggleHierarchyState(e,t,l=!0){this.stateManager.updateHoverIcon(e,t,void 0,void 0);let i=this.getHierarchyState(e,t);if(this.isHeader(e,t)){let l=this.internalProps.layoutMap.getHeader(e,t),{hierarchyState:n,define:o}=l;if(![f.g.collapse,f.g.expand].includes(n)||!o)return;let r=o.columns;if(Array.isArray(r)&&r.length>0){let e=n===f.g.expand?f.g.collapse:f.g.expand;l.hierarchyState=e,l.define.hierarchyState=e,this.updateColumns(this.internalProps.columns)}this.fireListeners(F.B.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:i,originData:l,cellLocation:this.getCellLocation(e,t)})}else if(i===f.g.expand)this._refreshHierarchyState(e,t,l),this.fireListeners(F.B.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:f.g.collapse});else if(i===f.g.collapse){let i=this.getCellOriginRecord(e,t);Array.isArray(i.children)&&this._refreshHierarchyState(e,t,l),this.fireListeners(F.B.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:f.g.expand,originData:i})}}setLoadingHierarchyState(e,t){this.scenegraph.setLoadingHierarchyState(e,t)}_refreshHierarchyState(e,t,l=!0){var i,n;let o=!1,r=!1,a=this.internalProps.layoutMap.checkHasChart();a&&(this.autoFillWidth&&(o=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&(r=this.getAllRowsHeight()<=this.tableNoFrameHeight));let s=this.getRecordShowIndexByCell(e,t),h=this.dataSource.toggleHierarchyState(s,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount,Math.max(this.scenegraph.proxy.rowEnd-this.columnHeaderLevelCount,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount+this.scenegraph.proxy.rowLimit-1)),d=this.internalProps.layoutMap.toggleHierarchyState(h);this.refreshRowColCount();for(let e=this.rowCount-this.bottomFrozenRowCount;e<this.rowCount;e++){let t=(0,tk.P)(e,0,this.colCount-1,this);this._setRowHeight(e,t)}this.clearCellStyleCache(),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1;let{updateCells:u,addCells:c,removeCells:g}=(0,tj.E)(d,e,t,this);null==(i=this.reactCustomLayout)||i.clearCache(),this.scenegraph.updateRow(g,c,u,l,!0),null==(n=this.reactCustomLayout)||n.updateAllCustomCell(),a&&(this.autoFillWidth&&!o&&(o=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!r&&(r=this.getAllRowsHeight()<=this.tableNoFrameHeight),("adaptive"===this.widthMode||o||"adaptive"===this.heightMode||r)&&this.scenegraph.updateChartSizeForResizeColWidth(-1))}_hasHierarchyTreeHeader(){var e,t;return null==(t=null!=(e=this.options.columns)?e:this.options.header)?void 0:t.some((e,t)=>e.tree)}getMenuInfo(e,t,l){return{field:this.getHeaderField(e,t),value:this.getCellValue(e,t),cellLocation:this.getCellLocation(e,t),event:void 0}}_getSortFuncFromHeaderOption(e,t,l){if(e||(e=this.internalProps.columns),t&&e&&e.length>0)for(let i=0;i<e.length;i++){let n=e[i];if((l&&l===n.fieldKey||!l&&n.field===t)&&n.sort&&"function"==typeof n.sort)return n.sort;if(n.columns){let e=this._getSortFuncFromHeaderOption(n.columns,t,l);if(e)return e}}}updateSortState(e,t=!0){var l;if(e)this.internalProps.sortState=e;else if(this.internalProps.sortState)if(Array.isArray(this.internalProps.sortState))for(let t=0;t<this.internalProps.sortState.length;t++)(e=null==(l=this.internalProps.sortState)?void 0:l[t])&&(e.order="normal");else this.internalProps.sortState.order="normal",e=this.internalProps.sortState;(e=Array.isArray(e)?e:[e]).some(e=>e.field)&&t&&this.internalProps.layoutMap.headerObjects.some(e=>!1!==e.define.sort)&&(this.dataSource.sort(e.map(e=>{let t=this._getSortFuncFromHeaderOption(this.internalProps.columns,e.field);return this.internalProps.layoutMap.headerObjects.find(t=>t&&t.field===e.field),{field:e.field,order:e.order,orderFn:null!=t?t:W.K$}})),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.sortCell()),e.length&&this.stateManager.updateSortState(e)}updateFilterRules(e,t={clearRowHeightCache:!0}){var l;this.scenegraph.clearCells(),this.sortState?(this.dataSource.updateFilterRulesForSorted(e),tZ(this)):this.dataSource.updateFilterRules(e,null==t?void 0:t.onFilterRecordsEnd),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph(!(null==t?void 0:t.clearRowHeightCache)),null==(l=this.internalProps.emptyTip)||l.resetVisible(),this.resize()}getFilteredRecords(){return this.dataSource.records}getCheckboxState(e){if(this.stateManager.checkedState.size<this.rowCount-this.columnHeaderLevelCount&&this.stateManager.initLeftRecordsCheckState(this.records),(0,v.Z)(e)){let t=Array.from(this.stateManager.checkedState.keys()).sort((e,t)=>{var l,i;let n=e.split(","),o=t.split(","),r=Math.max(n.length,o.length);for(let e=0;e<r;e++){let t=null!=(l=Number(n[e]))?l:0,r=null!=(i=Number(o[e]))?i:0;if(t!==r)return t-r}return 0}).map(e=>this.stateManager.checkedState.get(e));return this.options.groupBy&&(t=(0,em.aC)(this)),Array.from(t,t=>t&&t[e])}return[...this.stateManager.checkedState.values()]}getCellCheckboxState(e,t){var l;let i=this.getBodyColumnDefine(e,t),n=null==i?void 0:i.field,o=this.getCellType(e,t);if((0,v.Z)(n)&&("checkbox"===o||"switch"===o)){let i=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(e,t)).toString();return null==(l=this.stateManager.checkedState.get(i))?void 0:l[n]}}getRadioState(e){return(0,v.Z)(e)?this.stateManager.radioState[e]:this.stateManager.radioState}getCellRadioState(e,t){return(0,tD.Wg)(e,t,this)}setCellCheckboxState(e,t,l){(0,em.Jd)(e,t,l,this)}setCellRadioState(e,t,l){(0,tD.vj)(e,t,l,this)}getSwitchState(e){return this.getCheckboxState(e)}getCellSwitchState(e,t){return this.getCellCheckboxState(e,t)}setCellSwitchState(e,t,l){this.setCellCheckboxState(e,t,l)}setRecords(e,t){var l,i,n,o;let r;(0,e7.H6)(),null==(l=this.internalProps.dataSource)||l.release(),this.internalProps.releaseList=null==(i=this.internalProps.releaseList)?void 0:i.filter(e=>!e.dataSourceObj),this.internalProps.dataSource=null,Array.isArray(t)||(null==t?void 0:t.order)?r=t:t?r=t.sortState:null===t&&(r=null),"undefined"!=typeof window&&window.performance.now();let a={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};if(this.scenegraph.clearCells(),void 0!==r&&(null===r||!Array.isArray(r)&&(0,v.Z)(r.field)||Array.isArray(r))&&(this.internalProps.sortState=this.internalProps.multipleSort?Array.isArray(r)?r:[r]:r,this.stateManager.setSortState(this.sortState)),e){if((0,b.mP)(this,e),this.sortState){let e=Array.isArray(this.sortState)?this.sortState:[this.sortState];e.some(e=>e.order&&e.field&&"normal"!==e.order)&&this.internalProps.layoutMap.headerObjectsIncludeHided.some(e=>!1!==e.define.sort)&&this.dataSource.sort(e.map(e=>{let t=this._getSortFuncFromHeaderOption(void 0,e.field);return this.internalProps.layoutMap.headerObjectsIncludeHided.find(t=>t&&t.field===e.field),{field:e.field,order:e.order||"asc",orderFn:null!=t?t:W.K$}}))}this.refreshRowColCount()}else(0,b.mP)(this,e);if(this.stateManager.initCheckedState(e),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(a.col,a.row),this._updateSize(),this.internalProps.title&&!this.internalProps.title.isReleased&&this.internalProps.title.resize(),this.scenegraph.resize(),this.options.emptyTip)if(this.internalProps.emptyTip)null==(n=this.internalProps.emptyTip)||n.resetVisible();else{let e=to.F.getComponent("emptyTip");this.internalProps.emptyTip=new e(this.options.emptyTip,this),null==(o=this.internalProps.emptyTip)||o.resetVisible()}this.render(),(0,v.Z)(a.col)&&(0,v.Z)(a.row)&&a.col>=0&&a.row>=0&&setTimeout(()=>{var e;null==(e=this.internalProps)||e.tooltipHandler.showTooltip(a.col,a.row)},0)}setRecordChildren(e,t,l,i=!0){let n=this.getCellOriginRecord(t,l);n.children=e;let o=this.getRecordShowIndexByCell(t,l);this.dataSource.setRecord(n,o),this._refreshHierarchyState(t,l,i)}startEditCell(e,t,l){var i;if((0,v.Z)(e)&&(0,v.Z)(t))this.eventManager.isDraging=!1,this.selectCell(e,t),this.editorManager.startEditCell(e,t,l);else if(null==(i=this.stateManager.select)?void 0:i.cellPos){let{col:e,row:t}=this.stateManager.select.cellPos;(0,v.Z)(e)&&(0,v.Z)(t)&&this.editorManager.startEditCell(e,t,l)}}completeEditCell(){this.editorManager.completeEdit()}getEditor(e,t){var l,i;let n=this.editorManager.cacheLastSelectedCellEditor[`${e}-${t}`];if(n)return n;Object.values(this.editorManager.cacheLastSelectedCellEditor).forEach(e=>{var t;return null==(t=null==e?void 0:e.onEnd)?void 0:t.call(e)}),this.editorManager.cacheLastSelectedCellEditor={};let o=this.getBodyColumnDefine(e,t),r=this.isHeader(e,t)?null!=(l=null==o?void 0:o.headerEditor)?l:this.options.headerEditor:null!=(i=null==o?void 0:o.editor)?i:this.options.editor;return"function"==typeof r&&(r=r({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||"",table:this})),"string"==typeof r&&(r=function(e){if(tF[e])return tF[e]}(r)),r&&(this.editorManager.cacheLastSelectedCellEditor[`${e}-${t}`]=r),r}isHasEditorDefine(e,t){var l,i;let n=this.getBodyColumnDefine(e,t),o=this.isHeader(e,t)?null!=(l=null==n?void 0:n.headerEditor)?l:this.options.headerEditor:null!=(i=null==n?void 0:n.editor)?i:this.options.editor;return"function"==typeof o&&(o=o({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||"",table:this})),(0,v.Z)(o)}changeCellValue(e,t,l,i=!1,n=!0){return function(e,t,l,i,n,o){if(i&&o.isHasEditorDefine(e,t)||!1===i){let i=o.getRecordShowIndexByCell(e,t),{field:r}=o.internalProps.layoutMap.getBody(e,t),a=o.getCellRawValue(e,t),s=o.getCellOriginValue(e,t);o.isHeader(e,t)?o.internalProps.layoutMap.updateColumnTitle(e,t,l):o.dataSource.changeFieldValue(l,i,r,e,t,o);let h=o.getCellRange(e,t),d=o.internalProps.layoutMap.getAggregatorsByCell(e,t);if(d){if(Array.isArray(d))for(let e=0;e<(null==d?void 0:d.length);e++)d[e].recalculate();else d.recalculate();let e=o.internalProps.layoutMap.getAggregatorCellAddress(h.start.col,h.start.row,h.end.col,h.end.row);for(let t=0;t<e.length;t++){let l=o.getCellRange(e[t].col,e[t].row);for(let e=l.start.col;e<=l.end.col;e++)for(let t=l.start.row;t<=l.end.row;t++)o.scenegraph.updateCellContent(e,t)}}for(let e=h.start.col;e<=h.end.col;e++)for(let t=h.start.row;t<=h.end.row;t++)o.scenegraph.updateCellContent(e,t);if("adaptive"===o.widthMode||o.autoFillWidth&&o.getAllColsWidth()<=o.tableNoFrameWidth)0===o.internalProps._widthResizedColMap.size&&o.scenegraph.recalculateColWidths();else if(!o.internalProps._widthResizedColMap.has(e)){let t=o.getColWidth(e),l=(0,tV.al)(e,0,o.rowCount-1,o,!1);l!==t&&o.scenegraph.updateColWidth(e,l-t)}if("adaptive"===o.heightMode||o.autoFillHeight&&o.getAllRowsHeight()<=o.tableNoFrameHeight)0===o.internalProps._heightResizedRowMap.size&&o.scenegraph.recalculateRowHeights();else if(o.isAutoRowHeight(t)&&!o.internalProps._heightResizedRowMap.has(t)){let e=o.getRowHeight(t),l=(0,tk.P)(t,0,o.colCount-1,o);o.scenegraph.updateRowHeight(t,l-e)}let u=o.getCellOriginValue(e,t);s!==u&&n&&o.fireListeners(F.B.CHANGE_CELL_VALUE,{col:e,row:t,rawValue:a,currentValue:s,changedValue:u}),o.scenegraph.updateNextFrame()}}(e,t,l,i,n,this)}changeCellValues(e,t,l,i=!1,n=!0){return function(e,t,l,i,n,o){var r,a,s,h,d,u;return s=this,h=void 0,d=void 0,u=function*(){let s,h=[],d=e,u=t,c=[],g=[];for(let i=0;i<l.length&&!(t+i>o.rowCount-1);i++){let n=l[i],r=[],a=[];c.push(r),g.push(a);for(let l=0;l<n.length&&!(e+l>o.colCount-1);l++){s=function(e,t,l,i){if("group"===i||"sort"===i&&!l.internalProps.groupBy)return i;let n="normal";return l.internalProps.groupBy?n="group":!l.isHeader(e,t)&&l.dataSource.lastOrderField&&l.getBodyField(e,t)===l.dataSource.lastOrderField&&(n="sort"),n}(e+l,t+i,o,s);let n=o.getCellRawValue(e+l,t+i);r.push(n);let h=o.getCellOriginValue(e+l,t+i);a.push(h)}}for(let s=0;s<l.length&&!(t+s>o.rowCount-1);s++){h[s]=[],u=t+s;let p=l[s],f=e;for(let l=0;l<p.length&&!(e+l>o.colCount-1);l++){f=e+l;let d=!1;if(!1===i)d=!0;else if(o.isHasEditorDefine(e+l,t+s)){let i=o.getEditor(e+l,t+s),n=g[s][l],h=p[l],u=null==(a=null==(r=null==i?void 0:i.validateValue)?void 0:r.call(i,h,n,{col:e+l,row:t+s},o))||a;if((0,L.tI)(u)){let e=yield u;d=!0===e||"validate-exit"===e||"validate-not-exit"===e}else d=!0===u||"validate-exit"===u||"validate-not-exit"===u}if(d){h[s][l]=!0;let i=p[l],r=o.getRecordShowIndexByCell(e+l,t+s),{field:a}=o.internalProps.layoutMap.getBody(e+l,t+s),d=c[s][l],u=g[s][l];o.isHeader(e+l,t+s)?o.internalProps.layoutMap.updateColumnTitle(e+l,t+s,i):o.dataSource.changeFieldValue(i,r,a,e+l,t+s,o);let f=o.getCellOriginValue(e+l,t+s);u!==f&&n&&o.fireListeners(F.B.CHANGE_CELL_VALUE,{col:e+l,row:t+s,rawValue:d,currentValue:u,changedValue:f})}else h[s][l]=!1}d=Math.max(d,f)}let p=o.getCellRange(e,t),f=o.getCellRange(d,u),C=o.internalProps.layoutMap.getAggregatorsByCellRange(p.start.col,p.start.row,f.end.col,f.end.row);if(C){for(let e=0;e<(null==C?void 0:C.length);e++)C[e].recalculate();if("normal"===s){let e=o.internalProps.layoutMap.getAggregatorCellAddress(p.start.col,p.start.row,f.end.col,f.end.row);for(let t=0;t<e.length;t++){let l=o.getCellRange(e[t].col,e[t].row);for(let e=l.start.col;e<=l.end.col;e++)for(let t=l.start.row;t<=l.end.row;t++)o.scenegraph.updateCellContent(e,t)}}}if("group"===s&&o.dataSource.updateRecordsForGroup([],[]),"sort"===s||"group"===s)return o.dataSource.sortedIndexMap.clear(),tZ(o),o.refreshRowColCount(),o.internalProps.layoutMap.clearCellRangeMap(),o.scenegraph.clearCells(),o.scenegraph.createSceneGraph(),h;for(let e=p.start.col;e<=f.end.col;e++)for(let t=p.start.row;t<=f.end.row;t++)o.scenegraph.updateCellContent(e,t);if("adaptive"===o.widthMode||o.autoFillWidth&&o.getAllColsWidth()<=o.tableNoFrameWidth)0===o.internalProps._widthResizedColMap.size&&o.scenegraph.recalculateColWidths();else for(let t=e;t<=f.end.col;t++)if(!o.internalProps._widthResizedColMap.has(t)){let e=o.getColWidth(t),l=(0,tV.al)(t,0,o.rowCount-1,o,!1);l!==e&&o.scenegraph.updateColWidth(t,l-e)}if("adaptive"===o.heightMode||o.autoFillHeight&&o.getAllRowsHeight()<=o.tableNoFrameHeight)o.scenegraph.recalculateRowHeights();else if(o.isAutoRowHeight(t)){let e=[],l=[];for(let i=t;i<=f.end.row;i++)if(o.rowHeightsMap.get(i)){let t=o.getRowHeight(i),n=(0,tk.P)(i,0,o.colCount-1,o);e.push(i),l.push(n-t)}o.scenegraph.updateRowsHeight(e,l)}return o.scenegraph.updateNextFrame(),h},new(d||(d=Promise))(function(e,t){function l(e){try{n(u.next(e))}catch(e){t(e)}}function i(e){try{n(u.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):((n=t.value)instanceof d?n:new d(function(e){e(n)})).then(l,i)}n((u=u.apply(s,h||[])).next())})}(e,t,l,i,n,this)}addRecord(e,t){var l;let i=function(e,t,l){var i,n,o,r;try{if(!e)return!1;if(l.internalProps.groupBy)null==(n=(i=l.dataSource).addRecordsForGroup)||n.call(i,[e],t),l.refreshRowColCount(),l.internalProps.layoutMap.clearCellRangeMap(),l.sortState&&tZ(l),l.scenegraph.clearCells(),l.scenegraph.createSceneGraph();else if("tree"===l.dataSource.rowHierarchyType)null==(r=(o=l.dataSource).addRecordsForTree)||r.call(o,[e],t),tG(l,t,1),l.refreshRowColCount(),l.internalProps.layoutMap.clearCellRangeMap(),l.sortState&&tZ(l),l.scenegraph.clearCells(),l.scenegraph.createSceneGraph();else if(l.sortState)l.dataSource.addRecordForSorted(e),l.stateManager.checkedState.clear(),tZ(l),l.refreshRowColCount(),l.scenegraph.clearCells(),l.scenegraph.createSceneGraph();else{(void 0===t||t>l.dataSource.sourceLength)&&(t=l.dataSource.sourceLength);let i=l.transpose?l.rowHeaderLevelCount:l.columnHeaderLevelCount;l.dataSource.addRecord(e,t),tG(l,t,1);let n=l.rowCount;if(l.refreshRowColCount(),0===l.scenegraph.proxy.totalActualBodyRowCount)return l.scenegraph.clearCells(),l.scenegraph.createSceneGraph(),!0;let o=l.transpose?l.colCount:l.rowCount;if(l.pagination){let{perPageCount:e,currentPage:r}=l.pagination,a=e*(r||0)+e;if(t<a)if(t<a-e)l.scenegraph.clearCells(),l.scenegraph.createSceneGraph();else{let r=t-(a-e)+i;if(n-i===l.pagination.perPageCount){let e=[];for(let t=r;t<o;t++)l.transpose?e.push({col:t,row:0}):e.push({col:0,row:t});l.transpose?l.scenegraph.updateCol([],[],e):l.scenegraph.updateRow([],[],e)}else{let e=[];for(let t=r;t<Math.min(o,r+1);t++)l.transpose?e.push({col:t,row:0}):e.push({col:0,row:t});l.transpose?l.scenegraph.updateCol([],e,[]):l.scenegraph.updateRow([],e,[])}}}else{let e=[];for(let n=t+i;n<t+i+1;n++)l.transpose?e.push({col:n,row:0}):e.push({col:0,row:n});let n=[],o=l.internalProps.layoutMap.hasAggregationOnTopCount,r=l.internalProps.layoutMap.hasAggregationOnBottomCount;for(let e=i;e<i+o;e++)l.transpose?n.push({col:e,row:0}):n.push({col:0,row:e});for(let e=(l.transpose?l.colCount:l.rowCount)-r;e<(l.transpose?l.colCount:l.rowCount);e++)l.transpose?n.push({col:e,row:0}):n.push({col:0,row:e});l.transpose?l.scenegraph.updateCol([],e,[]):l.scenegraph.updateRow([],e,[])}}return!0}catch(e){return!1}}(e,t,this);(0,tK.UF)(this,t,[e]),null==(l=this.internalProps.emptyTip)||l.resetVisible(),i&&this.fireListeners(F.B.ADD_RECORD,{records:[e],recordIndex:t,recordCount:1})}addRecords(e,t){var l;let i=function(e,t,l){var i,n,o,r;try{if(!e||0===e.length)return!1;if(l.internalProps.groupBy)null==(n=(i=l.dataSource).addRecordsForGroup)||n.call(i,e,t),l.refreshRowColCount(),l.internalProps.layoutMap.clearCellRangeMap(),l.sortState&&tZ(l),l.scenegraph.clearCells(),l.scenegraph.createSceneGraph();else if("tree"===l.dataSource.rowHierarchyType)null==(r=(o=l.dataSource).addRecordsForTree)||r.call(o,e,t),tG(l,t,e.length),l.refreshRowColCount(),l.internalProps.layoutMap.clearCellRangeMap(),l.sortState&&tZ(l),l.scenegraph.clearCells(),l.scenegraph.createSceneGraph();else if(l.sortState)l.dataSource.addRecordsForSorted(e),tZ(l),l.refreshRowColCount(),l.scenegraph.clearCells(),l.scenegraph.createSceneGraph();else{void 0===t||t>l.dataSource.sourceLength?t=l.dataSource.sourceLength:t<0&&(t=0);let i=l.transpose?l.rowHeaderLevelCount:l.columnHeaderLevelCount;l.dataSource.addRecords(e,t),tG(l,t,e.length);let n=l.transpose?l.colCount:l.rowCount;if(l.refreshRowColCount(),0===l.scenegraph.proxy.totalActualBodyRowCount)return l.scenegraph.clearCells(),l.scenegraph.createSceneGraph(),!0;let o=l.transpose?l.colCount:l.rowCount;if(l.pagination){let{perPageCount:r,currentPage:a}=l.pagination,s=r*(a||0)+r;if(t<s)if(t<s-r)l.scenegraph.clearCells(),l.scenegraph.createSceneGraph();else{let a=t-(s-r)+i;if(n-i===l.pagination.perPageCount){let e=[];for(let t=a;t<o;t++)l.transpose?e.push({col:t,row:0}):e.push({col:0,row:t});l.transpose?l.scenegraph.updateCol([],[],e):l.scenegraph.updateRow([],[],e)}else{let t=[];for(let i=a;i<Math.min(o,a+(Array.isArray(e)?e.length:1));i++)l.transpose?t.push({col:i,row:0}):t.push({col:0,row:i});l.transpose?l.scenegraph.updateCol([],t,[]):l.scenegraph.updateRow([],t,[])}}}else{let n=[];for(let o=t+i;o<t+i+(Array.isArray(e)?e.length:1);o++)l.transpose?n.push({col:o,row:0}):n.push({col:0,row:o});let o=l.internalProps.layoutMap.hasAggregationOnTopCount,r=l.internalProps.layoutMap.hasAggregationOnBottomCount,a=[];for(let e=i;e<i+o;e++)l.transpose?a.push({col:e,row:0}):a.push({col:0,row:e});for(let e=(l.transpose?l.colCount:l.rowCount)-r;e<(l.transpose?l.colCount:l.rowCount);e++)l.transpose?a.push({col:e,row:0}):a.push({col:0,row:e});l.transpose?l.scenegraph.updateCol([],n,a):l.scenegraph.updateRow([],n,a)}}return!0}catch(e){return!1}}(e,t,this);"number"==typeof t&&(0,tK.UF)(this,t,e),null==(l=this.internalProps.emptyTip)||l.resetVisible(),i&&this.fireListeners(F.B.ADD_RECORD,{records:e,recordIndex:t,recordCount:e.length})}deleteRecords(e){var t;(function(e,t){var l,i,n,o,r,a,s,h;if((null==e?void 0:e.length)>0)if(t.internalProps.groupBy)null==(i=(l=t.dataSource).deleteRecordsForGroup)||i.call(l,e),t.refreshRowColCount(),t.internalProps.layoutMap.clearCellRangeMap(),t.sortState&&tZ(t),t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else if("tree"===t.dataSource.rowHierarchyType){let l=null==(o=(n=t.dataSource).deleteRecordsForTree)?void 0:o.call(n,e);if(0===l.length)return;for(let e=0;e<l.length;e++)tU(t,l[e],1);t.refreshRowColCount(),t.internalProps.layoutMap.clearCellRangeMap(),t.sortState&&tZ(t),t.scenegraph.clearCells(),t.scenegraph.createSceneGraph()}else if(t.sortState)t.dataSource.deleteRecordsForSorted(e),tZ(t),t.refreshRowColCount(),t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else{let l=t.dataSource.deleteRecords(e);if(0===l.length)return;for(let e=0;e<l.length;e++)tU(t,l[e],1);let i=t.transpose?t.colCount:t.rowCount;t.refreshRowColCount();let n=t.transpose?t.colCount:t.rowCount,o=l.sort((e,t)=>e-t),d=o[0];if(t.pagination){let{perPageCount:e,currentPage:l}=t.pagination,o=e*(l||0)+e;if(d<o)if(d<o-e)t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else{let l=t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount,s=t.internalProps.layoutMap.hasAggregationOnTopCount,h=[],u=[];for(let l=d-(o-e)+(t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount)+s;l<n;l++)t.transpose?h.push({col:l,row:0}):h.push({col:0,row:l});for(let e=l;e<l+s;e++)t.transpose?h.push({col:e,row:0}):h.push({col:0,row:e});if(n<i)for(let e=n;e<i;e++)t.transpose?u.push({col:e,row:0}):u.push({col:0,row:e});null==(r=t.reactCustomLayout)||r.clearCache(),t.transpose?t.scenegraph.updateCol(u,[],h):t.scenegraph.updateRow(u,[],h),null==(a=t.reactCustomLayout)||a.updateAllCustomCell()}}else{let e=[],l=t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount,i=t.internalProps.layoutMap.hasAggregationOnTopCount,n=t.internalProps.layoutMap.hasAggregationOnBottomCount;for(let n=0;n<o.length;n++){let r=o[n]+l+i;t.transpose?e.push({col:r,row:0}):e.push({col:0,row:r})}let r=[];for(let e=l;e<l+i;e++)t.transpose?r.push({col:e,row:0}):r.push({col:0,row:e});for(let e=(t.transpose?t.colCount:t.rowCount)-n;e<(t.transpose?t.colCount:t.rowCount);e++)t.transpose?r.push({col:e,row:0}):r.push({col:0,row:e});null==(s=t.reactCustomLayout)||s.clearCache(),t.transpose?t.scenegraph.updateCol(e,[],r):t.scenegraph.updateRow(e,[],r),null==(h=t.reactCustomLayout)||h.updateAllCustomCell()}}})(e,this),(0,tK.b)(this,e),null==(t=this.internalProps.emptyTip)||t.resetVisible();let l=[];for(let t=0;t<e.length;t++)l.push(this.getBodyRowIndexByRecordIndex(e[t])+this.columnHeaderLevelCount);this.fireListeners(F.B.DELETE_RECORD,{recordIndexs:e,rowIndexs:l,deletedCount:(Array.isArray(e[0]),e.length)})}updateRecords(e,t){(function(e,t,l){var i,n,o,r;if((null==t?void 0:t.length)>0)if(l.internalProps.groupBy)null==(n=(i=l.dataSource).updateRecordsForGroup)||n.call(i,e,t),l.refreshRowColCount(),l.internalProps.layoutMap.clearCellRangeMap(),l.sortState&&tZ(l),l.scenegraph.clearCells(),l.scenegraph.createSceneGraph();else if("tree"===l.dataSource.rowHierarchyType)null==(r=(o=l.dataSource).updateRecordsForTree)||r.call(o,e,t),l.refreshRowColCount(),l.internalProps.layoutMap.clearCellRangeMap(),l.sortState&&tZ(l),l.scenegraph.clearCells(),l.scenegraph.createSceneGraph();else if(l.sortState)l.dataSource.updateRecordsForSorted(e,t),tZ(l),l.refreshRowColCount(),l.scenegraph.clearCells(),l.scenegraph.createSceneGraph();else{let i=l.dataSource.updateRecords(e,t);if(0===i.length)return;let n=i.map(e=>l.getBodyRowIndexByRecordIndex(e)).sort((e,t)=>e-t);if(l.pagination){let{perPageCount:e,currentPage:t}=l.pagination,i=l.transpose?l.rowHeaderLevelCount:l.columnHeaderLevelCount,o=l.internalProps.layoutMap.hasAggregationOnTopCount,r=e*(t||0)+e,a=[];for(let t=0;t<n.length;t++){let i=n[t];if(i<r&&i>=r-e){let t=i-(r-e)+(l.transpose?l.rowHeaderLevelCount:l.columnHeaderLevelCount)+o;a.push(t)}}if(a.length>=1){let e=[];for(let t=0;t<a.length;t++){let i=a[t];l.transpose?e.push({col:i,row:0}):e.push({col:0,row:i})}for(let t=i;t<i+o;t++)l.transpose?e.push({col:t,row:0}):e.push({col:0,row:t});l.transpose?l.scenegraph.updateCol([],[],e):l.scenegraph.updateRow([],[],e)}}else{let e=[],t=l.transpose?l.rowHeaderLevelCount:l.columnHeaderLevelCount,i=l.internalProps.layoutMap.hasAggregationOnTopCount,o=l.internalProps.layoutMap.hasAggregationOnBottomCount;for(let o=0;o<n.length;o++){let r=n[o]+t+i;l.transpose?e.push({col:r,row:0}):e.push({col:0,row:r})}for(let n=t;n<t+i;n++)l.transpose?e.push({col:n,row:0}):e.push({col:0,row:n});for(let t=(l.transpose?l.colCount:l.rowCount)-o;t<(l.transpose?l.colCount:l.rowCount);t++)l.transpose?e.push({col:t,row:0}):e.push({col:0,row:t});l.transpose?l.scenegraph.updateCol([],[],e):l.scenegraph.updateRow([],[],e)}}})(e,t,this),this.fireListeners(F.B.UPDATE_RECORD,{records:e,recordIndexs:t,updateCount:e.length})}_hasCustomRenderOrLayout(){var e,t,l,i;let{headerObjects:n}=this.internalProps.layoutMap;if(this.options.customRender)return!0;for(let o=0;o<n.length;o++){let r=n[o];if((null==(e=null==r?void 0:r.define)?void 0:e.customLayout)||(null==(t=null==r?void 0:r.define)?void 0:t.headerCustomLayout)||(null==(l=null==r?void 0:r.define)?void 0:l.customRender)||(null==(i=null==r?void 0:r.define)?void 0:i.headerCustomRender))return!0}return!1}getAggregateValuesByField(e){let t=this.internalProps.layoutMap.getColumnByField(e),l=[];for(let e=0;e<t.length;e++){let i=t[e].columnDefine.aggregator;if(delete t[e].columnDefine,i){let n={col:t[e].col,aggregateValue:null};if(n.aggregateValue=[],Array.isArray(i))for(let e=0;e<i.length;e++)n.aggregateValue.push({aggregationType:i[e].type,value:i[e].value()});else n.aggregateValue.push({aggregationType:i.type,value:i.value()});l.push(n)}}return l}isAggregation(e,t){return this.internalProps.layoutMap.isAggregation(e,t)}getGroupTitleLevel(e,t){var l;if(!this.internalProps.groupBy)return;let i=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(e,t)),n=null!=(l=this.dataSource.getGroupLength())?l:0,o=(0,m.Z)(i)?i.length-1:0;return n>0&&o===n&&(o=void 0),o}getBodyRowIndexByRecordIndex(e){return Array.isArray(e)&&1===e.length&&(e=e[0]),this.dataSource.getTableIndex(e)}release(){var e;null==(e=this.editorManager)||e.release(),super.release()}expandAllTreeNode(){if(!this._hasHierarchyTreeHeader())return;let e=!1;this.dataSource&&"function"==typeof this.dataSource.expandAllNodes&&(this.dataSource.expandAllNodes(),e=!0),e&&(this._recreateSceneForStateChange(),this.fireListeners(F.B.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:f.g.expand,originData:{children:this.records}}))}collapseAllTreeNode(){if(!this._hasHierarchyTreeHeader())return;let e=!1;this.dataSource&&"function"==typeof this.dataSource.collapseAllNodes&&(this.dataSource.collapseAllNodes(),e=!0),e&&(this._recreateSceneForStateChange(),this.fireListeners(F.B.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:f.g.collapse,originData:{children:this.records}}))}mergeCells(e,t,l,i){for(let n=e;n<=l;n++)for(let e=t;e<=i;e++){let t=this.getCellRange(n,e);if(t.start.col!==t.end.col||t.start.row!==t.end.row)return}this.options.customMergeCell?"function"==typeof this.options.customMergeCell&&(this.options.customMergeCell=[]):this.options.customMergeCell=[],this.options.customMergeCell.push({text:this.getCellValue(e,t),range:{start:{col:e,row:t},end:{col:l,row:i}}}),this.internalProps.customMergeCell=tE(this.options.customMergeCell);for(let n=e;n<=l;n++)for(let e=t;e<=i;e++)this.scenegraph.updateCellContent(n,e);this.scenegraph.updateNextFrame()}unmergeCells(e,t,l,i){this.options.customMergeCell?"function"==typeof this.options.customMergeCell&&(this.options.customMergeCell=[]):this.options.customMergeCell=[],this.options.customMergeCell=this.options.customMergeCell.filter(n=>{let{start:o,end:r}=n.range;return o.col!==e||o.row!==t||r.col!==l||r.row!==i}),this.internalProps.customMergeCell=tE(this.options.customMergeCell);for(let n=e;n<=l;n++)for(let e=t;e<=i;e++)this.scenegraph.updateCellContent(n,e);this.scenegraph.updateNextFrame()}}var t$=l(20408),tY=l(89530),tJ=l(454326),tq=l(309762),tQ=l(953752),t0=l(399346);function t1(e){return"bottom"===e||"top"===e}var t2=l(54988);class t3{constructor(){this._scale=new t2.j,this._scales=[this._scale]}valueToPosition(e){return this._scale.scale(e)}getPosition(e){let t=0,l=this._scale;if(1===this._scales.length||1===e.length)t=this.valueToPosition(e[0]);else{let i=Math.min(e.length,this._scales.length);for(let l=0;l<i;l++)t+=this._scales[l].scale(e[l]);l=this._scales[i-1]}return{position:t,bandScale:l}}calcScales(e,t){var l,i;let{bandPadding:n,paddingInner:o,paddingOuter:r}=this,a=(0,m.Z)(n),s=(0,m.Z)(o),h=(0,m.Z)(r);for(let d=0;d<this._scales.length;d++){let u=a?n[d]:n,c=s?o[d]:o,g=h?r[d]:r;this._scales[d].paddingInner(null!=(l=null!=c?c:u)?l:e,!0).paddingOuter(null!=(i=null!=g?g:u)?i:t)}}dataToPosition(e,t={}){var l;if(0===e.length||0===this._scales.length)return 0;let{position:i,bandScale:n}=this.getPosition(e);return i+n.bandwidth()*(null!=(l=t.bandPosition)?l:.5)}updateScaleDomain(e){for(let t=0;t<this._scales.length;t++)this._scales[t].domain(e)}updateRange(e){let[t,l]=this._scale.range();e[0]===t&&e[1]===l||this._scale.range(e)}}var t9=l(799127),t4=l(82349),t5=l(99344),t6=l(565880),t8=l(101466),t7=l(510145),le=l(999051);let lt=Math.sqrt(50),ll=Math.sqrt(10),li=Math.sqrt(2);class ln{constructor(e){this._extend={},this.type=null!=e?e:"linear",this._scale="log"===e?new t6.Y:"symlog"===e?new t8.g:new t7.f,this._scales=[this._scale]}setExtraAttrFromSpec(e,t,l,i,n,o){this.nice=!1,this.zero=t,this.zero&&(l.min=Math.min(l.min,0),l.max=Math.max(l.max,0)),this.domain=l,this.expand=i,"log"===this.type?this._scale.base(null!=n?n:10):"symlog"===this.type&&this._scale.constant(null!=o?o:10)}transformScaleDomain(){"symlog"===this.type||"log"===this.type||this.setScaleNice()}setScaleNice(){"log"===this.type?this.setLogScaleNice():this.setLinearScaleNice()}setLogScaleNice(){var e,t,l,i,n,o;(0,tJ.Z)(null==(e=this.domain)?void 0:e.min)&&(0,tJ.Z)(null==(t=this.domain)?void 0:t.max)?this.nice&&this._scale.nice():(0,v.Z)(null==(l=this.domain)?void 0:l.min)&&(0,tJ.Z)(null==(i=this.domain)?void 0:i.max)?this.nice&&this._scale.niceMax():(0,tJ.Z)(null==(n=this.domain)?void 0:n.min)&&(0,v.Z)(null==(o=this.domain)?void 0:o.max)&&this.nice&&this._scale.niceMin()}setLinearScaleNice(){var e,t,l,i,n,o,r,a;let s=null!=(t=null!=(e=this.forceTickCount)?e:this.tickCount)?t:10;"accurateFirst"===this.niceType&&(s=Math.max(10,s)),(0,tJ.Z)(null==(l=this.domain)?void 0:l.min)&&(0,tJ.Z)(null==(i=this.domain)?void 0:i.max)?this.nice&&this._scale.nice(s):(0,v.Z)(null==(n=this.domain)?void 0:n.min)&&(0,tJ.Z)(null==(o=this.domain)?void 0:o.max)?this.nice&&this._scale.niceMax(s):(0,tJ.Z)(null==(r=this.domain)?void 0:r.min)&&(0,v.Z)(null==(a=this.domain)?void 0:a.max)?this.nice&&this._scale.niceMin(s):this.nice&&this._scale.nice(s)}dataToPosition(e){return this.valueToPosition(e[0])}valueToPosition(e){return this._scale.scale(e)}computeLinearDomain(e){let t=[];return e.forEach(e=>{let{min:l,max:i}=e;t[0]=void 0===t[0]?l:Math.min(t[0],l),t[1]=void 0===t[1]?i:Math.max(t[1],i)}),this.expandDomain(t),this.includeZero(t),this.setDomainMinMax(t),t}expandDomain(e){if(!this.expand)return;let t=e[0],l=e[e.length-1];(0,v.Z)(this.expand.min)&&(e[0]=t-(l-t)*this.expand.min),(0,v.Z)(this.expand.max)&&(e[e.length-1]=l+(l-t)*this.expand.max)}niceDomain(e){if((0,v.Z)(e[0])||(0,v.Z)(e[1])||"linear"!==this.type)return e;if(1e-12>=Math.abs((0,le.iH)(e)-(0,le.CE)(e))){let t=e[0],l=t>=0?1:-1;if((t=Math.abs(t))<1)e[0]=0,e[1]=1;else{let l=t/5,i=Math.floor(Math.log(l)/Math.LN10),n=l/Math.pow(10,i);l=(n>=lt?10:n>=ll?5:n>=li?2:1)*Math.pow(10,i),e[0]=0,e[1]=10*l}l<0&&(e.reverse(),e[0]*=-1,e[1]*=-1)}return e}niceMinMax(){var e,t,l,i,n,o,r,a;if(this.nice){let s=null!=(t=null!=(e=this.forceTickCount)?e:this.tickCount)?t:10;"accurateFirst"===this.niceType&&(s=Math.max(10,s)),(0,tJ.Z)(null==(l=this.domain)?void 0:l.min)&&(0,tJ.Z)(null==(i=this.domain)?void 0:i.max)?this._scale.nice(s):(0,v.Z)(null==(n=this.domain)?void 0:n.min)&&(0,tJ.Z)(null==(o=this.domain)?void 0:o.max)?this._scale.niceMax(s):(0,tJ.Z)(null==(r=this.domain)?void 0:r.min)&&(0,v.Z)(null==(a=this.domain)?void 0:a.max)?this._scale.niceMin(s):this._scale.nice(s)}}includeZero(e){this.zero&&(e[0]=Math.min(e[0],0),e[e.length-1]=Math.max(e[e.length-1],0))}setExtendDomain(e,t){if(void 0===t)return void delete this._extend[e];this._extend[e]=t;let l=this._scale.domain();this.extendDomain(l),this.includeZero(l),this.setDomainMinMax(l),this.niceDomain(l),this._scale.domain(l,this.nice),this.niceMinMax()}extendDomain(e){let t,l=e.length-1,i=e[0]-e[l]>0,n=i?l:0,o=i?0:l;for(let l in this._extend)(t=this._extend[l])>e[o]&&(e[o]=t),t<e[n]&&(e[n]=t)}setDomainMinMax(e){if(!this.domain)return;let{min:t,max:l}=this.domain;(0,v.Z)(t)&&(e[0]=t),(0,v.Z)(l)&&(e[1]=l)}setZero(e){this.zero!==e&&(this.zero=e,this.updateScaleDomain())}updateScaleDomain(){let e=this.computeDomain([this.domain]);this.updateScaleDomainByModel(e)}computeDomain(e){return this.computeLinearDomain(e)}updateScaleDomainByModel(e){e=null!=e?e:this._scale.domain(),this.extendDomain(e),this.includeZero(e),this.setDomainMinMax(e),this.niceDomain(e),this._scale.domain(e,this.nice),this.niceMinMax()}updateRange(e){let[t,l]=this._scale.range();e[0]===t&&e[1]===l||this._scale.range(e)}}var lo=l(944843);function lr(e,t){var l;let i=t.option;(0,lo.Z)(e)||(null==(l=null==i?void 0:i.label)?void 0:l.flush)&&function(e,t){let{width:l,height:i}=t.getLayoutRect(),n=t1(t.orient),o=!0===t.option.inverse,r=e[0],a=(0,le.Z$)(e);if(n)if(o){let e=r.AABBBounds.x2,t=a.AABBBounds.x1;e>l&&r.setAttributes({x:l,textAlign:"right"}),t<0&&a.setAttributes({x:0,textAlign:"left"})}else{let e=r.AABBBounds.x1,t=a.AABBBounds.x2;e<0&&r.setAttributes({x:0,textAlign:"left"}),t>l&&a.setAttributes({x:l,textAlign:"right"})}else if(o){let e=r.AABBBounds.y1,t=a.AABBBounds.y2;e<0&&r.setAttributes({y:0,textBaseline:"top"}),t>i&&a.setAttributes({y:i,textBaseline:"bottom"})}else{let e=r.AABBBounds.y2,t=a.AABBBounds.y1;e>i&&r.setAttributes({y:i,textBaseline:"bottom"}),t<0&&a.setAttributes({y:0,textBaseline:"top"})}}(e,t)}let la=e=>e;function ls(e,t){let l;return"left"===e?l=t.axisStyle.leftAxisStyle:"right"===e?l=t.axisStyle.rightAxisStyle:"top"===e?l=t.axisStyle.topAxisStyle:"bottom"===e&&(l=t.axisStyle.bottomAxisStyle),(0,t$.Z)({},t.axisStyle.defaultAxisStyle,l)}function lh(e){return"number"!=typeof e&&(e=Number(e)),Number(e.toPrecision(1)).toString()}function ld(e,t,l=0){let i=l*Math.PI/180,n=-e/2,o=-t/2,r=e/2,a=-t/2,s=e/2,h=t/2,d=-e/2,u=t/2,c={x:n*Math.cos(i)-o*Math.sin(i),y:n*Math.sin(i)+o*Math.cos(i)},g={x:r*Math.cos(i)-a*Math.sin(i),y:r*Math.sin(i)+a*Math.cos(i)},p={x:s*Math.cos(i)-h*Math.sin(i),y:s*Math.sin(i)+h*Math.cos(i)},f={x:d*Math.cos(i)-u*Math.sin(i),y:d*Math.sin(i)+u*Math.cos(i)},C=Math.min(c.x,g.x,p.x,f.x),v=Math.max(c.x,g.x,p.x,f.x),m=Math.min(c.y,g.y,p.y,f.y);return{width:v-C,height:Math.max(c.y,g.y,p.y,f.y)-m}}var lu=l(419452),lc=l(475133),lg=l(625397),lp=l(685506),lf=l(475609),lC=l(878921),lv=l(844561),lm=function(e,t){var l={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(l[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)0>t.indexOf(i[n])&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(l[i[n]]=e[i[n]])}return l};let lb={orient:"bottom",position:"middle",padding:30,title:{visible:!1,padding:0,textStyle:{fontSize:14,fill:"#000000",fontWeight:"normal"},space:12},item:{visible:!0,spaceCol:10,spaceRow:10,padding:2,background:{state:{selectedHover:{fill:"gray",fillOpacity:.7},unSelectedHover:{fill:"gray",fillOpacity:.2}}},shape:{space:4,state:{unSelected:{fillOpacity:.5}}},label:{space:4,style:{fill:"#89909D",fontSize:14},state:{unSelected:{fillOpacity:.5}}}},allowAllCanceled:!0,visible:!0};var ly=l(376352);class lw{constructor(e,t){var l,i,n,o;this.table=t,this.option=(0,e9.Z)(e),this.orient=null!=(l=e.orient)?l:"left",this.visible=null==(i=e.visible)||i,this.position=null!=(n=e.position)?n:"middle",this.selectedData=null!=(o=e.defaultSelected)?o:null,this.createComponent(),this.initEvent()}createComponent(){let e=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight}),t=new lp.W((0,t$.Z)({},e,{defaultSelected:this.selectedData,disableTriggerEvent:this.table.options.disableInteraction}));t.name="legend",this.legendComponent=t,!1===this.visible&&(t.setAttributes({visible:!1,visibleAll:!1}),t.hideAll()),this.table.scenegraph.stage.defaultLayer.appendChild(t),this.adjustTableSize(e)}resize(){if(!this.legendComponent||!1===this.visible)return;let e=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight});this.legendComponent.setAttributes(e),this.adjustTableSize(this.legendComponent.attribute)}adjustTableSize(e){var t,l;if(!this.legendComponent||!1===this.visible)return;let i=isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,n=isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0;if(i<=0||n<=0)return;let o=this.table.tableNoFrameWidth,r=this.table.tableNoFrameHeight,a=(0,ly.u)(null!=(l=null!=(t=e.padding)?t:this.option.padding)?l:10),s=0,h=0;"left"===this.orient?(s=a[3],h=0,i+=a[1]+a[3]):"top"===this.orient?(s=0,h=a[0],n+=a[0]+a[2]):"right"===this.orient?(s=o-i-a[1],h=0,i+=a[1]+a[3]):"bottom"===this.orient&&(s=0,h=r-n-a[2],n+=a[0]+a[2]);let d="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",u=this.position,c=0,g=0;"horizontal"===d?c="middle"===u?(o-i)/2:"end"===u?o-i-a[1]:a[3]:g="middle"===u?(r-n)/2:"end"===u?r-n-a[2]:a[0],this.legendComponent.setAttributes({dx:c,dy:g,x:s,y:h}),"left"===this.orient?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(i),this.table.tableX+=Math.ceil(i)):"top"===this.orient?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(n),this.table.tableY+=Math.ceil(n)):"right"===this.orient?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(i):"bottom"===this.orient&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(n))}getLegendAttributes(e){var t,l;let i="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",n=function(e,t){let l=(0,t$.Z)({},lb,e),{title:i={},item:n={},pager:o={},background:r={},type:a,id:s,visible:h,orient:d,position:u,data:c,filter:g,regionId:p,regionIndex:f,seriesIndex:C,seriesId:m,padding:b}=l,y=lm(l,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return i.visible&&(y.title=(0,lv.qi)(i)),(0,lo.Z)(n.focusIconStyle)||(0,lv.h_)(n.focusIconStyle),(0,lv.ro)(n.shape),(0,lv.ro)(n.label),(0,lv.ro)(n.value),(0,lv.ro)(n.background),(0,lC.hU)(n.maxWidth)&&(n.maxWidth=Number(n.maxWidth.substring(0,n.maxWidth.length-1))*t.width/100),(0,lC.hU)(n.width)&&(n.width=Number(n.width.substring(0,n.width.length-1))*t.width/100),(0,lC.hU)(n.height)&&(n.height=Number(n.height.substring(0,n.height.length-1))*t.width/100),y.item=n,(0,lo.Z)(o.textStyle)||(0,lv.h_)(o.textStyle),(0,lv.ro)(o.handler),y.pager=o,r.visible&&!(0,lo.Z)(r.style)&&((0,t$.Z)(y,r.style),(0,v.Z)(r.padding)&&(y.padding=r.padding)),y}(this.option,e),o=(0,ly.u)(null!=(l=null!=(t=n.padding)?t:this.option.padding)?l:10);return Object.assign({layout:i,items:this.getLegendItems(),maxWidth:e.width-o[1]-o[3],maxHeight:e.height-o[0]-o[2]},n)}getLegendItems(){return this.option.data}initEvent(){this.legendComponent&&(this.legendComponent.addEventListener(lf.dk.legendItemClick,e=>{let t=(0,lg.Z)(e,"detail.currentSelected");this.table.fireListeners(F.B.LEGEND_ITEM_CLICK,{model:this,value:t,event:e})}),this.legendComponent.addEventListener(lf.dk.legendItemHover,e=>{let t=(0,lg.Z)(e,"detail");this.table.fireListeners(F.B.LEGEND_ITEM_HOVER,{model:this,value:t,event:e})}),this.legendComponent.addEventListener(lf.dk.legendItemUnHover,e=>{let t=(0,lg.Z)(e,"detail");this.table.fireListeners(F.B.LEGEND_ITEM_UNHOVER,{model:this,value:t,event:e})}),this.legendComponent.addEventListener("legendItemAttributeUpdate",e=>{this.table.scenegraph.updateNextFrame()}))}getLegendBounds(){return{width:isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,height:isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0}}release(){this.legendComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this.legendComponent),this.legendComponent=null}}var l_=l(360855),lM=l(255111),lS=function(e,t){var l={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(l[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)0>t.indexOf(i[n])&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(l[i[n]]=e[i[n]])}return l};let lR={orient:"right",position:"middle",padding:30,title:{visible:!1,padding:0,textStyle:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"titleFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}},endText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}},handlerText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}}},lx={horizontal:Object.assign(Object.assign({},lR),{rail:{width:200,height:8,style:{fill:"rgba(0,0,0,0.04)"}}}),vertical:Object.assign(Object.assign({},lR),{rail:{width:8,height:200,style:{fill:"rgba(0,0,0,0.04)"}}})},lE={horizontal:Object.assign({sizeBackground:{fill:"#cdcdcd"},track:{style:{fill:"rgba(20,20,20,0.1)"}},rail:{width:200,height:4,style:{fill:"rgba(0,0,0,0.04)"}}},lR),vertical:Object.assign({sizeBackground:{fill:"#cdcdcd"},track:{style:{fill:"rgba(20,20,20,0.1)"}},rail:{width:4,height:200,style:{fill:"rgba(0,0,0,0.04)"}}},lR)};class lP{constructor(e,t){var l,i,n,o;this.table=t,this.option=(0,e9.Z)(e),this.orient=null!=(l=e.orient)?l:"left",this.visible=null==(i=e.visible)||i,this.position=null!=(n=e.position)?n:"middle",this.selectedData=null!=(o=e.defaultSelected)?o:null,this.createComponent(),this.initEvent()}createComponent(){let e,t=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight});(e="color"===this.option.type?new l_.e((0,t$.Z)({},t,{slidable:!0})):new lM.D((0,t$.Z)({},t,{slidable:!0}))).name="legend",this.legendComponent=e,!1===this.visible&&(e.setAttributes({visible:!1,visibleAll:!1}),e.hideAll()),this.table.scenegraph.stage.defaultLayer.appendChild(e),this.adjustTableSize(t)}resize(){this.legendComponent&&!1!==this.visible&&(this.legendComponent.setAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight}),this.adjustTableSize(this.legendComponent.attribute))}adjustTableSize(e){var t,l;if(!this.legendComponent||!1===this.visible)return;let i=isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,n=isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0;if(i<=0||n<=0)return;let o=this.table.tableNoFrameWidth,r=this.table.tableNoFrameHeight,a=(0,ly.u)(null!=(l=null!=(t=e.padding)?t:this.option.padding)?l:10),s=0,h=0;"left"===this.orient?(s=a[3],h=0,i+=a[1]+a[3]):"top"===this.orient?(s=0,h=a[0],n+=a[0]+a[2]):"right"===this.orient?(s=o-i-a[1],h=0,i+=a[1]+a[3]):"bottom"===this.orient&&(s=0,h=r-n-a[2],n+=a[0]+a[2]);let d="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",u=this.position,c=0,g=0;"horizontal"===d?c="middle"===u?(o-i)/2:"end"===u?o-i-a[1]:a[3]:g="middle"===u?(r-n)/2:"end"===u?r-n-a[2]:a[0],this.legendComponent.setAttributes({dx:c,dy:g,x:s,y:h}),"left"===this.orient?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(i),this.table.tableX+=Math.ceil(i)):"top"===this.orient?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(n),this.table.tableY+=Math.ceil(n)):"right"===this.orient?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(i):"bottom"===this.orient&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(n))}getLegendAttributes(e){let t="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",l="horizontal"===t?"bottom":this.orient;return Object.assign(Object.assign({},function(e,t){let l=(0,t$.Z)({},("color"===e.type?lx:lE)["bottom"===e.orient||"top"===e.orient?"horizontal":"vertical"],e),{title:i={},handler:n={},rail:o={},track:r={},startText:a,endText:s,handlerText:h,sizeBackground:d,background:u={},type:c,id:g,visible:p,orient:f,position:C,data:m,defaultSelected:b,field:y,filter:w,regionId:_,regionIndex:M,seriesIndex:S,seriesId:R,padding:x}=l,E=lS(l,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return i.visible&&(E.title=(0,lv.qi)(i)),E.showHandler=!1!==n.visible,(0,lo.Z)(n.style)||(E.handlerStyle=(0,lv.h_)(n.style)),(0,v.Z)(o.width)&&(E.railWidth=o.width),(0,v.Z)(o.height)&&(E.railHeight=o.height),(0,lo.Z)(o.style)||(E.railStyle=(0,lv.h_)(o.style)),(0,lo.Z)(r.style)||(E.trackStyle=(0,lv.h_)(r.style)),E.startText=(0,lv.ro)(a),E.endText=(0,lv.ro)(s),E.handlerText=(0,lv.ro)(h),(0,lo.Z)(d)||(E.sizeBackground=(0,lv.h_)(d)),u.visible&&!(0,lo.Z)(u.style)&&((0,t$.Z)(E,u.style),(0,v.Z)(u.padding)&&(E.padding=u.padding)),E}(this.option,0)),{layout:t,align:l,min:this.option.min,max:this.option.max,value:this.option.value,["color"===this.option.type?"colors":"sizeRange"]:"color"===this.option.type?this.option.colors:this.option.sizeRange})}initEvent(){this.legendComponent&&this.legendComponent.addEventListener("change",e=>{let t=(0,lg.Z)(e,"detail.value");this.table.fireListeners(F.B.LEGEND_CHANGE,{model:this,value:t,event:e}),this.table.scenegraph.updateNextFrame()})}getLegendBounds(){return{width:isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,height:isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0}}release(){this.legendComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this.legendComponent),this.legendComponent=null}}class lA{constructor(e){this._table=e}release(){this.unbindMenuElement(),this._menuElement&&this._menuElement.release(),this._menuElement=void 0}_getMenuElement(){return this._menuElement||(this._menuElement=this.createMenuElementInternal()),this._menuElement}bindMenuElement(e,t,l){return this._getMenuElement().bindToCell(this._table,e,t,l)}unbindMenuElement(){this._getMenuElement().unbindFromCell()}pointInMenuElement(e,t){return this._getMenuElement().pointInMenuElement(e,t)}getRootElement(){return this._getMenuElement().rootElement}}let lT="vtable__menu-element",lH=`${lT}--hidden`,lL=`${lT}--shown`;class lF{constructor(e){var t,l,i;this._handler=new D,this._rootElement=(0,eL.a)("div",[lT,lH]),this._rootElement.addEventListener("wheel",e=>{e.stopPropagation()}),null==(t=this._rootElement)||t.addEventListener("mousedown",e=>{e.stopPropagation(),e.preventDefault()}),null==(l=this._rootElement)||l.addEventListener("click",t=>{if(t.stopPropagation(),t.preventDefault(),this._rootElement.classList.contains(lH))return;let{col:l,row:i,dropDownIndex:n,menuKey:o,text:r,hasChildren:a}=t.target;if("number"!=typeof n||a)return void t.stopPropagation();let s=e.isPivotTable()?e.internalProps.layoutMap.getPivotDimensionInfo(l,i):e.getHeaderField(l,i),h=e._dropDownMenuIsHighlight(l,i,n);e.fireListeners(F.B.DROPDOWN_MENU_CLICK,{col:l,row:i,field:s,menuKey:o,text:r,highlight:h,cellLocation:e.getCellLocation(l,i),event:t}),e.fireListeners(F.B.DROPDOWN_MENU_CLEAR,null),e.fireListeners(F.B.HIDE_MENU,null),t.stopPropagation()}),null==(i=this._rootElement)||i.addEventListener("mousemove",e=>{this._rootElement.classList.contains(lH)||e.stopPropagation()})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();let e=this._rootElement;(null==e?void 0:e.parentElement)&&e.parentElement.removeChild(e),this._handler.release(),delete this._rootElement}bindToCell(e,t,l,i){let n=this._rootElement;if(this._menuInstanceInfo=i,null==n||n.classList.remove(lL),null==n||n.classList.add(lH),this._canBindToCell(e,t,l)){if(n.innerHTML="",n.appendChild(i.content),this._bindCell(e,t,l,i.position,i.referencePosition))return null==n||n.classList.add(lL),null==n||n.classList.remove(lH),!0}else this.unbindFromCell();return!1}unbindFromCell(){let e=this._rootElement;this._menuInstanceInfo=void 0,(null==e?void 0:e.parentElement)&&(e.classList.remove(lL),e.classList.add(lH))}_canBindToCell(e,t,l){var i;let n=e.getCellRangeRelativeRect({col:t,row:l}),o=null!=(i=e.internalProps.menu.parentElement)?i:e.getElement(),{top:r,bottom:a,left:s,right:h}=n;if(e.isFrozenCell(t,l))return!0;if(a<e.getFrozenRowsHeight()||h<e.getFrozenColsWidth()||s>e.tableNoFrameWidth-e.getRightFrozenColsWidth()||r>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight())return!1;let{offsetHeight:d,offsetWidth:u}=o;return!(d<r)&&!(u<s)}_bindCell(e,t,l,i,n){var o;let r=this._rootElement,a=null!=(o=e.internalProps.menu.parentElement)?o:e.getElement(),{width:s,height:h,left:d,top:u}=a.getBoundingClientRect();if(r){let t,l;r.parentElement!==a&&a.appendChild(r),r.style.left="0px",r.style.maxWidth=`${.8*s}px`;let o=r.clientWidth,c=r.clientHeight;i&&(t=i.x,l=i.y),n&&(t=n.rect.right-o,l=n.rect.bottom),l+c>h&&(l=h-c,t+=o-2),l<0&&(l/=2);let g=0,p=0;if(e.getElement()!==a){let{left:t,top:l}=e.getElement().getBoundingClientRect();g=l-u,p=t-d}return r.style.top=`${l+g}px`,t<0?t=0:t+o>s&&(t=s-o),r.style.left=`${t+p}px`,!0}return!1}pointInMenuElement(e,t){let{x:l,y:i,width:n,height:o}=this._rootElement.getBoundingClientRect();return e>l-5&&e<l+n+5&&t>i-5&&t<i+o+5}}class lB extends lA{createMenuElementInternal(){return new e$(this._table)}}class lI extends lA{createMenuElementInternal(){return new lF(this._table)}}let lk={"dropdown-menu":function(e){return new lB(e)},"context-menu":function(e){return new lB(e)},container:e=>new lI(e)};var lD=l(863718);class lO{constructor(e){this._table=e}release(){var e,t;this.unbindTooltipElement(),this._tooltipElement&&(null==(t=(e=this._tooltipElement).release)||t.call(e)),this._tooltipElement=void 0}_getTooltipElement(){return this._tooltipElement||(this._tooltipElement=this.createTooltipElementInternal()),this._tooltipElement}bindTooltipElement(e,t,l,i){return this._getTooltipElement().bindToCell(this._table,e,t,l,i)}moveTooltipElement(e,t,l,i){this._getTooltipElement().move(this._table,e,t,l,i)}unbindTooltipElement(){this._getTooltipElement().unbindFromCell()}locateTooltipElement(e,t,l,i,n){this._getTooltipElement()._locate(this._table,e,t,l,i,n)}}!function(){if("node"===A.X.mode)return;let e=document.createElement("style");e.id="vtable-tooltip-styleSheet",e.textContent="\n@keyframes vtable__bubble-tooltip-element--shown-animation {\n	0% {\n		opacity: 0;\n	}\n	100% {\n		opacity: 1;\n	}\n}\n.vtable__bubble-tooltip-element {\n	position: absolute;\n	\n	// pointer-events: none;\n	//user-select: none;\n	max-width: 300px;\n	z-index: 99999;\n\n	background: #FFFFFF;\n    border: 1px solid #E6E8ED;\n    box-sizing: border-box;\n    border-radius: 4px;\n    box-shadow: 0px 2px 4px rgb(27 31 35 / 8%);\n    color: #141414;\n    font-size: 13px;\n}\n.vtable__bubble-tooltip-element--hidden {\n	opacity: 0;\n  pointer-events: none;\n	user-select: none;\n	/* transform: translate(-50%, -50%); */\n	transition: opacity 75ms linear;\n}\n.vtable__bubble-tooltip-element--shown {\n	opacity: 1;\n	/* transform: translate(-50%, -50%); */\n	animation: vtable__bubble-tooltip-element--shown-animation 150ms ease-out;\n}\n.vtable__bubble-tooltip-element__content {\n	/* font-size: .75rem; */\n	padding: 6px 8px;\n	min-height: 1em;\n	line-height: 1.5;\n	width: 100%;\n	display: block;\n	white-space: pre-wrap;\n	margin: 0;\n	box-sizing: border-box;\n	overflow: auto;\n	word-wrap: break-word;\n	position: relative;\n	background-color: #FFF;\n	z-index: 2;\n	border-radius: 4px;\n}\n/*  WebKit Microsoft Edge\uFF08\u65B0\u7248\uFF09\uFF1A */\n.vtable__bubble-tooltip-element__content::-webkit-scrollbar {\n  width: 0;\n  height: 0;\n  background-color: transparent;\n}\n/*  Opera Firefox  */\n.vtable__bubble-tooltip-element__content > scrollbar-track {\n  width: 0;\n  height: 0;\n  background-color: transparent;\n}\n/* Internet Explorer 11 \u548C Microsoft Edge\uFF08\u65E7\u7248\uFF09 */\n.vtable__bubble-tooltip-element__content > scrollbar {\n  width: 0;\n  height: 0;\n  background-color: transparent;\n}\n.vtable__bubble-tooltip-element__triangle {\n	/* font-size: .75rem; */\n	position: absolute;\n	width: 10px;\n	height: 10px;\n	display: block;\n	transform: rotate(45deg);\n    transform-origin: 50% 50% 0;\n	z-index: 1;\n	background-color: #FFF;\n	border: 1px solid #E6E8ED;\n}\n",document.head.appendChild(e)}();let lz="vtable__bubble-tooltip-element",lW=`${lz}__content`,lN=`${lz}__triangle`,lV=`${lz}--hidden`,lZ=`${lz}--shown`;class lU{constructor(){this._handler=new D;let e=this._rootElement=(0,eL.a)("div",[lz,lV]),t=(0,eL.a)("div",[lW]),l=(0,eL.a)("span",[lN]);e.appendChild(l),e.appendChild(t),this._messageElement=e.querySelector(`.${lW}`)||void 0,this._triangleElement=e.querySelector(`.${lN}`)||void 0,e.addEventListener("mousemove",()=>{this._disappearDelayId&&clearTimeout(this._disappearDelayId)}),e.addEventListener("mouseleave",()=>{this._disappearDelay=void 0,this.unbindFromCell()}),t.addEventListener("wheel",e=>{e.stopPropagation()}),t.addEventListener("copy",e=>{(0,W.Ed)(t)&&e.stopPropagation()})}bindToCell(e,t,l,i,n){var o,r,a,s,h,d,u,c,g,p,f,C,v,m,b,y,w,_,M;this._disappearDelay=null==i?void 0:i.disappearDelay,this._disappearDelayId&&clearTimeout(this._disappearDelayId);let S=this._rootElement,R=this._messageElement,x=this._triangleElement;if(null==S||S.classList.remove(lZ),null==S||S.classList.add(lV),this._canBindToCell(e,t,l)){if(R.setAttribute("style",""),x.setAttribute("style",""),(null==i?void 0:i.className)&&S.classList.add(i.className),(null==(o=null==i?void 0:i.style)?void 0:o.bgColor)&&(R.style.backgroundColor=null==(r=null==i?void 0:i.style)?void 0:r.bgColor),(null==(a=null==i?void 0:i.style)?void 0:a.bgColor)&&(x.style.backgroundColor=null==(s=null==i?void 0:i.style)?void 0:s.bgColor),x.style.display=!0===(null==(h=null==i?void 0:i.style)?void 0:h.arrowMark)?"block":"none",(null==(d=null==i?void 0:i.style)?void 0:d.fontSize)&&(R.style.fontSize=(null!=(c=null==(u=null==i?void 0:i.style)?void 0:u.fontSize)?c:12)+"px"),(null==(g=null==i?void 0:i.style)?void 0:g.fontFamily)&&(R.style.fontFamily=null==(p=null==i?void 0:i.style)?void 0:p.fontFamily),(null==(f=null==i?void 0:i.style)?void 0:f.color)&&(R.style.color=null==(C=null==i?void 0:i.style)?void 0:C.color),(null==(v=null==i?void 0:i.style)?void 0:v.padding)&&(R.style.padding=`${null==(m=null==i?void 0:i.style)?void 0:m.padding.join("px ")}px`),(null==(b=null==i?void 0:i.style)?void 0:b.maxHeight)&&(R.style.maxHeight=`${null==(y=null==i?void 0:i.style)?void 0:y.maxHeight}px`),(null==(w=null==i?void 0:i.style)?void 0:w.maxWidth)&&(R.style.maxWidth=`${null==(_=null==i?void 0:i.style)?void 0:_.maxWidth}px`),R&&(R.textContent=null==i?void 0:i.content),this._bindToCell(e,t,l,null==i?void 0:i.position,null==i?void 0:i.referencePosition,n,null==(M=null==i?void 0:i.style)?void 0:M.arrowMark))return null==S||S.classList.add(lZ),null==S||S.classList.remove(lV),!0}else this.unbindFromCell();return!1}release(){var e,t;this.unbindFromCell();let l=this._rootElement;(null==l?void 0:l.parentElement)&&l.parentElement.removeChild(l),null==(t=null==(e=this._handler)?void 0:e.release)||t.call(e),delete this._rootElement,delete this._messageElement}move(e,t,l,i,n){let o=this._rootElement;this._canBindToCell(e,t,l)?(this._bindToCell(e,t,l,null==i?void 0:i.position,null==i?void 0:i.referencePosition,n),null==o||o.classList.add(lZ),null==o||o.classList.remove(lV)):this.unbindFromCell()}unbindFromCell(){var e;if(this._disappearDelay)this._disappearDelayId=setTimeout(()=>{let e=this._rootElement;(null==e?void 0:e.parentElement)&&(e.classList.remove(lZ),e.classList.add(lV))},null!=(e=this._disappearDelay)?e:0);else{let e=this._rootElement;(null==e?void 0:e.parentElement)&&(e.classList.remove(lZ),e.classList.add(lV))}}_canBindToCell(e,t,l){let i=e.getCellRangeRelativeRect({col:t,row:l}),n=e.getElement(),{bottom:o,left:r,right:a,top:s}=i;if(e.isFrozenCell(t,l))return!0;if(o<e.getFrozenRowsHeight()||a<e.getFrozenColsWidth()||r>e.tableNoFrameWidth-e.getRightFrozenColsWidth()||s>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight())return!1;let{offsetHeight:h,offsetWidth:d}=n;return!(s>h)&&!(r>d)}_bindToCell(e,t,l,i,n,o,r){let a=this._rootElement,s=e.getCellRangeRelativeRect({col:t,row:l}),h=e.internalProps.tooltip.parentElement,d=e.internalProps.element.offsetWidth,{width:u}=s;if(a){let s,c;a.parentElement!==h&&h.appendChild(a),a.style.left="0px";let g=Math.min(.8*d,4*u);a.style.maxWidth=`${g}px`;let p=a.clientWidth,f=a.clientHeight;if(!i&&!n)return!1;{let a=this.getComputedPosition(e,t,l,i,n,o,r);c=a.x,s=a.y}a.style.left=`${c}px`,a.style.top=`${s}px`,(0,W.tq)()&&(a.style.fontSize="11px");let{x1:C,x2:v,y1:m,y2:b}=e.stateManager.menu.bounds,y=c,w=s;return!(e.stateManager.menu.isShow&&C<y+p&&v>y&&b>w&&m<y+f)}return!1}getComputedPosition(e,t,l,i,n,o,r){var a;let s,h,d=this._rootElement,u=e.getCellRangeRelativeRect({col:t,row:l}),{x:c,y:g}=e.internalProps.tooltip.parentElement.getBoundingClientRect(),{width:p,height:C,x:v,y:m}=e.internalProps.element.getBoundingClientRect(),{width:b}=u,y=Math.min(.8*p,4*b);d.style.maxWidth=`${y}px`;let w=d.clientWidth,_=d.clientHeight,M=6*!!r;if(i)h=i.x,s=i.y+M,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.top="-5px";else if(n){let e=null!=(a=n.placement)?a:f.u.bottom,t=n.rect.left+n.rect.width/2,l=n.rect.top+n.rect.height/2,i=n.rect.top,r=n.rect.bottom,d=n.rect.left,u=n.rect.right,c=0,g=()=>{++c>=4||(this.removeStyleFromTriangle(),e===f.u.top?(h=t-w/2,s=i-_-M,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.bottom="-5px",o&&s<0&&(e=f.u.right,g())):e===f.u.bottom?(h=t-w/2,s=r+M,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.top="-5px",o&&s+_>C&&(e=f.u.left,g())):e===f.u.left?(s=l-_/2,h=d-w-M,this._triangleElement.style.top="50%",this._triangleElement.style.marginTop="-5px",this._triangleElement.style.right="-5px",o&&h<0&&(e=f.u.top,g())):e===f.u.right&&(s=l-_/2,h=u+M,this._triangleElement.style.top="50%",this._triangleElement.style.marginTop="-5px",this._triangleElement.style.left="-5px",o&&h+w>p&&(e=f.u.bottom,g())))};g()}return o&&(h<0?h=0:h+d.offsetWidth>p&&(h=p-d.offsetWidth)),{x:h+v-c,y:s+m-g}}removeStyleFromTriangle(){this._triangleElement.style.left="",this._triangleElement.style.right="",this._triangleElement.style.top="",this._triangleElement.style.bottom="",this._triangleElement.style.marginLeft="",this._triangleElement.style.marginTop=""}_locate(e,t,l,i,n,o){let r=this.getComputedPosition(e,t,l,i,n,o),a=r.x,s=r.y;this._rootElement.style.left=`${a}px`,this._rootElement.style.top=`${s}px`}}class lG extends lO{createTooltipElementInternal(){return new lU}}let lj={"bubble-tooltip":function(e){return new lG(e)}};var lK=l(837054),lX=l(357944),l$=l(162911),lY=l(808855);to.F.registerComponent("axis",class e{constructor(e,t,l,i,n){var o,r,a,s,h,d,u,c,g;(this.x=0,this.y=0,this.bodyChartCellPadding=i,this.table=n,this.orient=null!=(o=e.orient)?o:"left",this.type=null!=(r=e.type)?r:"band",this.option=(0,t$.Z)({},(0,t0.UP)(e.__vtableChartTheme),ls(this.orient,n.theme),function(e,t,l){let i,n;if(!l)return{};let o=l.axis;return"linear"===t||"log"===t||"symlog"===t?i=l.axisLinear:"band"===t&&(i=l.axisBand),"top"===e||"bottom"===e?n=l.axisX:"left"!==e&&"right"!==e||(n=l.axisY),(0,t$.Z)({},o,i,n)}(this.orient,this.type,e.__vtableChartTheme),e),"left"===this.orient||"right"===this.orient)?("left"===this.orient&&(this.x=null!=(a=this.option.cellPaddingLeft)?a:0,this.width=t-(null!=(s=this.option.cellPaddingLeft)?s:0)),"right"===this.orient&&(this.x=0,this.width=t-(null!=(h=this.option.cellPaddingRight)?h:0)),this.height=l-i[0]-i[2]-0,this.y=i[0]+0):("top"===this.orient||"bottom"===this.orient)&&(this.width=t-i[1]-i[3]-0,this.x=i[3]+0,"top"===this.orient&&(this.y=null!=(d=this.option.cellPaddingTop)?d:0,this.height=l-(null!=(u=this.option.cellPaddingTop)?u:0)),"bottom"===this.orient&&(this.y=0,this.height=l-(null!=(c=this.option.cellPaddingBottom)?c:0))),this.visible=null==(g=e.visible)||g,this.inverse="inverse"in e&&!!e.inverse,"band"===e.type&&(this.data=e.domain),this.initScale(),this.initData(),this.createComponent(),this.initEvent()}initScale(){let e=this.option;"band"===this.type||"point"===this.type?(this.scale=new t3,this.scale.bandPadding=e.bandPadding,this.scale.paddingInner=e.paddingInner,this.scale.paddingOuter=e.paddingOuter,this.scale.calcScales(.1,.3),this.scale.updateScaleDomain(this.data),this.updateScaleRange()):"linear"!==this.type&&"time"!==this.type&&"log"!==this.type&&"symlog"!==this.type||(this.scale=new ln(this.type),this.scale.setExtraAttrFromSpec(e.nice,e.zero,e.range,e.expand,e.base,e.constant),this.scale.transformScaleDomain(),this.scale.updateScaleDomain(),this.updateScaleRange())}initData(){var e,t,l,i,n;this.table._vDataSet||(this.table._vDataSet=new t9.q),e=this.table._vDataSet,t="scale",e.getParser(t)||e.registerParser(t,la),l=this.table._vDataSet,i="ticks",n=t5.s,l.getTransform(i)||l.registerTransform(i,n);let o=this.option.label||{},r=this.option.tick||{},a=new t4.V(this.table._vDataSet).parse(this.scale._scale,{type:"scale"}).transform({type:"ticks",options:{sampling:!1!==this.option.sampling,tickCount:r.tickCount,forceTickCount:r.forceTickCount,tickStep:r.tickStep,tickMode:r.tickMode,noDecimals:r.noDecimals,axisOrientType:this.orient,coordinateType:"cartesian",labelStyle:o.style,labelFormatter:o.formatMethod,labelGap:o.minGap,labelLastVisible:o.lastVisible,labelFlush:o.flush}},!1);this.tickData=a,this.computeData()}computeData(){this.tickData.reRunAllTransform()}initEvent(){}createComponent(){let e=(0,t0.sG)(this.option),t=this.getUpdateAttribute();t.verticalFactor="top"===this.orient||"right"===this.orient?-1:1,this.component=new tQ.$((0,t$.Z)({disableTriggerEvent:this.table.options.disableInteraction},e,t)),this.component.setAttributes(this.setLayoutStartPosition({x:this.x,y:this.y})),this.component.originAxis=this}resize(e,t){var l,i,n,o;"left"===this.orient?this.width=e-(null!=(l=this.option.cellPaddingLeft)?l:0):"right"===this.orient?this.width=e-(null!=(i=this.option.cellPaddingRight)?i:0):"top"!==this.orient&&"bottom"!==this.orient||(this.width=e-(this.bodyChartCellPadding[1]+this.bodyChartCellPadding[3])),"top"===this.orient?this.height=t-(null!=(n=this.option.cellPaddingTop)?n:0):"bottom"===this.orient?this.height=t-(null!=(o=this.option.cellPaddingBottom)?o:0):"left"!==this.orient&&"right"!==this.orient||(this.height=t-(this.bodyChartCellPadding[2]+this.bodyChartCellPadding[0])),this.updateScaleRange(),this.computeData();let r=(0,t0.sG)(this.option),a=this.getUpdateAttribute();a.verticalFactor="top"===this.orient||"right"===this.orient?-1:1,this.component.setAttributes((0,t$.Z)({},r,a)),this.component.setAttributes(this.setLayoutStartPosition({x:this.x,y:this.y})),this.overlap()}overlap(){!function(e,t){let l=e.find(e=>"axis-label-container-layer-0"===e.name,!0),i=e.find(e=>"axis-label-container-layer-1"===e.name,!0);lr(l?l.getChildren():[],t),lr(i?i.getChildren():[],t)}(this.component,this)}getLayoutRect(){return{width:this.width,height:this.height}}getUpdateAttribute(){var e;this.table.tableNoFrameHeight,this.table.tableNoFrameWidth;let{width:t,height:l}=this.getLayoutRect(),i=t1(this.orient),n="left"===(e=this.orient)||"right"===e,o={x:0,y:0},r=0;i?(o={x:t,y:0},r=t):n&&(o={x:0,y:l},r=l);let a="top"===this.orient||"bottom"===this.orient?l:t;return{start:{x:0,y:0},end:o,title:{text:this.option.title.text,maxWidth:this._getTitleLimit(i)},items:this.getLabelItems(r),verticalLimitSize:a,verticalMinSize:a}}getLabelItems(e){return[this.tickData.latestData.map(t=>({id:t.value,label:t.value,value:0===e?0:this.scale.dataToPosition([t.value])/e,rawValue:t.value})).filter(e=>e.value>=0&&e.value<=1)]}updateScaleRange(){var e,t,l,i,n,o,r,a;let s=null!=(t=null==(e=this.option.innerOffset)?void 0:e.right)?t:0,h=null!=(i=null==(l=this.option.innerOffset)?void 0:l.left)?i:0,d=null!=(o=null==(n=this.option.innerOffset)?void 0:n.top)?o:0,u=null!=(a=null==(r=this.option.innerOffset)?void 0:r.bottom)?a:0,{width:c,height:g}=this.getLayoutRect(),p=this.option.inverse||!1,f=[0,0];t1(this.orient)?(0,tY.Z)(c)&&(f=p?[c-s,h]:[h,c-s]):(0,tY.Z)(g)&&(f=p?[d,g-u]:[g-u,d]),this.scale.updateRange(f)}setLayoutStartPosition(e){let{x:t,y:l}=e;return(0,tY.Z)(t)&&(t+=Number("left"===this.orient)*this.getLayoutRect().width),(0,tY.Z)(l)&&(l+=Number("top"===this.orient)*this.getLayoutRect().height),{x:t,y:l}}_getTitleLimit(e){var t,l,i;if(this.option.title.visible&&(0,tJ.Z)(null==(t=this.option.title.style)?void 0:t.maxLineWidth)){let t=(null==(l=this.option.title.style)?void 0:l.angle)||0;if((null==(i=this.option.title)?void 0:i.autoRotate)&&(0,tJ.Z)(this.option.title.angle)&&(t="left"===this.option.orient?-90:90),e){let e=this.getLayoutRect().width,l=Math.abs(Math.cos((0,tq.M4)(t)));return l<1e-6?1/0:e/l}let n=this.getLayoutRect().height,o=Math.abs(Math.sin((0,tq.M4)(t)));return o<1e-6?1/0:n/o}return null}getScale(){return this.scale._scale}getDomainSpec(){return this.scale.domain}}),to.F.registerFunction("computeAxisComponentWidth",function(e,t){var l,i,n,o,r,a,s,h,d,u,c,g,p,f,C,v,b,y,w,_;let M=(0,t$.Z)({},t0.b8,e),S=0;!1!==M.tick.visible&&(S=null!=(l=M.tick.width)?l:4);let R=0;if(M.label.visible){if("band"===M.type)M.domain.forEach(e=>{var l,i,n,o,r,a,s,h,d,u,c,g,p,f,C,v;M.label.formatMethod&&(e=M.label.formatMethod(e));let{width:m,height:b}=t.measureText(e,{fontSize:null!=(n=null==(i=null==(l=M.label)?void 0:l.style)?void 0:i.fontSize)?n:t0.$M,fontWeight:null!=(a=null==(r=null==(o=M.label)?void 0:o.style)?void 0:r.fontWeight)?a:"normal",fontFamily:null!=(d=null==(h=null==(s=M.label)?void 0:s.style)?void 0:h.fontFamily)?d:t0.iR}),y=(null==(c=null==(u=M.label)?void 0:u.style)?void 0:c.maxLineWidth)||1/0,w=(null!=(f=null==(p=null==(g=M.label)?void 0:g.style)?void 0:p.angle)?f:0)+90*("vertical"===(null==(v=null==(C=M.label)?void 0:C.style)?void 0:v.direction));R=Math.max(R,ld(Math.min(m,y),b,w).width)});else{let l;if((null==(i=e.sync)?void 0:i.tickAlign)&&(0,j.Z)(null==(n=e.tick)?void 0:n.tickMode))l=e.tick.tickMode();else if((0,m.Z)(e.__ticksForVTable))l=e.__ticksForVTable;else{let e=M.range,t=Math.abs(e.min)>1?Math.round(e.min):e.min,i=Math.abs(e.max)>1?Math.round(e.max):e.max;l=[lh(t),lh(i)]}l.forEach(e=>{var l,i,n,o,r,a,s,h,d,u,c,g,p,f,C,v;M.label.formatMethod&&(e=M.label.formatMethod(e));let{width:m,height:b}=t.measureText(e,{fontSize:null!=(n=null==(i=null==(l=M.label)?void 0:l.style)?void 0:i.fontSize)?n:t0.$M,fontWeight:null!=(a=null==(r=null==(o=M.label)?void 0:o.style)?void 0:r.fontWeight)?a:"normal",fontFamily:null!=(d=null==(h=null==(s=M.label)?void 0:s.style)?void 0:h.fontFamily)?d:t0.iR}),y=(null==(c=null==(u=M.label)?void 0:u.style)?void 0:c.maxLineWidth)||1/0,w=(null!=(f=null==(p=null==(g=M.label)?void 0:g.style)?void 0:p.angle)?f:0)+90*("vertical"===(null==(v=null==(C=M.label)?void 0:C.style)?void 0:v.direction));R=Math.max(R,ld(Math.min(m,y),b,w).width)})}R+=null!=(o=M.label.space)?o:4}let x=0;if(M.title.visible&&(0,tz.Z)(M.title.text)){let{width:l,height:i}=t.measureText(M.title.text,{fontSize:null!=(s=null==(a=null==(r=M.title)?void 0:r.style)?void 0:a.fontSize)?s:t0.$M,fontWeight:null!=(u=null==(d=null==(h=M.title)?void 0:h.style)?void 0:d.fontWeight)?u:"normal",fontFamily:null!=(p=null==(g=null==(c=M.title)?void 0:c.style)?void 0:g.fontFamily)?p:t0.iR}),n=ld(Math.min(l,(null==(C=null==(f=M.label)?void 0:f.style)?void 0:C.maxLineWidth)||1/0),i,null==(b=null==(v=M.title)?void 0:v.style)?void 0:b.angle);x=(("left"===e.orient||"right"===e.orient)&&M.title.autoRotate?n.height:n.width)+(null!=(y=M.title.space)?y:4)}let E=0,P=ls(e.orient,t.theme);return"left"===e.orient?E=null!=(w=null==P?void 0:P.cellPaddingLeft)?w:0:"right"===e.orient&&(E=null!=(_=null==P?void 0:P.cellPaddingRight)?_:0),Math.ceil(S+R+x+E+1)}),to.F.registerFunction("computeAxisComponentHeight",function(e,t){var l,i,n,o,r,a,s,h,d,u,c,g,p,f,C,v,b,y,w,_;let M=(0,t$.Z)({},t0.b8,e),S=0;!1!==M.tick.visible&&(S=null!=(l=M.tick.width)?l:4);let R=0;if(M.label.visible){if("band"===M.type)M.domain.forEach(e=>{var l,i,n,o,r,a,s,h,d,u,c,g,p,f,C,v;M.label.formatMethod&&(e=M.label.formatMethod(e));let{width:m,height:b}=t.measureText(e,{fontSize:null!=(n=null==(i=null==(l=M.label)?void 0:l.style)?void 0:i.fontSize)?n:t0.$M,fontWeight:null!=(a=null==(r=null==(o=M.label)?void 0:o.style)?void 0:r.fontWeight)?a:"normal",fontFamily:null!=(d=null==(h=null==(s=M.label)?void 0:s.style)?void 0:h.fontFamily)?d:t0.iR}),y=(null==(c=null==(u=M.label)?void 0:u.style)?void 0:c.maxLineWidth)||1/0,w=(null!=(f=null==(p=null==(g=M.label)?void 0:g.style)?void 0:p.angle)?f:0)+90*("vertical"===(null==(v=null==(C=M.label)?void 0:C.style)?void 0:v.direction));R=Math.max(R,ld(Math.min(m,y),b,w).height)});else{let l;if((null==(i=e.sync)?void 0:i.tickAlign)&&(0,j.Z)(null==(n=e.tick)?void 0:n.tickMode))l=e.tick.tickMode();else if((0,m.Z)(e.__ticksForVTable))l=e.__ticksForVTable;else{let e=M.range,t=Math.abs(e.min)>1?Math.round(e.min):e.min,i=Math.abs(e.max)>1?Math.round(e.max):e.max;l=[lh(t),lh(i)]}l.forEach(e=>{var l,i,n,o,r,a,s,h,d,u,c,g,p,f,C,v;M.label.formatMethod&&(e=M.label.formatMethod(e));let{width:m,height:b}=t.measureText(e,{fontSize:null!=(n=null==(i=null==(l=M.label)?void 0:l.style)?void 0:i.fontSize)?n:t0.$M,fontWeight:null!=(a=null==(r=null==(o=M.label)?void 0:o.style)?void 0:r.fontWeight)?a:"normal",fontFamily:null!=(d=null==(h=null==(s=M.label)?void 0:s.style)?void 0:h.fontFamily)?d:t0.iR}),y=(null==(c=null==(u=M.label)?void 0:u.style)?void 0:c.maxLineWidth)||1/0,w=(null!=(f=null==(p=null==(g=M.label)?void 0:g.style)?void 0:p.angle)?f:0)+90*("vertical"===(null==(v=null==(C=M.label)?void 0:C.style)?void 0:v.direction));R=Math.max(R,ld(Math.min(m,y),b,w).height)})}R+=null!=(o=M.label.space)?o:4}let x=0;if(M.title.visible&&M.title.text){let{width:l,height:i}=t.measureText(M.title.text,{fontSize:null!=(s=null==(a=null==(r=M.title)?void 0:r.style)?void 0:a.fontSize)?s:t0.$M,fontWeight:null!=(u=null==(d=null==(h=M.title)?void 0:h.style)?void 0:d.fontWeight)?u:"normal",fontFamily:null!=(p=null==(g=null==(c=M.title)?void 0:c.style)?void 0:g.fontFamily)?p:t0.iR}),n=ld(Math.min(l,(null==(C=null==(f=M.label)?void 0:f.style)?void 0:C.maxLineWidth)||1/0),i,null==(b=null==(v=M.title)?void 0:v.style)?void 0:b.angle);x=(("bottom"===e.orient||"top"===e.orient)&&M.title.autoRotate?n.width:n.height)+(null!=(y=M.title.space)?y:4)}let E=0,P=ls(e.orient,t.theme);return"top"===e.orient?E=null!=(w=null==P?void 0:P.cellPaddingTop)?w:0:"bottom"===e.orient&&(E=null!=(_=null==P?void 0:P.cellPaddingBottom)?_:0),S+R+x+E+1}),to.F.registerFunction("getAxisConfigInPivotChart",tc.hZ),to.F.registerComponent("emptyTip",class e{constructor(e,t){this._emptyTipOption={spaceBetweenTextAndIcon:20,text:"no data",textStyle:{fontSize:14,color:"#000"},icon:{image:'<svg t="1716726614852" class="icon" viewBox="0 0 1194 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2621" width="200" height="200"><path d="M1038.694079 367.237067c13.265507 23.342857-16.633865-40.004445-63.05621-40.004446H219.018794c-26.558738 0-46.46393 13.334815-63.05621 40.004446S0.006238 607.277601 0.006238 650.608819V940.647979a82.351494 82.351494 0 0 0 82.961402 83.349526H1111.702885a82.337632 82.337632 0 0 0 82.975264-83.349526V650.608819c0-43.331218-155.970208-283.371753-155.970208-283.371752zM730.066575 667.284269a136.328386 136.328386 0 0 1-132.738243 133.33429 133.417459 133.417459 0 0 1-132.738243-133.33429v-6.681269a40.6698 40.6698 0 0 0-36.497473-26.66963H73.015044l119.458874-220.02445s23.231965-40.004445 53.103614-40.004446h713.481918c26.544876 0 29.871649 10.008042 46.436207 40.004446L1128.33675 633.947231H769.904682c-26.184476 0-39.838107 7.623855-39.838107 33.337038zM338.505391 210.559919l-89.601086-86.69016a22.178487 22.178487 0 0 1 0-33.26773 21.984425 21.984425 0 0 1 33.170699 0l89.601087 86.676299a22.317102 22.317102 0 0 1 0 33.26773 24.950798 24.950798 0 0 1-33.1707 0z m252.197118-40.059891a25.532983 25.532983 0 0 1-6.639685-16.633865l-3.326773-126.694606A28.263709 28.263709 0 0 1 603.995739 0.515788c13.251646-3.326773 23.204242 10.021904 26.544877 23.342858V153.866163a28.249847 28.249847 0 0 1-23.259688 26.66963c-6.611961-3.312911-13.279369-3.312911-16.578419-10.035765z m235.646421 33.337038a22.372548 22.372548 0 0 1 0-33.337038l86.288175-90.030795a22.039871 22.039871 0 0 1 33.170699 0 22.289379 22.289379 0 0 1 0 33.364761l-82.961401 90.003072a25.962691 25.962691 0 0 1-36.483611 0z" fill="#8a8a8a" p-id="2622"></path></svg>',width:100,height:100}},this.isReleased=!1,this.table=t,this._emptyTipOption=Object.assign(this._emptyTipOption,!0===e?{}:e),(0,v.Z)(this._emptyTipOption.displayMode)||(this.table.isListTable()?this._emptyTipOption.displayMode="basedOnTable":this._emptyTipOption.displayMode="basedOnContainer"),this._emptyTipComponent=this._createOrUpdateEmptyTipComponent(this._getEmptyTipAttrs())}_createOrUpdateEmptyTipComponent(e){if(this._emptyTipComponent)(0,lc.X)(e,this._cacheAttrs)||this._emptyTipComponent.setAttributes(e);else{let t=new lu.S(e);t.name="emptyTip",this.table.scenegraph.stage.defaultLayer.appendChild(t),this._emptyTipComponent=t,this.bindEvents()}return this._emptyTipComponent}bindEvents(){this._emptyTipComponent.on("click",e=>{let t=new e4.FB;this._emptyTipComponent.forEachChildren(e=>{t.union(e.globalAABBBounds)}),t.contains(e.x,e.y)&&this.table.fireListeners("empty_tip_click",e)}),this._emptyTipComponent.on("dblclick",e=>{let t=new e4.FB;this._emptyTipComponent.forEachChildren(e=>{t.union(e.globalAABBBounds)}),t.contains(e.x,e.y)&&this.table.fireListeners("empty_tip_dblclick",e)})}resize(){var e;if(!this._emptyTipComponent)return;let{leftHeaderWidth:t,topHeaderHeight:l,width:i,height:n}=this.getWidthAndHeight();this._emptyTipComponent.setAttributes({spaceBetweenTextAndIcon:this._emptyTipOption.spaceBetweenTextAndIcon,x:this.table.tableX+t,y:this.table.tableY+l,width:i,height:n,text:Object.assign(Object.assign({text:this._emptyTipOption.text},this._emptyTipOption.textStyle),{fill:null==(e=this._emptyTipOption.textStyle)?void 0:e.color}),icon:Object.assign({},this._emptyTipOption.icon)})}release(){this._emptyTipComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent),this._emptyTipComponent=null,this.isReleased=!0}resetVisible(){(this.table.recordsCount&&0!==this.table.recordsCount||this.table.internalProps.layoutMap.rowCount!==this.table.internalProps.layoutMap.columnHeaderLevelCount)&&this.table.internalProps.layoutMap.colCount!==this.table.internalProps.layoutMap.rowHeaderLevelCount?this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)&&this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent):this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)||this.table.scenegraph.stage.defaultLayer.appendChild(this._emptyTipComponent)}getWidthAndHeight(){let e=this.table.transpose||!1===this.table.options.indicatorsAsCol?this.table.getFrozenColsWidth():0,t=!this.table.transpose||this.table.options.indicatorsAsCol?this.table.getFrozenRowsHeight():0;return{leftHeaderWidth:e,topHeaderHeight:t,width:("basedOnContainer"!==this._emptyTipOption.displayMode&&this.table.columnHeaderLevelCount>0&&this.table.colCount>this.table.rowHeaderLevelCount?this.table.getDrawRange().width:this.table.tableNoFrameWidth)-e-this.table.getTheme().scrollStyle.width,height:("basedOnContainer"!==this._emptyTipOption.displayMode&&this.table.rowHeaderLevelCount>0&&this.table.rowCount>this.table.columnHeaderLevelCount?this.table.getDrawRange().height:this.table.tableNoFrameHeight)-t-this.table.getTheme().scrollStyle.width}}_getEmptyTipAttrs(){var e;let{leftHeaderWidth:t,topHeaderHeight:l,width:i,height:n}=this.getWidthAndHeight();return{spaceBetweenTextAndIcon:this._emptyTipOption.spaceBetweenTextAndIcon,x:this.table.tableX+t,y:this.table.tableY+l,width:i,height:n,text:Object.assign(Object.assign({text:this._emptyTipOption.text},this._emptyTipOption.textStyle),{fill:null==(e=this._emptyTipOption.textStyle)?void 0:e.color}),icon:Object.assign({},this._emptyTipOption.icon)}}}),to.F.registerFunction("createLegend",function(e,t){return"color"===e.type||"size"===e.type?new lP(e,t):new lw(e,t)}),to.F.registerComponent("menuHandler",class e{constructor(e){this._table=e,this._menuInstances={},this._bindTableEvent(e)}release(){let e=this._menuInstances;for(let t in e)e[t].release();delete this._menuInstances,this._attachInfo=null}_bindToCell(e,t,l,i){var n;let o=this._attachInfo,r=this._getMenuInstanceInfo(e,t,l,i);if(!o||r&&o.instance===r.instance||(null==(n=o.instance)||n.unbindMenuElement(),this._attachInfo=null),!r)return;let{instance:a,info:s}=r;if(a&&a.bindMenuElement(e,t,s)){let l=-1===e&&-1===t?{start:{col:-1,row:-1},end:{col:-1,row:-1}}:this._table.getCellRange(e,t);this._attachInfo={range:l,instance:a}}}_unbindFromCell(){let e=this._attachInfo;if(!e)return;let{instance:t}=e;null==t||t.unbindMenuElement(),this._attachInfo=null}_isBindToCell(e,t){let l=this._attachInfo;return!!l&&(0,L._Z)(l.range,e,t)}pointInMenuElement(e,t){if(!this._attachInfo)return!1;let{instance:l}=this._attachInfo;return l.pointInMenuElement(e,t)}_bindTableEvent(e){e.on(F.B.DROPDOWN_ICON_CLICK,e=>{this._attachInfo&&this._isBindToCell(e.col,e.row)?this._unbindFromCell():this._bindToCell(e.col,e.row,"dropdown-menu")}),e.on(F.B.DROPDOWN_MENU_CLEAR,e=>{this._unbindFromCell()}),e.on(F.B.CONTEXTMENU_CELL,t=>{var l,i,n,o;if("html"===(null==(l=e.internalProps.menu)?void 0:l.renderMode)){let l=e._getMouseAbstractPoint(t.event),r=null;l.inTable&&"function"==typeof(null==(i=e.internalProps.menu)?void 0:i.contextMenuItems)?r=e.internalProps.menu.contextMenuItems(e.getHeaderField(t.col,t.row),t.row,t.col,e):l.inTable&&Array.isArray(null==(n=e.internalProps.menu)?void 0:n.contextMenuItems)&&(r=null==(o=e.internalProps.menu)?void 0:o.contextMenuItems),this._bindToCell(t.col,t.row,"context-menu",{content:r,position:{x:l.x,y:l.y}})}}),e.on(F.B.CONTEXTMENU_CANVAS,t=>{var l,i,n,o;if("html"===(null==(l=e.internalProps.menu)?void 0:l.renderMode)){let l=e._getMouseAbstractPoint(t.event),r=null;l.inTable&&"function"==typeof(null==(i=e.internalProps.menu)?void 0:i.contextMenuItems)?r=e.internalProps.menu.contextMenuItems(e.getHeaderField(t.col,t.row),t.row,t.col,e):l.inTable&&Array.isArray(null==(n=e.internalProps.menu)?void 0:n.contextMenuItems)&&(r=null==(o=e.internalProps.menu)?void 0:o.contextMenuItems),this._bindToCell(-1,-1,"context-menu",{content:r,position:{x:l.x,y:l.y}})}})}_getMenuInstanceInfo(e,t,l,i){let n=this._table,o=this._menuInstances,r=function(e,t,l,i,n){var o,r,a;if(-1===t&&-1===l&&"context-menu"===i)return(null==n?void 0:n.content)?{type:i,position:n.position,referencePosition:null!=(o=n.referencePosition)?o:{rect:{left:0,right:0,top:0,bottom:0,width:0,height:0}},content:n.content}:null;let{lineHeight:s,textBaseline:h,textStick:d}=e._getCellStyle(t,l),u=e.getCellRangeRelativeRect(e.getCellRange(t,l));d&&(u=e.getVisibleCellRangeRelativeRect({col:t,row:l}));let{left:c,right:g,bottom:p,top:f,width:C,height:v}=u;if(e.isHeader(t,l)&&({left:c,right:g,bottom:p,top:f,width:C,height:v}=e.internalProps.headerHelper.getDropDownIconRect(u,s,h||"middle")),null==n?void 0:n.content)return{type:i,position:n.position,referencePosition:null!=(r=n.referencePosition)?r:{rect:{left:c,right:g,top:f,bottom:p,width:C,height:v}},content:n.content};if("dropdown-menu"===i){let n=e.globalDropDownMenu,o=e._getHeaderLayoutMap(t,l);n=null!=(a=o.dropDownMenu)?a:n;let r=o.pivotInfo;return"function"==typeof n&&(n=n({row:l,col:t,table:e})),{type:i,referencePosition:{rect:{left:c,right:g,top:f,bottom:p,width:C,height:v}},content:n,pivotInfo:r}}return null}(n,e,t,l,i);return r?{instance:o&&o[l]||o&&(o[l]=lk[l](n)),type:l,info:r}:null}containElement(e){var t;for(let l in this._menuInstances)if(null==(t=this._menuInstances[l].getRootElement())?void 0:t.contains(e))return!0;return!1}}),to.F.registerComponent("title",class e{constructor(e,t){this.isReleased=!1,this.table=t,this._titleOption=(0,t$.Z)({orient:"top"},e),!1!==e.visible&&(this._titleComponent=this._createOrUpdateTitleComponent(this._getTitleAttrs()))}_createOrUpdateTitleComponent(e){if(this._titleComponent)(0,lc.X)(e,this._cacheAttrs)||this._titleComponent.setAttributes(e);else{let t=new lD.D(e);t.name="title",this.table.scenegraph.stage.defaultLayer.appendChild(t),this._titleComponent=t}return this._adjustTableSize(this._titleComponent.attribute),this._titleComponent}resize(){var e,t,l,i,n;if(!this._titleComponent)return;let o=(0,ly.u)(null!=(e=this._titleOption.padding)?e:10),r=null!=(t=this._titleOption.width)?t:("adaptive"===this.table.widthMode?this.table.tableNoFrameWidth:Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width))-o[1]-o[3],a=null!=(l=this._titleOption.height)?l:("adaptive"===this.table.heightMode?this.table.tableNoFrameHeight:Math.min(this.table.tableNoFrameHeight,this.table.getDrawRange().height))-o[0]-o[2];this._titleComponent.setAttributes({x:(null!=(i=this._titleOption.x)?i:"right"===this._titleOption.orient)?this.table.tableX+Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width):this.table.tableX,y:(null!=(n=this._titleOption.y)?n:"bottom"===this._titleOption.orient)?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY,width:"top"===this._titleOption.orient||"bottom"===this._titleOption.orient?r:this._titleOption.width,height:"left"===this._titleOption.orient||"right"===this._titleOption.orient?a:this._titleOption.height,textStyle:Object.assign({width:r},this._titleOption.textStyle),subtextStyle:Object.assign({width:r},this._titleOption.subtextStyle)}),this._adjustTableSize(this._titleComponent.attribute)}_adjustTableSize(e){var t,l,i,n;let o=isFinite(null==(t=this._titleComponent)?void 0:t.AABBBounds.width())?this._titleComponent.AABBBounds.width():0,r=isFinite(null==(l=this._titleComponent)?void 0:l.AABBBounds.height())?this._titleComponent.AABBBounds.height():0;"left"===this._titleOption.orient?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(o),this.table.tableX+=Math.ceil(o)):"top"===this._titleOption.orient?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(r),this.table.tableY+=Math.ceil(r)):"right"===this._titleOption.orient?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(o):"bottom"===this._titleOption.orient&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(r)),this._cacheAttrs=e,"right"!==this._titleOption.orient&&"bottom"!==this._titleOption.orient||this._titleComponent.setAttributes({x:(null!=(i=this._titleOption.x)?i:"right"===this._titleOption.orient)?this.table.tableX+this.table.tableNoFrameWidth:this.table.tableX,y:(null!=(n=this._titleOption.y)?n:"bottom"===this._titleOption.orient)?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY})}release(){this._titleComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this._titleComponent),this._titleComponent=null,this.isReleased=!0}_getTitleAttrs(){var e,t,l,i,n,o,r,a,s,h,d;let u=this._titleOption.text||this._titleOption.subtext?10:0,c=(0,ly.u)(null!=(e=this._titleOption.padding)?e:u),g=null!=(t=this._titleOption.width)?t:Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width)-c[1]-c[3],p=null!=(l=this._titleOption.height)?l:Math.min(this.table.tableNoFrameHeight,this.table.getDrawRange().height)-c[0]-c[2];return{text:null!=(i=this._titleOption.text)?i:"",subtext:null!=(n=this._titleOption.subtext)?n:"",x:(null!=(o=this._titleOption.x)?o:"right"===this._titleOption.orient)?this.table.tableX+Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width):this.table.tableX,y:(null!=(r=this._titleOption.y)?r:"bottom"===this._titleOption.orient)?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY,width:"top"===this._titleOption.orient||"bottom"===this._titleOption.orient?g:this._titleOption.width,height:"left"===this._titleOption.orient||"right"===this._titleOption.orient?p:this._titleOption.height,minWidth:this._titleOption.minWidth,maxWidth:this._titleOption.maxWidth,minHeight:this._titleOption.minHeight,maxHeight:this._titleOption.maxHeight,padding:this._titleOption.padding,align:null!=(a=this._titleOption.align)?a:"left",verticalAlign:null!=(s=this._titleOption.verticalAlign)?s:"top",textStyle:Object.assign({width:g},this._titleOption.textStyle),subtextStyle:Object.assign({width:g},this._titleOption.subtextStyle),dx:null!=(h=this._titleOption.dx)?h:0,dy:null!=(d=this._titleOption.dy)?d:0}}getComponentGraphic(){return this._titleComponent}}),to.F.registerComponent("tooltipHandler",class e{constructor(e,t){this._table=e,this._tooltipInstances={},this._bindTableEvent(e),this.confine=t}release(){var e,t;let l=this._tooltipInstances;for(let i in l)null==(t=null==(e=l[i])?void 0:e.release)||t.call(e);delete this._tooltipInstances,this._attachInfo=null}_bindToCell(e,t,l){var i;let n=this._attachInfo,o=this._getTooltipInstanceInfo(e,t);if(!n||o&&n.instance===o||(null==(i=n.instance)||i.unbindTooltipElement(),this._attachInfo=null),o&&o&&o.bindTooltipElement(e,t,l,this.confine)){let i=this._table.getCellRange(e,t);this._attachInfo={range:i,instance:o,tooltipOptions:l}}}_move(e,t,l){let i=this._attachInfo;if(!i||!(0,L._Z)(i.range,e,t))return;let{instance:n}=i;null==n||n.moveTooltipElement(e,t,l,this.confine)}moveToPosition(e,t,l,i){let n=this._attachInfo;if(!n||!(0,L._Z)(n.range,e,t))return;let{instance:o}=n;this._attachInfo.tooltipOptions.position=l,this._attachInfo.tooltipOptions.referencePosition=i,null==o||o.locateTooltipElement(e,t,l,i,this.confine)}_unbindFromCell(){let e=this._attachInfo;if(!e)return;let{instance:t}=e;null==t||t.unbindTooltipElement(),this._attachInfo=null}_isBindCell(e,t){let l=this._attachInfo;return!!l&&(0,L._Z)(l.range,e,t)}_bindTableEvent(e){e.on(F.B.MOUSEENTER_CELL,t=>{if((0,W.tq)())return;let{x1:l,x2:i,y1:n,y2:o}=e.stateManager.menu.bounds;if(e.stateManager.menu.isShow&&"number"==typeof t.x&&"number"==typeof t.y&&t.x>l&&t.x<i&&t.y>n&&t.y<o)return;let{col:r,row:a}=t;this.showTooltip(r,a)}),e.on(F.B.MOUSEMOVE_CELL,t=>{var l,i;if(!(0,W.tq)()){if(null==(i=null==(l=this._attachInfo)?void 0:l.tooltipOptions)?void 0:i.referencePosition){let l=this._attachInfo.tooltipOptions.referencePosition,{event:i}=t,{left:n,right:o,top:r,bottom:a}=l.rect,s=e._getMouseAbstractPoint(i);s.inTable&&s.x>=n-5&&s.x<=o+5&&s.y>=r-5&&s.y<=a+5||this._unbindFromCell()}this._attachInfo&&e.stateManager.menu.isShow&&this._bindToCell(t.col,t.row)}}),e.on(F.B.MOUSELEAVE_CELL,e=>{this._unbindFromCell()}),e.on(F.B.SELECTED_CELL,e=>{this._isBindCell(e.col,e.row)&&this._unbindFromCell()}),e.on(F.B.MOUSELEAVE_TABLE,e=>{this._unbindFromCell()}),e.on(F.B.SCROLL,e=>{this._unbindFromCell()})}showTooltip(e,t){var l,i,n;let o,r=this._table,a=r.getHeaderDescription(e,t);if(a){let i=r.getCellRangeRelativeRect({col:e,row:t});o={content:a,referencePosition:{placement:r.internalProps.tooltip.position,rect:i},disappearDelay:null!=(l=r.internalProps.tooltip.overflowTextTooltipDisappearDelay)?l:0,style:r.theme.tooltipStyle}}else if((0,j.Z)(null==(i=r.internalProps.tooltip)?void 0:i.isShowOverflowTextTooltip)?r.internalProps.tooltip.isShowOverflowTextTooltip(e,t,r):r.internalProps.tooltip.isShowOverflowTextTooltip){let l=r.getCellOverflowText(e,t),i=r.getCellRangeRelativeRect({col:e,row:t});l&&(o={content:a?`${a}
  ${l}`:l,referencePosition:{placement:r.internalProps.tooltip.position,rect:i},disappearDelay:null!=(n=r.internalProps.tooltip.overflowTextTooltipDisappearDelay)?n:0,style:r.theme.tooltipStyle})}o?this._bindToCell(e,t,o):this._unbindFromCell()}_getTooltipInstanceInfo(e,t){let l=this._table,i=this._tooltipInstances;return i&&i["bubble-tooltip"]||i&&(i["bubble-tooltip"]=lj["bubble-tooltip"](l))}isBinded(e){var t;return JSON.stringify(e)===JSON.stringify(null==(t=this._attachInfo)?void 0:t.tooltipOptions)}}),(0,l$.t)(),(0,tp.zf)(),(0,lK.Hp)(),(0,lX.d)(),(0,lY.LQ)(),(0,lY.yR)(),(0,lY.pk)(),(0,lY.m4)(),(0,lY.Jy)(),(0,lY.VT)(),(0,lY.ah)(),(0,lY.dB)(),(0,lY.ge)(),(0,lY.au)();class lJ extends tX{}},75008:function(e,t,l){l.d(t,{U:()=>r});var i=l(135759);let n={},o={};function r(){return(0,i.l7)(o,n)}},399346:function(e,t,l){l.d(t,{$M:()=>d,UP:()=>g,Zu:()=>u,b8:()=>c,iR:()=>h,sG:()=>p});var i=l(20408),n=l(454326),o=l(615215),r=l(309762),a=l(844561);let s={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}},h="PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol",d=14,u={FONT_FAMILY:h,LABEL_FONT_SIZE:14,MAP_LABEL_FONT_SIZE:10,TITLE_FONT_SIZE:18,AXIS_TICK_SIZE:4},c={domainLine:{visible:!0,style:{lineWidth:0,stroke:"#D9DDE4",strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:"#EBEDF2",strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#EBEDF2",strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,tickSize:u.AXIS_TICK_SIZE,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},subTick:{visible:!1,tickSize:u.AXIS_TICK_SIZE/2,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},label:{visible:!0,space:1,style:{fontSize:u.LABEL_FONT_SIZE,fill:"#89909D",fontWeight:"normal",fillOpacity:1},autoLimit:!0},title:{space:10,style:{fontSize:u.LABEL_FONT_SIZE,fill:"#333333",fontWeight:"normal",fillOpacity:1}}};function g(e){var t,l;return(null==(l=null==(t=null==e?void 0:e.colorScheme)?void 0:t.default)?void 0:l.palette)?(0,i.Z)({},c,{tick:{style:{stroke:e.colorScheme.default.palette.axisDomainColor||"#D9DDE4"}},subTick:{style:{stroke:e.colorScheme.default.palette.axisDomainColor||"#D9DDE4"}},label:{style:{fill:e.colorScheme.default.palette.axisLabelFontColor||"#89909D"}},title:{style:{fill:e.colorScheme.default.palette.secondaryFontColor||"#333333"}}}):c}function p(e){var t,l,h,d,u,c,g,p,f,C,v,m,b;let y=(0,i.Z)({},e);e.labelHoverOnAxis&&!1===y.domainLine.visible&&(y.domainLine.style.lineWidth=0,y.domainLine.visible=!0);let w,_=null!=(l=null==(t=y.title)?void 0:t.angle)?l:0;"left"!==y.orient&&"right"!==y.orient||(null==(h=y.title)?void 0:h.autoRotate)&&(0,n.Z)(y.title.angle)&&(_="left"===y.orient?-90:90,w=s[y.orient]);let M=(0,o.Z)(y.label,["style","formatMethod","state"]);return{orient:y.orient,select:y.select,hover:y.hover,line:(0,a.lc)(y.domainLine),label:Object.assign({style:(0,a.h_)(y.label.style),formatMethod:y.label.formatMethod?(e,t,l)=>y.label.formatMethod(t.rawValue,t):null,state:(0,a.Zv)(y.label.state)},M),tick:{visible:y.tick.visible,length:y.tick.tickSize,inside:y.tick.inside,alignWithLabel:y.tick.alignWithLabel,style:(0,a.h_)(y.tick.style),state:(0,a.Zv)(y.tick.state),dataFilter:y.tick.dataFilter},subTick:{visible:y.subTick.visible,length:y.subTick.tickSize,inside:y.subTick.inside,count:y.subTick.tickCount,style:(0,a.h_)(y.subTick.style),state:(0,a.Zv)(y.subTick.state)},grid:{type:"line",visible:y.grid.visible,alternateColor:y.grid.alternateColor,alignWithLabel:y.grid.alignWithLabel,style:(0,a.h_)(y.grid.style)},subGrid:{type:"line",visible:y.subGrid.visible,alternateColor:y.subGrid.alternateColor,style:(0,a.h_)(y.subGrid.style)},title:{visible:y.title.visible,position:y.title.position,space:y.title.space,autoRotate:!1,angle:_?(0,r.M4)(_):null,textStyle:(0,i.Z)({},w,(0,a.h_)(y.title.style)),padding:y.title.padding,shape:{visible:null==(d=y.title.shape)?void 0:d.visible,space:null==(u=y.title.shape)?void 0:u.space,style:(0,a.h_)(null==(c=y.title.shape)?void 0:c.style)},background:{visible:null==(g=y.title.background)?void 0:g.visible,style:(0,a.h_)(null==(p=y.title.background)?void 0:p.style)},state:{text:(0,a.Zv)(y.title.state),shape:(0,a.Zv)(null==(f=y.title.shape)?void 0:f.state),background:(0,a.Zv)(null==(C=y.title.background)?void 0:C.state)}},panel:{visible:null==(v=y.background)?void 0:v.visible,style:(0,a.h_)(null==(m=y.background)?void 0:m.style),state:(0,a.Zv)(null==(b=y.background)?void 0:b.state)},labelHoverOnAxis:y.labelHoverOnAxis}}},26249:function(e,t,l){l.d(t,{D:()=>n,Z:()=>o});var i=l(829425);function n(e){return{rootContainer:new i.ZA({}),renderDefault:!0}}class o{constructor(e){this.table=e,this.customLayoutFuncCache=new Map,this.reactRemoveGraphicCache=new Map,this.reactRemoveAllGraphicCache=new Map,this.headerCustomLayoutFuncCache=new Map,this.headerReactRemoveGraphicCache=new Map,this.headerReactRemoveAllGraphicCache=new Map}hasReactCreateGraphic(e,t){return t?this.headerCustomLayoutFuncCache.has(e):this.customLayoutFuncCache.has(e)}setReactCreateGraphic(e,t,l){l?this.headerCustomLayoutFuncCache.set(e,t):this.customLayoutFuncCache.set(e,t)}setReactRemoveGraphic(e,t,l){l?this.headerReactRemoveGraphicCache.set(e,t):this.reactRemoveGraphicCache.set(e,t)}setReactRemoveAllGraphic(e,t,l){l?this.headerReactRemoveAllGraphicCache.set(e,t):this.reactRemoveAllGraphicCache.set(e,t)}updateCustomCell(e,t){let l=this.table;if("autoWidth"===l.widthMode&&l.scenegraph.recalculateColWidths(),(l.isAutoRowHeight()||"auto"===l.internalProps.defaultRowHeight&&!t||"auto"===l.internalProps.defaultHeaderRowHeight&&t)&&l.scenegraph.recalculateRowHeights(),l.isPivotTable()){let i=function(e,t,l){let i=+!!t.internalProps.rowSeriesNumber,n=[],o=t.internalProps.layoutMap;if(l){let{headerObjects:t}=o,l=[];for(let i=0;i<t.length;i++){let n=t[i];n&&n.define.componentId===e&&l.push(n.id)}for(let e=0;e<l.length;e++){let t=l[e],i=o.getHeaderCellAdressById(t),r=o.getCellRange(i.col,i.row);n.push(r)}}else{let t,{columnObjects:l,indicatorsAsCol:r}=o;for(let i=0;i<l.length;i++)if(l[i].define.componentId===e){t=i;break}if(r)for(let e=o.rowHeaderLevelCount+t;e<o.colCount;e+=l.length){let t={start:{col:e+i,row:o.columnHeaderLevelCount},end:{col:e+i,row:o.rowCount-1}};n.push(t)}else for(let e=o.columnHeaderLevelCount+t;e<o.rowCount;e+=l.length){let t={start:{col:o.rowHeaderLevelCount+i,row:e},end:{col:o.colCount-1,row:e}};n.push(t)}}return n}(e,l,t);for(let e=0;e<i.length;e++){let t=i[e];for(let e=t.start.col;e<=t.end.col;e++)for(let i=t.start.row;i<=t.end.row;i++)l.scenegraph.updateCellContent(e,i)}}else{let i=function(e,t,l){let i=+!!t.internalProps.rowSeriesNumber;if(l){let l,i=t.internalProps.layoutMap,{headerObjects:n}=t.internalProps.layoutMap;for(let t=0;t<n.length;t++){let i=n[t];if(i.define.componentId===e){l=i.id;break}}let o=i.getHeaderCellAdressById(l);return i.getCellRange(o.col,o.row)}let{columnObjects:n}=t.internalProps.layoutMap;for(let l=0;l<n.length;l++)if(n[l].define.componentId===e)return{start:{col:i+l,row:t.columnHeaderLevelCount},end:{col:i+l,row:t.rowCount-1}};return{start:{col:0,row:0},end:{col:t.colCount-1,row:t.rowCount-1}}}(e,l,t);for(let e=i.start.col;e<=i.end.col;e++)for(let t=i.start.row;t<=i.end.row;t++)l.scenegraph.updateCellContent(e,t)}l.scenegraph.renderSceneGraph()}getCustomLayoutFunc(e,t){var l;if(this.table.isHeader(e,t)){let{componentId:i}=this.table.getHeaderDefine(e,t);return null!=(l=this.headerCustomLayoutFuncCache.get(i))?l:n}let{componentId:i}=this.table.getBodyColumnDefine(e,t);return this.customLayoutFuncCache.get(i)||n}removeCustomCell(e,t){let l;if(this.table.isHeader(e,t)){let{componentId:i}=this.table.getHeaderDefine(e,t);l=this.headerReactRemoveGraphicCache.get(i)}else{let{componentId:i}=this.table.getBodyColumnDefine(e,t);l=this.reactRemoveGraphicCache.get(i)}l&&l(e,t)}clearCache(){this.reactRemoveAllGraphicCache.forEach(e=>{e()}),this.headerReactRemoveAllGraphicCache.forEach(e=>{e()})}updateAllCustomCell(){this.customLayoutFuncCache.forEach((e,t)=>{this.updateCustomCell(t)}),this.headerCustomLayoutFuncCache.forEach((e,t)=>{this.updateCustomCell(t,!0)})}}},844561:function(e,t,l){l.d(t,{Zv:()=>h,h_:()=>a,lc:()=>d,qi:()=>r,ro:()=>s});var i=l(944843),n=l(20408),o=l(309762);function r(e){var t,l;let o=Object.assign({},e);return(0,i.Z)(e.style)||(o.textStyle=a(e.style)),(0,i.Z)(e.textStyle)||(0,n.Z)(o.textStyle,a(e.textStyle)),(null==(t=e.shape)?void 0:t.style)&&a(o.shape.style),(null==(l=e.background)?void 0:l.style)&&a(o.background.style),o}function a(e){return(0,i.Z)(e)||e.angle&&(e.angle=(0,o.M4)(e.angle)),e}function s(e={}){return(0,i.Z)(e.style)||(e.style=a(e.style)),(0,i.Z)(e.state)||Object.keys(e.state).forEach(t=>{(0,i.Z)(e.state[t])||(e.state[t]=a(e.state[t]))}),e}function h(e){return(0,i.Z)(e)?null:(Object.keys(e).forEach(t=>{(0,i.Z)(e[t])||(e[t]=a(e[t]))}),e)}function d(e){return s(e),s(e.startSymbol),s(e.endSymbol),e}},657198:function(e,t,l){l.d(t,{B:()=>i});let i={CLICK_CELL:"click_cell",DBLCLICK_CELL:"dblclick_cell",MOUSEDOWN_CELL:"mousedown_cell",MOUSEUP_CELL:"mouseup_cell",SELECTED_CELL:"selected_cell",SELECTED_CLEAR:"selected_clear",BEFORE_KEYDOWN:"before_keydown",KEYDOWN:"keydown",MOUSEENTER_TABLE:"mouseenter_table",MOUSELEAVE_TABLE:"mouseleave_table",MOUSEDOWN_TABLE:"mousedown_table",MOUSEMOVE_TABLE:"mousemove_table",MOUSEMOVE_CELL:"mousemove_cell",MOUSEENTER_CELL:"mouseenter_cell",MOUSELEAVE_CELL:"mouseleave_cell",CONTEXTMENU_CELL:"contextmenu_cell",CONTEXTMENU_CANVAS:"contextmenu_canvas",RESIZE_COLUMN:"resize_column",RESIZE_COLUMN_END:"resize_column_end",RESIZE_ROW:"resize_row",RESIZE_ROW_END:"resize_row_end",CHANGE_HEADER_POSITION_START:"change_header_position_start",CHANGE_HEADER_POSITION:"change_header_position",CHANGING_HEADER_POSITION:"changing_header_position",CHANGE_HEADER_POSITION_FAIL:"change_header_position_fail",SORT_CLICK:"sort_click",AFTER_SORT:"after_sort",FREEZE_CLICK:"freeze_click",SCROLL:"scroll",CAN_SCROLL:"can_scroll",SCROLL_HORIZONTAL_END:"scroll_horizontal_end",SCROLL_VERTICAL_END:"scroll_vertical_end",DROPDOWN_MENU_CLICK:"dropdown_menu_click",MOUSEOVER_CHART_SYMBOL:"mouseover_chart_symbol",DRAG_SELECT_END:"drag_select_end",SELECTED_CHANGED:"selected_changed",COPY_DATA:"copy_data",DROPDOWN_ICON_CLICK:"dropdown_icon_click",DROPDOWN_MENU_CLEAR:"dropdown_menu_clear",TREE_HIERARCHY_STATE_CHANGE:"tree_hierarchy_state_change",SHOW_MENU:"show_menu",HIDE_MENU:"hide_menu",ICON_CLICK:"icon_click",LEGEND_ITEM_CLICK:"legend_item_click",LEGEND_ITEM_HOVER:"legend_item_hover",LEGEND_ITEM_UNHOVER:"legend_item_unHover",LEGEND_CHANGE:"legend_change",MOUSEENTER_AXIS:"mouseenter_axis",MOUSELEAVE_AXIS:"mouseleave_axis",CHECKBOX_STATE_CHANGE:"checkbox_state_change",RADIO_STATE_CHANGE:"radio_state_change",SWITCH_STATE_CHANGE:"switch_state_change",BEFORE_SET_SIZE:"before_set_size",BEFORE_INIT:"before_init",BEFORE_UPDATE_OPTION:"before_update_option",AFTER_RENDER:"after_render",INITIALIZED:"initialized",UPDATED:"updated",AFTER_UPDATE_CELL_CONTENT_WIDTH:"after_update_cell_content_width",AFTER_UPDATE_SELECT_BORDER_HEIGHT:"after_update_select_border_height",CHANGE_CELL_VALUE:"change_cell_value",DRAG_FILL_HANDLE_END:"drag_fill_handle_end",MOUSEDOWN_FILL_HANDLE:"mousedown_fill_handle",DBLCLICK_FILL_HANDLE:"dblclick_fill_handle",EMPTY_TIP_CLICK:"empty_tip_click",EMPTY_TIP_DBLCLICK:"empty_tip_dblclick",BUTTON_CLICK:"button_click",BEFORE_CACHE_CHART_IMAGE:"before_cache_chart_image",PASTED_DATA:"pasted_data",PLUGIN_EVENT:"plugin_event",ADD_RECORD:"add_record",DELETE_RECORD:"delete_record",UPDATE_RECORD:"update_record",ADD_COLUMN:"add_column",DELETE_COLUMN:"delete_column",FILTER_MENU_SHOW:"filter_menu_show",FILTER_MENU_HIDE:"filter_menu_hide"}},254833:function(e,t,l){l.d(t,{F:()=>i});class i{static registerComponent(e,t){i._components[e]=t}static getComponent(e){return i._components[e]}static registerFunction(e,t){i._functions[e]=t}static getFunction(e){return i._functions[e]}static registerCellType(e,t){i._cellTypes[e]=t}static getCellType(e){return i._cellTypes[e]}}i._components={},i._functions={},i._cellTypes={}},720307:function(e,t,l){l.d(t,{sQ:()=>M,MO:()=>H,mP:()=>b,bW:()=>T,_I:()=>C,qf:()=>S,VN:()=>x,rQ:()=>A,ke:()=>_,x6:()=>w,gX:()=>v,xv:()=>P,RT:()=>E,AS:()=>R});var i=l(937572),n=l(695723),o=l(704654),r=l(364776),a=l(551976),s=l(937098),h=l(513546),d=l.n(h);class u extends i.o2{static get EVENT_TYPE(){return i.o2.EVENT_TYPE}static ofArray(e,t,l,i,n,o){return new u({get:t=>e[t],length:e.length,records:e},t,l,i,n,o)}constructor(e,t,l,i,o,r){let a;(0,n.Z)(null==t?void 0:t.groupByRules)&&(a=!0),super(e,t,l,i,o,r),this._isGrouped=a,this._recordCache=[],this._fieldCache={}}getOriginalRecord(e){return(0,o.Z)(e)&&this._recordCache&&this._recordCache[e]?this._recordCache[e]:super.getOriginalRecord(e)}getRawRecord(e){var t,l,n,a;let s,h;if(this._isGrouped){if(s=this.getOriginRecordIndexForGroup(e),(0,r.Z)(s)&&(null==(t=this.beforeChangedRecordsMap)?void 0:t.has(s.toString())))return null==(l=this.beforeChangedRecordsMap)?void 0:l.get(s.toString())}else if(null==(n=this.beforeChangedRecordsMap)?void 0:n.has(e.toString()))return null==(a=this.beforeChangedRecordsMap)?void 0:a.get(e.toString());return(0,o.Z)(e)&&this._recordCache&&this._recordCache[e]?this._recordCache[e]:(h=this.dataSourceObj.records?Array.isArray(e)?(0,i.UN)(this.records,e):this.records[e]:this._get(e),(0,i.NA)(h,t=>{this.recordPromiseCallBack(e,t)}))}getOriginalField(e,t,l,i,n){let o=this._fieldCache&&this._fieldCache[e];if(o){let e=o.get(t);if(e)return e}return super.getOriginalField(e,t,l,i,n)}clearCache(){this._recordCache&&(this._recordCache=[]),this._fieldCache&&(this._fieldCache={})}fieldPromiseCallBack(e,t,l){var i;i=this._fieldCache,(i[e]||(i[e]=new Map)).set(t,l)}recordPromiseCallBack(e,t){this._recordCache&&(this._recordCache[e]=t)}get records(){return Array.isArray(this._recordCache)&&this._recordCache.length>0?this._recordCache:super.records}release(){var e;null==(e=super.release)||e.call(this),this._recordCache=null,this._fieldCache=null}_generateFieldAggragations(){var e;if(super._generateFieldAggragations(),(0,n.Z)(null==(e=this.dataConfig)?void 0:e.groupByRules)){let e=this.dataConfig.groupByRules;this.groupAggregator=new this.registedAggregators[s.E.CUSTOM]({field:"",aggregationFun:(t,l,i)=>{let n=new Map,o=[];for(let t=0;t<l.length;t++)!function e(t,l,i,n,o){let a=n[o];if(!(0,r.Z)(a))return void l.push(t);let s=d()(t,a);if(void 0!==s){if(i.has(s)){let r=i.get(s);return e(t,l[r].children,l[r].map,n,o+1)}return i.set(s,l.length),l.push({vtableMerge:!0,vtableMergeName:s,children:[],map:new Map}),e(t,l[l.length-1].children,l[l.length-1].map,n,o+1)}}(l[t],o,n,e,0);return o}}),this.fieldAggregators.push(this.groupAggregator)}}processRecords(e){var t;let l=super.processRecords(e);return(null==(t=this.groupAggregator)?void 0:t.value())||l}getGroupLength(){var e,t,l;return null!=(l=null==(t=null==(e=this.dataConfig)?void 0:e.groupByRules)?void 0:t.length)?l:0}updateGroup(){var e,t,l;this.clearCache();let i=this.source;this._source=this.processRecords(null!=(t=null==(e=this.dataSourceObj)?void 0:e.records)?t:this.dataSourceObj),i&&function e(t,l,i,o){if(!i){i=new Map;for(let e=0;e<t.length;e++){let l=t[e];l.vtableMerge&&i.set(l.vtableMergeName,e)}}if(!o){o=new Map;for(let e=0;e<l.length;e++){let t=l[e];t.vtableMerge&&o.set(t.vtableMergeName,e)}}for(let i=0;i<t.length;i++){let a=t[i],s=l[o.get(a.vtableMergeName)];(0,r.Z)(s)&&(s.hierarchyState=t[i].hierarchyState),(0,n.Z)(null==a?void 0:a.children)&&(0,n.Z)(null==s?void 0:s.children)&&0!==a.map.size&&0!==s.map.size&&e(a.children,s.children,a.map,s.map)}}(i,this.source),this.sourceLength=(null==(l=this.source)?void 0:l.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this.sourceLength},(e,t)=>t),this.userPagination||(this.pagination.perPageCount=this.sourceLength,this.pagination.totalCount=this.sourceLength),this.initTreeHierarchyState(),this.updatePagerData()}getOriginRecordIndexForGroup(e){let t=this.getOriginalRecord(e);if((0,r.Z)(t)&&!(t.children&&t.children.length>0)){for(let e=0;e<this.dataSourceObj.records.length;e++)if(this.dataSourceObj.records[e]===t)return e}}addRecordsForGroup(e,t){if(!(0,n.Z)(e)||0===e.length)return;let l=this.getOriginRecordIndexForGroup(t);(void 0===l||l>this.dataSourceObj.records)&&(l=this.dataSourceObj.records.length),this.dataSourceObj.records.splice(l,0,...e),this.adjustBeforeChangedRecordsMap(l,e.length),this.updateGroup()}deleteRecordsForGroup(e){if(!(0,n.Z)(e)||0===e.length)return;let t=(0,i.pY)(e,-1);for(let e=0;e<t.length;e++){let l=t[e];if((0,o.Z)(l)&&(l>=this.sourceLength||l<0))continue;let i=this.getOriginRecordIndexForGroup(l);this.beforeChangedRecordsMap.delete(i.toString()),this.dataSourceObj.records.splice(i,1),this.sourceLength-=1,this.adjustBeforeChangedRecordsMap(i,1,"delete")}this.updateGroup()}updateRecordsForGroup(e,t){for(let l=0;l<t.length;l++){let i=t[l];if((0,o.Z)(i)&&(i>=this.sourceLength||i<0))continue;let n=this.getOriginRecordIndexForGroup(i);this.beforeChangedRecordsMap.delete(n.toString()),this.dataSourceObj.records[n]=e[l]}this.updateGroup()}addRecordsForTree(e,t){if((0,n.Z)(e)&&0!==e.length){if(this.adjustBeforeChangedRecordsMap(t,e.length),(0,o.Z)(t))this.dataSourceObj.records.splice(t,0,...e);else{let l=[...t],i=l.pop(),n=this.getOriginalRecord(l);n.children?n.children.splice(i,0,...e):n.children=e}this.initTreeHierarchyState(),this.updatePagination()}}deleteRecordsForTree(e){if(!(0,n.Z)(e)||0===e.length)return[];let t=(0,i.pY)(e,-1),l=[];for(let e=0;e<t.length;e++){let i=t[e];if(!(0,o.Z)(i)||!(i>=this.sourceLength||i<0)){if(this.beforeChangedRecordsMap.delete(i.toString()),(0,o.Z)(i))this.dataSourceObj.records.splice(i,1);else{let e=[...i],t=e.pop();this.getOriginalRecord(e).children.splice(t,1)}this.adjustBeforeChangedRecordsMap(i,1,"delete"),l.push(i)}}return this.initTreeHierarchyState(),this.updatePagination(),l}updateRecordsForTree(e,t){for(let l=0;l<t.length;l++){let i=t[l],n=e[l];if(!(0,o.Z)(i)||!(i>=this.sourceLength||i<0))if(this.beforeChangedRecordsMap.delete(i.toString()),(0,o.Z)(i))this.dataSourceObj.records.splice(i,1,n);else{let e=[...i],t=e.pop();this.getOriginalRecord(e).children.splice(t,1,n)}}this.initTreeHierarchyState(),this.updatePagerData()}adjustBeforeChangedRecordsMap(e,t,l="add"){if("tree"===this.rowHierarchyType){let i;i=(0,o.Z)(e)?[e]:e;let n=[];this.beforeChangedRecordsMap.forEach((e,o)=>{var r,a;let s=o.split(","),h=Math.max(s.length,i.length);for(let d=0;d<h;d++){let h=null!=(r=i[d])?r:-1,u=null!=(a=Number(s[d]))?a:-1;if(h<u||h===u&&d===s.length-1&&d===i.length-1)return s[d]=(u+("add"===l?t:-t)).toString(),void n.push({originKey:o,targetKey:s.toString(),value:e})}}),n.forEach(({originKey:e,targetKey:t,value:l})=>{this.beforeChangedRecordsMap.delete(e),this.beforeChangedRecordsMap.set(t,l)})}else super.adjustBeforeChangedRecordsMap(e,t,l)}cacheBeforeChangedRecord(e,t){var l;let i=this.getOriginalRecord(e);t.internalProps.groupBy&&(e=this.getOriginRecordIndexForGroup(e)),this.beforeChangedRecordsMap.has(e.toString())||this.beforeChangedRecordsMap.set(e.toString(),null!=(l=(0,a.Z)(i,void 0,["vtable_gantt_linkedFrom","vtable_gantt_linkedTo"]))?l:{})}getGroupSeriesNumber(e){let t=this.dataSource.currentIndexedData[e],l=t.length-1,i=t.length,n=1;for(;i>l;n++){let t=this.dataSource.currentIndexedData[e-n];i=(0,o.Z)(t)?1:t.length}return n-1}}var c=l(865634),g=l(376352),p=l(177629),f=l(878921);function C(e,t="vtable"){var l,i;let n=document.createElement("div");n.setAttribute("tabindex","0"),n.classList.add(t),n.style.outline="none",n.style.margin=`${e.top}px ${e.right}px ${e.bottom}px ${e.left}px`;let o=(n.offsetWidth||(null==(l=n.parentElement)?void 0:l.offsetWidth)||1)-1,r=(n.offsetHeight||(null==(i=n.parentElement)?void 0:i.offsetHeight)||1)-1;return n.style.width=o&&o-e.left-e.right+"px"||"0px",n.style.height=r&&r-e.top-e.bottom+"px"||"0px",n}function v(e,t){var l,i;e.style.margin=`${t.top}px ${t.right}px ${t.bottom}px ${t.left}px`;let n=(e.offsetWidth||(null==(l=e.parentElement)?void 0:l.offsetWidth)||1)-1,o=(e.offsetHeight||(null==(i=e.parentElement)?void 0:i.offsetHeight)||1)-1;e.style.width=n&&n-t.left-t.right+"px"||"0px",e.style.height=o&&o-t.top-t.bottom+"px"||"0px"}function m(e,t){let{dataSourceEventIds:l}=e.internalProps;l&&l.forEach(t=>e.internalProps.handler.off(t)),t(e),e.internalProps.dataSourceEventIds=[e.internalProps.handler.on(e.internalProps.dataSource,i.o2.EVENT_TYPE.CHANGE_ORDER,()=>{e.dataSource.hierarchyExpandLevel&&e.refreshRowColCount(),e.render()})]}function b(e,t=[]){m(e,()=>{var l;e.internalProps.records=t;let i=e.internalProps.layoutMap.rowHierarchyType;(0,n.Z)(null==(l=e.internalProps.dataConfig)?void 0:l.groupByRules)&&(i="tree"),e.pluginManager.getPluginByName("Master Detail Plugin")&&(i="grid");let o=e.internalProps.dataSource=u.ofArray(t,e.internalProps.dataConfig,e.pagination,e.internalProps.columns,i,y(e));e.addReleaseObj(o)})}function y(e){var t;return e.options.hierarchyExpandLevel?e.options.hierarchyExpandLevel:e.internalProps.groupBy?1/0:(null==(t=e._hasHierarchyTreeHeader)?void 0:t.call(e))?1:void 0}function w(e,t){m(e,()=>{e.internalProps.dataSource&&e.internalProps.releaseList.forEach(t=>{t instanceof i.o2&&(t.release(),e.internalProps.releaseList.splice(e.internalProps.releaseList.indexOf(t),1))}),t?t instanceof i.o2?(e.internalProps.dataSource=t,e.internalProps.dataSource.supplementConfig(e.pagination,e.options.columns,e.internalProps.layoutMap.rowHierarchyType,y(e))):e.internalProps.dataSource=new u(t):e.internalProps.dataSource=i.o2.EMPTY,e.addReleaseObj(e.internalProps.dataSource),e.internalProps.records=null})}function _(e,t){if(!e.internalProps.frozenRowCount)return null;let{scrollTop:l}=e,i=e.internalProps.frozenRowCount;for(let n=0;n<i;n++){let i=e.getRowHeight(n),o=l+i;if(o>t)return{top:l,row:n,bottom:o,height:i};l=o}return null}function M(e,t){if(!e.internalProps.frozenColCount)return null;let{scrollLeft:l}=e,i=e.internalProps.frozenColCount;for(let n=0;n<i;n++){let i=e.getColWidth(n),o=l+i;if(o>t)return{left:l,col:n,right:o,width:i};l=o}return null}function S(e,t){return Math.round(f.aR(t,e.internalProps.calcWidthContext))}function R(e,t){return e?e.min&&e.min>t?e.min:e.max&&e.max<t?e.max:t:t}function x(e){let t=0,l=0;e.frozenColCount>0&&(t=e.getFrozenColsWidth()),e.rightFrozenColCount>0&&(l=e.getRightFrozenColsWidth());let i=0,n=0;return e.frozenRowCount>0&&(i=e.getFrozenRowsHeight()),e.bottomFrozenRowCount>0&&(n=e.getBottomFrozenRowsHeight()),new p.U(e.scrollLeft+t,e.scrollTop+i,e.tableNoFrameWidth-t-l,e.tableNoFrameHeight-i-n)}function E(e,t,l,i,n,o=!0){let a,s,h,d,u,p=(0,g.u)(n("padding",e,l,i,t)),f=n("bgColor",e,l,i,t),C=n("font",e,l,i,t);if(C){let{family:e,size:t,weight:l,style:i,variant:n}=(0,c.Z)(C);a=e.join(" "),s=t,h=l,d=i,d=n}else a=n("fontFamily",e,l,i,t),s=n("fontSize",e,l,i,t),h=n("fontWeight",e,l,i,t),d=n("fontStyle",e,l,i,t),u=n("fontVariant",e,l,i,t);let v=n("textAlign",e,l,i,t),m=n("textBaseline",e,l,i,t),b=n("color",e,l,i,t),y=n("strokeColor",e,l,i,t),w=n("lineHeight",e,l,i,t),_=n("underline",e,l,i,t),M=n("underlineDash",e,l,i,t),S=n("underlineOffset",e,l,i,t),R=n("lineThrough",e,l,i,t),x=Math.max(1,Math.floor(s/10)),P=n("textOverflow",e,l,i,t),A=n("borderColor",e,l,i,t),T=n("borderLineWidth",e,l,i,t),H=n("borderLineDash",e,l,i,t),L=n("marked",e,l,i,t),F=n("cursor",e,l,i,t),B=!(p&&f&&C&&v&&m&&b&&P&&A&&T&&H&&"boolean"==typeof _&&"boolean"==typeof R&&"boolean"==typeof L);if(!o)return{hasFunctionPros:B};let I={text:{fontFamily:a,fontSize:s,fontWeight:h,fontStyle:d,fontVariant:u,fill:b,stroke:null!=y&&y,textAlign:v,textBaseline:m,lineHeight:null!=w?w:s,underline:_?x:void 0,underlineDash:M,underlineOffset:S,lineThrough:R?x:void 0,ellipsis:"clip"===P?"":"ellipsis"===P?"...":(0,r.Z)(P)?P:void 0},group:{fill:f,lineDash:H,lineWidth:T,stroke:A,cursor:"auto"===F||"default"===F?void 0:F},_vtable:{padding:p,marked:L}};if(Array.isArray(T)&&(I.group.strokeArrayWidth=(0,g.u)(T)),Array.isArray(A)){let e=(0,g.u)(A);I.group.stroke=!e.every(e=>!e)&&e,I.group.strokeArrayColor=(0,g.u)(A)}return{theme:I,hasFunctionPros:B}}function P(e,t,l){let i=l.theme.frameStyle.cornerRadius;if(l.theme.cellInnerBorder){if(Array.isArray(i)){let n=[0,0,0,0];return 0===e&&0===t&&(n[0]=i[0]),e===l.colCount-1&&0===t&&(n[1]=i[1]),0===e&&t===l.rowCount-1&&(n[3]=i[3]),e===l.colCount-1&&t===l.rowCount-1&&(n[2]=i[2]),n}if(i){let n=[0,0,0,0];return 0===e&&0===t&&(n[0]=i),e===l.colCount-1&&0===t&&(n[1]=i),0===e&&t===l.rowCount-1&&(n[3]=i),e===l.colCount-1&&t===l.rowCount-1&&(n[2]=i),n}}return 0}function A(e){for(let t=0;t<e.internalProps.columns.length;t++){let l=e.internalProps.columns[t];if(l.aggregation);else if(e.options.aggregation){let i;if(i="function"==typeof e.options.aggregation?e.options.aggregation({col:t,field:l.field}):e.options.aggregation)if(Array.isArray(i)){let e=[];i.forEach(t=>{e.push(Object.assign({showOnTop:!1},t))}),l.aggregation=e}else l.aggregation=Object.assign({showOnTop:!1},i)}}}function T(e){for(let t=0;t<e.length;t++)if(e[t].aggregation)return!0;return!1}function H(e){if("autoWidth"===e.options.widthMode||"auto"===e.options.defaultHeaderColWidth||Array.isArray(e.options.defaultHeaderColWidth)&&e.options.defaultHeaderColWidth.includes("auto"))return!0;let t=e.internalProps.layoutMap.columnObjects;for(let e=0;e<t.length;e++)if("auto"===t[e].width)return!0;return!1}},937572:function(e,t,l){l.d(t,{NA:()=>C,UN:()=>y,o2:()=>b,pY:()=>w});var i=l(853216),n=l(936781),o=l(937098),r=l(135759),a=l(809032),s=l(75665),h=l(364776),d=l(480971),u=l(999051),c=l(551976),g=l(704654),p=l(561789);let f={SOURCE_LENGTH_UPDATE:"source_length_update",CHANGE_ORDER:"change_order"};function C(e,t){let l=(0,r.vi)(e);if((0,r.tI)(l)){let e=l.then(e=>(t(e),e));return t(e),e}return l}function v(e,t,l,i,n,o){var a;if(null==e)return;if((0,r.tI)(e))return e.then(e=>v(e,t,l,i,n,o));let u=(a=t,!(r.j6.isObject(a)&&(0,h.Z)(a.get)&&(0,h.Z)(a.set))&&1)?t:t.get;if((void 0===u||""===u)&&Array.isArray(e))return e[l-n.leftRowSeriesNumberCount];if((0,d.Z)(e)&&u in e)return C(e[u],o);if("function"==typeof u)return C(u(e,l,i,n),o);if(Array.isArray(u))return C((0,s.MU)(e,[...u]),o);let c=`${u}`.split(".");return c.length<=1?C(e[u],o):C((0,r.vl)(e,(e,t)=>v(e,t,l,i,n,r.nO),...c),o)}function m(e,t){if(!e)return t;let l=e[t];return(0,h.Z)(l)?l:t}class b extends a.R{static get EVENT_TYPE(){return f}constructor(e,t,l,i,n,o){var r;super(),this.addRecordRule="Object",this.currentIndexedData=[],this.hierarchyExpandLevel=0,this.hasHierarchyStateExpand=!1,this.beforeChangedRecordsMap=new Map,this.registedAggregators={},this.rowHierarchyType="grid",this.fieldAggregators=[],this.addRecordRule=(null==t?void 0:t.addRecordRule)||"Object",this.registerAggregators(),this.dataSourceObj=e,this.dataConfig=t,this._get=null==e?void 0:e.get,this.columns=i,this._source=(null==e?void 0:e.records)?this.processRecords(null==e?void 0:e.records):e,this._sourceLength=(null==(r=this._source)?void 0:r.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=l,this.pagination=l||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},o>=1&&(this.hierarchyExpandLevel=o),this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t),"tree"===n&&this.initTreeHierarchyState(),this.rowHierarchyType=n,this.updatePagerData()}initTreeHierarchyState(){var e,t;this._sourceLength=(null==(e=this._source)?void 0:e.length)||0,this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t);let l=this._sourceLength;for(let e=0;e<l;e++){let i=this.currentIndexedData[e],o=this.getOriginalRecord(i);if(!o)continue;let r=null!=(t=o.filteredChildren)?t:o.children;if((null==r?void 0:r.length)>0){if(this.hierarchyExpandLevel>1?o.hierarchyState||(o.hierarchyState=n.g.expand):o.hierarchyState||(o.hierarchyState=n.g.collapse),this.hasHierarchyStateExpand=!0,o.hierarchyState===n.g.collapse)continue;let t=this.initChildrenNodeHierarchy(i,this.hierarchyExpandLevel,2,o);e+=t,l+=t}else!0!==o.children||o.hierarchyState||(o.hierarchyState=n.g.collapse)}}supplementConfig(e,t,l,i){var n;this.columns=t,this._sourceLength=(null==(n=this._source)?void 0:n.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=e,this.pagination=e||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},i>=1&&(this.hierarchyExpandLevel=i),this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t),"tree"===l&&this.initTreeHierarchyState(),this.rowHierarchyType=l,this.updatePagerData()}registerAggregator(e,t){this.registedAggregators[e]=t}registerAggregators(){this.registerAggregator(o.E.RECORD,p.hT),this.registerAggregator(o.E.SUM,p.__),this.registerAggregator(o.E.COUNT,p.ZP),this.registerAggregator(o.E.MAX,p.Fn),this.registerAggregator(o.E.MIN,p.NF),this.registerAggregator(o.E.AVG,p.ky),this.registerAggregator(o.E.NONE,p.ld),this.registerAggregator(o.E.CUSTOM,p.Js)}updateColumns(e){this.columns=e}_generateFieldAggragations(){let e=this.columns;this.fieldAggregators=[];let t=e=>{delete e.vtable_aggregator;let t=e.field,l=e.aggregation;if(l)if(Array.isArray(l))for(let i of l){let l=new this.registedAggregators[i.aggregationType]({field:t,formatFun:i.formatFun,isRecord:!0,aggregationFun:i.aggregationFun});this.fieldAggregators.push(l),e.vtable_aggregator||(e.vtable_aggregator=[]),e.vtable_aggregator.push(l)}else{let i=new this.registedAggregators[l.aggregationType]({field:t,formatFun:l.formatFun,isRecord:!0,aggregationFun:l.aggregationFun});this.fieldAggregators.push(i),e.vtable_aggregator=i}},l=e=>{if(e&&0!==e.length)for(let i of e)t(i),i.columns&&l(i.columns)};l(e)}processRecords(e){var t,l,i,n,o,r,a,s;this._generateFieldAggragations();let h=[],d=this.fieldAggregators.length>=1;if((null==(l=null==(t=this.dataConfig)?void 0:t.filterRules)?void 0:l.length)>=1||(null==(i=this.lastFilterRules)?void 0:i.length)>=1||d){for(let t=0,l=e.length;t<l;t++){let l=e[t];null!=l&&((null==(o=null==(n=this.dataConfig)?void 0:n.filterRules)?void 0:o.length)>=1?this.filterRecord(l)&&(h.push(l),"tree"===this.rowHierarchyType&&l.children&&(l.filteredChildren=this.filteredChildren(l.children)),d&&this.processRecord(l)):((null==(r=this.lastFilterRules)?void 0:r.length)>=1&&this.clearFilteredChildren(l),d&&this.processRecord(l)))}if((null==(s=null==(a=this.dataConfig)?void 0:a.filterRules)?void 0:s.length)>=1)return h}return e}filteredChildren(e){let t=[];for(let l=0,i=e.length;l<i;l++){let i=e[l];this.filterRecord(i)&&(t.push(i),i.children&&(i.filteredChildren=this.filteredChildren(i.children)))}return t}processRecord(e){for(let t=0;t<this.fieldAggregators.length;t++)this.fieldAggregators[t].push(e)}initChildrenNodeHierarchy(e,t,l,i){var o,r,a;let s=0,h=i.filteredChildren?i.filteredChildren.length:null!=(r=null==(o=i.children)?void 0:o.length)?r:0;for(let o=0;o<h;o++){(l<=t||i.hierarchyState===n.g.expand)&&(s+=1);let r=i.filteredChildren?i.filteredChildren[o]:i.children[o],h=Array.isArray(e)?e.concat(o):[e,o];(l<=t||i.hierarchyState===n.g.expand)&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(e)+s,0,h),(r.filteredChildren?r.filteredChildren.length>0:(null==(a=r.children)?void 0:a.length)>0)&&(l<t||r.hierarchyState===n.g.expand?(r.hierarchyState||(r.hierarchyState=n.g.expand),this.hasHierarchyStateExpand=!0):r.hierarchyState||(r.hierarchyState=n.g.collapse)),r.hierarchyState===n.g.expand&&(s+=this.initChildrenNodeHierarchy(h,t,l+1,r)),!0!==r.children||r.hierarchyState||(r.hierarchyState=n.g.collapse)}return s}updatePagination(e){this.pagination=e||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},this.updatePagerData()}updatePagerData(){let{currentIndexedData:e}=this,{perPageCount:t,currentPage:l}=this.pagination,i=t*(l||0),n=i+t;if(this._currentPagerIndexedData.length=0,e&&e.length>0){let t=-1;for(let l=0;l<e.length;l++)if((Array.isArray(e[l])&&1===e[l].length||!Array.isArray(e[l]))&&t++,t>=i&&t<n)this._currentPagerIndexedData.push(e[l]);else if(t>=n)break}else if(this._sourceLength>0)throw Error("currentIndexedData should has values!")}getRecordIndexPaths(e){return this._currentPagerIndexedData[e]}get records(){return Array.isArray(this._source)?this._source:[]}get source(){return this._source}get(e){return this.getOriginalRecord(m(this.currentPagerIndexedData,e))}getRaw(e){return this.getRawRecord(m(this.currentPagerIndexedData,e))}getIndexKey(e){return m(this.currentPagerIndexedData,e)}getTableIndex(e){return Array.isArray(e)?"tree"===this.rowHierarchyType?this.currentPagerIndexedData.findIndex(t=>(0,u.h6)(t,e)):this.currentPagerIndexedData.findIndex(t=>t===e[0]):this.currentPagerIndexedData.findIndex(t=>t===e)}getField(e,t,l,i,n){return this.getOriginalField(m(this.currentPagerIndexedData,e),t,l,i,n)}getRawField(e,t,l,i,n){return this.getRawFieldData(m(this.currentPagerIndexedData,e),t,l,i,n)}hasField(e,t){return this.hasOriginalField(m(this.currentPagerIndexedData,e),t)}getHierarchyState(e){var t;let l=this.getOriginalRecord(this.currentPagerIndexedData[e]);if(null==l?void 0:l.hierarchyState){let e=l.hierarchyState;if((null==(t=l.children)?void 0:t.length)>0||!0===l.children)return e}return null}toggleHierarchyState(e,t,l){let i=this.currentIndexedData.slice(0),o=this.getIndexKey(e),r=this.getHierarchyState(e),a=this.getOriginalRecord(o);if(this.clearSortedIndexMap(),r===n.g.collapse)a.hierarchyState=n.g.expand,this.pushChildrenNode(o,n.g.expand,a),this.hasHierarchyStateExpand=!0;else if(r===n.g.expand){let e=(0,s.pr)(o,r,a);this.currentIndexedData.splice(this.currentIndexedData.indexOf(o)+1,e),a.hierarchyState=n.g.collapse}this.updatePagerData();let h=[],d=[];if(r===n.g.collapse){let t=this.currentIndexedData.length-i.length;for(let l=0;l<t;l++)h.push(e+l+1)}else if(r===n.g.expand){let t=i.length-this.currentIndexedData.length;for(let l=0;l<t;l++)d.push(e+l+1)}return{add:h,remove:d}}pushChildrenNode(e,t,l){var o,r;if(!t||t===n.g.collapse||t===n.g.none)return 0;let a=0,s=l.filteredChildren?l.filteredChildren:l.children;if(s){let t=Array.from({length:s.length},(e,t)=>t);null==(o=this.lastSortStates)||o.forEach(l=>{"normal"!==l.order&&i.D(e=>(0,h.Z)(t[e])?t[e]:t[e]=e,(e,l)=>{t[e]=l},s.length,l.orderFn,l.order,t=>this.getOriginalField(Array.isArray(e)?e.concat([t]):[e,t],l.field))});for(let l=0;l<t.length;l++){a+=1;let i=Array.isArray(e)?e.concat([t[l]]):[e,t[l]];this.currentIndexedData.splice(this.currentIndexedData.indexOf(e)+a,0,i);let o=this.getOriginalRecord(i);!o.hierarchyState&&(null!=(r=o.filteredChildren)?r:o.children)&&(o.hierarchyState=n.g.collapse),a+=this.pushChildrenNode(i,o.hierarchyState,s[t[l]])}}return a}changeFieldValue(e,t,l,i,n,o){var a;if(null!==l&&t>=0){let n=this.getIndexKey(t);if(this.cacheBeforeChangedRecord(n,o),void 0!==l&&""!==l||(l=i-o.leftRowSeriesNumberCount),"string"==typeof l||"number"==typeof l){let t=null==(a=this.beforeChangedRecordsMap.get(n.toString()))?void 0:a[l],i=this.getOriginalRecord(n),o=e;"number"==typeof t&&(0,s.Zf)(e)&&(o=parseFloat(e)),(0,r.tI)(i)?i.then(e=>{e[l]=o}).catch(e=>{}):i?i[l]=o:(this.records[n]="Array"===this.addRecordRule?[]:{},this.records[n][l]=o)}}}cacheBeforeChangedRecord(e,t){var l;if(!this.beforeChangedRecordsMap.has(e.toString())){let t=this.getOriginalRecord(e);this.beforeChangedRecordsMap.set(e.toString(),null!=(l=(0,c.Z)(t,void 0,["vtable_gantt_linkedFrom","vtable_gantt_linkedTo"]))?l:{})}}setRecord(e,t){var l,i;let n=!0;if((null==(i=null==(l=this.dataConfig)?void 0:l.filterRules)?void 0:i.length)>=1&&(this.filterRecord(e)?"tree"===this.rowHierarchyType&&e.children&&(e.filteredChildren=this.filteredChildren(e.children)):n=!1),n&&Array.isArray(this.records)){let l=this.getIndexKey(t);Array.isArray(l)||this.records.splice(l,1,e)}}addRecord(e,t){var l;if(Array.isArray(this.records)){this.records.splice(t,0,e),this.adjustBeforeChangedRecordsMap(t,1),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1;for(let t=0;t<this.fieldAggregators.length;t++)this.fieldAggregators[t].push(e);if("tree"===this.rowHierarchyType&&this.initTreeHierarchyState(),this.userPagination){this.pagination.totalCount=this._sourceLength;let{perPageCount:e,currentPage:l}=this.pagination;t<e*(l||0)+e&&this.updatePagerData()}else this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData();(null==(l=this.dataSourceObj)?void 0:l.added)&&this.dataSourceObj.added(t,1)}}addRecords(e,t){var l;if(Array.isArray(this.records)){if(Array.isArray(e)){this.records.splice(t,0,...e),this.adjustBeforeChangedRecordsMap(t,e.length);for(let t=0;t<e.length;t++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=e.length;for(let t=0;t<this.fieldAggregators.length;t++)for(let l=0;l<e.length;l++)this.fieldAggregators[t].push(e[l])}if(this.userPagination){this.pagination.totalCount=this._sourceLength;let{perPageCount:e,currentPage:l}=this.pagination;t<e*(l||0)+e&&this.updatePagerData()}else this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData();(null==(l=this.dataSourceObj)?void 0:l.added)&&this.dataSourceObj.added(t,e.length)}}addRecordForSorted(e){Array.isArray(this.records)&&(this.beforeChangedRecordsMap.clear(),this.records.push(e),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1,this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength))}addRecordsForSorted(e){if(Array.isArray(this.records)){if(this.beforeChangedRecordsMap.clear(),Array.isArray(e)){this.records.push(...e);for(let t=0;t<e.length;t++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=e.length,this.sortedIndexMap.clear()}this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}}adjustBeforeChangedRecordsMap(e,t,l="add"){for(let i=this.beforeChangedRecordsMap.size-1;i>=e;i--){let e=this.beforeChangedRecordsMap.get(i.toString());this.beforeChangedRecordsMap.delete(i.toString()),this.beforeChangedRecordsMap.set((i+("add"===l?t:-t)).toString(),e)}}deleteRecords(e){var t;if(Array.isArray(this.records)){let l=[],i=e.sort((e,t)=>t-e);for(let e=0;e<i.length;e++){let t=i[e];if(t>=this._sourceLength||t<0)continue;this.adjustBeforeChangedRecordsMap(t,1,"delete"),l.push(t);let n=this.records[t];for(let e=0;e<this.fieldAggregators.length;e++)this.fieldAggregators[e].deleteRecord(n);this.records.splice(t,1),this.currentIndexedData.pop(),this._sourceLength-=1}return this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.updatePagerData(),(null==(t=this.dataSourceObj)?void 0:t.deleted)&&this.dataSourceObj.deleted(l),l}return[]}deleteRecordsForSorted(e){if(Array.isArray(this.records)){let t=e.sort((e,t)=>t-e);for(let e=0;e<t.length;e++){let l=t[e];if(l>=this._sourceLength||l<0)continue;let i=this.currentIndexedData[l];this.records.splice(i,1),this._sourceLength-=1}this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.beforeChangedRecordsMap.clear()}}updateRecords(e,t){let l=[];for(let i=0;i<t.length;i++){let n=t[i];if(Array.isArray(n))this.beforeChangedRecordsMap.delete(n.toString()),l.push(n),n.slice(0,-1).reduce((e,t)=>(void 0===e[t]&&(e[t]={}),e[t].children),this.records)[n[n.length-1]]=e[i];else{if(n>=this._sourceLength||n<0)continue;this.beforeChangedRecordsMap.delete(n.toString()),l.push(n);for(let t=0;t<this.fieldAggregators.length;t++)this.fieldAggregators[t].updateRecord(this.records[n],e[i]);this.records[n]=e[i]}}return this.userPagination&&this.updatePagerData(),l}updateRecordsForSorted(e,t){let l=[];for(let i=0;i<t.length;i++){let n=t[i];if(n>=this._sourceLength||n<0)continue;let o=this.currentIndexedData[n];if("number"!=typeof o)return;this.beforeChangedRecordsMap.delete(o.toString()),l.push(n),this.records[o]=e[i]}this.sortedIndexMap.clear()}sort(e){e=(Array.isArray(e)?e:[e]).filter(e=>{let t=this.columns.find(t=>t.field===e.field);return!1!==(null==t?void 0:t.sort)&&"normal"!==e.order}),this.lastSortStates=e;let t=e.map(e=>this.sortedIndexMap.get(null==e?void 0:e.field)||{asc:[],desc:[],normal:[]}),l=null;if(t.length>0&&(l=e.reduce((e,l,i)=>{var n;let o=null==(n=t[i])?void 0:n[l.order];return o&&o.length>0?o:e},null))&&l.length>0)return this.currentIndexedData=l,this.updatePagerData(),void this.fireListeners(f.CHANGE_ORDER,null);let i=Array.from({length:this._sourceLength},(e,t)=>t);if(i.sort((t,l)=>{let i=this.getOriginalRecord(t),n=this.getOriginalRecord(l),o=null==i||"object"==typeof i&&0===Object.keys(i).length,r=null==n||"object"==typeof n&&0===Object.keys(n).length;return e.reduce((e,i)=>{if(0!==e)return e;if("asc"===i.order||"desc"===i.order){if(o&&!r)return 1;if(!o&&r)return -1;if(o&&r)return t-l}else if(o||r)return t-l;return(i.orderFn||("desc"!==i.order?(e,t)=>e===t?0:e>t?1:-1:(e,t)=>e===t?0:e<t?1:-1))(this.getOriginalField(t,i.field),this.getOriginalField(l,i.field),i.order)},0)}),this.currentIndexedData=i,this.hierarchyExpandLevel&&"tree"===this.rowHierarchyType){let e=i.length;for(let t=0;t<e;t++){let l=this.getOriginalRecord(i[t]),n=this.pushChildrenNode(i[t],l.hierarchyState,this.getOriginalRecord(i[t]));e+=n,t+=n}}if(!t.length){t=e.map(()=>({asc:[],desc:[],normal:[]}));for(let l=0;l<e.length;l++)this.sortedIndexMap.set(e[l].field,t[l])}e.forEach((e,l)=>{t[l][e.order]=i.slice()}),this.updatePagerData(),this.fireListeners(f.CHANGE_ORDER,null)}setSortedIndexMap(e,t){this.sortedIndexMap.set(e,t)}clearFilteredChildren(e){var t,l;e.filteredChildren=void 0;for(let i=0;i<(null!=(l=null==(t=e.children)?void 0:t.length)?l:0);i++)this.clearFilteredChildren(e.children[i])}filterRecord(e){var t,l,i;let n=!0;for(let o=0;o<(null==(t=this.dataConfig.filterRules)?void 0:t.length);o++){let t=null==(l=this.dataConfig)?void 0:l.filterRules[o];if(t.filterKey){let l=e[t.filterKey];if(-1===t.filteredValues.indexOf(l)){n=!1;break}}else if(!(null==(i=t.filterFunc)?void 0:i.call(t,e))){n=!1;break}}return n}updateFilterRulesForSorted(e){var t,l,i;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=e,this._source=this.processRecords(null!=(l=null==(t=this.dataSourceObj)?void 0:t.records)?l:this.dataSourceObj),this._sourceLength=(null==(i=this._source)?void 0:i.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t),"tree"===this.rowHierarchyType&&this.initTreeHierarchyState(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}updateFilterRules(e,t){var l,i,n;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=e,this._source=this.processRecords(null!=(i=null==(l=this.dataSourceObj)?void 0:l.records)?i:this.dataSourceObj),t&&t(this._source),this._sourceLength=(null==(n=this._source)?void 0:n.length)||0,this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,"tree"===this.rowHierarchyType&&this.initTreeHierarchyState()),this.updatePagerData()}clearSortedIndexMap(){this.lastSortStates&&this.lastSortStates.length>0&&this.sortedIndexMap.forEach((e,t)=>{this.lastSortStates.some(e=>e.field===t)?this.lastSortStates.forEach(t=>{"asc"===t.order?(e.desc=[],e.normal=[]):"desc"===t.order?(e.asc=[],e.normal=[]):(e.asc=[],e.desc=[])}):this.sortedIndexMap.delete(t)})}get sourceLength(){return this._sourceLength}set sourceLength(e){this._sourceLength!==e&&(this._sourceLength=e,this.fireListeners(f.SOURCE_LENGTH_UPDATE,this._sourceLength))}get length(){return this.currentPagerIndexedData.length}get dataSource(){return this}get currentPagerIndexedData(){return this._currentPagerIndexedData.length>0?this._currentPagerIndexedData:[]}release(){var e;null==(e=super.release)||e.call(this),this.lastFilterRules=null,this.clearSortedMap(),this.clearCurrentIndexedData(),this.currentPagerIndexedData.length=0}clearSortedMap(){this.currentIndexedData&&(this.currentIndexedData.length=0),this.currentIndexedData=null,this.sortedIndexMap.forEach(e=>{e.asc&&(e.asc.length=0),e.desc&&(e.desc.length=0)}),this.sortedIndexMap.clear()}clearCurrentIndexedData(){this.currentIndexedData=null,this.currentPagerIndexedData.length=0}getOriginalRecord(e){return C(this.dataSourceObj.records?Array.isArray(e)?y(this.records,e):this.records[e]:this._get(e),t=>{this.recordPromiseCallBack(e,t)})}getRawRecord(e){var t,l;return(null==(t=this.beforeChangedRecordsMap)?void 0:t.has(e.toString()))?null==(l=this.beforeChangedRecordsMap)?void 0:l.get(e.toString()):C(this.dataSourceObj.records?Array.isArray(e)?y(this.records,e):this.records[e]:this._get(e),t=>{this.recordPromiseCallBack(e,t)})}getOriginalField(e,t,l,i,n){if(null!==t)return v(this.getOriginalRecord(e),t,l,i,n,l=>{this.fieldPromiseCallBack(e,t,l)})}getRawFieldData(e,t,l,i,n){if(null!==t)return v(this.getRawRecord(e),t,l,i,n,l=>{this.fieldPromiseCallBack(e,t,l)})}hasOriginalField(e,t){if(null===t)return!1;if("function"==typeof t)return!0;let l=this.getOriginalRecord(e);return!!(l&&t in l)}fieldPromiseCallBack(e,t,l){}recordPromiseCallBack(e,t){}canChangeOrder(e,t){var l;if(null==(l=this.dataSourceObj)?void 0:l.canChangeOrder)return this.dataSourceObj.canChangeOrder(e,t);if(this.hasHierarchyStateExpand){let l=this.currentPagerIndexedData[e],i=this.currentPagerIndexedData[t];if(l=Array.isArray(l)?[...l]:[l],i=Array.isArray(i)?[...i]:[i],t>e&&i.length>l.length){let e=this.currentPagerIndexedData[t+1];(e=Array.isArray(e)?[...e]:[e]).length<i.length&&i.splice(i.length-1,1)}if(l.length===i.length){for(let e=0;e<=l.length-2;e++)if(l[e]!==i[e])return!1;return!0}return!1}return!0}changeOrder(e,t){var l,i,n;if(null==(l=this.dataSourceObj)?void 0:l.changeOrder)this.dataSourceObj.changeOrder(e,t);else if(!(null==(i=this.lastSortStates)?void 0:i.some(e=>"asc"===e.order||"desc"===e.order))&&this.canChangeOrder(e,t))if(this.hasHierarchyStateExpand){let l,i,o=this.currentPagerIndexedData[e],r=this.currentPagerIndexedData[t];if(o=Array.isArray(o)?[...o]:[o],r=Array.isArray(r)?[...r]:[r],o.length>1||r.length>1){if(t>e&&r.length>o.length){let e=this.currentPagerIndexedData[t+1];(e=Array.isArray(e)?[...e]:[e]).length<r.length&&r.splice(r.length-1,1)}if(l=o.splice(o.length-1,1)[0],i=r.splice(r.length-1,1)[0],o.length>=1){let e=this.getOriginalRecord(o);if(e){let t=e.filteredChildren?e.filteredChildren.splice(l,1):e.children.splice(l,1);t.unshift(i,0),Array.prototype.splice.apply(null!=(n=e.filteredChildren)?n:e.children,t)}}else{let e=this.records.splice(l,1);e.unshift(i,0),Array.prototype.splice.apply(this.records,e)}}else this.exchangeRecordData(e,t);this.restoreTreeHierarchyState(),this.updatePagerData()}else this.exchangeRecordData(e,t)}exchangeRecordData(e,t){let l=this.getRecordIndexPaths(e),i=this.getRecordIndexPaths(t),n=this.records.splice(l,1);n.unshift(i,0),Array.prototype.splice.apply(this.records,n)}restoreTreeHierarchyState(){var e,t;if(this.hierarchyExpandLevel){for(let t=0;t<this._sourceLength;t++){let l=this.getOriginalRecord(t);l&&(null!=(e=l.filteredChildren)?e:l.children)&&!l.hierarchyState&&(l.hierarchyState=n.g.collapse)}this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t);let l=this._sourceLength;for(let e=0;e<l;e++){let i=this.currentIndexedData[e],o=this.getOriginalRecord(i);if(!o)continue;let r=null!=(t=o.filteredChildren)?t:o.children;if((null==r?void 0:r.length)>0&&o.hierarchyState===n.g.expand){this.hasHierarchyStateExpand=!0;let t=this.restoreChildrenNodeHierarchy(i,o);e+=t,l+=t}else!0!==o.children||o.hierarchyState||(o.hierarchyState=n.g.collapse)}}}restoreChildrenNodeHierarchy(e,t){var l,i;let o=0,r=null!=(l=t.filteredChildren)?l:t.children,a=null!=(i=null==r?void 0:r.length)?i:0;for(let l=0;l<a;l++){t.hierarchyState===n.g.expand&&(o+=1);let i=r[l],a=Array.isArray(e)?e.concat(l):[e,l];t.hierarchyState===n.g.expand&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(e)+o,0,a),o+=this.restoreChildrenNodeHierarchy(a,i)}return o}_setNodeStateRecursive(e,t){var l;if(!e)return;let i=null!=(l=e.filteredChildren)?l:e.children;if(i&&(Array.isArray(i)?i.length>0:!0===i)&&(e.hierarchyState=t),i&&Array.isArray(i))for(let e of i)this._setNodeStateRecursive(e,t)}expandAllNodes(){if(Array.isArray(this._source)){for(let e of this._source)this._setNodeStateRecursive(e,n.g.expand);this.hasHierarchyStateExpand=!0,this.clearSortedIndexMap(),this.restoreTreeHierarchyState(),this.lastSortStates&&this.lastSortStates.length>0?this.sort(this.lastSortStates):this.updatePagerData()}}collapseAllNodes(){if(Array.isArray(this._source)){for(let e of this._source)this._setNodeStateRecursive(e,n.g.collapse);this.clearSortedIndexMap(),this.restoreTreeHierarchyState(),this.lastSortStates&&this.lastSortStates.length>0?this.sort(this.lastSortStates):this.updatePagerData()}}}function y(e,t){var l;let i=e;for(let e=0;e<t.length;e++){let n=t[e];if(!i[n])return;let o=null!=(l=(i=i[n]).filteredChildren)?l:null==i?void 0:i.children;o&&e+1<t.length&&(i=o)}return i}function w(e,t){return e.sort((e,l)=>{var i,n;(0,g.Z)(e)&&(e=[e]),(0,g.Z)(l)&&(l=[l]);let o=Math.max(e.length,l.length);for(let r=0;r<o;r++){let o=null!=(i=e[r])?i:-1,a=null!=(n=l[r])?n:-1;if(o!==a)return 1===t?o-a:a-o}return 0})}b.EMPTY=new b({get(){},length:0})},809032:function(e,t,l){l.d(t,{R:()=>o});var i=l(364776);let n=1;class o{constructor(){this.listenersData={listeners:{},listenerData:{}}}on(e,t){let l=this.listenersData.listeners[e]||(this.listenersData.listeners[e]=[]);l.push(t);let i=n++;return this.listenersData.listenerData[i]={type:e,listener:t,remove:()=>{delete this.listenersData.listenerData[i];let n=l.indexOf(t);l.splice(n,1),this.listenersData.listeners[e].length||delete this.listenersData.listeners[e]}},i}off(e,t){var l;if(t)this.removeEventListener(e,t);else{if(!this.listenersData)return;null==(l=this.listenersData.listenerData[e])||l.remove()}}addEventListener(e,t,l){this.on(e,t)}removeEventListener(e,t){if(this.listenersData)for(let l in this.listenersData.listenerData){let i=this.listenersData.listenerData[l];i.type===e&&i.listener===t&&this.off(l)}}hasListeners(e){return!!this.listenersData&&!!this.listenersData.listeners[e]}fireListeners(e,t){if(!this.listenersData)return[];let l=this.listenersData.listeners[e];return l?l.map(e=>e.call(this,t)).filter(e=>(0,i.Z)(e)):[]}release(){delete this.listenersData}}},170559:function(e,t,l){l.d(t,{J$:()=>o,RJ:()=>n,r5:()=>a,xD:()=>r});var i=l(364776);function n(e){let t={abstractPos:{x:e.viewport.x,y:e.viewport.y}},l=o(e.target);return l&&(t.eventArgs={col:l.col,row:l.row,event:e,targetCell:l,mergeInfo:function(e){if((0,i.Z)(e.mergeStartCol)&&(0,i.Z)(e.mergeStartRow)&&(0,i.Z)(e.mergeEndCol)&&(0,i.Z)(e.mergeEndRow))return{colStart:e.mergeStartCol,colEnd:e.mergeEndCol,rowStart:e.mergeStartRow,rowEnd:e.mergeEndRow}}(l),target:e.target}),t}function o(e){for(;e&&e.parent;){if("cell"===e.role)return e;e=e.parent}return null}let r=/radio-\d+-\d+-(\d+)/;function a(e){let t=["<table>"],l=e.split("\r\n");return l.forEach(function(e,i){let n=e.split("	"),o=[];0===i&&t.push("<tbody>"),n.forEach(function(e,t){let l=e?e.toString().replace(/&/g,"&amp;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,e=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(e.length-1)} </span>`).replace(/\t/gi,"&#9;"):" ";o.push(`<td>${l}</td>`)}),t.push("<tr>",...o,"</tr>"),i===l.length-1&&t.push("</tbody>")}),t.push("</table>"),['<meta name="author" content="Visactor"/><style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>',t.join("")].join("")}}}]);