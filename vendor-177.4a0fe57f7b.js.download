"use strict";(window.webpackChunkweb=window.webpackChunkweb||[]).push([["37465"],{733154:function(e,o,t){function l(e,o,t){let l=t.getCellRange(e.col,e.row);if(t.isColumnHeader(e.col,e.row)||"column"===t.stateManager.columnMove.movingColumnOrRow&&0===e.row){let r=t.getCellRange(o.col,l.start.row);o.row>=t.columnHeaderLevelCount&&(o.row=Math.max(t.columnHeaderLevelCount-1,0)),o.col>=e.col?o.col=r.end.col:o.col=r.start.col}else if(t.isRowHeader(e.col,e.row)){let r=t.internalProps.layoutMap,n=t.getCellRange(l.start.col,o.row);if(o.col>=t.rowHeaderLevelCount+r.leftRowSeriesNumberColumnCount&&(o.col=t.rowHeaderLevelCount+r.leftRowSeriesNumberColumnCount-1),"tree"===r.rowHierarchyType){let l=r.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths,n=r.getCellHeaderPathsWithTreeNode(o.col,o.row).rowHeaderPaths;if(l.length<=n.length){let r=n[l.length-1];r&&(o.row>=e.row?o.row=r.startInTotal+r.size-1+t.columnHeaderLevelCount:o.row=r.startInTotal+t.columnHeaderLevelCount)}}else o.row>=e.row?o.row=n.end.row:o.row=n.start.row}return o}function r(e,o){if(o.internalProps._widthResizedColMap.size>0){let t=Array.from(o.internalProps._widthResizedColMap.keys());o.internalProps._widthResizedColMap.clear();for(let l=0;l<t.length;l++){let r,n=t[l],{sourceIndex:a,targetIndex:i,sourceSize:c}=e;r=n>=a&&n<a+c?i+(n-a):a<i?n>=a+c&&n<i||n>=i?n-c:n:n>=i&&n<a?n+c:n,o.internalProps._widthResizedColMap.add(r)}}}function n(e,o){if(o.internalProps._heightResizedRowMap.size>0){let t=Array.from(o.internalProps._heightResizedRowMap.keys());o.internalProps._heightResizedRowMap.clear();for(let l=0;l<t.length;l++){let r,n=t[l],{sourceIndex:a,targetIndex:i,sourceSize:c}=e;r=n>=a&&n<a+c?i+(n-a):a<i?n>=a+c&&n<i||n>=i?n-c:n:n>=i&&n<a?n+c:n,o.internalProps._heightResizedRowMap.add(r)}}}function a(e,o,t){let l=Array.from(e.internalProps._heightResizedRowMap.keys()),r=o+(e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount);for(let o=0;o<l.length;o++)l[o]>=r&&(e.internalProps._heightResizedRowMap.delete(l[o]),e.internalProps._heightResizedRowMap.add(l[o]+t.length))}function i(e,o){let t=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount;o.sort((e,o)=>o-e);for(let l=0;l<o.length;l++){let r=o[l]+t,n=Array.from(e.internalProps._heightResizedRowMap.keys());for(let o=0;o<n.length;o++)n[o]===r?e.internalProps._heightResizedRowMap.delete(n[o]):n[o]>r&&(e.internalProps._heightResizedRowMap.delete(n[o]),e.internalProps._heightResizedRowMap.add(n[o]-1))}}t.d(o,{$Q:()=>l,J7:()=>n,UF:()=>a,b:()=>i,ct:()=>r})},400268:function(e,o,t){t.d(o,{FR:()=>c,Lu:()=>a,vS:()=>i});var l=t(657198),r=t(75665),n=t(733154);function a(e,o,t,n,a,i,c){var s;let d;if(!("canMoveHeaderPosition"in a.table.internalProps.layoutMap))return;if(a.columnMove.movingColumnOrRow=c,a.columnMove.moving=!0,a.columnMove.colSource=e,a.columnMove.rowSource=o,a.table.isListTable()){let t=a.table.getRecordIndexByCell(e,o),l=a.table.getRecordByCell(e,o),n=a.table.getRecordHierarchyState(e,o);a.columnMove.rowSourceSize=(0,r.pr)(t,n,l)+1}if(a.columnMove.x=t-a.table.tableX,a.columnMove.y=n-a.table.tableY,"column"===c)d=a.columnMove.x;else if("row"===c)d=a.columnMove.y;else{let t=a.table.getCellLocation(e,o);d="columnHeader"===t?a.columnMove.x:"rowHeader"===t||a.table.internalProps.layoutMap.isSeriesNumberInBody(e,o)?a.columnMove.y:0}let{backX:u,lineX:g,backY:h,lineY:w}=a.table.scenegraph.component.showMoveCol(e,o,d);a.table.fireListeners(l.B.CHANGE_HEADER_POSITION_START,{col:e,row:o,x:t,y:n,backX:u,lineX:g,backY:h,lineY:w,event:i,movingColumnOrRow:c});let C=!!(null==(s=a.select.ranges)?void 0:s.length);a.table.stateManager.updateSelectPos(-1,-1),a.table.stateManager.endSelectCells(!0,C),a.table.scenegraph.updateNextFrame()}function i(e,o,t,a,i,c){if(!("canMoveHeaderPosition"in i.table.internalProps.layoutMap))return;let s=(0,n.$Q)({col:i.columnMove.colSource,row:i.columnMove.rowSource},{col:e,row:o},i.table);if(i.table.internalProps.layoutMap.canMoveHeaderPosition({col:i.columnMove.colSource,row:i.columnMove.rowSource},{col:s.col,row:s.row})){let n,d,u,g;if(i.columnMove.x=t-i.table.tableX,i.columnMove.y=a-i.table.tableY,i.columnMove.colTarget=s.col,i.columnMove.rowTarget=s.row,i.table.isListTable()){let e=i.table.getRecordIndexByCell(s.col,s.row),o=i.table.getRecordByCell(s.col,s.row),t=i.table.getRecordHierarchyState(s.col,s.row);i.columnMove.rowTargetSize=(0,r.pr)(e,t,o)+1}i.updateCursor("grabbing");let h=i.table.getCellLocation(i.columnMove.colSource,i.columnMove.rowSource);"columnHeader"===h||"column"===i.columnMove.movingColumnOrRow&&0===i.columnMove.rowSource?(d=i.columnMove.x,n=i.table.isLeftFrozenColumn(e)?i.columnMove.colTarget>=i.columnMove.colSource?i.table.getColsWidth(0,i.columnMove.colTarget):i.table.getColsWidth(0,i.columnMove.colTarget-1):i.table.isRightFrozenColumn(e)?i.table.tableNoFrameWidth-i.table.getColsWidth(s.col+1,i.table.colCount-1):(i.columnMove.colTarget>=i.columnMove.colSource?i.table.getColsWidth(0,i.columnMove.colTarget):i.table.getColsWidth(0,i.columnMove.colTarget-1))-i.table.stateManager.scroll.horizontalBarPos):("rowHeader"===h||i.table.internalProps.layoutMap.isSeriesNumberInBody(e,o)||"row"===i.columnMove.movingColumnOrRow)&&(g=i.columnMove.y,u=i.table.isFrozenRow(o)?i.columnMove.rowTarget>=i.columnMove.rowSource?i.table.getRowsHeight(0,i.columnMove.rowTarget):i.table.getRowsHeight(0,i.columnMove.rowTarget-1):i.table.isBottomFrozenRow(o)?i.table.tableNoFrameHeight-i.table.getRowsHeight(s.row+1,i.table.rowCount-1):(i.columnMove.rowTarget>=i.columnMove.rowSource?i.table.getRowsHeight(0,i.columnMove.rowTarget):i.table.getRowsHeight(0,i.columnMove.rowTarget-1))-i.table.stateManager.scroll.verticalBarPos),i.table.scenegraph.component.updateMoveCol(d,n,g,u),i.table.fireListeners(l.B.CHANGING_HEADER_POSITION,{col:e,row:o,x:t,y:a,backX:d,lineX:n,backY:g,lineY:u,event:c,movingColumnOrRow:i.columnMove.movingColumnOrRow}),i.table.scenegraph.updateNextFrame()}else i.updateCursor("not-allowed"),i.columnMove.colTarget=i.columnMove.colSource,i.columnMove.rowTarget=i.columnMove.rowSource}function c(e){var o,t;let l=!1;if("canMoveHeaderPosition"in e.table.internalProps.layoutMap&&e.columnMove.moving&&(e.columnMove.colSource>=0||"row"===e.columnMove.movingColumnOrRow)&&(e.columnMove.rowSource>=0||"column"===e.columnMove.movingColumnOrRow)&&(e.columnMove.colTarget>=0||"row"===e.columnMove.movingColumnOrRow)&&(e.columnMove.rowTarget>=0||"column"===e.columnMove.movingColumnOrRow)&&!0!==(null==(o=e.table.options.customConfig)?void 0:o.notUpdateInColumnRowMove)){let o=e.table.getCellRange(e.columnMove.colSource,e.columnMove.rowSource),t=e.table.getCellRange(e.columnMove.colTarget,e.columnMove.rowTarget),r=e.table._moveHeaderPosition({col:e.columnMove.colSource,row:e.columnMove.rowSource},{col:e.columnMove.colTarget,row:e.columnMove.rowTarget});if(!r||r.targetIndex===r.sourceIndex)return e.updateCursor(),e.columnMove.moving=!1,setTimeout(()=>{delete e.columnMove.colSource,delete e.columnMove.rowSource,delete e.columnMove.colTarget,delete e.columnMove.rowTarget,e.columnMove.movingColumnOrRow=void 0},0),e.table.scenegraph.component.hideMoveCol(),e.table.scenegraph.updateNextFrame(),!1;{e.table.internalProps.useOneRowHeightFillAll=!1,e.table.internalProps.layoutMap.clearCellRangeMap();let n=e.table.getCellRange(e.columnMove.colSource,e.columnMove.rowSource),a=e.table.getCellRange(e.columnMove.colTarget,e.columnMove.rowTarget),i=Math.min(n.start.col,a.start.col,o.start.col,t.start.col),c=Math.max(n.end.col,a.end.col,o.end.col,t.end.col),d=Math.min(n.start.row,a.start.row,o.start.row,t.start.row),u=Math.max(n.end.row,a.end.row,o.end.row,t.end.row);"row"===r.moveType&&"tree"===e.table.internalProps.layoutMap.rowHierarchyType&&(u=r.targetIndex>r.sourceIndex?u+r.targetSize-1:u+r.sourceSize-1),e.table.transpose||!e.table.internalProps.layoutMap.isSeriesNumberInBody(e.columnMove.colSource,e.columnMove.rowSource)&&"row"!==e.columnMove.movingColumnOrRow||(e.table.changeRecordOrder(r.sourceIndex,r.targetIndex),e.changeCheckboxAndRadioOrder(r.sourceIndex,r.targetIndex)),"column"===r.moveType?s(i,c,0,-1,e.table):s(0,-1,d,u,e.table),e.table.clearCellStyleCache(),e.table.internalProps.layoutMap.isSeriesNumberInBody(e.columnMove.colSource,e.columnMove.rowSource)||"row"===e.columnMove.movingColumnOrRow?e.table.scenegraph.updateHeaderPosition(e.table.scenegraph.proxy.colStart,e.table.scenegraph.proxy.colEnd,e.table.scenegraph.proxy.rowStart,e.table.scenegraph.proxy.rowEnd,r.moveType):"column"===r.moveType?e.table.scenegraph.updateHeaderPosition(i,c,0,-1,r.moveType):e.table.scenegraph.updateHeaderPosition(0,-1,d,u,r.moveType),"adjustFrozenCount"===e.table.internalProps.frozenColDragHeaderMode&&e.table.isListTable()&&(e.table.isLeftFrozenColumn(e.columnMove.colTarget)&&!e.table.isLeftFrozenColumn(e.columnMove.colSource)?e.table.frozenColCount+=n.end.col-n.start.col+1:e.table.isLeftFrozenColumn(e.columnMove.colSource)&&!e.table.isLeftFrozenColumn(e.columnMove.colTarget)&&(e.table.frozenColCount-=n.end.col-n.start.col+1),e.table.isRightFrozenColumn(e.columnMove.colTarget)&&!e.table.isRightFrozenColumn(e.columnMove.colSource)?e.table.rightFrozenColCount+=n.end.col-n.start.col+1:e.table.isRightFrozenColumn(e.columnMove.colSource)&&!e.table.isRightFrozenColumn(e.columnMove.colTarget)&&(e.table.rightFrozenColCount-=n.end.col-n.start.col+1)),l=!0}}return e.columnMove.moving=!1,setTimeout(()=>{delete e.columnMove.colSource,delete e.columnMove.rowSource,delete e.columnMove.colTarget,delete e.columnMove.rowTarget,e.columnMove.movingColumnOrRow=void 0},0),e.table.scenegraph.component.hideMoveCol(),!(e.columnResize.col<e.table.frozenColCount)||e.table.isPivotTable()||e.table.transpose?!(e.columnResize.col>=e.table.colCount-e.table.rightFrozenColCount)||e.table.isPivotTable()||e.table.transpose?e.table.options.frozenColCount?e.table.scenegraph.component.setFrozenColumnShadow(e.table.frozenColCount-1):e.table.options.rightFrozenColCount&&e.table.scenegraph.component.setRightFrozenColumnShadow(e.table.colCount-e.table.rightFrozenColCount):e.table.scenegraph.component.setRightFrozenColumnShadow(e.table.colCount-e.table.rightFrozenColCount):(e.table.scenegraph.component.setFrozenColumnShadow(e.table.frozenColCount-1,e.columnResize.isRightFrozen),e.table.scenegraph.component.setRightFrozenColumnShadow(e.table.colCount-e.table.rightFrozenColCount)),e.table.scenegraph.updateNextFrame(),!0===(null==(t=e.table.options.customConfig)?void 0:t.notUpdateInColumnRowMove)||l}function s(e,o,t,l,r){for(let t=e;t<=o;t++)r._clearColRangeWidthsMap(t);for(let e=t;e<=l;e++)r._clearRowRangeHeightsMap(e)}},876659:function(e,o,t){t.d(o,{Bd:()=>C,GW:()=>g,Jd:()=>b,Pi:()=>w,Vz:()=>u,Y:()=>s,aC:()=>f,gs:()=>h,hR:()=>p,r5:()=>m});var l=t(364776),r=t(796241),n=t(480971),a=t(704654),i=t(695723),c=t(135759);function s(e,o,t,l,r){let n=r.table.getCellRange(e,o);if(n.start.col!==n.end.col||n.start.row!==n.end.row)for(let e=n.start.col;e<=n.end.col;e++)for(let o=n.start.row;o<=n.end.row;o++)d(e,o,t,l,r);else d(e,o,t,l,r)}function d(e,o,t,l,r){let n=r.table.getRecordShowIndexByCell(e,o);if(n>=0){let e=r.table.dataSource.getIndexKey(n).toString();r.checkedState.get(e)?r.checkedState.get(e)[t]=l:r.checkedState.set(e,{[t]:l})}}function u(e,o,t){var l;t.headerCheckedState[e]=o,t.table.internalProps.enableCheckboxCascade&&(null==(l=t.checkedState)||l.forEach(t=>{t[e]=o}))}function g(e,o,t,r,n){var a,i;if(n.table.isHeader(e,o)){if((0,l.Z)(n.headerCheckedState[t]))return n.headerCheckedState[t];if("function"==typeof r)return;if((0,l.Z)(r))n.headerCheckedState[t]=r;else if((null==(a=n.checkedState)?void 0:a.size)>0)return n.updateHeaderCheckedState(t,e,o);return n.headerCheckedState[t]}let c=n.table.getRecordShowIndexByCell(e,o);if(c>=0){let e=n.table.dataSource.getIndexKey(c).toString();if((0,l.Z)(null==(i=n.checkedState.get(e))?void 0:i[t]))return n.checkedState.get(e)[t];if(n.checkedState.get(e))n.checkedState.get(e)[t]=r;else if(n.table.internalProps.enableCheckboxCascade&&e.includes(",")){let o=e.split(",").slice(0,-1).join(",");n.checkedState.has(o)&&!0===n.checkedState.get(o)[t]?n.checkedState.set(e,{[t]:!0}):n.checkedState.set(e,{[t]:r})}else n.checkedState.set(e,{[t]:r})}return r}function h(e,o){o.checkedState.clear(),o.headerCheckedState={},o.radioState={};let t=!1;if(o._checkboxCellTypeFields=[],o._headerCheckFuncs={},o.table.internalProps.layoutMap.headerObjects.forEach((e,l)=>{if("checkbox"===e.headerType){let l=e.define.checked;null==l||"function"==typeof l?(t=!0,"function"==typeof l&&(o._headerCheckFuncs[e.field]=l)):o.headerCheckedState[e.field]=l,"checkbox"!==e.define.cellType&&!(0,r.Z)(e.define.cellType)||e.fieldFormat||o._checkboxCellTypeFields.push(e.field)}}),1===o.table.leftRowSeriesNumberCount)o.headerCheckedState._vtable_rowSeries_number=!1,o._checkboxCellTypeFields.push("_vtable_rowSeries_number"),t=!0;else if(o.table.leftRowSeriesNumberCount>1){for(let e=0;e<o.table.leftRowSeriesNumberCount;e++)o.headerCheckedState[`_vtable_rowSeries_number_${e}`]=!1,o._checkboxCellTypeFields.push(`_vtable_rowSeries_number_${e}`);t=!0}t&&function(e,o){let t=o.table,l=t.isPivotTable()?0:t.internalProps.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount,r=t.isPivotTable()?(0,i.Z)(e)?e.length:0:t.internalProps.transpose?t.colCount:t.rowCount;for(let a=0;a+l<r;a++){let l=t.isPivotTable()?e[a]:t.dataSource.get(a);o._checkboxCellTypeFields.forEach(e=>{let r,i=l&&l[e];if((0,n.Z)(i)?r=i.checked:"boolean"==typeof i&&(r=i),null==r){let t=o._headerCheckFuncs[e];if(t){let l=o.table.getCellAddrByFieldRecord(e,a);r=(0,c.vi)(t,{col:l.col,row:l.row,table:o.table,context:null,value:i})}}let s=t.isPivotTable()?a.toString():o.table.dataSource.getIndexKey(a).toString();o.checkedState.get(s)||o.checkedState.set(s,{}),o.checkedState.get(s)[e]=r})}}(e,o)}function w(e,o,t,l){let r=!0,n=!0,a=!1;return o.checkedState.forEach((i,c)=>{var s;c=c.includes(",")?c.split(",").map(e=>Number(e)):Number(c);let d=o.table.getTableIndexByRecordIndex(c),u=o.table.transpose?o.table.getCustomMerge(d,l):o.table.getCustomMerge(t,d),g=null==(s=o.table.dataSource)?void 0:s.get(c);u||!o.table.internalProps.enableCheckboxCascade&&(null==g?void 0:g.vtableMerge)||(!0!==(null==i?void 0:i[e])?r=!1:(n=!1,a=!0))}),r?(o.headerCheckedState[e]=!0,r):n?(o.headerCheckedState[e]=!1,!1):!!a&&(o.headerCheckedState[e]="indeterminate","indeterminate")}function C(e,o){for(let t=o.checkedState.size;t<e.length;t++){let l=e[t];o._checkboxCellTypeFields.forEach(e=>{let r,a=l[e];(0,n.Z)(a)?r=a.checked:"boolean"==typeof a&&(r=a);let i=t.toString();o.checkedState.get(i)||o.checkedState.set(i,{}),o.checkedState.get(i)[e]=r})}}function b(e,o,t,l){var r,n;let a=l.scenegraph.getCell(e,o),i=(null==a?void 0:a.getChildByName("checkbox"))||(null==(n=null==(r=null==a?void 0:a.getChildByName("checkbox-content"))?void 0:r._checkboxGroup)?void 0:n.getChildByName("checkbox"));if(!i){let r=l.getHeaderField(e,o);if(l.isHeader(e,o))l.stateManager.setHeaderCheckedState(r,t),"checkbox"===l.getCellType(e,o)&&l.scenegraph.updateCheckboxCellState(e,o,t);else if(l.stateManager.setCheckedState(e,o,r,t),"checkbox"===l.getCellType(e,o)){let t=l.stateManager.headerCheckedState[r],n=l.stateManager.updateHeaderCheckedState(r,e,o);t!==n&&l.scenegraph.updateHeaderCheckboxCellState(e,o,n)}return}let{checked:c,indeterminate:s}=i.attribute;s?(t||i._handlePointerUp(),i._handlePointerUp()):c?t||i._handlePointerUp():t&&i._handlePointerUp()}function m(e,o,t,l){var r,n;let a=l.scenegraph.getCell(e,o),i=(null==a?void 0:a.getChildByName("checkbox"))||(null==(n=null==(r=null==a?void 0:a.getChildByName("checkbox-content"))?void 0:r._checkboxGroup)?void 0:n.getChildByName("checkbox"));i&&("indeterminate"===t?(i.setAttribute("indeterminate",!0),i.setAttribute("checked",void 0)):(i.setAttribute("indeterminate",void 0),i.setAttribute("checked",t)))}function p(e,o,t){let l,r,{checkedState:n,table:c}=t;if(c.internalProps.transpose?(e=c.getRecordShowIndexByCell(e,0),o=c.getRecordShowIndexByCell(o,0)):(l=c.isPivotTable()?void 0:c.getRecordIndexByCell(0,e),r=c.isPivotTable()?void 0:c.getRecordIndexByCell(0,o)),(0,a.Z)(l)&&(0,a.Z)(r)){if((e=l)>(o=r)){let t=n.get(e.toString());for(let t=e;t>o;t--)n.set(t.toString(),n.get((t-1).toString()));n.set(o.toString(),t)}else if(e<o){let t=n.get(e.toString());for(let t=e;t<o;t++)n.set(t.toString(),n.get((t+1).toString()));n.set(o.toString(),t)}}else if((0,i.Z)(l)&&(0,i.Z)(r)){if((e=l[l.length-1])>(o=r[r.length-1])){let t=n.get(l.toString());for(let t=e;t>o;t--){let e=[...l];e[e.length-1]=t;let o=[...l];o[o.length-1]=t-1,n.set(e.toString(),n.get(o.toString()))}n.set(r.toString(),t)}else if(e<o){let t=n.get(l.toString());for(let t=e;t<o;t++){let e=[...l];e[e.length-1]=t;let o=[...l];o[o.length-1]=t+1,n.set(e.toString(),n.get(o.toString()))}n.set(r.toString(),t)}}}function f(e){let o=[],t=e.dataSource,l=t.dataConfig.groupByRules.length+1;return t.currentIndexedData.forEach((r,n)=>{(0,i.Z)(r)&&r.length===l&&(o[t.getOriginRecordIndexForGroup(r)]=e.stateManager.checkedState.get(r.toString()))}),o}},93947:function(e,o,t){t.d(o,{B5:()=>n,i:()=>r});var l=t(135759);function r(e,o,t){for(let r=0;r<t.length;r++){let n=t[r];if((0,l._Z)(n,e,o))return!0}return!1}function n(e,o,t,r){for(let r=0;r<t.length;r++){let n=t[r];if((0,l.ib)(n,{start:e,end:o}))return!0}return!1}},873975:function(e,o,t){t.d(o,{D:()=>l});function l(e,o,t,l,r){let n=r.getCellLocation(e,o),a=0,i=0,c=!1;"columnHeader"===n?(a=r.getColsWidth(0,r.rowHeaderLevelCount-1)-(0===r.frozenColCount?r.scrollLeft:0),i=r.getRowsHeight(0,o-1)+r.getRowHeight(o)/2,c=!0):"rowHeader"===n&&(i=r.getRowsHeight(0,r.columnHeaderLevelCount-1),a=r.getColsWidth(0,e-1)+r.getColWidth(e)/2,c=!0),r.scenegraph.updateDrill(c,a,i,t,l)}},701092:function(e,o,t){t.d(o,{j:()=>l});function l(e,o,t){t.frozenColCount>0?e!==t.frozenColCount-1?t.setFrozenColCount(e+1):t.setFrozenColCount(0):t.setFrozenColCount(e+1)}},502837:function(e,o,t){t.d(o,{J:()=>i});var l=t(297),r=t(426902),n=t(364776),a=t(615829);function i(e,o){var t,r,i,s,d,u,g,h,w,C,b;let m,p;if("cell"===e.role&&(0,n.Z)(e.mergeStartCol)&&(0,n.Z)(e.mergeStartRow)&&(0,n.Z)(e.mergeEndCol)&&(0,n.Z)(e.mergeEndRow)){let{colStart:t,colEnd:l,rowStart:r,rowEnd:n}=(0,a.e)(e,o.scenegraph);for(let a=t;a<=l;a++)for(let t=r;t<=n;t++){let l=c(o.stateManager,a,t,e);!l||m&&"cellBgColor"!==l||(m=l)}}else"cell"===e.role&&(m=c(o.stateManager,e.col,e.row,e));if(!m)return;let f=o.internalProps.layoutMap;return f.isCornerHeader(e.col,e.row)?p=(null==(t=o.theme.cornerHeaderStyle)?void 0:t.hover)||(null==(r=o.theme.headerStyle)?void 0:r.hover):f.isColumnHeader(e.col,e.row)?p=null==(i=o.theme.headerStyle)?void 0:i.hover:f.isRowHeader(e.col,e.row)?p=null==(s=o.theme.rowHeaderStyle)?void 0:s.hover:f.isBottomFrozenRow(e.col,e.row)?p=(null==(d=o.theme.bottomFrozenStyle)?void 0:d.hover)||(o.isListTable()?null==(u=o.theme.bodyStyle)?void 0:u.hover:null==(g=o.theme.headerStyle)?void 0:g.hover):f.isRightFrozenColumn(e.col,e.row)?p=(null==(h=o.theme.rightFrozenStyle)?void 0:h.hover)||(o.isListTable()?null==(w=o.theme.bodyStyle)?void 0:w.hover:null==(C=o.theme.rowHeaderStyle)?void 0:C.hover):o.isHeader(e.col,e.row)||(p=null==(b=o.theme.bodyStyle)?void 0:b.hover),(0,l.WJ)(m,p,e.col,e.row,o)}function c(e,o,t,l){var n;let a,{highlightScope:i,disableHeader:c,cellPos:s}=e.hover,d=e.table,u=d.isHeader(o,t);if(!u||!c){if(i===r.p.single&&s.col===o&&s.row===t?a="cellBgColor":i===r.p.column&&s.col===o?a=s.col===o&&s.row===t?"cellBgColor":"inlineColumnBgColor":i===r.p.row&&s.row===t?a=s.col===o&&s.row===t?"cellBgColor":"inlineRowBgColor":i===r.p.cross&&(s.col===o&&s.row===t?a="cellBgColor":s.col===o?a="inlineColumnBgColor":s.row===t&&(a="inlineRowBgColor")),a){let e;if(u){let r=d.getHeaderDefine(o,t);e=null==r?void 0:r.disableHeaderHover,l.firstChild&&"axis"===l.firstChild.name&&(null==(n=d.options.hover)?void 0:n.disableAxisHover)&&(e=!0)}else{let l=d.getBodyColumnDefine(o,t);e=null==l?void 0:l.disableHover}e&&(a=void 0)}return a}}},960341:function(e,o,t){t.d(o,{O:()=>u});var l=t(426902),r=t(364776),n=t(615829);function a(e,o,t){let l=e.highPerformanceGetCell(o,t);if("cell"===l.role&&(0,r.Z)(l.mergeStartCol)&&(0,r.Z)(l.mergeStartRow)&&(0,r.Z)(l.mergeEndCol)&&(0,r.Z)(l.mergeEndRow)){let{colStart:o,colEnd:t,rowStart:r,rowEnd:a}=(0,n.e)(l,e);for(let l=o;l<=t;l++)for(let o=r;o<=a;o++){let t=e.highPerformanceGetCell(l,o);"cell"===t.role&&t.addUpdateBoundTag()}}else l.addUpdateBoundTag()}function i(e,o,t,l,r){let n=e.table;for(let t=0;t<n.columnHeaderLevelCount;t++)a(e,o,t);let i=e.getColGroup(o);return null==i||i.addUpdateBoundTag(),!0}function c(e,o,t,l,r,n){let i=e.table;for(let t=0;t<i.columnHeaderLevelCount;t++)a(e,o,t);let c=e.getColGroup(o);return null==c||c.addUpdateBoundTag(),!0}function s(e,o,t,l,r){let n=e.table;for(let o=0;o<n.colCount;o++)a(e,o,t);return!0}function d(e,o,t,l,r,n){let i=e.table;for(let o=0;o<i.colCount;o++)a(e,o,t);return!0}function u(e,o,t){var r;let{table:n}=e,{scenegraph:u}=n,{highlightScope:g,singleStyle:h,disableHeader:w,cellPos:C,cellPosContainHeader:b}=e.hover,m=C.col,p=C.row;if(g===l.p.none||w&&(b.col!==o||b.row!==t)){let e=b.col,l=b.row;u.hideHoverIcon(e,l),u.showHoverIcon(o,t),b.col=o,b.row=t}if((w&&n.isHeader(o,t)||g===l.p.none)&&(o=-1,t=-1),m===o&&p===t)return;C.col=o,C.row=t,(null==(r=e.table.options.customConfig)?void 0:r.disableBuildInChartActive)||(u.deactivateChart(m,p),u.activateChart(o,t));let f=!1,{ranges:v,highlightScope:S}=e.select;if(-1!==m&&-1!==p&&(f=function(e,o,t,r,n,c,d){let u=!1;return c===l.p.single?(a(e,o,t),u=!0):c===l.p.row?u=!!s(e,o,t,r,d)||u:c===l.p.column?u=!!i(e,o,t,r,d)||u:c===l.p.cross&&(u=!!s(e,o,t,r,d)||u,u=!!i(e,o,t,r,d)||u),u}(u,m,p,v,0,g,S),w||u.hideHoverIcon(m,p)),-1===o||-1===t)return C.col=-1,C.row=-1,void(!f||m===o&&p===t||e.table.scenegraph.updateNextFrame());g===l.p.single?(a(u,o,t),f=!0):g===l.p.row?f=!!d(u,o,t,v,S,h)||f:g===l.p.column?f=!!c(u,o,t,v,S,h)||f:g===l.p.cross&&(f=!!d(u,o,t,v,S,h)||f,f=!!c(u,o,t,v,S,h)||f),g===l.p.none||w||u.showHoverIcon(o,t),f&&e.table.scenegraph.updateNextFrame()}},301999:function(e,o,t){t.d(o,{Oq:()=>i,Wg:()=>c,fM:()=>s,tO:()=>u,vj:()=>d});var l=t(704654),r=t(364776),n=t(480971),a=t(863778);function i(e,o,t,r,n,a){let i=a.table.getRecordShowIndexByCell(e,o);if(i>=0){let e=a.table.dataSource.getIndexKey(i);"column"===r?(0,l.Z)(n)?(a.radioState[t]={},a.radioState[t][e]=n):a.radioState[t]=e:(a.radioState[t]||(a.radioState[t]={}),(0,l.Z)(n)?a.radioState[t][e]=n:a.radioState[t][e]=!0)}}function c(e,o,t){var a;let i=t.getBodyColumnDefine(e,o),c=null==i?void 0:i.field,s=t.getCellType(e,o);if((0,r.Z)(c)&&"radio"===s){let r=t.dataSource.getIndexKey(t.getRecordShowIndexByCell(e,o)),i=null==(a=t.stateManager.radioState)?void 0:a[c];if((0,l.Z)(i)){if(i===r)return!0}else if((0,n.Z)(i)){let e=i[r];if((0,l.Z)(e))return e}}return!1}function s(e,o,t,i,c,s,d){var u,g,h,w,C;let b=d.table.getRecordShowIndexByCell(e,o);if(b>=0){let e=d.table.dataSource.getIndexKey(b);if("column"===i){if(!(0,r.Z)(d.radioState[t])&&s)return(0,l.Z)(c)?(d.radioState[t]={},d.radioState[t][e]=c):d.radioState[t]=e,!0;if((0,l.Z)(d.radioState[t])&&!(0,l.Z)(c))return d.radioState[t]===e;if((0,l.Z)(d.radioState[t])&&(0,l.Z)(c)||(0,n.Z)(d.radioState[t])&&!(0,l.Z)(c))return!1;if((0,n.Z)(d.radioState[t])&&(0,l.Z)(c))return d.radioState[t][e]===c}else if("cell"===i){if(!(0,r.Z)(d.radioState[t])&&s)return d.radioState[t]={},(0,l.Z)(c)?d.radioState[t][e]=c:d.radioState[t][e]=!0,!0;if(!(0,r.Z)(null==(u=d.radioState[t])?void 0:u[e])&&s)return(0,l.Z)(c)?d.radioState[t][e]=c:d.radioState[t][e]=!0,!0;if((0,a.Z)(null==(g=d.radioState[t])?void 0:g[e])&&!(0,l.Z)(c))return d.radioState[t][e];if((0,a.Z)(null==(h=d.radioState[t])?void 0:h[e])&&(0,l.Z)(c)||(0,l.Z)(null==(w=d.radioState[t])?void 0:w[e])&&!(0,l.Z)(c))return!1;if((0,l.Z)(null==(C=d.radioState[t])?void 0:C[e])&&(0,l.Z)(c))return d.radioState[t][e]===c}}return s}function d(e,o,t,r){let n=r.scenegraph.getCell(e,o);if(n)if((0,l.Z)(t)){let e=n.getChildAt(t);null==e||e._handlePointerUp()}else{let e=n.getChildByName("radio");null==e||e._handlePointerUp()}}function u(e,o,t){let{radioState:l,table:r}=t;if(r.internalProps.transpose?(e=r.getRecordShowIndexByCell(e,0),o=r.getRecordShowIndexByCell(o,0)):(e=r.getRecordShowIndexByCell(0,e),o=r.getRecordShowIndexByCell(0,o)),e>o){let t=l[e];for(let t=e;t>o;t--)l[t]=l[t-1];l[o]=t}else if(e<o){let t=l[e];for(let t=e;t<o;t++)l[t]=l[t+1];l[o]=t}}},239903:function(e,o,t){function l(e,o,t){var l;e=Math.ceil(e),o=Math.ceil(o);let n=t.columnResize.isRightFrozen?t.columnResize.x-e:e-t.columnResize.x;if(1>Math.abs(n))return;let a=t.table.getColWidth(t.columnResize.col),i=a;i+=n;let c=t.table.getMinColWidth(t.columnResize.col),s=t.table.getMaxColWidth(t.columnResize.col);if(i<c||i>s){if(a===c||a===s)return;n=a-c>s-a?s-a:c-a}let d=t.table.getColWidth(t.columnResize.col)+n;if(d<t.table.internalProps.limitMinWidth&&(n=(d=t.table.internalProps.limitMinWidth)-t.table.getColWidth(t.columnResize.col)),"adaptive"===t.table.widthMode&&t.columnResize.col<t.table.colCount-1){let e=t.table.getColWidth(t.columnResize.col+1),o=t.table.getMinColWidth(t.columnResize.col+1),l=t.table.getMaxColWidth(t.columnResize.col+1),r=e;if((r-=n)<o||r>l){if(e===o||e===l)return;n=e-o>l-e?l-e:o-e}r-n<t.table.internalProps.limitMinWidth&&(n=r-t.table.internalProps.limitMinWidth)}n=Math.ceil(n),t.columnResize.col<t.table.rowHeaderLevelCount||t.columnResize.col>=t.table.colCount-t.table.rightFrozenColCount?r(n,t):"indicator"===t.table.internalProps.columnResizeType?function(e,o){let t,l,r,n=o.table.internalProps.layoutMap;if(n.indicatorsAsCol)t=n.getIndicatorKey(o.columnResize.col,o.table.columnHeaderLevelCount);else{let e=n.getCellHeaderPaths(o.columnResize.col,o.table.columnHeaderLevelCount-1),t=e.colHeaderPaths[e.colHeaderPaths.length-1];l=t.dimensionKey,r=t.value}for(let a=o.table.rowHeaderLevelCount;a<o.table.colCount-o.table.rightFrozenColCount;a++){let i=n.getIndicatorKey(a,o.table.columnHeaderLevelCount);if(n.indicatorsAsCol&&i===t)o.table.scenegraph.updateColWidth(a,e),o.table.internalProps._widthResizedColMap.add(a);else if(!n.indicatorsAsCol){let t=n.getCellHeaderPaths(a,o.table.columnHeaderLevelCount-1),i=null==t?void 0:t.colHeaderPaths[t.colHeaderPaths.length-1];i&&l===i.dimensionKey&&r===i.value&&(o.table.scenegraph.updateColWidth(a,e),o.table.internalProps._widthResizedColMap.add(a))}}}(n,t):"indicatorGroup"===t.table.internalProps.columnResizeType?function(e,o){let t=o.table.internalProps.layoutMap,l=t.getCellHeaderPaths(o.columnResize.col,o.table.columnHeaderLevelCount),r=t.getHeadNodeByRowOrColDimensions(l.colHeaderPaths.slice(0,l.colHeaderPaths.length-1)),n=r.startInTotal+o.table.frozenColCount,a=r.startInTotal+o.table.frozenColCount+r.size-1,i=o.table.getColsWidth(n,a);for(let l=n;l<=a;l++){if(!(o.table.internalProps.transpose||o.table.isPivotTable()&&!t.indicatorsAsCol)){let e=t.getBody(l,o.table.columnHeaderLevelCount);if(null==e?void 0:e.disableColumnResize)continue}let r=o.table.getColWidth(l)/i*e;r>0&&r<.5?r=.5:r<0&&r>=-.5&&(r=-.5),o.table.scenegraph.updateColWidth(l,r),o.table.internalProps._widthResizedColMap.add(l)}}(n,t):"all"===t.table.internalProps.columnResizeType?function(e,o){let t=o.table.internalProps.layoutMap;for(let l=o.table.frozenColCount;l<o.table.colCount-o.table.rightFrozenColCount;l++){if(!(o.table.internalProps.transpose||o.table.isPivotTable()&&!t.indicatorsAsCol)){let e=t.getBody(l,o.table.columnHeaderLevelCount);if(null==e?void 0:e.disableColumnResize)continue}o.table.scenegraph.updateColWidth(l,e),o.table.internalProps._widthResizedColMap.add(l)}}(n,t):r(n,t),t.columnResize.x=e,t.table.scenegraph.component.updateResizeCol(t.columnResize.col,o,t.columnResize.isRightFrozen),t.table._updateSize(),null==(l=t.table.internalProps.legends)||l.forEach(e=>{null==e||e.resize()}),t.table.internalProps.title&&t.table.internalProps.title.resize(),t.table.internalProps.emptyTip&&t.table.internalProps.emptyTip.resize(),!(t.columnResize.col<t.table.frozenColCount)||t.table.isPivotTable()||t.table.transpose?t.table.options.frozenColCount&&t.table.scenegraph.component.setFrozenColumnShadow(t.table.frozenColCount-1):t.table.scenegraph.component.setFrozenColumnShadow(t.table.frozenColCount-1,t.columnResize.isRightFrozen),(t.columnResize.col>=t.table.colCount-t.table.rightFrozenColCount&&!t.table.isPivotTable()&&!t.table.transpose||t.table.options.rightFrozenColCount)&&t.table.scenegraph.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount),t.table.scenegraph.updateNextFrame()}function r(e,o){"adaptive"===o.table.widthMode&&o.columnResize.col<o.table.colCount-1?(o.table.scenegraph.updateColWidth(o.columnResize.col,e),o.table.scenegraph.updateColWidth(o.columnResize.col+1,-e),o.table.internalProps._widthResizedColMap.add(o.columnResize.col),o.table.internalProps._widthResizedColMap.add(o.columnResize.col+1)):(o.table.scenegraph.updateColWidth(o.columnResize.col,e),o.table.internalProps._widthResizedColMap.add(o.columnResize.col))}t.d(o,{n:()=>l})},800790:function(e,o,t){function l(e,o,t){var l;e=Math.ceil(e),o=Math.ceil(o);let n=t.rowResize.isBottomFrozen?t.rowResize.y-o:o-t.rowResize.y;if(1>Math.abs(n))return;t.table.getRowHeight(t.rowResize.row);let a=t.table.getRowHeight(t.rowResize.row)+n;if(a<t.table.internalProps.limitMinHeight&&(n=(a=t.table.internalProps.limitMinHeight)-t.table.getRowHeight(t.rowResize.row)),"adaptive"===t.table.heightMode&&t.rowResize.row<t.table.rowCount-1){let e=t.table.getRowHeight(t.rowResize.row+1);(e-=n)-n<t.table.internalProps.limitMinHeight&&(n=e-t.table.internalProps.limitMinHeight)}n=Math.ceil(n),t.rowResize.row<t.table.columnHeaderLevelCount||t.rowResize.row>=t.table.rowCount-t.table.bottomFrozenRowCount?r(n,t):"indicator"===t.table.internalProps.rowResizeType?function(e,o){var t,l;let r,n,a,i=o.table.internalProps.layoutMap;if(i.indicatorsAsCol){let e=i.getCellHeaderPaths(o.table.rowHeaderLevelCount-1,o.rowResize.row),l=null==(t=e.rowHeaderPaths)?void 0:t[e.rowHeaderPaths.length-1];n=null==l?void 0:l.dimensionKey,a=null==l?void 0:l.value}else r=i.getIndicatorKey(o.table.rowHeaderLevelCount,o.rowResize.row);for(let t=o.table.columnHeaderLevelCount;t<o.table.rowCount-o.table.bottomFrozenRowCount;t++){let c=i.getIndicatorKey(o.table.rowHeaderLevelCount,t);if(i.indicatorsAsCol||c!==r){if(i.indicatorsAsCol){let r=i.getCellHeaderPaths(o.table.rowHeaderLevelCount-1,t),c=null==(l=null==r?void 0:r.rowHeaderPaths)?void 0:l[r.rowHeaderPaths.length-1];c&&n===c.dimensionKey&&a===c.value&&(o.table.scenegraph.updateRowHeight(t,e),o.table.internalProps._heightResizedRowMap.add(t))}}else o.table.scenegraph.updateRowHeight(t,e),o.table.internalProps._heightResizedRowMap.add(t)}}(n,t):"indicatorGroup"===t.table.internalProps.rowResizeType?function(e,o){let t=o.table.internalProps.layoutMap,l=t.getCellHeaderPaths(o.table.rowHeaderLevelCount,o.rowResize.row),r=t.getHeadNodeByRowOrColDimensions(l.rowHeaderPaths.slice(0,l.rowHeaderPaths.length-1)),n=r.startInTotal+o.table.frozenRowCount,a=r.startInTotal+o.table.frozenRowCount+r.size-1,i=o.table.getRowsHeight(n,a);for(let t=n;t<=a;t++){let l=o.table.getRowHeight(t)/i*e;l>0&&l<.5?l=.5:l<0&&l>=-.5&&(l=-.51),o.table.scenegraph.updateRowHeight(t,l),o.table.internalProps._heightResizedRowMap.add(t)}}(n,t):"all"===t.table.internalProps.rowResizeType?function(e,o){for(let t=o.table.frozenRowCount;t<o.table.rowCount-o.table.bottomFrozenRowCount;t++)o.table.scenegraph.updateRowHeight(t,e),o.table.internalProps._heightResizedRowMap.add(t)}(n,t):r(n,t),t.rowResize.y=o,t.table.scenegraph.component.updateResizeRow(t.rowResize.row,e,t.rowResize.isBottomFrozen),t.table._updateSize(),null==(l=t.table.internalProps.legends)||l.forEach(e=>{null==e||e.resize()}),t.table.internalProps.title&&t.table.internalProps.title.resize(),t.table.internalProps.emptyTip&&t.table.internalProps.emptyTip.resize(),t.table.scenegraph.updateNextFrame()}function r(e,o){"adaptive"===o.table.heightMode&&o.rowResize.row<o.table.rowCount-1?(o.table.scenegraph.updateRowHeight(o.rowResize.row,e),o.table.scenegraph.updateRowHeight(o.rowResize.row+1,-e),o.table.internalProps._heightResizedRowMap.add(o.rowResize.row),o.table.internalProps._heightResizedRowMap.add(o.rowResize.row+1)):(o.table.scenegraph.updateRowHeight(o.rowResize.row,e),o.table.internalProps._heightResizedRowMap.add(o.rowResize.row))}t.d(o,{u:()=>l})},564463:function(e,o,t){t.d(o,{$:()=>a,O:()=>n});var l=t(300434),r=t(106108);function n(e){let{customSelectedRangeComponents:o}=e.table.scenegraph;o.forEach((e,o)=>{e.rect.delete()}),o.clear(),e.select.customSelectRanges=[]}function a(e,o){e.forEach(e=>{(0,r.K)(o.table.scenegraph,e.range,e.style)}),o.select.customSelectRanges=e,(0,l.Iy)(o.table.scenegraph),o.table.scenegraph.updateNextFrame()}},859582:function(e,o,t){t.d(o,{wP:()=>d,zh:()=>c});var l=t(297),r=t(426902),n=t(364776),a=t(615829),i=t(135759);function c(e,o){var t,r,i,c,d,u,g,h,w,C,b;let m,p;if("cell"===e.role&&(0,n.Z)(e.mergeStartCol)&&(0,n.Z)(e.mergeStartRow)&&(0,n.Z)(e.mergeEndCol)&&(0,n.Z)(e.mergeEndRow)){let{colStart:t,colEnd:l,rowStart:r,rowEnd:n}=(0,a.e)(e,o.scenegraph);for(let a=t;a<=l;a++)for(let t=r;t<=n;t++){let l=s(o.stateManager,a,t,e);!l||m&&"cellBgColor"!==l||(m=l)}}else"cell"===e.role&&(m=s(o.stateManager,e.col,e.row,e));if(!m)return;let f=o.internalProps.layoutMap;return f.isCornerHeader(e.col,e.row)?p=(null==(t=o.theme.cornerHeaderStyle)?void 0:t.select)||(null==(r=o.theme.headerStyle)?void 0:r.select):f.isColumnHeader(e.col,e.row)?p=null==(i=o.theme.headerStyle)?void 0:i.select:f.isRowHeader(e.col,e.row)?p=null==(c=o.theme.rowHeaderStyle)?void 0:c.select:f.isBottomFrozenRow(e.col,e.row)?p=(null==(d=o.theme.bottomFrozenStyle)?void 0:d.select)||(o.isListTable()?null==(u=o.theme.bodyStyle)?void 0:u.select:null==(g=o.theme.headerStyle)?void 0:g.select):f.isRightFrozenColumn(e.col,e.row)?p=(null==(h=o.theme.rightFrozenStyle)?void 0:h.select)||(o.isListTable()?null==(w=o.theme.bodyStyle)?void 0:w.select:null==(C=o.theme.rowHeaderStyle)?void 0:C.select):o.isHeader(e.col,e.row)||(p=null==(b=o.theme.bodyStyle)?void 0:b.select),(0,l.WJ)(m,p,e.col,e.row,o)}function s(e,o,t,l){var n;let a,{highlightInRange:c,disableHeader:s,ranges:u}=e.select,g=1===u.length&&((n=null==u?void 0:u[0]).start.col!==n.end.col||n.start.row!==n.end.row)&&c;if(g?1===(null==u?void 0:u.length)&&u[0].start&&u[0].end:1===(null==u?void 0:u.length)&&u[0].end.col===u[0].start.col&&u[0].end.row===u[0].start.row){if(e.table.isHeader(o,t)&&s)return;(a=g?function(e,o,t){let l,{highlightScope:n,cellPos:a,ranges:c}=e.select,s=c[0],d=Math.min(s.start.col,s.end.col),u=Math.max(s.start.col,s.end.col),g=Math.min(s.start.row,s.end.row),h=Math.max(s.start.row,s.end.row);return n===r.p.single&&a.col===o&&a.row===t?l="cellBgColor":n===r.p.column&&o>=d&&o<=u?l=(0,i._Z)(c[0],o,t)?"cellBgColor":"inlineColumnBgColor":n===r.p.row&&t>=g&&t<=h?l=(0,i._Z)(c[0],o,t)?"cellBgColor":"inlineRowBgColor":n===r.p.cross&&((0,i._Z)(c[0],o,t)?l="cellBgColor":o>=d&&o<=u?l="inlineColumnBgColor":t>=g&&t<=h&&(l="inlineRowBgColor")),l}(e,o,t):function(e,o,t){let l,{highlightScope:n,cellPos:a}=e.select;return n===r.p.single&&a.col===o&&a.row===t?l="cellBgColor":n===r.p.column&&a.col===o?l=a.col===o&&a.row===t?"cellBgColor":"inlineColumnBgColor":n===r.p.row&&a.row===t?l=a.col===o&&a.row===t?"cellBgColor":"inlineRowBgColor":n===r.p.cross&&(a.col===o&&a.row===t?l="cellBgColor":a.col===o?l="inlineColumnBgColor":a.row===t&&(l="inlineRowBgColor")),l}(e,o,t))&&d(e.table,o,t)&&(a=void 0)}else if("replace"===e.table.theme.selectionStyle.selectionFillMode)for(let e=0;e<u.length;e++){let l=u[e],r=Math.min(l.start.col,l.end.col),n=Math.max(l.start.col,l.end.col),i=Math.min(l.start.row,l.end.row),c=Math.max(l.start.row,l.end.row);if(r<=o&&i<=t&&n>=o&&c>=t){a="cellBgColor";break}}return a}function d(e,o,t){var l,r;let n=null==(l=e.options.select)?void 0:l.disableSelect;if("function"==typeof n?n(o,t,e):n)return!0;if(e.isHeader(o,t)){let l=null==(r=e.options.select)?void 0:r.disableHeaderSelect;if(l)return!0;let n=e.getHeaderDefine(o,t);if(l=null==n?void 0:n.disableHeaderSelect)return!0}else{let l=e.getBodyColumnDefine(o,t),r=null==l?void 0:l.disableSelect;if("function"==typeof r?r(o,t,e):r)return!0}return!1}},882015:function(e,o,t){t.d(o,{u:()=>n,w:()=>a});var l=t(364776),r=t(426902);function n(e,o,t,a,i,c,s=!0,d=!1){var u,g;let{table:h,interactionState:w}=e,{scenegraph:C}=h,{cellPos:b}=e.select;if(e.select.isSelectAll=c,-1!==o&&-1!==t&&s&&h._makeVisibleCell(o,t),-1!==o&&-1!==t&&s)if(w===r.F.grabing&&e.select.ranges.length>0){let l=e.select.ranges[e.select.ranges.length-1];o>l.start.col&&o>l.end.col&&h._makeVisibleCell(o+1,t),t>l.start.row&&t>l.end.row&&h._makeVisibleCell(o,t+1),o<l.start.col&&o<l.end.col&&h._makeVisibleCell(o-1,t),t<l.start.row&&t<l.end.row&&h._makeVisibleCell(o,t-1)}else h._makeVisibleCell(o,t);if(c){e.select.ranges=[],C.deleteAllSelectBorder();let o=0,t=0,{disableHeaderSelect:l,disableRowSeriesNumberSelect:r}=(null==(u=h.options.keyboardOptions)?void 0:u.selectAllOnCtrlA)||{};l&&(o=h.rowHeaderLevelCount,t=h.columnHeaderLevelCount),(r||l&&h.transpose)&&h.options.rowSeriesNumber&&(o+=1),e.select.ranges.push({start:{col:o,row:t},end:{col:h.colCount-1,row:h.rowCount-1}});let n=e.select.ranges[e.select.ranges.length-1];C.updateCellSelectBorder(n,!1)}else if(-1===b.col||-1===b.row||-1!==o&&-1!==t)if(w!==r.F.default||h.eventManager.isDraging||h.stateManager.isResizeCol()){if((w===r.F.grabing||h.eventManager.isDraging)&&!h.stateManager.isResizeCol()){let r=!(0,l.Z)(d)||!d;-1===b.col&&(b.col=o),-1===b.row&&(b.row=t),b.col=o,b.row=t;let n=e.select.ranges[e.select.ranges.length-1];if(n){if(h.internalProps.layoutMap.isSeriesNumberInBody(n.start.col,n.start.row))r=!1,n.end={col:h.colCount-1,row:t};else if(e.fillHandle.isFilling){if("top"===e.fillHandle.direction)if(t===e.fillHandle.beforeFillMinRow&&t===e.fillHandle.beforeFillMaxRow)n.start.row=n.end.row=t;else if(t<=e.fillHandle.beforeFillMinRow){if(n.start.row<n.end.row){let e=n.start.row;n.start.row=n.end.row,n.end.row=e}n.end.row=t}else t===e.fillHandle.beforeFillMaxRow&&(n.start.row>n.end.row?n.start.row=t:n.end.row=t);else if("bottom"===e.fillHandle.direction){if(t>=e.fillHandle.beforeFillMaxRow){if(n.start.row>n.end.row){let e=n.start.row;n.start.row=n.end.row,n.end.row=e}n.end.row=t}}else if("left"===e.fillHandle.direction)if(o===e.fillHandle.beforeFillMinCol&&o===e.fillHandle.beforeFillMaxCol)n.start.col=n.end.col=o;else if(o<=e.fillHandle.beforeFillMinCol){if(n.start.col<n.end.col){let e=n.start.col;n.start.col=n.end.col,n.end.col=e}n.end.col=o}else o===e.fillHandle.beforeFillMaxCol&&(n.start.col>n.end.col?n.start.col=o:n.end.col=o);else if("right"===e.fillHandle.direction&&o>=e.fillHandle.beforeFillMaxCol){if(n.start.col>n.end.col){let e=n.start.col;n.start.col=n.end.col,n.end.col=e}n.end.col=o}}else{n.end={col:o,row:t};let l=d?{start:{col:o,row:t},end:{col:o,row:t}}:h.getCellRange(o,t);n.start.col<l.end.col?n.end.col=l.end.col:n.start.col>l.start.col&&(n.end.col=l.start.col),n.start.row<l.end.row?n.end.row=l.end.row:n.start.row>l.start.row&&(n.end.row=l.start.row),"body"===e.select.headerSelectMode&&(h.isRowHeader(o,t)?(n.start.col=h.rowHeaderLevelCount+h.leftRowSeriesNumberCount,n.end.col=h.colCount-1):h.isColumnHeader(o,t)?(n.start.row=h.columnHeaderLevelCount,n.end.row=h.rowCount-1):h.internalProps.layoutMap.isSeriesNumberInBody(o,t)?(n.start.col=h.leftRowSeriesNumberCount,n.end.col=h.colCount-1):h.isCornerHeader(o,t)?(n.start.col=h.rowHeaderLevelCount+h.leftRowSeriesNumberCount,n.start.row=h.columnHeaderLevelCount,n.end.col=h.colCount-1,n.end.row=h.rowCount-1):h.isSeriesNumber(o,t)&&(n.start.col=h.leftRowSeriesNumberCount,n.start.row=h.columnHeaderLevelCount,n.end.col=h.colCount-1,n.end.row=h.rowCount-1)),d&&(n.skipBodyMerge=!0)}n&&n.start.row<=h.rowCount-1&&n.end.row<=h.rowCount-1&&n.start.col<=h.colCount-1&&n.end.col<=h.colCount-1&&C.updateCellSelectBorder(n,r)}}}else{let r=e.select.ranges[e.select.ranges.length-1];if(a&&r){if("cell"!==e.select.headerSelectMode&&h.isColumnHeader(o,t)){let l=Math.min(r.start.col,r.end.col,o),n=Math.max(r.start.col,r.end.col,o),a=Math.min(r.start.row,r.end.row,t),i=h.rowCount-1;"body"===e.select.headerSelectMode?(r.start={col:l,row:h.columnHeaderLevelCount},r.end={col:n,row:h.rowCount-1}):(r.start={col:l,row:a},r.end={col:n,row:i})}else if("cell"!==e.select.headerSelectMode&&h.isRowHeader(o,t)){let l=Math.min(r.start.col,r.end.col,o),n=h.colCount-1,a=Math.min(r.start.row,r.end.row,t),i=Math.max(r.start.row,r.end.row,t);"body"===e.select.headerSelectMode?(r.start={col:h.leftRowSeriesNumberCount+h.rowHeaderLevelCount,row:a},r.end={col:h.colCount-1,row:i}):(r.start={col:l,row:a},r.end={col:n,row:i})}else if("cell"!==e.select.headerSelectMode&&h.isSeriesNumberInBody(o,t)){let l=Math.min(r.start.col,r.end.col,o),n=h.colCount-1,a=Math.min(r.start.row,r.end.row,t),i=Math.max(r.start.row,r.end.row,t);"body"===e.select.headerSelectMode?(r.start={col:h.leftRowSeriesNumberCount,row:a},r.end={col:h.colCount-1,row:i}):(r.start={col:l,row:a},r.end={col:n,row:i})}else r.end={col:o,row:t};a||(r.end=r.start),C.deleteLastSelectedRangeComponents(),C.updateCellSelectBorder(r)}else{let r=!(0,l.Z)(d)||!d;if(-1===b.col||-1===b.row||i||(e.select.ranges=[],C.deleteAllSelectBorder()),"cell"!==e.select.headerSelectMode&&h.isColumnHeader(o,t)){let l=h.getCellRange(o,t);"body"===e.select.headerSelectMode?e.select.ranges.push({start:{col:l.start.col,row:h.columnHeaderLevelCount},end:{col:l.end.col,row:h.rowCount-1},skipBodyMerge:!0}):e.select.ranges.push({start:{col:l.start.col,row:l.start.row},end:{col:l.end.col,row:h.rowCount-1},skipBodyMerge:!0})}else if("cell"!==e.select.headerSelectMode&&h.isRowHeader(o,t)){let l=h.getCellRange(o,t);"body"===e.select.headerSelectMode?e.select.ranges.push({start:{col:h.rowHeaderLevelCount+h.leftRowSeriesNumberCount,row:l.start.row},end:{col:h.colCount-1,row:l.end.row},skipBodyMerge:!0}):e.select.ranges.push({start:{col:l.start.col,row:l.start.row},end:{col:h.colCount-1,row:l.end.row},skipBodyMerge:!0})}else if(h.internalProps.layoutMap.isSeriesNumberInHeader(o,t)){r=!1;let{cornerHeaderSelectMode:l}=e.select;if("body"===l)e.select.ranges.push({start:{col:h.leftRowSeriesNumberCount,row:h.columnHeaderLevelCount},end:{col:h.colCount-1,row:h.rowCount-1},skipBodyMerge:!0});else if("inline"===l){let l=d?{start:{col:o,row:t},end:{col:o,row:t}}:h.getCellRange(o,t);e.select.ranges.push({start:{col:l.start.col,row:l.start.row},end:{col:l.end.col,row:h.rowCount-1},skipBodyMerge:!0})}else if("cell"===l){let l=d?{start:{col:o,row:t},end:{col:o,row:t}}:h.getCellRange(o,t);e.select.ranges.push({start:{col:l.start.col,row:l.start.row},end:{col:l.end.col,row:l.end.row},skipBodyMerge:d||void 0})}else e.select.ranges.push({start:{col:0,row:0},end:{col:h.colCount-1,row:h.rowCount-1},skipBodyMerge:!0})}else if(h.internalProps.layoutMap.isSeriesNumberInBody(o,t))r=!1,"body"===e.select.headerSelectMode?e.select.ranges.push({start:{col:h.leftRowSeriesNumberCount,row:t},end:{col:h.colCount-1,row:t},skipBodyMerge:!0}):e.select.ranges.push({start:{col:o,row:t},end:{col:h.colCount-1,row:t},skipBodyMerge:!0});else if(h.internalProps.layoutMap.isCornerHeader(o,t)){r=!1;let{cornerHeaderSelectMode:l}=e.select;if("body"===l)e.select.ranges.push({start:{col:h.rowHeaderLevelCount+h.leftRowSeriesNumberCount,row:h.columnHeaderLevelCount},end:{col:h.colCount-1,row:h.rowCount-1},skipBodyMerge:!0});else if("cell"===l){let l=d?{start:{col:o,row:t},end:{col:o,row:t}}:h.getCellRange(o,t);e.select.ranges.push({start:{col:l.start.col,row:l.start.row},end:{col:l.end.col,row:l.end.row},skipBodyMerge:d||void 0})}else if("inline"===l){let l=d?{start:{col:o,row:t},end:{col:o,row:t}}:h.getCellRange(o,t);e.select.ranges.push({start:{col:l.start.col,row:l.start.row},end:{col:l.end.col,row:h.rowCount-1},skipBodyMerge:!0})}else e.select.ranges.push({start:{col:h.leftRowSeriesNumberCount,row:0},end:{col:h.colCount-1,row:h.rowCount-1},skipBodyMerge:!0})}else if(o>=0&&t>=0){let l=d?{start:{col:o,row:t},end:{col:o,row:t}}:h.getCellRange(o,t);e.select.ranges.push({start:{col:l.start.col,row:l.start.row},end:{col:l.end.col,row:l.end.row},skipBodyMerge:d||void 0})}b.col=o,b.row=t;let n=null==(g=e.select.ranges)?void 0:g[e.select.ranges.length-1];n&&n.start.row<=h.rowCount-1&&n.end.row<=h.rowCount-1&&n.start.col<=h.colCount-1&&n.end.col<=h.colCount-1&&C.updateCellSelectBorder(n,r)}}else b.col=-1,b.row=-1,e.select.ranges=[],C.deleteAllSelectBorder();C.updateNextFrame()}function a(e){e.moveSelectingRangeComponentsToSelectedRangeComponents()}}}]);