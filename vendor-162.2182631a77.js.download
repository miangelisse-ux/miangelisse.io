/*! For license information please see vendor-162.2182631a77.js.LICENSE.txt */
"use strict";(window.webpackChunkweb=window.webpackChunkweb||[]).push([["89400"],{799127:function(t,e,i){i.d(e,{q:()=>l});var s=i(421883),a=i.n(s),n=i(985476),r=i(818350);class l{constructor(t){var e;let i;this.options=t,this.isDataSet=!0,this.transformMap={},this.parserMap={},this.dataViewMap={},this.target=new(a()),i=(null==t?void 0:t.name)?t.name:(0,r.F)("dataset"),this.name=i,this._logger=null!=(e=null==t?void 0:t.logger)?e:n.Y.getInstance()}setLogger(t){this._logger=t}getDataView(t){return this.dataViewMap[t]}setDataView(t,e){var i;this.dataViewMap[t]&&(null==(i=this._logger)||i.error(`Error: dataView ${t} \u{4E4B}\u{524D}\u{5DF2}\u{5B58}\u{5728}\u{FF0C}\u{8BF7}\u{91CD}\u{65B0}\u{547D}\u{540D}`)),this.dataViewMap[t]=e}removeDataView(t){this.dataViewMap[t]=null,delete this.dataViewMap[t]}registerParser(t,e){var i;this.parserMap[t]&&(null==(i=this._logger)||i.warn(`Warn: transform ${t} \u{4E4B}\u{524D}\u{5DF2}\u{6CE8}\u{518C}\u{FF0C}\u{6267}\u{884C}\u{8986}\u{76D6}\u{903B}\u{8F91}`)),this.parserMap[t]=e}removeParser(t){this.parserMap[t]=null,delete this.parserMap[t]}getParser(t){return this.parserMap[t]||this.parserMap.default}registerTransform(t,e){var i;this.transformMap[t]&&(null==(i=this._logger)||i.warn(`Warn: transform ${t} \u{4E4B}\u{524D}\u{5DF2}\u{6CE8}\u{518C}\u{FF0C}\u{6267}\u{884C}\u{8986}\u{76D6}\u{903B}\u{8F91}`)),this.transformMap[t]=e}removeTransform(t){this.transformMap[t]=null,delete this.transformMap[t]}getTransform(t){return this.transformMap[t]}multipleDataViewAddListener(t,e,i){this._callMap||(this._callMap=new Map);let s=this._callMap.get(i);s||(s=()=>{t.some(t=>t.isRunning)||i()}),t.forEach(t=>{t.target.addListener(e,s)}),this._callMap.set(i,s)}allDataViewAddListener(t,e){this.multipleDataViewAddListener(Object.values(this.dataViewMap),t,e)}multipleDataViewRemoveListener(t,e,i){if(this._callMap){let s=this._callMap.get(i);s&&t.forEach(t=>{t.target.removeListener(e,s)}),this._callMap.delete(i)}}multipleDataViewUpdateInParse(t){t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.markRunning()}),t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.parseNewData(t.data,t.options)})}multipleDataViewUpdateInRawData(t){t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.markRunning()}),t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.updateRawData(t.data,t.options)})}destroy(){this.transformMap=null,this.parserMap=null,this.dataViewMap=null,this._callMap=null,this.target.removeAllListeners()}}},82349:function(t,e,i){i.d(e,{V:()=>f,v:()=>p});var s=i(421883),a=i.n(s),n=i(475133),r=i(551976),l=i(20408),o=i(454326),h=i(818350),d=i(89530),u=i(364776);let g=(t,e)=>{var i,s;if(!(null==e?void 0:e.fields)||0===t.length)return t;let a=e.fields,n=t[0],r={},l=[];for(let e in a)if(Object.prototype.hasOwnProperty.call(a,e)){let o,h=a[e];if(h.sort&&((0,d.Z)(h.sortIndex)||(h.sortIndex=0),(0,u.Z)(h.sortReverse)||(h.sortReverse="desc"===h.sort)),!h.type){let s=n;e in n||(s=null!=(i=t.find(t=>e in t))?i:n),h.type="number"==typeof s[e]?"linear":"ordinal"}if("number"==typeof h.sortIndex&&(o={key:e,type:h.type,index:h.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:!0===h.sortReverse},l.push(o)),(null==(s=h.domain)?void 0:s.length)>0)if("ordinal"===h.type){h._domainCache={},r[e]=h;let t={};h.domain.forEach((e,i)=>{t[e]=i,h._domainCache[e]=i}),o&&(o.sortIndex=t,o.sortIndexCount=h.domain.length)}else h.domain.length>=2&&(r[e]=h)}return Object.keys(r).length>0&&(t=t.filter(t=>{for(let e in r){let i=r[e];if("ordinal"===i.type){if(!(t[e]in i._domainCache))return!1}else if(i.domain[0]>t[e]||i.domain[1]<t[e])return!1}return!0})),l.sort((t,e)=>t.index-e.index),t.sort((t,e)=>(function(t,e,i){for(let s=0;s<i.length;s++){let a=i[s],n=0;if("ordinal"===a.type?(void 0===a.sortIndex[e[a.key]]&&(a.sortIndex[e[a.key]]=a.sortIndexCount++),void 0===a.sortIndex[t[a.key]]&&(a.sortIndex[t[a.key]]=a.sortIndexCount++),n=a.sortIndex[t[a.key]]-a.sortIndex[e[a.key]]):"linear"===a.type&&(n=t[a.key]-e[a.key]),a.sortReverse&&(n=-n),0!==n)return n}return 0})(t,e,l)),t};class f{constructor(t,e){let i;this.dataSet=t,this.options=e,this.isDataView=!0,this.target=new(a()),this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=(t={})=>{let e=this.latestData;return this.isRunning=!0,this.resetTransformData(),this.transformsArr.forEach(e=>{this.executeTransform(e,{pushHistory:t.pushHistory,emitMessage:!1})}),this.isRunning=!1,!1===t.emitMessage||t.skipEqual&&(0,n.X)(e,this.latestData)||this.target.emit("change",{latestData:this.latestData}),this},this.markRunning=()=>{this.isRunning=!0,this.target.emit("markRunning",[])},i=(null==e?void 0:e.name)?e.name:(0,h.F)("dataview"),this.name=i,(null==e?void 0:e.history)&&(this.history=e.history,this.historyData=[]),this.dataSet.setDataView(i,this),this.setFields(null==e?void 0:e.fields)}parse(t,e,i=!1){var s;this.isRunning=!0,i&&this.target.emit("beforeParse",[]),e&&(this.parseOption=e);let a=this.cloneParseData(t,e);if(null==e?void 0:e.type){let t=(null!=(s=this.dataSet.getParser(e.type))?s:this.dataSet.getParser("bytejson"))(a,e.options,this);this.rawData=a,this.parserData=t,this.history&&this.historyData.push(a,t),this.latestData=t}else this.parserData=a,this.rawData=a,this.history&&this.historyData.push(a),this.latestData=a;return this.isRunning=!1,i&&this.target.emit("afterParse",[]),this}transform(t,e=!0){if(this.isRunning=!0,t&&t.type){let i=!0;if("fields"===t.type){this._fields=t.options.fields;let e=this.transformsArr.findIndex(e=>e.type===t.type);e>=0&&(i=!1,this.transformsArr[e].options.fields=this._fields)}i&&this.transformsArr.push(t),e&&this.executeTransform(t)}return this.sortTransform(),this.isRunning=!1,this}sortTransform(){this.transformsArr.length>=2&&this.transformsArr.sort((t,e)=>{var i,s;return(null!=(i=t.level)?i:0)-(null!=(s=e.level)?s:0)})}executeTransform(t,e={}){let{pushHistory:i,emitMessage:s,skipEqual:a}=e,r=this.dataSet.getTransform(t.type),l=this.latestData,o=r(l,t.options);this.history&&!1!==i&&this.historyData.push(o),this.latestData=o,!1===s||a&&(0,n.X)(l,this.latestData)||this.target.emit("change",{latestData:this.latestData})}resetTransformData(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}cloneParseData(t,e){let i=!1;return t instanceof f||!0!==(null==e?void 0:e.clone)||(i=!0),i?(0,r.Z)(t):t}parseNewData(t,e){this.parse(t,e||this.parseOption),this.reRunAllTransform()}updateRawData(t,e){let i=this.cloneParseData(t,e);this.rawData=i,this.parserData=i,this.latestData=i,this.reRunAllTransform()}getFields(){var t;return this._fields?this._fields:"dataview"===(null==(t=this.parseOption)?void 0:t.type)&&1===this.rawData.length&&this.rawData[0].getFields?this.rawData[0].getFields():null}setFields(t,e=!1){this._fields=t&&e?(0,l.Z)({},this._fields,t):t;let i=this.transformsArr.find(t=>"fields"===t.type);!(0,o.Z)(this._fields)&&(0,o.Z)(i)?(this.dataSet.registerTransform("fields",g),this.transform({type:"fields",options:{fields:this._fields}},!1)):i&&(i.options.fields=this._fields)}destroy(){this.dataSet.removeDataView(this.name),this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}}function p(t){return t instanceof f}},818350:function(t,e,i){i.d(e,{F:()=>a});let s=0;function a(t="dataset"){return s>1e8&&(s=0),t+"_"+s++}},769234:function(t,e,i){var s,a;i.d(e,{o:()=>s}),(a=s||(s={})).DSV="dsv",a.TREE="tree",a.GEO="geo",a.BYTE="bytejson",a.HEX="hex",a.GRAPH="graph",a.TABLE="table",a.GEO_GRATICULE="geo-graticule"},586831:function(t,e,i){i.d(e,{q:()=>l});var s=i(421883),a=i.n(s),n=i(473729),r=i(14368);class l{constructor(t){var e;let i;this.options=t,this.isDataSet=!0,this.transformMap={},this.parserMap={},this.dataViewMap={},this.target=new(a()),i=(null==t?void 0:t.name)?t.name:(0,r.F)("dataset"),this.name=i,this._logger=null!=(e=null==t?void 0:t.logger)?e:n.Y.getInstance()}setLogger(t){this._logger=t}getDataView(t){return this.dataViewMap[t]}setDataView(t,e){var i;this.dataViewMap[t]&&(null==(i=this._logger)||i.error(`Error: dataView ${t} \u{4E4B}\u{524D}\u{5DF2}\u{5B58}\u{5728}\u{FF0C}\u{8BF7}\u{91CD}\u{65B0}\u{547D}\u{540D}`)),this.dataViewMap[t]=e}removeDataView(t){this.dataViewMap[t]=null,delete this.dataViewMap[t]}registerParser(t,e){var i;this.parserMap[t]&&(null==(i=this._logger)||i.warn(`Warn: transform ${t} \u{4E4B}\u{524D}\u{5DF2}\u{6CE8}\u{518C}\u{FF0C}\u{6267}\u{884C}\u{8986}\u{76D6}\u{903B}\u{8F91}`)),this.parserMap[t]=e}removeParser(t){this.parserMap[t]=null,delete this.parserMap[t]}getParser(t){return this.parserMap[t]||this.parserMap.default}registerTransform(t,e){var i;this.transformMap[t]&&(null==(i=this._logger)||i.warn(`Warn: transform ${t} \u{4E4B}\u{524D}\u{5DF2}\u{6CE8}\u{518C}\u{FF0C}\u{6267}\u{884C}\u{8986}\u{76D6}\u{903B}\u{8F91}`)),this.transformMap[t]=e}removeTransform(t){this.transformMap[t]=null,delete this.transformMap[t]}getTransform(t){return this.transformMap[t]}multipleDataViewAddListener(t,e,i){this._callMap||(this._callMap=new Map);let s=this._callMap.get(i);s||(s=()=>{t.some(t=>t.isRunning)||i()}),t.forEach(t=>{t.target.addListener(e,s)}),this._callMap.set(i,s)}allDataViewAddListener(t,e){this.multipleDataViewAddListener(Object.values(this.dataViewMap),t,e)}multipleDataViewRemoveListener(t,e,i){if(this._callMap){let s=this._callMap.get(i);s&&t.forEach(t=>{t.target.removeListener(e,s)}),this._callMap.delete(i)}}multipleDataViewUpdateInParse(t){t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.markRunning()}),t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.parseNewData(t.data,t.options)})}multipleDataViewUpdateInRawData(t){t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.markRunning()}),t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.updateRawData(t.data,t.options)})}destroy(){this.transformMap=null,this.parserMap=null,this.dataViewMap=null,this._callMap=null,this.target.removeAllListeners()}}},102094:function(t,e,i){i.d(e,{V:()=>u});var s=i(421883),a=i.n(s),n=i(873173),r=i(516974),l=i(801983),o=i(580164),h=i(14368),d=i(351758);class u{constructor(t,e){let i;this.dataSet=t,this.options=e,this.isDataView=!0,this.target=new(a()),this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=(t={})=>{let e=this.latestData;return this.isRunning=!0,this.resetTransformData(),this.transformsArr.forEach(e=>{this.executeTransform(e,{pushHistory:t.pushHistory,emitMessage:!1})}),this.isRunning=!1,!1===t.emitMessage||t.skipEqual&&(0,n.X)(e,this.latestData)||this.target.emit("change",{latestData:this.latestData}),this},this.markRunning=()=>{this.isRunning=!0,this.target.emit("markRunning",[])},i=(null==e?void 0:e.name)?e.name:(0,h.F)("dataview"),this.name=i,(null==e?void 0:e.history)&&(this.history=e.history,this.historyData=[]),this.dataSet.setDataView(i,this),this.setFields(null==e?void 0:e.fields)}parse(t,e,i=!1){var s;this.isRunning=!0,i&&this.target.emit("beforeParse",[]),e&&(this.parseOption=e);let a=this.cloneParseData(t,e);if(null==e?void 0:e.type){let t=(null!=(s=this.dataSet.getParser(e.type))?s:this.dataSet.getParser("bytejson"))(a,e.options,this);this.rawData=a,this.parserData=t,this.history&&this.historyData.push(a,t),this.latestData=t}else this.parserData=a,this.rawData=a,this.history&&this.historyData.push(a),this.latestData=a;return this.isRunning=!1,i&&this.target.emit("afterParse",[]),this}transform(t,e=!0){if(this.isRunning=!0,t&&t.type){let i=!0;if("fields"===t.type){this._fields=t.options.fields;let e=this.transformsArr.findIndex(e=>e.type===t.type);e>=0&&(i=!1,this.transformsArr[e].options.fields=this._fields)}i&&this.transformsArr.push(t),e&&this.executeTransform(t)}return this.sortTransform(),this.isRunning=!1,this}sortTransform(){this.transformsArr.length>=2&&this.transformsArr.sort((t,e)=>{var i,s;return(null!=(i=t.level)?i:0)-(null!=(s=e.level)?s:0)})}executeTransform(t,e={}){let{pushHistory:i,emitMessage:s,skipEqual:a}=e,r=this.dataSet.getTransform(t.type),l=this.latestData,o=r(l,t.options);this.history&&!1!==i&&this.historyData.push(o),this.latestData=o,!1===s||a&&(0,n.X)(l,this.latestData)||this.target.emit("change",{latestData:this.latestData})}resetTransformData(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}cloneParseData(t,e){let i=!1;return t instanceof u||!0!==(null==e?void 0:e.clone)||(i=!0),i?(0,r.Z)(t):t}parseNewData(t,e){this.parse(t,e||this.parseOption),this.reRunAllTransform()}updateRawData(t,e){let i=this.cloneParseData(t,e);this.rawData=i,this.parserData=i,this.latestData=i,this.reRunAllTransform()}getFields(){var t;return this._fields?this._fields:"dataview"===(null==(t=this.parseOption)?void 0:t.type)&&1===this.rawData.length&&this.rawData[0].getFields?this.rawData[0].getFields():null}setFields(t,e=!1){this._fields=t&&e?(0,l.Z)({},this._fields,t):t;let i=this.transformsArr.find(t=>"fields"===t.type);!(0,o.Z)(this._fields)&&(0,o.Z)(i)?(this.dataSet.registerTransform("fields",d.X),this.transform({type:"fields",options:{fields:this._fields}},!1)):i&&(i.options.fields=this._fields)}destroy(){this.dataSet.removeDataView(this.name),this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}}},736299:function(t,e,i){i.d(e,{i:()=>n});var s=i(674399),a=i(89841);let n=(t,e,i)=>{let n=!(0,s.Z)(null==e?void 0:e.dependencyUpdate)||(null==e?void 0:e.dependencyUpdate);if(!t||!(0,a.Z)(t))throw TypeError("Invalid data: must be DataView array!");return(0,a.Z)(i.rawData)&&i.rawData.forEach(t=>{t.target&&(t.target.removeListener("change",i.reRunAllTransform),t.target.removeListener("markRunning",i.markRunning))}),n&&t.forEach(t=>{t.target.addListener("change",i.reRunAllTransform),t.target.addListener("markRunning",i.markRunning)}),t}},399166:function(t,e,i){i.d(e,{$W:()=>d,UI:()=>u,mK:()=>g});var s=i(837330),a=i(848463),n=i(173723),r=i(713628),l=i(769234),o=i(376407);let h={delimiter:","},d=(t,e={},i)=>{i.type=l.o.DSV;let{delimiter:a}=(0,o.g)(h,e);if(!(0,r.Z)(a))throw TypeError("Invalid delimiter: must be a string!");return(0,s.Z)(a).parse(t)},u=(t,e={},i)=>(i.type=l.o.DSV,(0,a.ue)(t)),g=(t,e={},i)=>(i.type=l.o.DSV,(0,n.tJ)(t))},813215:function(t,e,i){i.d(e,{_s:()=>d,bL:()=>g});var s=i(470522),a=i(769234),n=i(376407),r=i(768933),l=i(876574),o=i(458539);let h=(0,s.Z)(),d={centroid:!1,name:!1,bbox:!1,rewind:!1},u=t=>{if(t.geometry.type.startsWith("Multi")){let e=(0,l.Z)(t).features[0];return Object.assign(Object.assign({},e),e.properties)}return Object.assign(Object.assign({},t),t.properties)},g=(t,e={},i)=>{i.type=a.o.GEO;let{centroid:s,name:l,bbox:g,rewind:f}=(0,n.g)(d,e);if(Array.isArray(t)){let e=[];return t.forEach(t=>{"FeatureCollection"===t.type?t.features.forEach(t=>{e.push(u(t))}):e.push(u(t))}),e}let p=t.features;return f&&(p=(0,r.Z)(t,{reverse:!(0,o.Z)(f)||f.reverse}).features),p.forEach(t=>{if(s){let e=h.centroid(t);t.centroidX=e[0],t.centroidY=e[1]}if(l&&(t.name=t.properties.name),g){let e=h.bounds(t);t.bbox=e}}),t.features=p,t}},131386:function(t,e,i){i.d(e,{Q:()=>h});var s=i(42292),a=i(713628),n=i(769234),r=i(376407),l=i(813215);let o={},h=(t,e,i)=>{i.type=n.o.GEO;let h=(0,r.g)(l._s,o,e),{object:d}=h;if(!(0,a.Z)(d))throw TypeError("Invalid object: must be a string!");let u=(0,s.Z)(t,t.objects[d]);return(0,l.bL)(u,h,i)}},784507:function(t,e,i){i.d(e,{UQ:()=>k});var s=i(470522),a=i(146161),n=i(212648),r=i(780116),l=i(275330),o=i(975055),h=i(410894),d=i(836753),u=i(757297),g=i(626239),f=i(761588),p=i(311551),c=i(195744),y=i(572238),x=i(170923),m=i(710444),v=i(723808);(0,s.Z)();let M={},S={albers:a.Z,albersusa:n.Z,azimuthalequalarea:r.Z,azimuthalequidistant:l.Z,conicconformal:o.Z,conicequalarea:h.Z,conicequidistant:d.Z,equalearth:u.Z,equirectangular:g.Z,gnomonic:f.Z,identity:p.Z,mercator:c.ZP,naturalearth1:y.Z,orthographic:x.Z,stereographic:m.Z,transversemercator:v.Z},_=["clipAngle","clipExtent","scale","translate","center","rotate","precision","reflectX","reflectY","parallels","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function w(t,e){return function i(){let a=e();return a.type=t,a.path=(0,s.Z)().projection(a),a.copy=a.copy||function(){let t=i();return _.forEach(e=>{a[e]&&t[e](a[e]())}),t.path.pointRadius(a.path.pointRadius()),t},a}}function k(t,e){let i=t.toLowerCase();return arguments.length>1?w(i,e):S[i]?(M[i]||(M[i]=w(i,S[i])),M[i]):null}},351758:function(t,e,i){i.d(e,{X:()=>n});var s=i(966353),a=i(479176);let n=(t,e)=>{var i,n;if(!(null==e?void 0:e.fields)||0===t.length)return t;let r=e.fields,l=t[0],o={},h=[];for(let e in r)if(Object.prototype.hasOwnProperty.call(r,e)){let d,u=r[e];if(u.sort&&((0,s.Z)(u.sortIndex)||(u.sortIndex=0),(0,a.Z)(u.sortReverse)||(u.sortReverse="desc"===u.sort)),!u.type){let s=l;e in l||(s=null!=(i=t.find(t=>e in t))?i:l),u.type="number"==typeof s[e]?"linear":"ordinal"}if("number"==typeof u.sortIndex&&(d={key:e,type:u.type,index:u.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:!0===u.sortReverse},h.push(d)),(null==(n=u.domain)?void 0:n.length)>0)if("ordinal"===u.type){u._domainCache={},o[e]=u;let t={};u.domain.forEach((e,i)=>{t[e]=i,u._domainCache[e]=i}),d&&(d.sortIndex=t,d.sortIndexCount=u.domain.length)}else u.domain.length>=2&&(o[e]=u)}return Object.keys(o).length>0&&(t=t.filter(t=>{for(let e in o){let i=o[e];if("ordinal"===i.type){if(!(t[e]in i._domainCache))return!1}else if(i.domain[0]>t[e]||i.domain[1]<t[e])return!1}return!0})),h.sort((t,e)=>t.index-e.index),t.sort((t,e)=>(function(t,e,i){for(let s=0;s<i.length;s++){let a=i[s],n=0;if("ordinal"===a.type?(void 0===a.sortIndex[e[a.key]]&&(a.sortIndex[e[a.key]]=a.sortIndexCount++),void 0===a.sortIndex[t[a.key]]&&(a.sortIndex[t[a.key]]=a.sortIndexCount++),n=a.sortIndex[t[a.key]]-a.sortIndex[e[a.key]]):"linear"===a.type&&(n=t[a.key]-e[a.key]),a.sortReverse&&(n=-n),0!==n)return n}return 0})(t,e,h)),t}},423210:function(t,e,i){i.d(e,{h:()=>s});let s=(t,e)=>{let{callback:i}=e;return i&&(t=t.filter(i)),t}},163281:function(t,e,i){i.d(e,{g:()=>s});let s=(t,e)=>{let{fields:i,key:s,value:a,retains:n}=e,r=[];for(let e=0;e<t.length;e++)i.forEach(l=>{let o={};if(o[s]=l,o[a]=t[e][l],n)n.forEach(i=>{o[i]=t[e][i]});else for(let s in t[e])-1===i.indexOf(s)&&(o[s]=t[e][s]);r.push(o)});return r}},468342:function(t,e,i){i.d(e,{o:()=>l});var s=i(130939),a=i.n(s),n=i(376407);let r={tolerance:.01},l=(t,e)=>{let{tolerance:i}=(0,n.g)(r,e);return a()(t,i)}},376407:function(t,e,i){i.d(e,{g:()=>n});var s=i(516974),a=i(458539);let n=function(t,...e){return function(t,...e){t||(t={});let i=-1,s=e.length;for(;++i<s;){var n=t,r=e[i];if((0,a.Z)(r)&&n!==r)for(let t in r)!function t(e,i,s){let n=i[s];if(void 0===n)e[s]=null;else if((0,a.Z)(n))for(let i in(0,a.Z)(e[s])||(e[s]={}),n)t(e[s],n,i);else e[s]=n}(n,r,t)}return t}((0,s.Z)(t),...e)}},14368:function(t,e,i){i.d(e,{F:()=>a});let s=0;function a(t="dataset"){return s>1e8&&(s=0),t+"_"+s++}},684881:function(t,e,i){i.d(e,{l:()=>k});var s=i(643405),a=i(895611),n=i(473729);function r(t,e){let i=t.radius-e.radius,s=e.x-t.x,a=e.y-t.y;return i<0||i*i<s*s+a*a}function l(t,e){let i=t.radius-e.radius+1e-9*Math.max(t.radius,e.radius,1),s=e.x-t.x,a=e.y-t.y;return i>0&&i*i>s*s+a*a}function o(t,e){for(let i=0;i<e.length;++i)if(!l(t,e[i]))return!1;return!0}function h(t,e){let i=t.x,s=t.y,a=t.radius,n=e.x,r=e.y,l=e.radius,o=n-i,h=r-s,d=l-a,u=Math.sqrt(o*o+h*h);return{x:(i+n+o/u*d)/2,y:(s+r+h/u*d)/2,radius:(u+a+l)/2}}function d(t,e,i){let s=t.x,a=t.y,n=t.radius,r=e.x,l=e.y,o=e.radius,h=i.x,d=i.y,u=i.radius,g=s-r,f=s-h,p=a-l,c=a-d,y=o-n,x=u-n,m=s*s+a*a-n*n,v=m-r*r-l*l+o*o,M=m-h*h-d*d+u*u,S=f*p-g*c,_=(p*M-c*v)/(2*S)-s,w=(c*y-p*x)/S,k=(f*v-g*M)/(2*S)-a,b=(g*x-f*y)/S,z=w*w+b*b-1,R=2*(n+_*w+k*b),F=_*_+k*k-n*n,T=-(Math.abs(z)>1e-6?(R+Math.sqrt(R*R-4*z*F))/(2*z):F/R);return{x:s+_+w*T,y:a+k+b*T,radius:T}}function u(t,e,i){let s,a,n,r,l=t.x-e.x,o=t.y-e.y,h=l*l+o*o;h?(a=e.radius+i.radius,a*=a,r=t.radius+i.radius,a>(r*=r)?(s=(h+r-a)/(2*h),n=Math.sqrt(Math.max(0,r/h-s*s)),i.x=t.x-s*l-n*o,i.y=t.y-s*o+n*l):(s=(h+a-r)/(2*h),n=Math.sqrt(Math.max(0,a/h-s*s)),i.x=e.x+s*l-n*o,i.y=e.y+s*o+n*l)):(i.x=e.x+i.radius,i.y=e.y)}function g(t,e){let i=t.radius+e.radius-1e-6,s=e.x-t.x,a=e.y-t.y;return i>0&&i*i>s*s+a*a}function f(t){let e=t._,i=t.next._,s=e.radius+i.radius,a=(e.x*i.radius+i.x*e.radius)/s,n=(e.y*i.radius+i.y*e.radius)/s;return a*a+n*n}function p(t){return{_:t,next:null,prev:null}}var c=i(25279),y=i(643597),x=i(851111),m=i(89841),v=i(543091),M=i(91852);function S(t){return function(e){e.children||(e.radius=Math.max(0,+t(e)||0))}}function _(t,e,i){return function(s){let c=null==s?void 0:s.children;if(c){let y,x=c.length,m=t(s)*e||0;if(m)for(y=0;y<x;++y)c[y].radius+=m;let v=function(t,e){let i=(t=(0,a.IX)(t)).length;if(!i)return 0;let s=t[0];if(s.x=0,s.y=0,1===i)return s.radius;let c=t[1];if(s.x=-c.radius,c.x=s.radius,c.y=0,2===i)return s.radius+c.radius;let y=t[2];u(c,s,y);let x,m,v,M,S,_,w,k=p(s),b=p(c),z=p(y);k.next=b,z.prev=b,b.next=z,k.prev=z,z.next=k,b.prev=k;for(let e=3;e<i;++e){w=!1,y=t[e],u(k._,b._,y),z=p(y),x=b.next,m=k.prev,v=b._.radius,M=k._.radius;do if(v<=M){if(g(x._,z._)){b=x,k.next=b,b.prev=k,--e,w=!0;break}v+=x._.radius,x=x.next}else{if(g(m._,z._)){(k=m).next=b,b.prev=k,--e,w=!0;break}M+=m._.radius,m=m.prev}while(x!==m.next);if(!w){for(z.prev=k,z.next=b,k.next=b.prev=b=z,S=f(k),z=z.next;z!==b;)(_=f(z))<S&&(k=z,S=_),z=z.next;b=k.next}}let R=[b._];for(z=b.next;z!==b;)R.push(z._),z=z.next;y=function(t,e){let i=0,s=(0,a.Sy)(Array.from(t),e),u=s.length,g,f,p=[];for(;i<u;)g=s[i],f&&l(f,g)?++i:(f=function(t){switch(t.length){case 1:var e;return{x:(e=t[0]).x,y:e.y,radius:e.radius};case 2:return h(t[0],t[1]);case 3:return d(t[0],t[1],t[2])}}(p=function(t,e){let i,s;if(o(e,t))return[e];for(i=0;i<t.length;++i)if(r(e,t[i])&&o(h(t[i],e),t))return[t[i],e];for(i=0;i<t.length-1;++i)for(s=i+1;s<t.length;++s)if(r(h(t[i],t[s]),e)&&r(h(t[i],e),t[s])&&r(h(t[s],e),t[i])&&o(d(t[i],t[s],e),t))return[t[i],t[s],e];n.Y.getInstance().error("error when packEncloseRandom")}(p,g)),i=0);return f}(R,e);for(let e=0;e<i;++e)s=t[e],s.x-=y.x,s.y-=y.y;return y.radius}(c,i);if(m)for(y=0;y<x;++y)c[y].radius-=m;s.radius=v+m}}}function w(t,e){return function(i,s,a){i.radius*=t,i.maxDepth=e,a&&(i.x=a.x+t*i.x,i.y=a.y+t*i.y)}}class k{constructor(t){this.options=t;let e=null==t?void 0:t.nodeKey,i=(0,c.Z)(e)?e:e?(0,y.EP)(e):null;this._getNodeKey=i,this._getPadding=(0,x.Z)(null==t?void 0:t.padding)?e=>t.padding:(0,m.Z)(null==t?void 0:t.padding)?e=>{var i;return null!=(i=t.padding[e.depth+1])?i:0}:()=>0,this._maxDepth=-1}layout(t,e){var i;let a="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};if(!t||!t.length)return[];let n=[],r=(0,s.Ch)(t,n,0,-1,null,this._getNodeKey);this._maxDepth=r.maxDepth;let l=(0,v.JY)(),o={flattenIndex:-1,maxDepth:-1,key:"root",depth:-1,index:-1,value:r.sum,datum:null,children:n,x:a.x0+a.width/2,y:a.y0+a.height/2},{nodeSort:h,setRadius:d,padding:u,includeRoot:g}=null!=(i=this.options)?i:{};if(!1!==h){let t=(0,c.Z)(h)?this.options.nodeKey:k.defaultOpionts.nodeSort;(0,s.R$)([o],e=>{e.children&&e.children.length&&e.children.sort(t)})}if(d)(0,s.R$)([o],S(d)),(0,s.Ye)([o],_(this._getPadding,.5,l)),(0,s.R$)([o],w(1,this._maxDepth));else{let t=Math.min(a.width,a.height);(0,s.R$)([o],S(k.defaultOpionts.setRadius)),(0,s.Ye)([o],_(M.b,1,l)),u&&(0,s.Ye)([o],_(this._getPadding,o.radius/t,l)),(0,s.R$)([o],w(t/(2*o.radius),this._maxDepth))}return g?[o]:n}}k.defaultOpionts={setRadius:t=>Math.sqrt(t.value),padding:0,nodeSort:(t,e)=>e.value-t.value}},541497:function(t,e,i){i.d(e,{V:()=>S});var s=i(895611),a=i(580164),n=i(828390),r=i(25279),l=i(643597),o=i(473729),h=i(713628),d=i(617742),u=i(851111),g=i(56157),f=i(983903);let p=t=>{let e=0;return t.forEach((t,i)=>{var s;(0,a.Z)(t.value)&&((null==(s=t.children)?void 0:s.length)?t.value=p(t.children):t.value=0),e+=Math.abs(t.value)}),e};function c(t){return t.depth}function y(t,e){return e-1-t.endDepth}let x=(t,e)=>(null==t?void 0:t.y0)-(null==e?void 0:e.y0),m=(t,e)=>{if((0,a.Z)(t.value))return null;let i=(e?t.targetLinks:t.sourceLinks).reduce((t,e)=>((0,a.Z)(e.value)?t.count+=1:t.sum+=e.value,t),{sum:0,count:0});return i.count>0?(t.value-i.sum)/i.count:null},v={left:c,right:y,justify:function(t,e){return t.sourceLinks.length?t.depth:e-1},center:function(t,e,i){return t.targetLinks.length?t.depth:t.sourceLinks.length?(0,s.iH)(t.sourceLinks.map(t=>i[t.target].depth))-1:0},start:c,end:y},M=(0,n.i)(0,1);class S{constructor(t){this._ascendingSourceBreadth=(t,e)=>x(this._nodeMap[t.source],this._nodeMap[e.source])||t.index-e.index,this._ascendingTargetBreadth=(t,e)=>x(this._nodeMap[t.target],this._nodeMap[e.target])||t.index-e.index,this.options=Object.assign({},S.defaultOptions,t);let e=this.options.nodeKey,i=(0,r.Z)(e)?e:e?(0,l.EP)(e):null;this._getNodeKey=i,this._logger=o.Y.getInstance(),this._alignFunc=(0,r.Z)(this.options.setNodeLayer)?t=>this.options.setNodeLayer(t.datum):v[this.options.nodeAlign]}layout(t,e){if(!t)return null;let i="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};"vertical"===this.options.direction?this._viewBox={x0:i.y0,x1:i.y1,y0:i.x0,y1:i.x1,width:i.height,height:i.width}:this._viewBox=i;let s=this.computeNodeLinks(t),n=s.nodes,r=s.links;if(this._nodeMap=s.nodeMap,this.computeNodeValues(n),this.computeNodeDepths(n),["right","end","justify"].includes(this.options.nodeAlign)&&this.computeNodeEndDepths(n),this._maxDepth<=0)return null;let l=this.computeNodeBreadths(n);if(this.computeLinkBreadths(n),n.forEach(t=>{t.sourceLinks=t.sourceLinks.filter(t=>!(0,a.Z)(t.source)&&!(0,a.Z)(t.target)),t.targetLinks=t.targetLinks.filter(t=>!(0,a.Z)(t.source)&&!(0,a.Z)(t.target))}),r=r.filter(t=>!(0,a.Z)(t.source)&&!(0,a.Z)(t.target)),"vertical"===this.options.direction)if(this.options.inverse){let t=this._viewBox.x1;n.forEach(e=>{let{y0:i,y1:s,x0:a,x1:n}=e;e.y0=t-n,e.y1=t-a,e.x0=i,e.x1=s}),r.forEach(e=>{e.vertical=!0;let{x0:i,x1:s,y0:a,y1:n}=e;e.x0=a,e.x1=n,e.y0=t-i,e.y1=t-s})}else n.forEach(t=>{let{y0:e,y1:i}=t;t.y0=t.x0,t.y1=t.x1,t.x0=e,t.x1=i}),r.forEach(t=>{t.vertical=!0;let e=t.x0,i=t.x1;t.x0=t.y0,t.x1=t.y1,t.y0=e,t.y1=i});else this.options.inverse&&(n.forEach(t=>{let{x0:e,x1:s}=t;t.x0=i.x1-s,t.x1=i.x1-e}),r.forEach(t=>{t.x0=i.x1-t.x0,t.x1=i.x1-t.x1}));return r.forEach(t=>{let e=this._nodeMap[t.source],i=this._nodeMap[t.target];t.sourceRect={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1},t.targetRect={x0:i.x0,x1:i.x1,y1:i.y1,y0:i.y0}}),{nodes:n,links:r,columns:l}}computeHierarchicNodeLinks(t){return function(t,e){let i=[],s=[],n={},r={},l=[];return function(t,e,i=[],s={},n){p(t);let r=(t,l,o)=>{t.forEach((t,h)=>{let d=e?e(t):o?`${o[o.length-1].key}-${h}`:`${l}-${h}`,u=(0,a.Z)(t.value)?0:(0,g.s)(t.value);if(s[d])s[d].value=void 0;else{let e={depth:l,datum:t,index:h,key:d,value:u,sourceLinks:[],targetLinks:[]};s[d]=e,i.push(e)}o&&n&&n.push({source:o[o.length-1].key,target:d,value:u,parents:o}),t.children&&t.children.length&&r(t.children,l+1,o?o.concat([s[d]]):[s[d]])})};r(t,0,null)}(t,e,i,n,l),l.forEach((t,e)=>{let i=`${t.source}-${t.target}`,a=(0,f.Z)(t,["parents"]);if(a.parents=t.parents.map(t=>(0,f.Z)(t,["sourceLinks","targetLinks"])),r[i])return r[i].value+=(0,g.s)(t.value),void r[i].datum.push(a);let l={index:e,key:`${t.source}-${t.target}`,source:t.source,target:t.target,datum:[a],value:t.value,parents:t.parents.map(t=>t.key)};s.push(l),n[t.source].sourceLinks.push(l),n[t.target].targetLinks.push(l),r[i]=l}),{nodes:i,links:s,nodeMap:n}}(t,this._getNodeKey)}computeSourceTargetNodeLinks(t){let e=[],i=[],n={};t.nodes&&t.nodes.forEach((t,i)=>{let s={depth:-1,datum:t,index:i,key:this._getNodeKey?this._getNodeKey(t):i,value:t.value,sourceLinks:[],targetLinks:[]};n[s.key]=s,e.push(s)});let r=[];return t.links.forEach((s,l)=>{let o=!(0,a.Z)(s.source),h=!(0,a.Z)(s.target);if(t.nodes&&(!n[s.source]||!n[s.target]))return;t.nodes||!o||n[s.source]||(n[s.source]={value:void 0,depth:-1,index:e.length,key:s.source,datum:null,sourceLinks:[],targetLinks:[]},e.push(n[s.source])),t.nodes||!h||n[s.target]||(n[s.target]={value:void 0,depth:-1,index:e.length,key:s.target,datum:null,sourceLinks:[],targetLinks:[]},e.push(n[s.target]));let d={index:l,source:s.source,target:s.target,datum:s,value:s.value};this.options.divideNodeValueToLink&&(0,a.Z)(s.value)&&r.push(d),i.push(d),o&&n[s.source].sourceLinks.push(d),h&&n[s.target].targetLinks.push(d)}),this.options.divideNodeValueToLink&&r.length&&r.forEach(t=>{let e=[m(n[t.source]),m(n[t.target],!0)].filter(t=>!(0,a.Z)(t));e.length&&(t.value=(0,s.iH)(e))}),{nodeMap:n,nodes:e,links:i}}computeNodeLinks(t){let e;"links"in t?e=this.computeSourceTargetNodeLinks(t):(this._isHierarchic=!0,e=this.computeHierarchicNodeLinks(t.nodes));let i=e.nodes,s=e.links;if(this.options.linkSortBy)for(let t=0,e=i.length;t<e;t++)i[t].sourceLinks.sort(this.options.linkSortBy),i[t].targetLinks.sort(this.options.linkSortBy);return this.options.dropIsolatedNode&&(i=i.filter(t=>t.targetLinks.length||t.sourceLinks.length)),{nodes:i,links:s,nodeMap:e.nodeMap}}computeNodeValues(t){for(let e=0,i=t.length;e<i;e++){let i=t[e];i.value=Math.max((0,a.Z)(i.value)?0:(0,g.s)(i.value),i.sourceLinks.reduce((t,e)=>{var i;return t+(null!=(i=(0,g.s)(e.value))?i:0)},0),i.targetLinks.reduce((t,e)=>{var i;return t+(null!=(i=(0,g.s)(e.value))?i:0)},0))}}computeNodeDepths(t){var e;let i=t.length,s,a,n=t,l=0,o=-1,h=(0,r.Z)(this.options.setNodeLayer)?this.options.setNodeLayer:null;for(;n.length&&l<i;){s=[],a={};for(let t=0,i=n.length;t<i;t++){let i=n[t];if(i&&(i.depth=h&&null!=(e=h(i.datum))?e:l,h&&(o=Math.max(i.depth,o)),i.sourceLinks&&i.sourceLinks.length))for(let t=0,e=i.sourceLinks.length;t<e;t++){let e=i.sourceLinks[t];a[e.target]||(s.push(this._nodeMap[e.target]),a[e.target]=!0)}}n=s,l+=1}l>i&&this._logger.warn("Error: there is a circular link"),this._maxDepth=h?o+1:l}computeNodeEndDepths(t){let e=t.length,i,s,a=t,n=0;for(;a.length&&n<e;){i=[],s={};for(let t=0,e=a.length;t<e;t++){let e=a[t];if(e){e.endDepth=n;for(let t=0,a=e.targetLinks.length;t<a;t++){let a=e.targetLinks[t];s[a.source]||(i.push(this._nodeMap[a.source]),s[a.source]=!0)}}}a=i,n+=1}n>e&&this._logger.warn("Error: there is a circular link")}computeNodeLayers(t){let e=this.options.nodeWidth,i=this.options.linkWidth,s=this.options.minStepWidth,n=this._viewBox.width,l=null,o=null,g=!1;if((0,h.Z)(e)){let t=(0,d.Z)(parseFloat(e.replace("%",""))/100,0,1),i=n/(this._maxDepth-1+t);s>0&&(i=Math.max(s,i)),l=i*t,o=i*(1-t),g=!0}else if((0,u.Z)(e)){if(l=e,(0,u.Z)(i))o=i;else if((0,a.Z)(i)){let t=(n-e)/(this._maxDepth-1);s>0&&(t=Math.max(s,t)),o=t-e}g=!0}else(0,r.Z)(e)&&(0,u.Z)(i)&&(o=i);let f=[];for(let e=0,i=t.length;e<i;e++){let i=t[e];i.layer=this._isHierarchic?i.depth:(0,d.Z)(Math.floor(this._alignFunc(i,this._maxDepth,this._nodeMap)),0,this._maxDepth-1);let s=i.layer;s===this._maxDepth-1&&(i.isLastLayer=!0),g&&(i.x0=this._viewBox.x0+s*(l+o),i.x1=i.x0+l),f[s]?f[s].push(i):f[s]=[i]}if(this.options.nodeSortBy)for(let t=0,e=f.length;t<e;t++)f[t].sort(this.options.nodeSortBy);if(!g&&(0,r.Z)(e)){let t=this._viewBox.x0;for(let s=0;s<this._maxDepth;s++){let a=f[s],n=0,h=0;for(let s=0,d=a&&a.length;s<d;s++){let d=a[s],u=e(d);d.x0=t,d.x1=t+u,n=Math.max(l,u);let g=d.sourceLinks;for(let t=0,e=g.length;t<e;t++){let e=g[t];h=Math.max(h,(0,r.Z)(i)?i(e,this._viewBox):o)}}t+=n+h}}return f}initializeNodeBreadths(t){var e,i,s;let n=null!=(e=this.options.minLinkHeight)?e:0,l=null!=(i=this.options.minNodeHeight)?i:0,o=null!=(s=this.options.maxNodeHeight)?s:1/0,h=this.options.maxLinkHeight;((0,a.Z)(l)||l<n)&&(l=n),((0,a.Z)(h)||h>o)&&(h=o);let d=0,g=null,f=null;if((0,r.Z)(this.options.nodeGap))g=this.options.nodeGap,d=t.reduce((t,e)=>{let i=e.reduce((t,e)=>t+e.value,0),s=e.reduce((t,e)=>t+this.options.nodeGap(e),0);return Math.min(t,(this._viewBox.height-s)/i)},1/0);else{let e=t.reduce((t,e)=>Math.max(t,e.length),0),i=this._viewBox.height/e,s=Math.min(this.options.nodeGap,i);if(l+s>i&&(s=l>=i?i/2:(i-l)/2,l=Math.min(i-s,l)),g=()=>s,this._gapY=s,this.options.equalNodeHeight)f=this._viewBox.height/e-s;else{let e=l>0?Math.max(s,l):s;d=t.reduce((t,i)=>{let s=i.reduce((t,e)=>t+e.value,0);return Math.min(t,(this._viewBox.height-((i.length-1)*e+l))/s)},1/0)}}let p="start"===this.options.gapPosition,c=!p&&"end"!==this.options.gapPosition,y=(0,u.Z)(this.options.nodeHeight)?t=>this.options.nodeHeight:(0,r.Z)(this.options.nodeHeight)?this.options.nodeHeight:f>0?t=>f:t=>Math.max(t.value*d,0),x=(0,u.Z)(this.options.linkHeight)?()=>this.options.linkHeight:(0,r.Z)(this.options.linkHeight)?this.options.linkHeight:(t,e,i)=>Math.min(Math.max(e.value?i*M(t.value/e.value):0,n,0),h);for(let e=0,i=t.length;e<i;e++){let i=t[e];if(!i||!i.length)continue;let s=this._viewBox.y0,a=0,n=0,r=0;for(let t=0,e=i.length;t<e;t++){let e=i[t];a=g(e),p&&(s+=a),n=Math.min(Math.max(r=y(e),l),o),e.y0=s,e.y1=s+n,s=p?e.y1:e.y1+a;for(let t=0,i=e.sourceLinks.length;t<i;t++){let i=e.sourceLinks[t];i.thickness=x(i,e,r)}}let h=this._viewBox.y1-s+(c?a:0);if(h>0)if("start"===this.options.crossNodeAlign);else if("end"===this.options.crossNodeAlign)for(let t=0,e=i.length;t<e;++t){let e=i[t];e.y0+=h,e.y1+=h}else if("parent"===this.options.crossNodeAlign){let s=i.reduce((t,e)=>(e.targetLinks&&e.targetLinks.length&&e.targetLinks.forEach(e=>{t[e.source]=!0}),t),{});if(Object.keys(s).length&&t[e-1]&&t[e-1].length){let a=t[e-1].filter(t=>s[t.key]);if(a&&a.length&&a[0].y0!==i[0].y0){let t=a[0].y0-i[0].y0;for(let e=0,s=i.length;e<s;++e){let s=i[e];s.y0+=t,s.y1+=t}}}}else{h/=i.length+1;for(let t=0,e=i.length;t<e;++t){let e=i[t];e.y0+=h*(t+1),e.y1+=h*(t+1)}}else if(h<0&&i.length>1&&a+(h/=i.length-1)>=0){a+=h,this._gapY=Math.min(a);for(let t=1,e=i.length;t<e;++t){let e=i[t];e.y0+=h*t,e.y1+=h*t}}this.reorderLinks(i)}}computeNodeBreadths(t){let e=this.computeNodeLayers(t);this.initializeNodeBreadths(e);let i=this.options.iterations;if(!this._isHierarchic&&!(0,r.Z)(this.options.setNodeLayer)&&!(0,r.Z)(this.options.nodeGap))for(let t=0;t<i;++t){let s=Math.pow(.99,t),a=Math.max(1-s,(t+1)/i);this.relaxRightToLeft(e,s,a),this.relaxLeftToRight(e,s,a)}return e}relaxLeftToRight(t,e,i){for(let s=1,n=t.length;s<n;++s){let n=t[s];for(let t=0,i=n.length;t<i;t++){let i=n[t],s=0,a=0;for(let t=0,e=i.targetLinks.length;t<e;t++){let e=i.targetLinks[t],n=e.value*(i.layer-this._nodeMap[e.source].layer);s+=this.targetTop(this._nodeMap[e.source],i)*n,a+=n}if(!(a>0))continue;let r=(s/a-i.y0)*e;i.y0+=r,i.y1+=r,this.reorderNodeLinks(i)}(0,a.Z)(this.options.nodeSortBy)&&n.sort(x),this.resolveCollisions(n,i)}}relaxRightToLeft(t,e,i){for(let s=t.length-2;s>=0;--s){let a=t[s];for(let t=0,i=a.length;t<i;t++){let i=a[t],s=0,n=0;for(let t=0,e=i.sourceLinks.length;t<e;t++){let e=i.sourceLinks[t],a=e.value*(this._nodeMap[e.target].layer-i.layer);s+=this.sourceTop(i,this._nodeMap[e.target])*a,n+=a}if(!(n>0))continue;let r=(s/n-i.y0)*e;i.y0+=r,i.y1+=r,this.reorderNodeLinks(i)}void 0===this.options.nodeSortBy&&a.sort(x),this.resolveCollisions(a,i)}}resolveCollisions(t,e){let i=t.length>>1,s=t[i];this.resolveCollisionsBottomToTop(t,s.y0-this._gapY,i-1,e),this.resolveCollisionsTopToBottom(t,s.y1+this._gapY,i+1,e),this.resolveCollisionsBottomToTop(t,this._viewBox.y1,t.length-1,e),this.resolveCollisionsTopToBottom(t,this._viewBox.y0,0,e)}resolveCollisionsTopToBottom(t,e,i,s){for(;i<t.length;++i){let a=t[i],n=(e-a.y0)*s;n>1e-6&&(a.y0+=n,a.y1+=n),e=a.y1+this._gapY}}resolveCollisionsBottomToTop(t,e,i,s){for(;i>=0;--i){let a=t[i],n=(a.y1-e)*s;n>1e-6&&(a.y0-=n,a.y1-=n),e=a.y0-this._gapY}}targetTop(t,e){let i,s,a,n=t.y0-(t.sourceLinks.length-1)*this._gapY/2;for(i=0,s=t.sourceLinks.length;i<s&&(a=t.sourceLinks[i]).target!==e.key;i++)n+=a.thickness+this._gapY;for(i=0,s=e.targetLinks.length;i<s&&(a=e.targetLinks[i]).source!==t.key;i++)n-=a.thickness;return n}sourceTop(t,e){let i,s,a,n=e.y0-(e.targetLinks.length-1)*this._gapY/2;for(i=0,s=e.targetLinks.length;i<s&&(a=e.targetLinks[i]).source!==t.key;i++)n+=a.thickness+this._gapY;for(i=0,s=t.sourceLinks.length;i<s&&(a=t.sourceLinks[i]).target!==e.key;i++)n-=a.thickness;return n}computeLinkBreadthsNoOverlap(t){for(let e=0,i=t.length;e<i;e++){let i=t[e],s=i.y0,a=!1;for(let t=0,e=i.sourceLinks.length;t<e;t++){let e=i.sourceLinks[t];a||(e.y0=s+e.thickness/2),e.x0=i.x1,s+e.thickness>i.y1||a?(e.y0=i.y1-e.thickness/2,a=!0):s+=e.thickness}let n=i.y0;a=!1;for(let t=0,e=i.targetLinks.length;t<e;t++){let e=i.targetLinks[t];a||(e.y1=n+e.thickness/2),e.x1=i.x0,n+e.thickness>i.y1||a?(e.y1=i.y1-e.thickness/2,a=!0):n+=e.thickness}}}computeLinkBreadthsOverlap(t){let e=this.options.linkOverlap;for(let i=0,s=t.length;i<s;i++){let s=t[i],a="start"===e?s.y0:"end"===e?s.y1:(s.y0+s.y1)/2,n="start"===e?.5:"end"===e?-.5:0;for(let t=0,e=s.sourceLinks.length;t<e;t++){let e=s.sourceLinks[t];e.y0=a+n*e.thickness,e.x0=s.x1}for(let t=0,e=s.targetLinks.length;t<e;t++){let e=s.targetLinks[t];e.y1=a+n*e.thickness,e.x1=s.x0}}}computeLinkBreadths(t){this.options.linkOverlap?this.computeLinkBreadthsOverlap(t):this.computeLinkBreadthsNoOverlap(t)}reorderNodeLinks(t){if((0,a.Z)(this.options.linkSortBy)){let e=t.targetLinks,i=t.sourceLinks;for(let t=0,i=e.length;t<i;t++){let i=e[t];this._nodeMap[i.source].sourceLinks.sort(this._ascendingTargetBreadth)}for(let t=0,e=i.length;t<e;t++){let e=i[t];this._nodeMap[e.target].targetLinks.sort(this._ascendingSourceBreadth)}}}reorderLinks(t){if((0,a.Z)(this.options.linkSortBy))for(let e=0,i=t.length;e<i;e++){let i=t[e];i.sourceLinks.sort(this._ascendingTargetBreadth),i.targetLinks.sort(this._ascendingSourceBreadth)}}}S.defaultOptions={iterations:6,nodeAlign:"justify",direction:"horizontal",nodeWidth:24,nodeGap:8,crossNodeAlign:"middle",dropIsolatedNode:!0}},521892:function(t,e,i){i.d(e,{p:()=>p});var s=i(75740),a=i(643405),n=i(89841),r=i(674399),l=i(25279),o=i(643597),h=i(265198),d=i(639682),u=i(580164),g=i(897682);let f={x0:"startAngle",x1:"endAngle",y0:"innerRadius",y1:"outerRadius"};class p{constructor(t){this._layoutNode=t=>{if(t.maxDepth=this._maxDepth,t.children){let e=this._parsedInnerRadius[t.depth+1],i=this._parsedOutterRadius[t.depth+1];(0,s.Z)(t,t.startAngle,Math.min(e,i),t.endAngle,Math.max(e,i),f);let a=(0,n.Z)(this.options.label)?this.options.label[t.depth+1]:this.options.label;t.children.forEach(t=>{if(t.x=this._parsedCenter[0],t.y=this._parsedCenter[1],a)return this._layoutLabel(t,(0,r.Z)(a)?{align:"center",rotate:"radial"}:a)})}},this.options=t?Object.assign({},p.defaultOpionts,t):Object.assign({},p.defaultOpionts);let e=this.options.nodeKey,i=(0,l.Z)(e)?e:e?(0,o.EP)(e):null;this._getNodeKey=i,this._maxDepth=-1}_parseRadius(t,e){let i=t.x0+(0,h.y)(this.options.center[0],t.width),s=t.y0+(0,h.y)(this.options.center[1],t.height),a=Math.min(t.width/2,t.height/2),r=this.options.innerRadius,l=this.options.outerRadius,o=(0,n.Z)(r),g=o?r.map(t=>(0,h.y)(t,a)):(0,h.y)(r,a),f=(0,n.Z)(l),p=this.options.gapRadius,c=f?l.map(t=>(0,h.y)(t,a)):(0,h.y)(l,a),y=(0,d.w)(0,e+1);if(o)this._parsedInnerRadius=y.map((t,e)=>{let i=g[e];return(0,u.Z)(i)?a:i}),this._parsedOutterRadius=y.map((t,i)=>{var s,r;return f?null!=(s=c[i])?s:a:i<e?this._parsedInnerRadius[i+1]-((0,n.Z)(p)?null!=(r=p[i])?r:0:p):c});else if(f)this._parsedOutterRadius=y.map((t,e)=>(0,u.Z)(c[e])?a:c[e]),this._parsedInnerRadius=y.map((t,e)=>{var i;return 0===e?g:this._parsedOutterRadius[e-1]-((0,n.Z)(p)?null!=(i=p[e])?i:0:p)});else{let t=(0,h.y)(r,a),i=(c-t)/(e+1);this._parsedInnerRadius=y.map((e,s)=>t+s*i),this._parsedOutterRadius=y.map((t,e)=>{var s;return this._parsedInnerRadius[e]+i-((0,n.Z)(p)?null!=(s=p[e])?s:0:p)})}this._parsedCenter=[i,s],this._maxRadius=a}layout(t,e){let i="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};if(!t||!t.length)return[];let s=[],n=(0,a.Ch)(t,s,0,-1,null,this._getNodeKey);return this._parseRadius(i,n.maxDepth),this._maxDepth=n.maxDepth,this._layout(s,{flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:n.sum,datum:null,children:s,startAngle:this.options.startAngle,endAngle:this.options.endAngle}),s}_layout(t,e){this._layoutNode(e),t.forEach(t=>{var e;(null==(e=null==t?void 0:t.children)?void 0:e.length)?this._layout(t.children,t):this._layoutNode(t)})}_layoutLabel(t,e){var i;let s=(t.startAngle+t.endAngle)/2,a=("start"===e.align?t.innerRadius:"end"===e.align?t.outerRadius:(t.innerRadius+t.outerRadius)/2)+(null!=(i=e.offset)?i:0),n=(0,g.op)({x:this._parsedCenter[0],y:this._parsedCenter[1]},a,s);if(t.label={x:n.x,y:n.y,textBaseline:"middle"},"tangential"===e.rotate)t.label.angle=s-Math.PI/2,t.label.textAlign="center",t.label.maxLineWidth=Math.abs(t.endAngle-t.startAngle)*a;else{let i=s%(2*Math.PI),a=i<0?i+2*Math.PI:i;a>Math.PI/2&&a<1.5*Math.PI?(t.label.angle=a+Math.PI,t.label.textAlign="start"===e.align?"end":"end"===e.align?"start":"center"):(t.label.angle=a,t.label.textAlign=e.align),t.label.maxLineWidth=t.isLeaf?void 0:Math.abs(t.outerRadius-t.innerRadius)}}}p.defaultOpionts={startAngle:Math.PI/2,endAngle:-3*Math.PI/2,center:["50%","50%"],gapRadius:0,innerRadius:0,outerRadius:"70%"}},75740:function(t,e,i){i.d(e,{Z:()=>s});function s(t,e,i,a,n,r={x0:"x0",x1:"x1",y0:"y0",y1:"y1"}){let l=t.children,o,h=-1,d=l.length,u=t.value&&(a-e)/t.value;for(;++h<d;)(o=l[h])[r.y0]=i,o[r.y1]=n,o[r.x0]=e,o[r.x1]=e+=o.value*u}},97595:function(t,e,i){i.d(e,{j:()=>u});var s=i(75740);function a(t,e,i,s,a){let n=t.children,r,l=-1,o=n.length,h=t.value&&(a-i)/t.value;for(;++l<o;)(r=n[l]).x0=e,r.x1=s,r.y0=i,i+=r.value*h,r.y1=i}var n=i(643405),r=i(89841),l=i(25279),o=i(643597),h=i(851111);let d={binary:function(t,e,i,s,a){let n=t.children,r=n.length,l=0,o=Array(r+1);o[0]=0;for(let t=0;t<r;++t)l+=n[t].value,o[t+1]=l;let h=(t,e,i,s,a,r,l)=>{if(t>=e-1){let e=n[t];return e.x0=s,e.y0=a,e.x1=r,void(e.y1=l)}let d=o[t],u=i/2+d,g=t+1,f=e-1;for(;g<f;){let t=g+f>>>1;o[t]<u?g=t+1:f=t}u-o[g-1]<o[g]-u&&t+1<g&&--g;let p=o[g]-d,c=i-p;if(r-s>l-a){let n=i?(s*c+r*p)/i:r;h(t,g,p,s,a,n,l),h(g,e,c,n,a,r,l)}else{let n=i?(a*c+l*p)/i:l;h(t,g,p,s,a,r,n),h(g,e,c,s,n,r,l)}};h(0,r,t.value,e,i,s,a)},dice:s.Z,slice:a,sliceDice:function(t,e,i,n,r){(t.depth%2==1?a:s.Z)(t,e,i,n,r)}};class u{constructor(t){var e;let i;this._filterByArea=(t,e)=>{var i;let s=this._getMinAreaByDepth(t.depth);if(s>0&&t.value*e<s)return!1;if(null==(i=t.children)?void 0:i.length){let i=t.children.filter(t=>this._filterByArea(t,e));i.length?i.length!==t.children.length&&(t.children=i):(t.isLeaf=!0,t.children=null)}return!0},this._getMinAreaByDepth=t=>{var e;return t<0?0:null!=(e=(0,r.Z)(this.options.minVisibleArea)?this.options.minVisibleArea[t]:this.options.minVisibleArea)?e:0},this._getGapWidthByDepth=t=>{var e;return t<0?0:null!=(e=(0,r.Z)(this.options.gapWidth)?this.options.gapWidth[t]:this.options.gapWidth)?e:0},this._getPaddingByDepth=t=>{var e;return t<0?0:null!=(e=(0,r.Z)(this.options.padding)?this.options.padding[t]:this.options.padding)?e:0},this._getLabelPaddingByDepth=t=>{var e;return t<0?0:null!=(e=(0,r.Z)(this.options.labelPadding)?this.options.labelPadding[t]:this.options.labelPadding)?e:0},this._layoutNode=t=>{let e=this._getGapWidthByDepth(t.depth),i=t.x0,s=t.y0,a=t.x1,n=t.y1;if(t.maxDepth=this._maxDepth,e>0&&(i+=e/2,a-=e/2,s+=e/2,n-=e/2,i>a&&(a=i=(i+a)/2),s>n&&(n=s=(s+n)/2),t.x0=i,t.x1=a,t.y0=s,t.y1=n),t.children){let e=this._getLabelPaddingByDepth(t.depth),r=this._getPaddingByDepth(t.depth);r>0&&r<Math.min(a-i,n-s)/2&&(s+=r,n-=r,i+=r,a-=r),e>0&&("top"===this.options.labelPosition&&s+e<n?(t.labelRect={x0:i,y0:s,x1:a,y1:s+e},s+=e):"bottom"===this.options.labelPosition&&n-e>s?(t.labelRect={x0:i,y0:n-e,x1:a,y1:n},n-=e):"left"===this.options.labelPosition&&i+e<a?(t.labelRect={x0:i,y0:s,x1:i+e,y1:n},i+=e):"right"===this.options.labelPosition&&a-e>i&&(t.labelRect={x0:a-e,y0:s,x1:a,y1:n},a-=e));let l=this._getGapWidthByDepth(t.depth+1);l>0&&(i-=l/2,a+=l/2,s-=l/2,n+=l/2),this._splitNode(t,i,s,a,n)}},this.options=Object.assign({},u.defaultOpionts,t);let n=this.options.nodeKey,h=(0,l.Z)(n)?n:n?(0,o.EP)(n):null;this._getNodeKey=h,this._splitNode="squarify"===this.options.splitType?(i=this.options.aspectRatio,(t,e,n,r,l)=>{!function(t,e,i,n,r,l){let o=[],h=e.children,d,u,g=0,f=0,p=h.length,c,y,x,m,v,M,S,_,w,k=e.value;for(;g<p;){c=r-i,y=l-n;do x=h[f++].value;while(!x&&f<p);for(m=x,S=Math.max((v=x)/(w=x*x*(_=Math.max(y/c,c/y)/(k*t))),w/m);f<p;++f){if(x+=u=h[f].value,u<m&&(m=u),u>v&&(v=u),(M=Math.max(v/(w=x*x*_),w/m))>S){x-=u;break}S=M}d=Object.assign({},e,{value:x,children:h.slice(g,f)}),o.push(d),c<y?(0,s.Z)(d,i,n,r,k?n+=y*x/k:l):a(d,i,n,k?i+=c*x/k:r,l),k-=x,g=f}}(i,t,e,n,r,l)}):null!=(e=d[this.options.splitType])?e:d.binary,this._maxDepth=-1}layout(t,e){var i;if(!t||!t.length)return[];let s="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)},a=[],r=(0,n.Ch)(t,a,0,-1,null,this._getNodeKey,this.options.valueField);if(this._maxDepth=r.maxDepth,r.sum<=0)return[];let l={flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:r.sum,datum:null,x0:s.x0,x1:s.x1,y0:s.y0,y1:s.y1,children:a},o=s.width*s.height/r.sum;return this._filterByArea(l,o),this._layout(l),null!=(i=l.children)?i:[]}_filterChildren(t){let e=this.options.maxDepth;if((0,h.Z)(e)&&e>=0&&t.depth>=e)return!1;let i=this.options.minChildrenVisibleArea;if((0,h.Z)(i)&&Math.abs((t.x1-t.x0)*(t.y1-t.y0))<i)return!1;let s=this.options.minChildrenVisibleSize;return!(0,h.Z)(s)||!(Math.abs(t.x1-t.x0)<s||Math.abs(t.y1-t.y0)<s)}_layout(t){var e;this._filterChildren(t)||(t.children=null,t.isLeaf=!0),this._layoutNode(t),(null==(e=t.children)?void 0:e.length)&&t.children.forEach(t=>{var e;(null==(e=null==t?void 0:t.children)?void 0:e.length)?this._layout(t):this._layoutNode(t)})}}u.defaultOpionts={aspectRatio:(1+Math.sqrt(5))/2,gapWidth:0,labelPadding:0,labelPosition:"top",splitType:"binary",minVisibleArea:10}},643405:function(t,e,i){i.d(e,{Ch:()=>n,R$:()=>r,Ye:()=>l,bp:()=>o});var s=i(580164),a=i(56157);let n=(t,e,i=0,r=-1,l,o,h="value")=>{let d=0,u=null!=r?r:-1,g=i;return t.forEach((t,r)=>{var f,p;let c={flattenIndex:++u,key:o?o(t):`${null!=(f=null==l?void 0:l.key)?f:""}-${r}`,maxDepth:-1,depth:i,index:r,value:t[h],isLeaf:!0,datum:l?l.datum.concat(t):[t],parentKey:null==l?void 0:l.key};if(null==(p=t.children)?void 0:p.length){c.children=[],c.isLeaf=!1;let e=n(t.children,c.children,i+1,u,c,o,h);c.value=(0,s.Z)(t[h])?e.sum:Math.max(e.sum,(0,a.s)(t[h])),u=e.flattenIndex,g=Math.max(e.maxDepth,g)}else c.isLeaf=!0,c.value=(0,a.s)(t[h]);d+=Math.abs(c.value),e.push(c)}),{sum:d,maxDepth:g,flattenIndex:u}},r=(t,e,i,s)=>{let a=s;return t.forEach((t,s)=>{var n;a=e(t,s,i,a),(null==(n=t.children)?void 0:n.length)&&(a=r(t.children,e,t,a))}),s},l=(t,e,i,s)=>{let a=s;return t.forEach((t,s)=>{var n;(null==(n=t.children)?void 0:n.length)&&(a=l(t.children,e,t,a)),a=e(t,s,i,a)}),a},o=(t,e=[],i)=>{let s=(null==i?void 0:i.maxDepth)>=0;return t.forEach(t=>{(!s||t.depth<=i.maxDepth)&&(e.push((null==i?void 0:i.callback)?i.callback(t):t),t.children&&(s&&t.depth===i.maxDepth?(t.children=null,t.isLeaf=!0):o(t.children,e,i)))}),e}},63199:function(t,e,i){i.d(e,{Qn:()=>c,Sl:()=>f,at:()=>l,rp:()=>o,tc:()=>p});var s=i(835574),a=i(966353),n=i(479176),r=i(897682);let l=(t,e,i)=>{let{threshold:s,invert:n=!1}=null!=e?e:{};if(!t||"#fff"===t)return(t,e,i)=>{let r=t.width;if(0===t.data[e*r*4+4*i+3])return!n;let l=t.data[e*r*4+4*i+0],o=t.data[e*r*4+4*i+1],h=t.data[e*r*4+4*i+2];if(255===l&&255===o&&255===h)return!n;if((0,a.Z)(s)){let t=.3*l+.59*o+.11*h;return n?t<=s:t>=s}return!1};let r=i({width:1,height:1}).getContext("2d",{willReadFrequently:!0});r.fillStyle=t,r.fillRect(0,0,1,1);let l=r.getImageData(0,0,1,1).data;return(t,e,i)=>{let s=t.width;return[0,1,2,3].every(a=>n?t.data[4*(e*s+i)+a]!==l[a]:t.data[4*(e*s+i)+a]===l[a])}},o=(t,e,i,s,a=!1,n)=>{let{backgroundColor:r="#fff"}=t,{fill:l="#000"}=t;a&&([r,l]=[l,r]);let o=s||n({width:e,height:i,dpr:1}),d=o.getContext("2d",{willReadFrequently:!0});if(s){let t=s.width,a=s.height;d.clearRect(0,0,t,a),s.style.width=`${e}px`,s.style.height=`${i}px`,s.width=e,s.height=i}return d.fillStyle=r,d.fillRect(0,0,o.width,o.height),"text"===t.type?h(t,l,o.width,o.height,d):"geometric"===t.type&&g(t,l,o.width,o.height,d),o},h=(t,e,i,s,a)=>{let{fontFamily:r="sans-serif",fontWeight:l="normal",fontStyle:o="normal",fontVariant:h="normal",text:d,hollow:u}=t,g=12;a.font=`${o} ${h} ${l} ${g}px ${r}`,a.textAlign="center",a.textBaseline="middle",a.fillStyle=e;let f=a.measureText(d),p="normal"!==o?1.1:1,c=(0,n.Z)(f.actualBoundingBoxRight)&&(0,n.Z)(f.actualBoundingBoxLeft)?Math.ceil(p*(Math.abs(f.actualBoundingBoxRight)+Math.abs(f.actualBoundingBoxLeft))):0,y=Math.max(Math.ceil(f.width),c,g);if(u&&(a.globalCompositeOperation="xor"),y>i){let t=Math.min(i/y,s/g);a.fillText(d,i/2,s/2),a.scale(t,t)}else g=Math.min(g=Math.floor(g*i/y),s),a.font=`${o} ${h} ${l} ${g}px ${r}`,a.fillText(d,Math.floor(i/2),Math.floor(s/2))},d=(t,e,i=0,s)=>{let a=2*Math.PI/s;return Array(s).fill(0).map((s,n)=>(0,r.op)(t,e,i+n*a))},u=(t,e)=>{t.beginPath(),e.forEach((e,i)=>{0===i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)}),t.closePath(),t.fill()},g=(t,e,i,a,n)=>{let{hollow:l}=t,{center:o,maxRadius:h}=(0,s.nf)(t.shape,[i,a]);n.fillStyle=e,l&&(n.globalCompositeOperation="xor");let g=o[0],f=o[1];if("cardioid"===t.shape){var p;let t;p=((t,e,i=0,a)=>{let n=2*Math.PI/a,l=(0,s.jc)("cardioid");return Array(a).fill(0).map((s,a)=>{let o=i+a*n,h=e*l(o);return(0,r.op)(t,h,o)})})({x:g,y:f},h,0,100),n.beginPath(),p.forEach((e,i)=>{0===i?n.moveTo(e.x,e.y):n.bezierCurveTo(e.x,e.y,t.x,t.y,e.x,e.y),t=e}),n.closePath(),n.fill()}else if("circle"===t.shape)n.beginPath(),n.arc(g,f,h,0,2*Math.PI,!0),n.fill();else if("diamond"===t.shape)u(n,d({x:g,y:f},h,-Math.PI/2,4));else if("square"===t.shape)u(n,d({x:g,y:f},h,-Math.PI/4,4));else if("pentagon"===t.shape)u(n,d({x:g,y:f},h,Math.PI/2,5));else if("triangle"===t.shape||"triangleUpright"===t.shape)u(n,d({x:g,y:f},h,-Math.PI/2,3));else if("triangleForward"===t.shape)u(n,d({x:g,y:f},h,0,3));else if("star"===t.shape){let t=d({x:g,y:f},h,-Math.PI/2,5),e=d({x:g,y:f},h/(2*Math.cos(Math.PI/5)),-Math.PI/2+Math.PI/5,5),i=[];for(let s=0;s<5;s++)i.push(t[s]),i.push(e[s]);u(n,i)}else n.fillRect(0,0,i,a)};function f(t){let{size:e,maskCanvas:i}=t,s=i.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,i.width,i.height),a=Array(e[0]*e[1]).fill(0),n=1,r=[[0,1],[1,0],[-1,0],[0,-1]],l=[];for(let i=0;i<e[1];i++)for(let o=0;o<e[0];o++)if(0===a[i*e[0]+o]&&!t.isEmptyPixel(s,i,o)){a[i*e[0]+o]=n,l.push([i,o]);for(let i=0;i<l.length;i++)for(let o=0;o<4;o++){let h=l[i][0]+r[o][0],d=l[i][1]+r[o][1];h=h<0?0:h>=e[1]?e[1]-1:h,d=d<0?0:d>=e[0]?e[0]-1:d,0!==a[h*e[0]+d]||t.isEmptyPixel(s,h,d)||(a[h*e[0]+d]=n,l.push([h,d]))}n++,l=[]}let o={},h={},d={},u={},g={},f={},p={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0,width:0,height:0},c=[];for(let t=0;t<e[1];t++)for(let i=0;i<e[0];i++){let s=a[t*e[0]+i];0!==s&&(function(t,i){let s=[[0,1],[1,0],[-1,0],[0,-1]];if(0===t||0===i||t===e[1]-1||i===e[0]-1)return!0;for(let n=0;n<4;n++){let r=t+s[n][0],l=i+s[n][1];if(r=r<0?0:r>=e[1]?e[1]-1:r,l=l<0?0:l>=e[0]?e[0]-1:l,0===a[r*e[0]+l])return!0}return!1}(t,i)&&(c.push([t,i]),o[s]=o[s]||[],o[s].push([i,t]),u[s]||(u[s]=[1/0,-1/0,1/0,-1/0]),t<u[s][0]&&(u[s][0]=t),t>u[s][1]&&(u[s][1]=t),i<u[s][2]&&(u[s][2]=i),i>u[s][3]&&(u[s][3]=i),i<p.x1&&(p.x1=i),i>p.x2&&(p.x2=i),t<p.y1&&(p.y1=t),t>p.y2&&(p.y2=t)),h[s]=(h[s]||0)+1)}let y=[];for(let t in o){let e=o[t],i=~~(e.reduce((t,e)=>t+e[0],0)/e.length),s=~~(e.reduce((t,e)=>t+e[1],0)/e.length);d[t]=[i,s],y.push(...e);let[a,n,r,l]=u[t];g[t]=~~Math.max(Math.sqrt((i-r)**2+(s-a)**2),Math.sqrt((i-l)**2+(s-n)**2),Math.sqrt((i-r)**2+(s-n)**2),Math.sqrt((i-l)**2+(s-a)**2)),f[t]=(l-r)/(n-a)}let x=Object.keys(d).map(t=>({label:t-1,boundary:o[t],area:h[t],center:d[t],maxPoint:u[t],maxR:g[t],ratio:f[t]}));p.width=p.x2-p.x1+1,p.height=p.y2-p.y1+1;let m=~~(y.reduce((t,e)=>t+e[0],0)/y.length),v=~~(y.reduce((t,e)=>t+e[1],0)/y.length),M=~~Math.max(Math.sqrt((m-p.x1)**2+(v-p.y1)**2),Math.sqrt((m-p.x2)**2+(v-p.y2)**2),Math.sqrt((m-p.x1)**2+(v-p.y2)**2),Math.sqrt((m-p.x2)**2+(v-p.y1)**2)),S=p.width/p.height,_=Object.keys(h).reduce((t,e)=>t+h[e],0),w={regions:x,labels:a,labelNumber:n-1};if(t.blur){let i=t.blur,s=function(t,e,i,s){let a=Math.ceil(s/2),n=function(t,e){let i=Array(2*t+1).fill(0),s=0;for(let a=-t;a<=t;a++){let n=Math.exp(-a*a/(2*e*e));i[a+t]=n,s+=n}for(let t=0;t<i.length;t++)i[t]/=s;return i}(a,s/3),r=Array(t.length).fill(0),l=Array(t.length).fill(0);for(let s=0;s<i;s++)for(let i=0;i<e;i++){let l=0;for(let r=-a;r<=a;r++)l+=t[s*e+Math.min(Math.max(i+r,0),e-1)]*n[r+a];r[s*e+i]=l}for(let t=0;t<e;t++)for(let s=0;s<i;s++){let o=0;for(let l=-a;l<=a;l++)o+=r[Math.min(Math.max(s+l,0),i-1)*e+t]*n[l+a];l[s*e+t]=Math.max(0,Math.min(1,o))}return l}(a,e[0],e[1],i);(function(t,e,i,s,a=1){let n=Array(t.length).fill(0);for(let[t,r]of e)if(n[t*i+r]=1,a>1){for(let e=1-a;e<=a-1;e++)for(let l=1-a;l<=a-1;l++)if(Math.sqrt(e*e+l*l)<a){let a=t+e,o=r+l;a>=0&&a<s&&o>=0&&o<i&&(n[a*i+o]=1)}}return n})(a,c,e[0],e[1],Math.ceil(i/2)).forEach((t,e)=>{1===t&&(a[e]=s[e])})}return Object.assign(t,{segmentation:w,shapeBounds:p,shapeMaxR:M,shapeRatio:S,shapeCenter:[m,v],shapeArea:_})}function p(t,e,i){e.width=t.width,e.height=t.height;let s=e.getContext("2d",{willReadFrequently:!0});s.clearRect(0,0,e.width,e.height),s.drawImage(t,0,0);let a=e.width,n=s.getImageData(0,0,e.width,e.height),r=0,l=n.height,o=0,h=n.width,d=(t,e)=>{for(let s=0;s<t;++s)if(!i(n,e,s))return!1;return!0},u=(t,e,s)=>{for(let a=e;a<s;++a)if(!i(n,a,t))return!1;return!0};for(;r<l&&d(a,r);)++r;for(;l-1>r&&d(a,l-1);)--l;for(;o<h&&u(o,r,l);)++o;for(;h-1>o&&u(h-1,r,l);)--h;let g=s.getImageData(o,r,h-o,l-r);return e.width=g.width,e.height=g.height,s.clearRect(0,0,e.width,e.height),s.putImageData(g,0,0),e}function c(t,e){let i=t.width,s=t.height,a=e[0]/i;s*a>e[1]&&(a=e[1]/s);let n=Math.floor(a*i),r=Math.floor(a*s);return{x:(e[0]-n)/2,y:(e[1]-r)/2,width:n,height:r,scale:a}}},835574:function(t,e,i){i.d(e,{jc:()=>r,nf:()=>n});let s={triangleForward:function(){return function(t){let e=t%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}},triangleUpright:a,triangle:a,diamond:function(){return function(t){let e=t%(2*Math.PI/4);return 1/(Math.cos(e)+Math.sin(e))}},square:function(){return function(t){return Math.min(1/Math.abs(Math.cos(t)),1/Math.abs(Math.sin(t)))}},star:function(){return function(t){let e=(t+.955)%(2*Math.PI/10);return(t+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-e)+3.07768*Math.sin(2*Math.PI/10-e)):1/(Math.cos(e)+3.07768*Math.sin(e))}},cardioid:function(){return function(t){return 1+Math.sin(t)}},circle:function(){return function(){return 1}},pentagon:function(){return function(t){let e=(t+.955)%(2*Math.PI/5);return 1/(Math.cos(e)+.726543*Math.sin(e))}}};function a(){return function(t){let e=(t+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}}function n(t,e){let i=e[0],s=e[1],a=1,n=[e[0]>>1,e[1]>>1];switch(t){case"cardioid":n[1]=~~(s/2.7*.4),a=Math.floor(Math.min(i/2.3,s/2.6));break;case"triangleForward":a=s/Math.sqrt(.75)>i?Math.floor(i/2):Math.floor(s/(2*Math.sqrt(.75)));break;case"triangle":case"triangleUpright":n[1]=~~(s/1.5),a=Math.floor(Math.min(s/1.5,i/2));break;case"circle":case"diamond":case"square":case"star":case"pentagon":a=Math.floor(Math.min(i/2,s/2));break;default:a=Math.floor(Math.max(i/2,s/2))}return{maxRadius:a,center:n}}let r=t=>s[t]?s[t]():s.circle()},648668:function(t,e,i){i.d(e,{v:()=>Z});var s,a,n=i(580164),r=i(473729);(s=a||(a={})).BEFORE_WORDCLOUD_SHAPE_LAYOUT="beforeWordcloudShapeLayout",s.AFTER_WORDCLOUD_SHAPE_LAYOUT="afterWordcloudShapeLayout",s.AFTER_WORDCLOUD_SHAPE_DRAW="afterWordcloudShapeDraw";let l=t=>/^[\u4e00-\u9fa5]+$/.test(t),o=(t,e)=>{if((0,n.Z)(t))return 0;let i=0;for(let e of t)l(e)?i+=1:i+=.53;return i};function h(t,e,i){let{stepFactor:s,importantWordCount:a,globalShinkLimit:n}=e,{size:r,segmentation:{regions:l},tempCanvas:o,boardSize:h,shapeCenter:u,shapeMaxR:g,shapeRatio:c}=i,y=o.getContext("2d",{willReadFrequently:!0}),x=p(i),m=x.slice(0),v=e.fontSizeShrinkFactor,M=null,S=1,_=1,w=0;t.length>a&&(w=t.sort((t,e)=>e.weight-t.weight)[a].weight);for(let e=0;e<l.length;e++){let{words:i,center:a,maxR:u,ratio:g}=l[e],p=!1;for(let e=0;e<i.length;e++){f(o,y,t,e);let l=i[e];if(l.x=a[0],l.y=a[1],!l.skip&&l.hasText&&l.sprite&&d(m,l,u,g,r,h,s))l.hasPlaced=!0;else{if(!l.skip&&l.weight>w&&_>n){let e=l.datum[Symbol.for("vGrammar_id")];e!==M&&(M=e,S=_),_*=v,t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*v}),m=x.slice(0),p=!0;break}if(!l.skip&&l.datum[Symbol.for("vGrammar_id")]===M){t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/_}),l.skip=!0,_=S,M=null,m=x.slice(0),p=!0;break}}}p&&(e=-1)}for(let i=0;i<e.textLayoutTimes;i++){let i=t.filter(t=>(t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced));if(0===i.length)break;for(let t=0;t<i.length;t++){let e=i[t];f(o,y,i,t),e.x=u[0],e.y=u[1],e.hasText&&d(m,e,g,c,r,h,s)&&(e.hasPlaced=!0)}}e.board=m}function d(t,e,i,s,a,n,r){var l;let o=e.x,h=e.y,d=(l=s,function(t){return[l*(t*=.1)*Math.cos(t),t*Math.sin(t)]}),f=+r,p,c,y,x=-f;for(;p=d(x+=f);){let{wordSize:s,bounds:{dTop:r,dBottom:l,dLeft:d,dRight:f}}=e;if(Math.min(Math.abs(c=p[0]),Math.abs(y=p[1]))>=i)break;if(e.x=~~(o+c),e.y=~~(h+y),!(e.x-d<0||e.x+f>a[0]||e.y-r<0||e.y+l>a[1]||g(e,t,n)))return u(e,t,n),!0}return!1}function u(t,e,i){let{wordSize:s}=t,a=t.sprite,n=s[0]>>5,r=i[0]>>5,l=t.x-(n<<4),o=l%32,h=32-o,d=s[1],u,g=(t.y-(s[1]>>1))*r+(l>>5);if(0===o)for(let t=0;t<d;t++){for(let i=0;i<n;i++)e[g+i]|=a[t*n+i];g+=r}else for(let t=0;t<d;t++){u=0;for(let i=0;i<=n;i++)e[g+i]|=u<<h|(i<n?(u=a[t*n+i])>>>o:0);g+=r}}function g(t,e,i){let{sprite:s,wordSize:a}=t,n=i[0]>>5,r=a[0]>>5,l=t.x-(r<<4),o=l%32,h=32-o,d=a[1],u,g=(t.y-(a[1]>>1))*n+(l>>5);if(0===o)for(let t=0;t<d;t++){for(let i=0;i<r;i++)if(e[g+i]&s[t*r+i])return!0;g+=n}else for(let t=0;t<d;t++){u=0;for(let i=0;i<=r;i++)if((u<<h|(i<r?(u=s[t*r+i])>>>o:0))&e[g+i])return!0;g+=n}return!1}function f(t,e,i,s){let a,n;if(i[s].sprite||0===i[s].fontSize)return;let r=Math.PI/180,l=i.length;t.width=2048,t.height=2048,e.clearRect(0,0,2048,2048),e.textAlign="center";let o,h,d=0,u=0,g=0,f=0,p=s;for(--s;++s<l;){let t=i[s],a=Math.max(t.fontSize,2);if(e.save(),e.font=t.fontStyle+" "+t.fontWeight+" "+a+"px "+t.fontFamily,o=e.measureText(t.text+"m").width+2*t.padding,h=2*a+2*t.padding,0!==t.rotate){let e=Math.sin(t.rotate*r),i=Math.cos(t.rotate*r),s=o*i,a=o*e,n=h*i,l=h*e;o=Math.max(Math.abs(s+l),Math.abs(s-l)),h=~~Math.max(Math.abs(a+n),Math.abs(a-n))}if(o=o+31>>5<<5,(h=Math.ceil(h))>g&&(g=h),d+o>=2048&&(d=0,u+=g,g=h),u+h>=2048){if(0===u){t.hasText=!1;continue}break}u+h>=f&&(f=u+h),e.translate(d+(o>>1),u+(h>>1)),0!==t.rotate&&e.rotate(t.rotate*r),e.fillText(t.text,0,0),t.padding&&(e.lineWidth=2*t.padding,e.strokeText(t.text,0,0)),e.restore(),t.LT=[d,u],t.wordSize=[o,h],t.hasText=!0,d+=o}if(0===f)return;let c=e.getImageData(0,0,2048,f).data;for(;--s>=p;){let t=i[s];if(!t.hasText){t.bounds={dTop:1/0,dBottom:-1/0,dLeft:1/0,dRight:-1/0};break}let{LT:e=[0,0],wordSize:r}=t;[d,u]=e;let l=r[0]>>5,o=Array(l*r[1]).fill(0),[h,g,f,p]=[1/0,-1/0,1/0,-1/0];for(n=0;n<r[1];n++){let t;for(a=0;a<r[0];a++)if(c[4*((u+n)*2048+(d+a))+3]>0){let e=1<<31-a%32;o[l*n+(a>>5)]|=e,a<f&&(f=a),a>p&&(p=a),t|=e}t&&(n<h&&(h=n),n>g&&(g=n))}t.bounds={dTop:(r[1]>>1)-h,dBottom:g-(r[1]>>1),dLeft:(r[0]>>1)-f,dRight:p-(r[0]>>1)},t.sprite=o,delete t.LT}}function p(t){let{segmentation:{labels:e},boardSize:i,size:s}=t,a=i[0]>>5,n=Array(a*s[1]).fill(0);for(let t=0;t<s[1];t++)for(let i=0;i<s[0];i++)if(0===e[t*s[0]+i]){let e=1<<31-i%32;n[a*t+(i>>5)]|=e}if(i[0]>s[0]){let t=(1<<i[0]-s[0])-1;for(let e=0;e<s[1];e++)n[a*e+a-1]|=t}return n}var c=i(63199),y=i(17924),x=i(6267),m=i(543091),v=i(713628),M=i(643597),S=i(895611),_=i(897682),w=i(25279),k=i(434288),b=i(586445),z=i(57892),R=i(129995);let F={x:"x",y:"y",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle",opacity:"opacity",visible:"visible",isFillingWord:"isFillingWord",color:"color"};class T{constructor(t){this.progressiveResult=[],this.options=t}layout(t){this.data=t;let e=this.options,i={shapeUrl:e.shape,size:e.size,ratio:e.ratio||.8,tempCanvas:void 0,boardSize:[0,0],random:!1,randomGenerator:void 0},s=this.options.createCanvas({width:e.size[0],height:e.size[1]}),a=s.getContext("2d",{willReadFrequently:!0});if(a.textAlign="center",a.textBaseline="middle",i.tempCanvas=s,i.boardSize=[e.size[0]+31>>5<<5,e.size[1]],i.random?i.randomGenerator=Math.random:i.randomGenerator=(0,m.s6)(),this.segmentationInput=i,(0,v.Z)(i.shapeUrl)){var n,r;i.isEmptyPixel=(0,c.at)(void 0,void 0,this.options.createCanvas);let t=(n=i.shapeUrl,r=this.options.createImage,n&&((0,y.Z)(n)||(0,x.Z)(n)||n.startsWith("<svg"))?new Promise((t,e)=>{var i;let s=r({image:n}),a=null==(i=s.resources)?void 0:i.get(n);a&&"success"===a.state&&a.data?t(a.data):(s.successCallback=()=>{var i;if(s){let a=null==(i=s.resources)?void 0:i.get(n);a&&"success"===a.state&&a.data?t(a.data):e(Error("image load failed: "+n))}else e(Error("image load failed: "+n))},s.failCallback=()=>{e(Error("image load failed: "+n))})}):null);t?(this.isImageFinished=!1,this.isLayoutFinished=!1,t.then(t=>{this.isImageFinished=!0;let s=this.options.createCanvas({width:e.size[0],height:e.size[1],dpr:1});i.maskCanvas=s;let a=s.getContext("2d");e.removeWhiteBorder&&(0,c.tc)(t,s,i.isEmptyPixel);let n=(0,c.Qn)(t,e.size);a.clearRect(0,0,e.size[0],e.size[1]),a.drawImage(t,n.x,n.y,n.width,n.height),this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(i.maskCanvas)}).catch(t=>{this.isImageFinished=!0})):(this.isImageFinished=!0,this.isLayoutFinished=!0)}else if(i.shapeUrl&&("text"===i.shapeUrl.type||"geometric"===i.shapeUrl.type)){i.isEmptyPixel=(0,c.at)(i.shapeUrl.backgroundColor,void 0,this.options.createCanvas);let t=(0,c.rp)(i.shapeUrl,e.size[0],e.size[1],void 0,!1,this.options.createCanvas);i.maskCanvas=t,this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(t),this.doLayout(),this.isImageFinished=!0,this.isLayoutFinished=!0}}canAnimate(){return!0}unfinished(){return!this.isLayoutFinished}output(){return this.progressiveResult}progressiveRun(){this.isImageFinished&&!this.isLayoutFinished&&(this.segmentationInput.maskCanvas&&this.doLayout(),this.isLayoutFinished=!0)}progressiveOutput(){return this.progressiveResult}doLayout(){var t,e,i,s,a,n,r,l,y,x,m,v,w,k,b,z,R,T,I,C,Z;let P,A,E=this.segmentationInput,O=(0,c.Sl)(E);if(!O.segmentation.regions.length)return;let W=this.options,B=this.data,V=W.colorMode||"ordinal",N={getText:(0,M.RF)(W.text),getFontSize:(0,M.RF)(W.fontSize),fontSizeRange:W.fontSizeRange,colorMode:V,getColor:W.colorField?(0,M.RF)(W.colorField):(0,M.RF)(W.text),getFillingColor:(0,M.RF)(W.fillingColorField),colorList:W.colorList||("ordinal"===V?["#2E62F1"]:["#537EF5","#2E62F1","#2358D8","#184FBF","#0C45A6","#013B8E"]),getColorHex:(0,M.RF)(W.colorHexField),getFontFamily:(0,M.RF)(W.fontFamily||"sans-serif"),rotateList:W.rotateList||[0],getPadding:(0,M.RF)(W.padding||1),getFontStyle:(0,M.RF)(W.fontStyle||"normal"),getFontWeight:(0,M.RF)(W.fontWeight||"normal"),getFontOpacity:W.fontOpacity?(0,M.RF)(W.fontOpacity):()=>1};L(B,N,O);let q={size:W.size,ratio:W.ratio||.8,shapeUrl:W.shape,random:void 0===W.random||W.random,textLayoutTimes:null!=(t=W.textLayoutTimes)?t:3,removeWhiteBorder:W.removeWhiteBorder,layoutMode:null!=(e=W.layoutMode)?e:"default",fontSizeShrinkFactor:null!=(i=W.fontSizeShrinkFactor)?i:.8,stepFactor:null!=(s=W.stepFactor)?s:1,importantWordCount:null!=(a=W.importantWordCount)?a:10,globalShinkLimit:W.globalShinkLimit||.2,fontSizeEnlargeFactor:null!=(n=W.fontSizeEnlargeFactor)?n:1.5,fillingRatio:null!=(r=W.fillingRatio)?r:.7,fillingTimes:null!=(l=W.fillingTimes)?l:4,fillingXStep:W.fillingXRatioStep?Math.max(Math.floor(W.size[0]*W.fillingXRatioStep),1):null!=(y=W.fillingXStep)?y:4,fillingYStep:W.fillingYRatioStep?Math.max(Math.floor(W.size[1]*W.fillingYRatioStep),1):null!=(x=W.fillingYStep)?x:4,fillingInitialFontSize:W.fillingInitialFontSize,fillingDeltaFontSize:W.fillingDeltaFontSize,fillingInitialOpacity:null!=(m=W.fillingInitialOpacity)?m:.8,fillingDeltaOpacity:null!=(v=W.fillingDeltaOpacity)?v:.05,getFillingFontFamily:(0,M.RF)(W.fillingFontFamily||"sans-serif"),getFillingFontStyle:(0,M.RF)(W.fillingFontStyle||"normal"),getFillingFontWeight:(0,M.RF)(W.fillingFontWeight||"normal"),getFillingPadding:(0,M.RF)(null!=(w=W.fillingPadding)?w:.4),fillingRotateList:null!=(k=W.fillingRotateList)?k:[0,90],fillingDeltaFontSizeFactor:null!=(b=W.fillingDeltaFontSizeFactor)?b:.2,fillingColorList:W.fillingColorList||["#537EF5"],sameColorList:!1,minInitFontSize:null!=(z=W.minInitFontSize)?z:10,minFontSize:null!=(R=W.minFontSize)?R:4,minFillFontSize:null!=(T=W.minFillFontSize)?T:2},j=((t,e)=>{if(1===e.length&&"#537EF5"===e[0])return!0;if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0})(N.colorList,q.fillingColorList);q.sameColorList=j,D(B,N,q,W),function(t,e,i,s){let{getText:a}=e,{fillingInitialFontSize:n,fillingDeltaFontSize:r}=i,{fillingRatio:l}=i,h=Math.ceil(Math.sqrt(s.shapeArea)/4);if(!n||!r){let e,d=t.reduce((t,e)=>{let i=o(a(e));return i>h?t:t+i},0)/t.length;n=~~(e=0===d?8:Math.sqrt(.2*s.shapeArea/d*(l/100))),r=e*i.fillingDeltaFontSizeFactor,Object.assign(i,{fillingInitialFontSize:n,fillingDeltaFontSize:r})}}(B,N,q,O);let{getText:$,getFontFamily:H,getFontStyle:Y,getFontWeight:U,getPadding:G,getColor:K,getFillingColor:X,getColorHex:J,fontSizeScale:Q,colorScale:tt,fillingColorScale:te,getFontOpacity:ti,rotateList:ts}=N,ta=B.map(t=>{var e,i;return{x:0,y:0,weight:0,text:$(t),fontFamily:H(t),fontWeight:U(t),fontStyle:Y(t),rotate:ts[~~(E.randomGenerator()*ts.length)],fontSize:Math.max(q.minInitFontSize,~~Q(t)),opacity:ti(t),padding:G(t),color:J&&J(t)||tt&&tt(K(t))||"black",fillingColor:!X||(null==(e=W.colorField)?void 0:e.field)===(null==(i=W.fillingColorField)?void 0:i.field)&&j?void 0:J&&J(t)||te&&te(X(t))||"black",datum:t,visible:!0,hasPlaced:!1}}),tn=(0,S.CE)(ta.map(t=>t.fontSize));ta.forEach(t=>t.weight=t.fontSize/tn),ta.sort((t,e)=>e.weight-t.weight);let{fillingWords:tr,successedWords:tl,failedWords:to}=function(t,e,i){(function(t,e){let{segmentation:{regions:i}}=e,s=-1/0,a=0,n=0;i.forEach((t,e)=>{let i=t.area;i>s&&(s=i,n=e),a+=i});let r=0;i.forEach(e=>{let i=e.area,n=Math.ceil(i/a*t.length),l=i/s;e.words=[],e.regionNum=n,e.regionWeight=l,r+=n}),r<t.length&&(i[n].wordsNum+=t.length-r);let l=n,o=i.map(t=>t.regionNum);t.forEach(t=>{let e=0,s=0;t.regionIndex=-1;do{if(o[l]>0&&t.weight<=i[l].regionWeight){t.regionIndex=l,i[l].words.push(t),o[l]--,l=(l+1)%i.length;break}l=(l+1)%i.length,e++,++s>i.length+1&&(i.forEach(t=>{t.regionWeight+=.15}),s=0)}while(-1===t.regionIndex&&e<3*i.length);-1===t.regionIndex&&(t.regionIndex=n,i[n].words.push(t),o[n]--)}),i.forEach(t=>{t.words.sort((t,e)=>e.weight-t.weight)})})(t,i),"ensureMapping"===e.layoutMode?h(t,e,i):"ensureMappingEnlarge"===e.layoutMode?function(t,e,i){let{size:s,stepFactor:a,importantWordCount:n}=e,{segmentation:{regions:r},tempCanvas:l,boardSize:o,shapeCenter:u,shapeMaxR:g,shapeRatio:c}=i,y=l.getContext("2d",{willReadFrequently:!0}),x=p(i),m=x.slice(0),v=e.fontSizeEnlargeFactor,M=Math.min(n,t.length),S=0;t.length>M&&(S=t.sort((t,e)=>e.weight-t.weight)[M-1].weight);let _=0,w=1,k=!1;for(let n=0;n<r.length;n++){let{words:u,center:g,maxR:p,ratio:c}=r[n],b=!1;for(let n=0;n<u.length;n++){f(l,y,t,n);let r=u[n];if(r.x=g[0],r.y=g[1],r.hasText&&r.sprite&&d(m,r,p,c,s,o,a)){if(r.hasPlaced=!0,r.weight>=S&&_++,_>=M&&!k){w*=v,t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*v}),m=x.slice(0),b=!0,_=0;break}}else{if(r.weight>=S&&w>1){t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/v}),w/=v,k=!0,m=x.slice(0),b=!0;break}if(r.weight>=S)return h(t,e,i)}}b&&(n=-1)}for(let i=0;i<e.textLayoutTimes;i++){let i=t.filter(t=>(t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced));if(0===i.length)break;for(let t=0;t<i.length;t++){let e=i[t];f(l,y,i,t),e.x=u[0],e.y=u[1],e.hasText&&d(m,e,g,c,s,o,a)&&(e.hasPlaced=!0)}}e.board=m}(t,e,i):function(t,e,i){let{size:s,stepFactor:a}=e,{segmentation:{regions:n},tempCanvas:r,boardSize:l,shapeCenter:o,shapeMaxR:h,shapeRatio:u}=i,g=p(i),c=r.getContext("2d",{willReadFrequently:!0});for(let e of n){let{words:i,center:n,maxR:o,ratio:h}=e;for(let e=0;e<i.length;e++){f(r,c,t,e);let u=i[e];u.x=n[0],u.y=n[1],u.hasText&&u.sprite&&d(g,u,o,h,s,l,a)&&(u.hasPlaced=!0)}}for(let i=0;i<e.textLayoutTimes;i++){let i=t.filter(t=>(t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced));if(0===i.length)break;for(let t=0;t<i.length;t++){let e=i[t];f(r,c,i,t),e.x=o[0],e.y=o[1],e.hasText&&d(g,e,h,u,s,l,a)&&(e.hasPlaced=!0)}}e.board=g}(t,e,i);let s=function(t,e,i){let{size:s,fillingTimes:a,fillingXStep:n,fillingYStep:r,getFillingFontStyle:l,getFillingFontWeight:o,getFillingFontFamily:h,fillingInitialFontSize:d,fillingDeltaFontSize:p,fillingInitialOpacity:c,fillingDeltaOpacity:y,fillingRotateList:x,getFillingPadding:m,random:v,board:M,minFillFontSize:S}=e,{boardSize:_,shapeBounds:w,tempCanvas:k,randomGenerator:b}=i,z=k.getContext("2d",{willReadFrequently:!0}),R=d,F=c,T=[];for(let e=0;e<a;e++)(function(e,i){let a=t.map(t=>{let{text:s,color:a,fillingColor:n,hasPlaced:r,datum:d}=t;return{x:0,y:0,weight:0,text:s,fontFamily:h(d),fontStyle:l(d),fontWeight:o(d),fontSize:e,rotate:x[~~(b()*x.length)],padding:m(d),opacity:i,visible:!0,color:a,fillingColor:n,hasPlaced:r,datum:d}});D(a);let d=0,{x1:p,y1:c,x2:y,y2:S}=w,[R,F]=[p+~~(b()*n*2),c+~~(b()*r*2)];for(let t=F;t<=S;t+=r)for(let e=R;e<=y;e+=n){f(k,z,a,d);let i=a[d];i.x=e,i.y=t;let{wordSize:n,bounds:r,hasPlaced:l}=i;if(!l||!r){++d===a.length&&(d=0,v&&D(a));continue}let{dTop:o,dBottom:h,dLeft:p,dRight:c}=r;i.x-p<0||i.x+c>s[0]||i.y-o<0||i.y+h>s[1]||i.hasText&&i.sprite&&!g(i,M,_)&&(u(i,M,_),T.push(Object.assign({},i)),++d===a.length&&(d=0,v&&D(a)))}})(R,F),R=Math.max(R>p?R-p:p,S),F=F>y?F-y:y;return T;function D(t){return t.sort(()=>b()-.5)}}(t,e,i),a=[],n=[];for(let e=0;e<t.length;e++)t[e].hasPlaced?n.push(t[e]):a.push(t[e]);return a.forEach(t=>t.visible=!1),{fillingWords:s,successedWords:n,failedWords:a}}(ta,q,O),th=null!=(C=null==(I=W.text)?void 0:I.field)?C:"textKey",td=null!=(Z=W.dataIndexKey)?Z:"defaultDataIndexKey",tu=W.as?Object.assign(Object.assign({},F),W.as):F,tg=[];for(let t=0;t<ta.length;++t)(A=(P=ta[t]).datum)[tu.x]=P.x,A[tu.y]=P.y,A[tu.fontFamily]=P.fontFamily,A[tu.fontSize]=P.fontSize,A[tu.fontStyle]=P.fontStyle,A[tu.fontWeight]=P.fontWeight,A[tu.angle]=(0,_.M4)(P.rotate),A[tu.opacity]=P.opacity,A[tu.visible]=P.visible,A[tu.isFillingWord]=!1,A[tu.color]=P.color,A[td]=`${P.text}_${t}_keyword`,tg.push(A);let tf=[];tr.forEach((t,e)=>{var i,s;let a=Object.assign({},t.datum);a[tu.x]=t.x,a[tu.y]=t.y,a[tu.fontFamily]=t.fontFamily,a[tu.fontSize]=t.fontSize,a[tu.fontStyle]=t.fontStyle,a[tu.fontWeight]=t.fontWeight,a[tu.angle]=(0,_.M4)(t.rotate),a[tu.opacity]=t.opacity,a[tu.visible]=t.visible,a[tu.isFillingWord]=!0,a[tu.color]=X?(null==(i=W.colorField)?void 0:i.field)===(null==(s=W.fillingColorField)?void 0:s.field)&&j?t.color:t.fillingColor:q.fillingColorList[~~(E.randomGenerator()*q.fillingColorList.length)],a[th]=t.text,a[td]=`${t.text}_${e}_fillingWords`,tf.push(a)}),this.options.onLayoutFinished&&this.options.onLayoutFinished({successedWords:tl,failedWords:to}),this.progressiveResult=tg.concat(tf)}release(){this.segmentationInput=null,this.data=null,this.progressiveResult=null,this.options=null}}let D=(t,e,i,s)=>{var a,n,r,l;let{colorMode:o,getColor:h,getFillingColor:d}=e,{sameColorList:u}=i,g,f,p=e.colorList,c=i.fillingColorList;if("ordinal"===o){let e=t.map(t=>h(t));if(g=t=>(new b.J).domain(e).range(p).scale(t),d&&((null==(a=s.colorField)?void 0:a.field)!==(null==(n=s.fillingColorField)?void 0:n.field)||!u)){let e=t.map(t=>d(t));f=t=>(new b.J).domain(e).range(c).scale(t)}}else{1===p.length&&(p=[p[0],p[0]]);let e=(new z.f).domain(C(h,t)).range(p);if(g=t=>e.scale(t),d&&((null==(r=s.colorField)?void 0:r.field)!==(null==(l=s.fillingColorField)?void 0:l.field)||!u)){1===c.length&&(c=[c[0],c[0]]);let e=(new z.f).domain(C(d,t)).range(c);f=t=>e.scale(t)}}Object.assign(e,{colorScale:g,fillingColorScale:f})},L=(t,e,i)=>{let s,{fontSizeRange:a}=e,{getFontSize:n,getText:r}=e;if(n){if(n&&a){let e=(new R.a).domain(C(n,t)).range(a);s=t=>e.scale(n(t))}else if(n&&(0,w.Z)(n)&&!a){let[e,l]=C(n,t),o=I(t.map(t=>({text:r(t),value:n(t),weight:l===e?1:(n(t)-e)/(l-e)})),i,!0);a=[~~(.5*o),~~o];let h=(new R.a).domain(C(n,t)).range(a);s=t=>h.scale(n(t))}}else{var l;s="function"==typeof(l=I(t.map(t=>({text:r(t)})),i,!1))?l:function(){return l}}Object.assign(e,{getFontSize:n,fontSizeRange:a,fontSizeScale:s})},I=(t,e,i)=>{let s=e.shapeArea,a=e.ratio,n=e.segmentation.regions,r=Math.ceil(Math.sqrt(s)/12),l=t.reduce((t,e)=>{let s=o(e.text);return s<r?t+s*(i?(.5+.5*e.weight)**2:1):t},0);if(0===l)return 12;let h=20;if(1===n.length)h=Math.sqrt(s/(1.7*l)*a);else{let t=[];for(let e=0;e<n.length;e++){let i=n[e].area,r=n[e].ratio,o=i/s;if(o<.1)continue;let h=Math.sqrt(i/(l*(r<1?2.7-r:1.7)*o)*a);t.push(h)}h=t.length?Math.min(...t):Math.sqrt(s/(1.7*l)*a)}return h},C=(t,e)=>{let i,s=1/0,a=-1/0,n=e.length;for(let r=0;r<n;++r)(i=(0,k.H)(t(e[r])))<s&&(s=i),i>a&&(a=i);return 1===e.length&&s===a&&(s-=1e4),[s,a]},Z=(t,e,i)=>{if(!t.size||(0,n.Z)(t.size[0])||(0,n.Z)(t.size[1])||t.size[0]<=0||t.size[1]<=0)return r.Y.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];if(t.size=[Math.ceil(t.size[0]),Math.ceil(t.size[1])],t.shape||r.Y.getInstance().error("WordcloudShape shape must be specified."),t.text||r.Y.getInstance().error("WordcloudShape text must be specified."),t.onBeforeLayout&&t.onBeforeLayout(),!e||0===e.length)return[];let s=new T(t);return s.layout(e),s.unfinished()?{progressive:s}:s.output()}},830327:function(t,e,i){i.d(e,{v:()=>R});var s=i(801983),a=i(25279),n=i(580164),r=i(897682),l=i(895611),o=i(543091),h=i(835574);let d=(t,e)=>"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(e-t)+t).toFixed()+"%)";function u(t){return(0,a.Z)(t)?t:function(){return t}}class g{constructor(t){var e,i;switch(this.options=(0,s.Z)({},g.defaultOptions,t),(0,a.Z)(this.options.shape)?this.shape=this.options.shape:this.shape=(0,h.jc)(this.options.shape),this.getText=null!=(e=u(this.options.text))?e:t=>t,this.getTextFontWeight=u(this.options.fontWeight),this.getTextFontSize=u(this.options.fontSize),this.getTextFontStyle=u(this.options.fontStyle),this.getTextFontFamily=u(this.options.fontFamily),this.outputCallback=null!=(i=this.options.outputCallback)?i:t=>t,this.options.color){case"random-dark":this.getTextColor=()=>d(10,50);break;case"random-light":this.getTextColor=()=>d(50,90);break;default:this.getTextColor=u(this.options.color)}if((0,n.Z)(this.options.rotate))if(this.options.useRandomRotate){let t=Math.abs(this.options.maxRotation-this.options.minRotation),e=Math.abs(Math.floor(this.options.rotationSteps)),i=Math.min(this.options.maxRotation,this.options.minRotation);this.getTextRotate=()=>0===this.options.rotateRatio||Math.random()>this.options.rotateRatio?0:0===t?i:e>0?i+Math.floor(Math.random()*e)*t/(e-1):i+Math.random()*t}else this.getTextRotate=()=>0;else this.getTextRotate=(0,a.Z)(this.options.rotate)?t=>{var e;return(0,r.M4)(null!=(e=this.options.rotate(t))?e:0)}:(t,e)=>{let i=(0,l.IX)(this.options.rotate),s=this.options.random?Math.random():(0,o.b8)(e);return(0,r.M4)(i[Math.floor(s*i.length)])}}canRepeat(){return!1}exceedTime(){var t;return this.options.progressiveStep>0?this.progressiveIndex>=((null!=(t=this.currentStepIndex)?t:-1)+1)*this.options.progressiveStep:this.options.progressiveTime>0&&(new Date).getTime()-this.escapeTime>this.options.progressiveTime}progressiveRun(){var t;if(this.options.progressiveStep>0?this.currentStepIndex=(null!=(t=this.currentStepIndex)?t:-1)+1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.data&&this.progressiveIndex<this.data.length){this.progressiveResult=[];let t=this.progressiveIndex,e=0,i=this.options.maxSingleWordTryCount,s=Math.min(this.options.maxFailCount,this.originalData.length);for(;t<this.data.length&&this.failCount<s;){let a=this.layoutWord(t);if(e++,(a||e>i)&&(t++,e=0,this.failCount=a?0:this.failCount+1),this.progressiveIndex=t,this.exceedTime())break;t===this.data.length&&this.failCount<s&&this.options.repeatFill&&this.canRepeat()&&(this.data=[...this.data,...this.originalData.map(t=>Object.assign(Object.assign({},t),{isFill:!0}))],this.isTryRepeatFill=!0)}return this.progressiveResult}return this.result}initProgressive(){this.failCount=0,this.progressiveIndex=0,this.options.progressiveStep>0?this.currentStepIndex=-1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.progressiveResult=[]}output(){return this.result?this.outputCallback(this.result):null}progressiveOutput(){return this.progressiveResult?this.outputCallback(this.progressiveResult):null}unfinished(){return this.data&&this.data.length&&!(0,n.Z)(this.progressiveIndex)&&this.progressiveIndex<this.data.length}release(){this.data=null,this.result=null,this.progressiveIndex=null,this.progressiveResult=null}}g.defaultOptions={fontFamily:'"Trebuchet MS", "Heiti TC", "\u5FAE\u8EDF\u6B63\u9ED1\u9AD4", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",fontStyle:"normal",minFontSize:12,drawOutOfBound:!1,shrink:!1,minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationSteps:0,rotateRatio:.1,random:!1,shape:"circle",progressiveTime:0,progressiveStep:0,repeatFill:!1,fillTextFontSize:12,maxFailCount:20};let f={archimedean:function(t){let e=t[0]/t[1];return t=>[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]},rectangular:function(t){let e=4*t[0]/t[1],i=0,s=0;return t=>{let a=t<0?-1:1;switch(Math.sqrt(1+4*a*t)-a&3){case 0:i+=e;break;case 1:s+=4;break;case 2:i-=e;break;default:s-=4}return[i,s]}}};var p=i(713628);class c extends g{constructor(t){var e;super((0,s.Z)({},c.defaultOptions,t)),this.cw=64,this.ch=2048,this._size=[256,256],this._isBoardExpandCompleted=!1,this._placeStatus=0,this._tTemp=null,this._dtTemp=null,this._dy=0,this.cacheMap=new Map,this.options.minFontSize<=c.defaultOptions.minFontSize&&(this.options.minFontSize=c.defaultOptions.minFontSize),this.spiral=(0,p.Z)(this.options.spiral)?null!=(e=f[this.options.spiral])?e:f.archimedean:this.options.spiral,this.random=this.options.random?Math.random:()=>1,this.getTextPadding=u(this.options.padding)}zoomRatio(){return this._originSize[0]/this._size[0]}dy(){return this._dy}layoutWord(t){let e=this.data[t];if(""===(""+e.text).trim())return!0;let{maxRadius:i,center:s}=(0,h.nf)(this.options.shape,this._size);if(e.x=s[0],e.y=s[1],function(t,e,i,s,a,n){let r,l,o,h,d;if(e.sprite)return;let u=t.context,g=t.ratio;u.setTransform(g,0,0,g,0,0),u.clearRect(0,0,(a<<5)/g,n/g);let f=0,p=0,c=0,y=i.length;for(--s;++s<y;){if(e=i[s],u.save(),u.font=e.fontStyle+" "+e.fontWeight+" "+~~((e.fontSize+1)/g)+"px "+e.fontFamily,r=u.measureText(e.text+"m").width*g,o=e.fontSize<<1,e.angle){let t=Math.sin(e.angle),i=Math.cos(e.angle),s=r*i,a=r*t,n=o*i,l=o*t;r=Math.max(Math.abs(s+l),Math.abs(s-l))+31>>5<<5,o=~~Math.max(Math.abs(a+n),Math.abs(a-n))}else r=r+31>>5<<5;if(o>c&&(c=o),f+r>=a<<5&&(f=0,p+=c,c=0),p+o>=n)break;u.translate((f+(r>>1))/g,(p+(o>>1))/g),e.angle&&u.rotate(e.angle),u.fillText(e.text,0,0),e.padding&&(u.lineWidth=2*e.padding,u.strokeText(e.text,0,0)),u.restore(),e.width=r,e.height=o,e.xoff=f,e.yoff=p,e.x1=r>>1,e.y1=o>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,f+=r}let x=u.getImageData(0,0,(a<<5)/g,n/g).data,m=[];for(;--s>=0;){if(!(e=i[s]).hasText)continue;for(l=(r=e.width)>>5,o=e.y1-e.y0,h=0;h<o*l;h++)m[h]=0;if(null==(f=e.xoff))return;p=e.yoff;let t=0,n=-1;for(d=0;d<o;d++){for(h=0;h<r;h++){let e=l*d+(h>>5),i=x[(p+d)*(a<<5)+(f+h)<<2]?1<<31-h%32:0;m[e]|=i,t|=i}t?n=d:(e.y0++,o--,d--,p++)}e.y1=e.y0+n,e.sprite=m.slice(0,(e.y1-e.y0)*l)}}(this.contextAndRatio,e,this.data,t,this.cw,this.ch),this._placeStatus=0,e.hasText&&this.place(this._board,e,this._bounds,i))return this.result.push(e),this._bounds?function(t,e){let i=t[0],s=t[1];e.x+e.x0<i.x&&(i.x=e.x+e.x0),e.y+e.y0<i.y&&(i.y=e.y+e.y0),e.x+e.x1>s.x&&(s.x=e.x+e.x1),e.y+e.y1>s.y&&(s.y=e.y+e.y1)}(this._bounds,e):this._bounds=[{x:e.x+e.x0,y:e.y+e.y0},{x:e.x+e.x1,y:e.y+e.y1}],e.x-=this._size[0]>>1,e.y-=this._size[1]>>1,this._tTemp=null,this._dtTemp=null,!0;if(this.updateBoardExpandStatus(e.fontSize),e.hasText&&this.shouldShrinkContinue()){if(1===this._placeStatus){let t=e.fontSize*this._originSize[0]/this.options.minFontSize,i=Math.max(e.width,e.height);if(i<=t)this.expandBoard(this._board,this._bounds,i/this._size[0]);else{if(!this.options.clip)return!0;this.expandBoard(this._board,this._bounds,t/this._size[0])}}else this._placeStatus,this.expandBoard(this._board,this._bounds);return this.updateBoardExpandStatus(e.fontSize),!1}return this._tTemp=null,this._dtTemp=null,!0}layout(t,e){this.initProgressive(),this.result=[],this._size=[e.width,e.height],this.clearCache(),this._originSize=[...this._size];let i=this.getContext(this.options.createCanvas({width:1,height:1}));this.contextAndRatio=i,this._board=Array((this._size[0]>>5)*this._size[1]).fill(0),this._bounds=null,t.length,this.result=[];let s=t.map((t,e)=>({text:this.getText(t),fontFamily:this.getTextFontFamily(t),fontStyle:this.getTextFontStyle(t),fontWeight:this.getTextFontWeight(t),angle:this.getTextRotate(t,e),fontSize:~~this.getTextFontSize(t),padding:this.getTextPadding(t),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:t,x:0,y:0,width:0,height:0})).sort(function(t,e){return e.fontSize-t.fontSize});if(this.originalData=s,this.data=s,this.progressiveRun(),!this.options.clip&&this.options.enlarge&&this._bounds&&this.shrinkBoard(this._bounds),this._bounds&&["cardioid","triangle","triangle-upright"].includes(this.options.shape)){let t=(this._bounds[0].y+this._bounds[1].y)/2;this._dy=-(t-this._originSize[1]/2)}return this.result}formatTagItem(t){let e,i,s=this._size,a=this.zoomRatio(),n=this.dy(),r=s[0]>>1,l=s[1]>>1,o=t.length,h=[];for(let s=0;s<o;++s)e=t[s],(i={}).datum=e.datum,i.x=(e.x+r)*a,i.y=(e.y+l+n)*a,i.fontFamily=e.fontFamily,i.fontSize=e.fontSize*a,i.fontStyle=e.fontStyle,i.fontWeight=e.fontWeight,i.angle=e.angle,h.push(i);return h}output(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.result)):this.formatTagItem(this.result)}progressiveOutput(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.progressiveResult)):this.formatTagItem(this.progressiveResult)}updateBoardExpandStatus(t){this._isBoardExpandCompleted=t*(this._originSize[0]/this._size[0])<this.options.minFontSize}shouldShrinkContinue(){return!this.options.clip&&this.options.shrink&&!this._isBoardExpandCompleted}shrinkBoard(t){let e=t[0],i=t[1];if(i.x>=this._size[0]||i.y>=this._size[1])return;let s=Math.min(e.x,this._size[0]-i.x),a=Math.min(e.y,this._size[1]-i.y),n=2*Math.min(s/this._size[0],a/this._size[1]);this._size=this._size.map(t=>t*(1-n))}expandBoard(t,e,i){let s=this._size[0]*(i||1.1)-this._size[0]>>5,a=2*s>2?s:2;a%2!=0&&a++;let n=Math.ceil(this._size[1]*(a<<5)/this._size[0]);n%2!=0&&n++;let r=this._size[0],l=this._size[1],o=Array(a).fill(0),h=Array(n/2*(a+(r>>5))).fill(0);this.insertZerosToArray(t,l*(r>>5),h.length+a/2);for(let e=l-1;e>0;e--)this.insertZerosToArray(t,e*(r>>5),o.length);this.insertZerosToArray(t,0,h.length+a/2),this._size=[r+(a<<5),l+n],e&&(e[0].x+=(a<<5)/2,e[0].y+=n/2,e[1].x+=(a<<5)/2,e[1].y+=n/2)}insertZerosToArray(t,e,i){if(this.options.customInsertZerosToArray)return this.options.customInsertZerosToArray(t,e,i);let s=Math.floor(i/6e4);for(let i=0;i<s;i++)t.splice(e+6e4*i,0,...Array(6e4).fill(0));t.splice(e+6e4*s,0,...Array(i%6e4).fill(0))}getContext(t){t.width=1,t.height=1;let e=Math.sqrt(t.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,1,1).data.length>>2);t.width=(this.cw<<5)/e,t.height=this.ch/e;let i=t.getContext("2d",{willReadFrequently:!0});return i.fillStyle=i.strokeStyle="red",i.textAlign="center",{context:i,ratio:e,canvas:t}}place(t,e,i,s){let a=!1;if(this.shouldShrinkContinue()&&(e.width>this._size[0]||e.height>this._size[1]))return this._placeStatus=1,!1;let n=.5>this.random()?1:-1;if(!this.shouldShrinkContinue()&&this.isSizeLargerThanMax(e,n))return null;let r=e.x,l=e.y,o=Math.sqrt(this._size[0]*this._size[0]+this._size[1]*this._size[1]),h=this.spiral(this._size),d,u,g,f,p=-n;for(this._tTemp=null,this._dtTemp=null;d=h(p+=n);){let h=Math.sqrt((u=d[0])**2+(g=d[1])**2),v=Math.atan(g/u);u<0?v+=Math.PI:g<0&&(v=2*Math.PI+v);let M=this.shape(v);if(Math.min(Math.abs(u),Math.abs(g))>=o)break;if(h>=s)a&&null===this._tTemp&&(this._tTemp=p,this._dtTemp=n);else{var c,m;if(e.x=r+~~(h*M*Math.cos(-v)),e.y=l+~~(h*M*Math.sin(-v)),f=e,this.options.clip)if(this.shouldShrinkContinue()){if(x(f,this._size)){a&&null===this._tTemp&&(this._tTemp=p,this._dtTemp=n);continue}}else{if(y(f,this._size)){a&&null===this._tTemp&&(this._tTemp=p,this._dtTemp=n);continue}x(f,this._size)&&(f=function(t,e){let i=t.sprite,s=t.y1-t.y0,a=t.width>>5,n=0,r=[],l=Math.max(-(t.y0+t.y),0),o=Math.min(s+(e[1]-(t.y1+t.y)),s),h=Math.max(-(t.x0+t.x),0)>>5,d=Math.min(a+(e[0]-(t.x1+t.x)>>5)+1,a);for(let t=0;t<s;t++){for(let e=0;e<a;e++)t<l||o<=t||e<h||d<=e||r.push(i[n+e]);n+=a}let u=h<<5,g=a-d<<5,f=s-o;return Object.assign(Object.assign({},t),{width:t.width-u-g,height:t.height-l-f,x0:t.x0+u,x1:t.x1-g,y0:t.y0+l,y1:t.y1-f,x:t.x+u/2-g/2,sprite:r})}(f,this._size))}else if(x(f,this._size)){a&&null===this._tTemp&&(this._tTemp=p,this._dtTemp=n);continue}if(a=!0,(!i||(c=f,m=i,c.x+c.x1>m[0].x&&c.x+c.x0<m[1].x&&c.y+c.y1>m[0].y&&c.y+c.y0<m[1].y))&&(!i||!function(t,e,i){let s=i[0]>>5,a=t.sprite,n=t.width>>5,r=t.x-(n<<4),l=127&r,o=32-l,h=t.y1-t.y0,d,u=(t.y+t.y0)*s+(r>>5);for(let t=0;t<h;t++){d=0;for(let i=0;i<=n;i++)if((d<<o|(i<n?(d=a[t*n+i])>>>l:0))&e[u+i])return!0;u+=s}return!1}(f,t,this._size))){let i=f.sprite,s=f.width>>5,a=this._size[0]>>5,n=f.x-(s<<4),r=127&n,l=32-r,o=f.y1-f.y0,h,d=(f.y+f.y0)*a+(n>>5);for(let e=0;e<o;e++){h=0;for(let a=0;a<=s;a++)t[d+a]|=h<<l|(a<s?(h=i[e*s+a])>>>r:0);d+=a}return e.sprite=null,f.sprite=null,!0}}}return null!==this._tTemp&&(this._placeStatus=3),this.shouldShrinkContinue()||this.setCache(f,n),!1}clearCache(){this.cacheMap.clear()}setCache(t,e){let i=`${t.angle}-${e}`,s=t.x1-t.x0,a=t.y1-t.y0;if(!this.cacheMap.has(i))return void this.cacheMap.set(i,{width:s,height:a});let{width:n,height:r}=this.cacheMap.get(i);(s<n&&a<r||s<=n&&a<r)&&this.cacheMap.set(i,{width:s,height:a})}isSizeLargerThanMax(t,e){let i=`${t.angle}-${e}`;if(!this.cacheMap.has(i))return!1;let{width:s,height:a}=this.cacheMap.get(i),n=t.x1-t.x0,r=t.y1-t.y0;return n>=s&&r>=a}}c.defaultOptions={enlarge:!1,minFontSize:2,maxSingleWordTryCount:2};let y=(t,e)=>t.x+t.x0>e[0]||t.y+t.y0>e[0]||t.x+t.x1<0||t.y+t.y1<0,x=(t,e)=>t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>e[0]||t.y+t.y1>e[1];var m=i(63199),v=i(458539);class M extends g{constructor(t){super((0,s.Z)({},M.defaultOptions,t)),this.fillGridAt=(t,e)=>{t>=this.ngx||e>=this.ngy||t<0||e<0||(this.grid[t][e]=!1)},this.updateGrid=(t,e,i,s,a)=>{let n=a.occupied,r=n.length;for(;r--;){let i=t+n[r][0],s=e+n[r][1];i>=this.ngx||s>=this.ngy||i<0||s<0||this.fillGridAt(i,s)}},this.gridSize=Math.max(Math.floor(this.options.gridSize),4)}getPointsAtRadius(t){if(this.pointsAtRadius[t])return this.pointsAtRadius[t];let e=8*t,i=e,s=[];for(0===t&&s.push([this.center[0],this.center[1],0]);i--;){let a=this.shape(i/e*2*Math.PI);s.push([this.center[0]+t*a*Math.cos(-i/e*2*Math.PI),this.center[1]+t*a*Math.sin(-i/e*2*Math.PI)*this.options.ellipticity,i/e*2*Math.PI])}return this.pointsAtRadius[t]=s,s}getTextInfo(t,e=1,i){var s;let a=this.options.clip?1:e,n=Math.max(Math.floor((this.isTryRepeatFill?this.options.fillTextFontSize:this.getTextFontSize(t))*a),this.options.minFontSize),r=this.getText(t)+"";if(this.options.clip&&(r=r.slice(0,Math.ceil(r.length*e))),!r)return null;let l=this.getTextFontWeight(t),o=this.getTextFontStyle(t),h=this.getTextRotate&&null!=(s=this.getTextRotate(t,i))?s:0,d=this.getTextFontFamily(t),u=this.options.createCanvas({width:1,height:1}),g=u.getContext("2d",{willReadFrequently:!0});g.font=o+" "+l+" "+n.toString(10)+"px "+d;let f=g.measureText(r).width,p=Math.max(n,g.measureText("m").width,g.measureText("\uFF37").width),c=f+2*p,y=3*p,x=Math.ceil(c/this.gridSize),m=Math.ceil(y/this.gridSize);c=x*this.gridSize;let v=-f/2,M=-(.4*p),S=Math.ceil((c*Math.abs(Math.sin(h))+(y=m*this.gridSize)*Math.abs(Math.cos(h)))/this.gridSize),_=Math.ceil((c*Math.abs(Math.cos(h))+y*Math.abs(Math.sin(h)))/this.gridSize),w=_*this.gridSize,k=S*this.gridSize;u.setAttribute("width",""+w),u.setAttribute("height",""+k),g.scale(1,1),g.translate(w/2,k/2),g.rotate(-h),g.font=o+" "+l+" "+n.toString(10)+"px "+d,g.fillStyle="#000",g.textBaseline="middle",g.fillText(r,v,M);let b=g.getImageData(0,0,w,k).data;if(this.exceedTime())return null;let z=[],R,F=_,T=[S/2,_/2,S/2,_/2],D=(t,e,i)=>{let s=this.gridSize;for(;s--;){let a=this.gridSize;for(;a--;)if(b[4*((e*this.gridSize+s)*w+(t*this.gridSize+a))+3])return i.push([t,e]),t<T[3]&&(T[3]=t),t>T[1]&&(T[1]=t),e<T[0]&&(T[0]=e),void(e>T[2]&&(T[2]=e))}};for(;F--;)for(R=S;R--;)D(F,R,z);return{datum:t,occupied:z,bounds:T,gw:_,gh:S,fillTextOffsetX:v,fillTextOffsetY:M,fillTextWidth:f,fillTextHeight:p,fontSize:n,fontStyle:o,fontWeight:l,fontFamily:d,angle:h,text:r}}calculateEmptyRate(){let t=this.ngx*this.ngy,e=0;for(let t=0;t<this.ngx;t++)for(let i=0;i<this.ngy;i++)this.grid[t][i]&&e++;return e/t}canFitText(t,e,i,s,a){let n=a.length;for(;n--;){let i=t+a[n][0],s=e+a[n][1];if(i>=this.ngx||s>=this.ngy||i<0||s<0){if(!this.options.drawOutOfBound)return!1}else if(!this.grid[i][s])return!1}return!0}layoutWord(t,e=1){let i=this.data[t],s=this.getTextInfo(i,e,t);if(!s||this.exceedTime())return!1;if(!this.options.drawOutOfBound&&(!this.options.shrink||s.fontSize<=this.options.minFontSize)&&!this.options.clip){let t=s.bounds;if(t[1]-t[3]+1>this.ngx||t[2]-t[0]+1>this.ngy)return!1}let a=this.maxRadius+1,n=t=>{let e=Math.floor(t[0]-s.gw/2),i=Math.floor(t[1]-s.gh/2),n=s.gw,r=s.gh;return!!this.canFitText(e,i,n,r,s.occupied)&&(s.distance=this.maxRadius-a,s.theta=t[2],this.outputText(e,i,s),this.updateGrid(e,i,n,r,s),!0)};for(;a--;){let t=this.getPointsAtRadius(this.maxRadius-a);if(this.options.random&&(t=[].concat(t),(0,l.Sy)(t)),t.some(n))return!0}return(this.options.clip||!!(this.options.shrink&&s.fontSize>this.options.minFontSize))&&this.layoutWord(t,.75*e)}outputText(t,e,i){let s=this.getTextColor(i),a={text:i.text,datum:i.datum,color:s,fontStyle:i.fontStyle,fontWeight:i.fontWeight,fontFamily:i.fontFamily,angle:i.angle,width:i.fillTextWidth,height:i.fillTextHeight,x:(t+i.gw/2)*this.gridSize,y:(e+i.gh/2)*this.gridSize+i.fillTextOffsetY+.5*i.fontSize,fontSize:i.fontSize};this.result.push(a),this.progressiveResult&&this.progressiveResult.push(a)}initGrid(t){this.grid=[];let e=this.options.shape;if((0,v.Z)(e)){let i=(0,m.rp)(e,t.width,t.height,void 0,!1,this.options.createCanvas),s=i.getContext("2d").getImageData(0,0,this.ngx*this.gridSize,this.ngy*this.gridSize);this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(i);let a=(0,m.at)(e.backgroundColor,void 0,this.options.createCanvas),n=(t,e)=>{let i=this.gridSize;for(;i--;){let n=this.gridSize;for(;n--;)if(!a(s,e*this.gridSize+i,t*this.gridSize+n))return void(this.grid[t][e]=!0)}this.grid[t][e]=!1},r=this.ngx;for(;r--;){this.grid[r]=[];let t=this.ngy;for(;t--;)n(r,t),!1!==this.grid[r][t]&&(this.grid[r][t]=!0)}s=a=void 0}else{let t=this.ngx;for(;t--;){this.grid[t]=[];let e=this.ngy;for(;e--;)this.grid[t][e]=!0}}}canRepeat(){return this.calculateEmptyRate()>.001}layout(t,e){this.initProgressive(),this.drawnCount=0,this.isTryRepeatFill=!1,this.originalData=t,this.data=t,this.pointsAtRadius=[],this.ngx=Math.floor(e.width/this.gridSize),this.ngy=Math.floor(e.height/this.gridSize);let{center:i,maxRadius:s}=(0,h.nf)(this.options.shape,[e.width,e.height]);return this.center=e.origin?[e.origin[0]/this.gridSize,e.origin[1]/this.gridSize]:[i[0]/this.gridSize,i[1]/this.gridSize],this.maxRadius=Math.floor(s/this.gridSize),this.initGrid(e),this.result=[],this.progressiveRun()}}M.defaultOptions={gridSize:8,ellipticity:1,maxSingleWordTryCount:1};class S extends g{constructor(t){super((0,s.Z)({},S.defaultOptions,t)),this.random=this.options.random?Math.random:()=>0,this.aspectRatio=1}fit(t){for(let s=0,a=this.result.length;s<a;s++){var e,i;if(e=t,i=this.result[s],!(e.left+e.width<i.left||e.top+e.height<i.top||e.left>i.left+i.width||e.top>i.top+i.height))return!1}return!0}getTextInfo(t,e){let i={datum:t,fontSize:this.getTextFontSize(t),fontWeight:this.getTextFontWeight(t),fontStyle:this.getTextFontStyle(t),fontFamily:this.getTextFontFamily(t),angle:this.getTextRotate(t,e),text:this.getText(t)+"",x:this.center[0],y:this.center[1]},s=this.options.getTextBounds(i);return i.width=s.width(),i.height=s.height(),i.top=this.center[1]-i.height+.21*i.height,i.left=this.center[0]-i.width/2,i}layoutWord(t){let e=this.getTextInfo(this.data[t],t),i=2*Math.PI,s=0,a=e.left,n=e.top,r=e.width,l=e.height,o=1,h=this.fit(e);for(;!h&&s<this.maxRadius;)s+=.5,o=this.shape(s/this.maxRadius*2*Math.PI),i+=.5*(this.options.random?this.random()>.5?1:-1:t%2==0?1:-1),a=this.center[0]-r/2+s*o*Math.cos(i)*this.aspectRatio,n=this.center[1]-l/2+s*o*Math.sin(i),e.left=a,e.top=n,e.x=a+r/2,e.y=n+l/2,h=this.fit(e);return!!h&&!!(this.options.clip||e.left>=0&&e.left+e.width<=this.width&&e.top>=0&&e.top+e.height<=this.height)&&(this.result.push(e),!0)}layout(t,e){if(!(null==t?void 0:t.length))return[];this.initProgressive(),this.result=[],this.maxRadius=Math.sqrt(e.width*e.width+e.height*e.height)/2,this.center=[e.width/2,e.height/2],this.width=e.width,this.height=e.height,this.data=t.sort((t,e)=>this.getTextFontSize(e)-this.getTextFontSize(t));let i=0;for(;i<t.length&&(this.layoutWord(i),i++,this.progressiveIndex=i,!this.exceedTime()););return this.result}}S.defaultOptions={enlarge:!1};var _=i(473729),w=i(851111),k=i(89841),b=i(434288);let z={x:"x",y:"y",z:"z",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle"},R=(t,e)=>{var i,s,a,n,r,l;if(t.size&&(t.size[0]<=0||t.size[1]<=0))return _.Y.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];let o=(null!=(i=t.size)?i:[500,500]).slice();o[0]=Math.floor(o[0]),o[1]=Math.floor(o[1]);let h=t.fontFamily?F(t.fontFamily):"sans-serif",d=t.fontStyle?F(t.fontStyle):"normal",u=t.fontWeight?F(t.fontWeight):"normal",g=t.rotate?F(t.rotate):0,f=F(t.text),p=null!=(s=t.spiral)?s:"archimedean",y=t.padding?F(t.padding):1,x=null!=(a=t.shape)?a:"square",m=null!=(n=t.shrink)&&n,v=null!=(r=t.enlarge)&&r,k=null!=(l=t.clip)&&l,b=t.minFontSize,R=t.randomVisible,T=t.as?Object.assign(Object.assign({},z),t.as):z,I=t.depth_3d,C=t.postProjection,Z=t.fontSize?F(t.fontSize):14,P=t.fontSizeRange;if(P&&!(0,w.Z)(Z)){let t=Z,i=D(L(t,e),P);Z=e=>i(t(e))}let A=c;"fast"===t.layoutType?A=S:"grid"===t.layoutType&&(A=M);let E=new A(Object.assign(Object.assign({},t),{text:f,padding:y,spiral:p,shape:x,rotate:g,fontFamily:h,fontStyle:d,fontWeight:u,fontSize:Z,shrink:m,clip:k,enlarge:v,minFontSize:b,random:R,outputCallback:e=>{let i,s,a=[];for(let n=0,r=e.length;n<r;n++)(i=(s=e[n]).datum)[T.x]=s.x,i[T.y]=s.y,i[T.fontFamily]=s.fontFamily,i[T.fontSize]=s.fontSize,i[T.fontStyle]=s.fontStyle,i[T.fontWeight]=s.fontWeight,i[T.angle]=s.angle,"StereographicProjection"===C&&function(t,e,i,s,a){let n=Math.max(t[0],t[1])/2,r=function(t,e,i,s,a){let{x:n,y:r}=a,l=n/t*Math.PI*2,o=Math.PI-r/e*Math.PI;return{x:i*Math.sin(o+=(o<Math.PI/2?1:-1)*Math.pow(Math.min(o-Math.PI/2,1),2)/5)*Math.cos(l)+s.x,y:i*Math.cos(o)+s.y,z:i*Math.sin(o)*Math.sin(l)+s.z}}(t[0],t[1],n,{x:n,y:n,z:null!=a?a:n},e);i[s.x]=r.x,i[s.y]=r.y,i[s.z]=r.z}(o,s,i,T,I),t.dataIndexKey&&(i[t.dataIndexKey]=`${n}`),a.push(i);return a}}));return E.layout(e,{width:o[0],height:o[1]}),t.progressiveStep>0||t.progressiveTime>0?{progressive:E}:E.output()},F=t=>(0,p.Z)(t)||(0,w.Z)(t)||(0,a.Z)(t)||(0,k.Z)(t)?t:e=>e[t.field],T=t=>t<0?-Math.sqrt(-t):Math.sqrt(t),D=(t,e,i)=>{if(t[0]===t[1])return t=>e[0];let s=T(t[0]),a=T(t[1]),n=Math.min(s,a),r=Math.max(s,a);return t=>(T(t)-n)/(r-n)*(e[1]-e[0])+e[0]},L=(t,e)=>{let i,s=1/0,a=-1/0,n=e.length;for(let r=0;r<n;++r)(i=(0,b.H)(t(e[r])))<s&&(s=i),i>a&&(a=i);return 1===e.length&&s===a&&(s-=1e4),[s,a]}}}]);