"use strict";(window.webpackChunkweb=window.webpackChunkweb||[]).push([["40057"],{119164:function(e,t,i){i.r(t),i.d(t,{Collector:()=>tu});var n=function(){return(n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function r(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return a}function o(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e}var a,s=(function(e,t){e.exports=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function i(n){function r(){}function o(t,i,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},r.defaults,o)).expires&&(o.expires=new Date(+new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(i);/^[\{\[]/.test(a)&&(i=a)}catch(e){}i=n.write?n.write(i,t):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in o)o[c]&&(s+="; "+c,!0!==o[c]&&(s+="="+o[c].split(";")[0]));return document.cookie=t+"="+i+s}}function a(e,i){if("undefined"!=typeof document){for(var r={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),c=s.slice(1).join("=");i||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=t(s[0]);if(c=(n.read||n)(c,l)||t(c),i)try{c=JSON.parse(c)}catch(e){}if(r[l]=c,e===l)break}catch(e){}}return e?r[e]:r}}return r.set=o,r.get=function(e){return a(e,!1)},r.getJSON=function(e){return a(e,!0)},r.remove=function(t,i){o(t,"",e(i,{expires:-1}))},r.defaults={},r.withConverter=i,r}(function(){})}()}(a={exports:{}},a.exports),a.exports),c=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e}(),l={getItem:function(e){try{var t=localStorage.getItem(e),i=t;try{t&&"string"==typeof t&&(i=JSON.parse(t))}catch(e){}return i||void 0}catch(e){}},setItem:function(e,t){try{var i="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,i)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){try{return s.get(e,{domain:t||document.domain})}catch(e){return""}},setCookie:function(e,t,i,n){try{var r=n||document.domain,o=+new Date+i;s.set(e,t,{expires:new Date(o),path:"/",domain:r})}catch(e){}},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},h={getItem:function(e){try{var t=sessionStorage.getItem(e),i=t;try{t&&"string"==typeof t&&(i=JSON.parse(t))}catch(e){}return i||void 0}catch(e){}},setItem:function(e,t){try{var i="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,i)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},u=function(){function e(e,t){this._storage=t&&"session"===t?h:!e&&l.isSupportLS?l:new c}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,i,n){this._storage.setCookie(e,t,i,n)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),d={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},p="/v1/user/webid",f="/v1/list",g="4.1.54",_={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,TIMEOUT:5005},m=function(e,t){return t?"__tea_cache_tokens_"+e:"__tea_cache_events_"+e},v=function(e){return"__tea_cache_config_"+e},y=function(e){return"__tea_session_id_"+e},b=function(){if("undefined"!=typeof window)return window.TeaAnalyticsObject},z={cn:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},w="__rangers_ab_style__",k="v1/list_test",E="1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1az1mz20z1cz4az1hz21",S="1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1fz1cz18z22z1kz18z1nz49z1az1mz20z1cz4az1hz21";function T(e,t,i,n,r,o,a){try{var s=new XMLHttpRequest,c=a||"POST";s.open(c,""+e,!0),s.setRequestHeader("Content-Type","application/json; charset=utf-8"),r&&s.setRequestHeader("X-MCS-AppKey",""+r),s.onload=function(){if(i){var e=null;if(s.responseText){try{e=JSON.parse(s.responseText)}catch(t){e={}}i(e,t)}}};try{o&&(s.timeout=o),o&&(s.ontimeout=function(){n&&n(t,_.TIMEOUT)}),s.onerror=function(){s.abort(),n&&n(t,_.XHR_ON)},s.send(JSON.stringify(t))}catch(e){}}catch(e){}}var x=function(e,t,i,n){try{var r=e.match(/\/v\d\//),o="";o=r?r[0]:-1!==e.indexOf("/v1/")?"/v1/":"/v2/";var a=e.split(o)[0];if(!a)return void n(e,t,_.NO_URL);t.forEach(function(r){var o=function(e){var t="";for(var i in e)e.hasOwnProperty(i)&&void 0!==e[i]&&(t+="&"+i+"="+encodeURIComponent(JSON.stringify(e[i])));return t="&"===t[0]?t.slice(1):t}(r),s=new Image(1,1);s.onload=function(){s=null,i&&i()},s.onerror=function(){s=null,n&&n(e,t,_.IMG_ON)},s.src=a+"/v1/gif?"+o})}catch(i){n&&n(e,t,_.IMG_CATCH,i.message)}},I=function(e,t,i,n,r,o,a,s,c){var l=window.navigator.userAgent,h=-1!==window.navigator.appName.indexOf("Microsoft Internet Explorer")&&(-1!==l.indexOf("MSIE 8.0")||-1!==l.indexOf("MSIE 9.0")),u=!!n;if(!u&&h)x(e,i,r,o);else if(!u&&s)return window.navigator&&window.navigator.sendBeacon?(c&&c(),void(window.navigator.sendBeacon(e,JSON.stringify(i))?r():o(e,i,_.BEACON_FALSE))):void x(e,i,r,o);a&&delete i.app_key,T(e,i,r,o,n,t)};function O(e){return e?(e^16*Math.random()>>e/4).toString(10):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,O)}var A=function(){return O().replace(/-/g,"").slice(0,19)},D=function(e){return function(e,t,i){if("string"==typeof e&&"number"==typeof i){var n,r=[],o=String.fromCharCode((i=i<=25?i:i%25)+97);n=e.split(o);for(var a=0;a<n.length;a++){var s=parseInt(n[a],i),c=String.fromCharCode(s^=64);r.push(c)}return r.join("")}}(e,64,25)},C=function(){function e(e,t,i,n){this.config=e,this.cfg=t,this.storage=new u(!1),this.appInfo=e.app_key||e.app_id,this.isNoWebid=e.disable_webid,this.isNoSsid=e.disable_webid||e.disable_ssid,this.domain=e.channel_domain||D(d[e.channel]),this.tokenReady=!1,this.checkExp=e.checkExp||!1,this.enableCookie=e.cross_subdomain||!1,this.expiresTime=94608e6*!!this.enableCookie,this.fetchUrl=""+this.domain+p,this.uuidQueue=[],this.sendQueue=[],this.hook=i,this.cookieDomain=e.cookie_domain||"",this.session=n}return e.prototype._getToken=function(){this.tokensKey=m(this.appInfo,!0),this.cookieKey="__tea_cookie_tokens_"+this.appInfo;try{var e=this.storage.getItem(this.tokensKey);if(this.enableCookie){var t=this.storage.getCookie(this.cookieKey,this.cookieDomain);if(t){t=decodeURIComponent(t);var i=(t=JSON.parse(t)).user_unique_id,n=t.web_id,r=t.timestamp,o=t.ssid;this._setToken(n,i,o,r)}else{if(!e)return void this._requestWebId();this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(e)),this.expiresTime,this.cookieDomain),this._checkLocal(e)}}else{if(!e)return void this._requestWebId();this._checkLocal(e)}}catch(e){}},e.prototype._checkLocal=function(e){if(!e.web_id){var t=this.storage.getCookie("tt_webid"),i=this.storage.getCookie("__tea_sdk__ssid"),n=this.storage.getCookie("__tea_sdk__user_unique_id");if(t&&i&&n){var r={web_id:t,ssid:i,user_unique_id:n,timestamp:Date.now()};this.storage.setItem(this.tokensKey,r)}}var o=this.storage.getItem(this.tokensKey),a=(n=o.user_unique_id,t=o.web_id,o.timestamp);i=o.ssid,t&&n?this._setToken(t,n,i,a):this._requestWebId()},e.prototype._setToken=function(e,t,i,n){if(this.uuid=t,this.web_id=e,this.ssid=i,this.checkExp){var r=Date.now()-parseFloat(n);if(r>7344e6)return void this._requestWebId();if(r>432e7)return void this._updateWebId(e)}this._complete(e,t,i)},e.prototype._complete=function(e,t,i){this.cfg.envInfo.user.ssid=i,this.cfg.envInfo.user.web_id=e,this.cfg.envInfo.user.user_unique_id=t,this.tokenReady=!0},e.prototype._requestWebId=function(){this.isNoWebid?this._setTokenId(A(),"","",!0):this._fetchWebId(this.fetchUrl,!1)},e.prototype._updateWebId=function(e){var t=""+this.domain+p+"/"+e+"/update";this._fetchWebId(t,!0)},e.prototype._fetchWebId=function(e,t){var i=this;this.isGetWebId=!0,I(e,5e3,{app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""},this.config.app_key,function(e){i.isGetWebId=!1,e&&0===e.e?(i.web_id=e.web_id,i.uuidQueue.length?i._requestSsId(i.uuidQueue[0]):i._setTokenId(e.web_id,"",t?i.ssid:e.ssid,!0)):(i.hook.emit("token-error"),console.warn("[]appid: "+i.config.app_id+", get webid error, init error~"))},function(){i.isGetWebId=!1,i.hook.emit("token-error"),console.warn("[]appid: "+i.config.app_id+", get webid error, init error~")},!0)},e.prototype._setTokenId=function(e,t,i,n){var r=this.cfg.envInfo.user.web_id||e,o={web_id:r,ssid:i,user_unique_id:t||r,timestamp:Date.now()};this.enableCookie&&this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(o)),this.expiresTime,this.cookieDomain),this.storage.setItem(this.tokensKey,o),this.cfg.envInfo.user.ssid=i,this.cfg.envInfo.user.web_id=r,this.cfg.envInfo.user.user_unique_id=t||r,this.uuid=t||r,this.web_id=r,this.ssid=i,n&&(this.tokenReady=!0,this.hook.emit("token-ready"))},e.prototype._getSsid=function(e){e&&-1===["0","Null","None","","undefined"].indexOf(e)&&this.uuid!==e&&(this.uuidQueue.push(e),this.uuid=e,this.cfg.envInfo.user.user_unique_id=e,-1===this.uuidQueue.indexOf(e)&&this.uuidQueue.push(e),this.isNoSsid||this.isGetWebId||(this.tokenReady=!1,this._requestSsId(e),this.sendQueue.push(e)),this.session._resetSessionId())},e.prototype._requestSsId=function(e){var t=this;this.sendQueue.length||I(this.domain+"/v1/user/ssid",5e3,{app_key:this.config.app_key,app_id:this.config.app_id,web_id:this.web_id,user_unique_id:e},this.config.app_key,function(i){t.sendQueue=[],t.uuidQueue.length&&t.uuidQueue.splice(t.uuidQueue.indexOf(e),1),i&&0===i.e?(t._setTokenId(t.web_id,e,i.ssid,0===t.uuidQueue.length),t.uuidQueue.length&&t._requestSsId(t.uuidQueue[0])):(t.tokenReady=!0,t.hook.emit("token-ready"),console.warn("[]appid: "+t.config.app_id+", get ssid error"))},function(){t.tokenReady=!0,t.hook.emit("token-ready")},!0)},e.prototype.isTokenReady=function(){return this.tokenReady},e}(),M=function(e){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)},N=function(e,t,i){void 0===e&&(e=[]),void 0===t&&(t=function(e){return e}),void 0===i&&(i=20);var n,r=[],o=0;return e.forEach(function(e){var a=t(e);void 0===n?n=a:(a!==n||r[o].length>=i)&&(o+=1,n=a),r[o]=r[o]||[],r[o].push(e)}),r},G=function(){function e(e,t,i,n,r,o,a){this.collect=e,this.cfg=i,this.config=t,this._token=n,this.appInfo=t.app_id||t.app_key,this.debugMode=!!t.log,this.evtDataKey=m(this.appInfo,!1);var s=t.channel_domain||D(d[t.channel]);if(this.reportUrl=t.report_url?t.report_url:""+s+f,this.storage=new u(!0),this.EventStorage=new u(!1),this.maxStorage=t.max_storage_num||-1,this.maxReport=t.max_report||10,this.reportTime=t.reportTime||30,this.timeout=t.timeout||1e5,this.closeStorage=!0,this.plugin=r,this.session=o,this.filter=a,this.plugin){var c=t.enable_storage,l=t.disable_storage;(c||!1===l)&&(this.closeStorage=!1)}this.addListener()}return e.prototype.addListener=function(){var e=this;window.addEventListener("unload",function(){e.report(!0)},!1),M(function(){e.report(!0)}),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&e.report(!0)},!1)},e.prototype.setReady=function(){this.isReady=!0,this.closeStorage||this.checkStorageEvent(),this.report()},e.prototype.event=function(e){var t=this;void 0===e&&(e=[]);try{var i=o(e,this.storage.getItem(this.evtDataKey)||[]);this.storage.setItem(this.evtDataKey,i),this.reportTimer&&clearTimeout(this.reportTimer),i.length>=this.maxReport?this.report(!1):this.reportTimer=setTimeout(function(){t.report(!1),t.reportTimer=null},this.reportTime)}catch(e){}},e.prototype.beconEvent=function(e){void 0===e&&(e=[]);var t=this._mergeEvents(e);this._dealData(t,!0)},e.prototype.report=function(e){if(void 0===e&&(e=!1),!this.collect.destroyInstance&&this._token.isTokenReady()&&this.isReady){var t=this.storage.getItem(this.evtDataKey)||[],i=this._mergeEvents(t);this.storage.removeItem(this.evtDataKey),this._dealData(i,e)}},e.prototype._mergeEvents=function(e){var t=this;if(!e.length)return e;var i=this.cfg.get();return i.header.custom=JSON.stringify(i.header.custom),N(e,function(e){return!t.closeStorage&&!!e.params.__disable_storage__},this.maxReport).map(function(e){return n({events:e.map(function(e){try{if(e.event&&"applog_trace"!==e.event){var i=n({},t.cfg.get("evtParams"),e.params);delete i.__disable_storage__;var r=[];return t.plugin&&t.plugin.ab&&t.plugin.ab.versions&&t.plugin.ab.extVersions&&(r=[],r=t.config.enable_multilink||-1!==window.location.href.indexOf("multilink=true")?t.plugin.ab.mulilinkVersions.concat(t.plugin.ab.extVersions):t.plugin.ab.versions.concat(t.plugin.ab.extVersions)),n({},e,{params:JSON.stringify(i),ab_sdk_version:r.join(","),session_id:t.session._getSessionId()})}return n({},e,{params:JSON.stringify(e.params)})}catch(t){return n({},e,{params:JSON.stringify(e.params)})}}),user:i.user,header:i.header},t.closeStorage?{}:{__disable_storage__:e[0].params.__disable_storage__},{verbose:t.debugMode?1:void 0,local_time:parseInt(""+(new Date).getTime()/1e3)})})},e.prototype._dealData=function(e,t){var i=this;if(!e.length)return e;var n=[];n=N(e,function(e){return!!e.__disable_storage__},this.maxReport),!this.closeStorage&&this.plugin.maxStorage&&this.plugin.maxStorage(n,this.maxStorage,this.evtDataKey,this.storage);var r={};n.forEach(function(e){var n=A(),o=e;try{i.filter&&(o=i.filter(e))}catch(e){}if(!i.closeStorage&&!e[0].__disable_storage__){var a=JSON.parse(JSON.stringify(e));a&&a[0]&&(a[0].header.__storage_index__=Date.now()),r[n]=a,i.EventStorage.setItem(i.evtDataKey,r)}i._send(n,o,t)})},e.prototype._send=function(e,t,i){var n=this;this.isSending=!0;var r=function(){n.isSending=!1};if(!this.closeStorage)try{t&&t[0]&&t[0].header.__storage_index__&&delete(t=JSON.parse(JSON.stringify(t)))[0].header.__storage_index__}catch(e){}this.plugin&&this.plugin.et_test&&this.plugin.et_test.send(t),I(this.reportUrl,this.timeout,t,this.config.app_key,function(t,i){if(r(),n.plugin&&!n.closeStorage){var o=n.EventStorage.getItem(n.evtDataKey)||{};Object.keys(o).length?(delete o[e],n.EventStorage.setItem(n.evtDataKey,o)):n.EventStorage.removeItem(n.evtDataKey)}t&&0!==t.e&&n.collect&&n.collect.tracer&&1!==n.cfg.staging&&n.collect.tracer.addErrorCount(i,"f_data",t.e,t)},function(e,t){r(),n.cfg.get("reportErrorCallback")(e,t),n.collect&&n.collect.tracer&&1!==n.cfg.staging&&n.collect.tracer.addErrorCount(e,"f_net",t),n.plugin&&n.plugin.monitor&&n.plugin.monitor.sdkError(n.config.app_key,n.reportUrl,e,t)},!1,i,r),this.plugin&&this.plugin.monitor&&this.plugin.monitor.sdkOnload(this.config.app_key,this.reportUrl,t)},e.prototype.checkStorageEvent=function(){var e=this;try{var t=this.EventStorage.getItem(this.evtDataKey)||{},i=Object.keys(t);i.length>0&&setTimeout(function n(){for(var r=[],o=0;o<e.maxReport;o++)i.length>0&&r.push(i.shift());r.length>0&&r.forEach(function(i){e._send(i,t[i],!1)}),setTimeout(n,5)},5)}catch(e){}},e}(),B=function(e,t){var i,n,r=function(e){var t=document.createElement("a");return t.href=e,t},o=window.screen.width,a=window.screen.height,s=window.navigator.appVersion,c=window.navigator.userAgent,l=window.navigator.language,h=document.referrer,d=h?r(h).hostname:"",p=function(e){var t=r(e).search;t=t.slice(1);var i={};return t.split("&").forEach(function(e){var t,n,r=e.split("=");r.length&&(t=r[0],n=r[1]);try{i[t]=decodeURIComponent(void 0===n?"":n)}catch(e){i[t]=n}}),i}(window.location.href),f="",g="",_="",m=""+parseFloat(s);-1!==(i=c.indexOf("Opera"))&&(_="Opera",m=c.substring(i+6),-1!==(i=c.indexOf("Version"))&&(m=c.substring(i+8))),-1!==(i=c.indexOf("Edge"))?(_="Microsoft Edge",m=c.substring(i+5)):-1!==(i=c.indexOf("MSIE"))?(_="Microsoft Internet Explorer",m=c.substring(i+5)):-1!==(i=c.indexOf("Lark"))?(_="Lark",m=c.substring(i+5,i+11)):-1!==c.indexOf("Chrome")?-1!==(i=c.indexOf("MicroMessenger"))?(_="weixin",m=c.substring(i+15,i+20)):-1!==(i=c.indexOf("MQQBrowser"))?(_="qqbrowser",m=c.substring(i+11,i+15)):-1!==(i=c.indexOf("360"))?(_="360browser",m=c.substring(c.indexOf("Chrome")+7)):-1!==c.indexOf("baidubrowser")||-1!==c.indexOf("BIDUBrowser")?(-1!==c.indexOf("baidubrowser")?(i=c.indexOf("baidubrowser"),m=c.substring(i+13,i+16)):-1!==c.indexOf("BIDUBrowser")&&(i=c.indexOf("BIDUBrowser"),m=c.substring(i+12,i+15)),_="baidubrowser"):-1!==(i=c.indexOf("xiaomi"))?-1!==c.indexOf("openlanguagexiaomi")?(_="openlanguage xiaomi",m=c.substring(i+7,i+13)):(_="xiaomi",m=c.substring(i-7,i-1)):-1!==(i=c.indexOf("TTWebView"))?(_="TTWebView",m=c.substring(i+10,i+23)):-1!==(i=c.indexOf("Chrome"))&&(_="Chrome",m=c.substring(i+7)):-1!==c.indexOf("Safari")?-1!==(i=c.indexOf("QQ"))?(_="qqbrowser",m=c.substring(i+10,i+16)):-1!==(i=c.indexOf("Safari"))&&(_="Safari",m=c.substring(i+7),-1!==(i=c.indexOf("Version"))&&(m=c.substring(i+8))):-1!==(i=c.indexOf("Firefox"))?(_="Firefox",m=c.substring(i+8)):-1!==(i=c.indexOf("MicroMessenger"))?(_="weixin",m=c.substring(i+15,i+20)):-1!==(i=c.indexOf("QQ"))&&(_="qqbrowser",m=c.substring(i+3,i+8)),-1!==(n=m.indexOf(";"))&&(m=m.substring(0,n)),-1!==(n=m.indexOf(" "))&&(m=m.substring(0,n)),-1!==(n=m.indexOf(")"))&&(m=m.substring(0,n));for(var v,y,b=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(s)?"wap":"web",z=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],w=0;w<z.length;w++){var k=z[w];if(k.r.test(c)){f=k.s;break}}function E(e,t){var i=e.exec(t);return i&&i[1]?i[1]:""}switch(/Windows/.test(f)&&(g=E(/Windows (.*)/,f),f="windows"),f){case"Mac OS X":v=c,g=(y=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?)","i").exec(v))?y.slice(1)[0]:"",f="mac";break;case"Android":g=function(e){var t=E(/Android ([\.\_\d]+)/,e);return t||(t=E(/Android\/([\.\_\d]+)/,e)),t}(c),f="android";break;case"iOS":g=(g=/OS (\d+)_(\d+)_?(\d+)?/.exec(s))?g[1]+"."+g[2]+"."+(0|g[3]):"",f="ios"}var S=function(e,t,i){var n=new u(!1),r=new u(!1,"session"),o=e?"_tea_utm_cache_"+e:"_tea_utm_cache",a=e?"_$utm_from_url_"+e:"_$utm_from_url",s={},c=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],l={utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4};try{var h=!1;for(var d in l)l[d]&&(-1!==c.indexOf(d)?(s.hasOwnProperty("tracer_data")||(s.tracer_data={}),s.tracer_data[d]=l[d]):s[d]=l[d],h=!0);if(h)r.setItem(a,"1"),n.setCookie(o,JSON.stringify(s),7776e6,i);else{var p=n.getCookie(o,i);p&&(s=JSON.parse(p))}r.getItem(a)&&(s.hasOwnProperty("tracer_data")||(s.tracer_data={}),s.tracer_data.$utm_from_url=1)}catch(e){return l}return s}(e,p,t);return{browser:_,browser_version:m,platform:b,os_name:f,os_version:g,userAgent:c,screen_width:o,screen_height:a,device_model:function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach(function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))});else if("ios"===e||"mac"===e||"windows"===e){var i=navigator.userAgent.replace("Mozilla/5.0 (",""),n=i.indexOf(";");t=i.slice(0,n)}}catch(e){}return t.trim()}(f),language:l,referrer:h,referrer_host:d,utm_source:S.utm_source,utm_medium:S.utm_medium,utm_campaign:S.utm_campaign,utm_term:S.utm_term,utm_content:S.utm_content,tracer_data:S.tracer_data}},R=void 0,U=(new Date).getTimezoneOffset(),L=parseInt(""+-U/60,10),j=60*U,V=function(){function e(e,t,i){this.cookieDomain=t.cookie_domain||"",this.initConfig=t;var n=B(e,this.cookieDomain);this.configKey=v(""+e),this.sessionStorage=new u(!1,"session"),this.localStorage=new u(!1,"local"),i&&(this.storage=1===i?this.sessionStorage:this.localStorage),this.envInfo={user:{user_unique_id:R,user_type:R,user_id:R,user_is_auth:R,user_is_login:R,device_id:R,web_id:R,ip_addr_id:R,ssid:R},header:{app_id:R,app_name:R,app_install_id:R,install_id:R,app_package:R,app_channel:R,app_version:R,os_name:n.os_name,os_version:n.os_version,device_model:n.device_model,ab_client:R,ab_version:R,ab_sdk_version:R,traffic_type:R,client_ip:R,device_brand:R,os_api:R,access:R,language:n.language,region:R,app_language:R,app_region:R,creative_id:R,ad_id:R,campaign_id:R,log_type:R,rnd:R,platform:n.platform,sdk_version:g,sdk_lib:"js",province:R,city:R,timezone:L,tz_offset:j,tz_name:R,sim_region:R,carrier:R,resolution:n.screen_width+"x"+n.screen_height,browser:n.browser,browser_version:n.browser_version,referrer:n.referrer,referrer_host:n.referrer_host,width:n.screen_width,height:n.screen_height,screen_width:n.screen_width,screen_height:n.screen_height,utm_term:n.utm_term,utm_content:n.utm_content,utm_source:n.utm_source,utm_medium:n.utm_medium,utm_campaign:n.utm_campaign,tracer_data:JSON.stringify(n.tracer_data),custom:{}}},this.evtParams={},this.reportErrorCallback=function(){}}return e.prototype.set=function(e,t){var i=this;if(null==t&&(this.delete(e),t=void 0),"evtParams"===e||"_staging_flag"===e){var r="evtParams"===e?t:{_staging_flag:Number(t)},o=n({},r);Object.keys(o).forEach(function(e){i.evtParams[e]=o[e]})}else if("reportErrorCallback"===e&&"function"==typeof t)this.reportErrorCallback=t;else{var a="";if(e.indexOf(".")>-1){var s=e.split(".");a=s[0],e=s[1]}if("user_unique_id"===e&&(!t||-1!==["0","Null","None","","undefined"].indexOf(t)))return;if("os_version"===e&&(e=""+t),"web_id"===e){if(!t)return;(!this.envInfo.user.user_unique_id||this.envInfo.user.user_unique_id&&this.envInfo.user.user_unique_id===this.envInfo.user.web_id)&&(this.envInfo.user.user_unique_id=t)}a?"user"===a||"header"===a?this.envInfo[a][e]=t:this.envInfo.header.custom[e]=t:this.envInfo.user.hasOwnProperty(e)?["user_type","ip_addr_id"].indexOf(e)>-1?this.envInfo.user[e]=t?Number(t):t:["user_id","web_id","user_unique_id","ssid"].indexOf(e)>-1?this.envInfo.user[e]=t?String(t):t:["user_is_auth","user_is_login"].indexOf(e)>-1?this.envInfo.user[e]=!!t:"device_id"===e&&(this.envInfo.user[e]=t):this.envInfo.header.hasOwnProperty(e)?this.envInfo.header[e]=t:this.envInfo.header.custom[e]=t}},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){console.log("get config stringify error ")}},e.prototype.setStore=function(e){try{var t=this.storage.getItem(this.configKey);if(Object.keys(e).length){var i=Object.assign(e,t);this.storage.setItem(this.configKey,i)}}catch(e){}},e.prototype.getStore=function(){try{var e=this.storage.getItem(this.configKey);return Object.keys(e).length?e:null}catch(e){return null}},e.prototype.delete=function(e){try{var t=this.storage.getItem(this.configKey);t&&t.hasOwnProperty(e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){}},e}(),P=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}var t=e.prototype;return t.info=function(e){this.isLog&&console.log("["+this.name+"] "+e)},t.warn=function(e){this.isLog&&console.warn("["+this.name+"] "+e)},t.error=function(e){this.isLog&&console.error("["+this.name+"] "+e)},t.throw=function(e){throw this.error(this.name),Error(e)},e}(),q=function(){function e(){this._hooks={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var i=this;e&&t&&"function"==typeof t&&this.on(e,function n(r){t(r),i.off(e,n)})},e.prototype.off=function(e,t){if(e&&this._hooks[e]&&this._hooks[e].length)if(t){var i=this._hooks[e].indexOf(t);-1!==i&&this._hooks[e].splice(i,1)}else this._hooks[e]=[]},e.prototype.emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&o(this._hooks[e]).forEach(function(e){try{e(t)}catch(e){}})},e}(),H=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},K=function(){function e(e,t){this.storage=new u(!1,"session"),this.sessionKey=y(e),this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSession||this._setSessionId()}return e.prototype._updateSessionId=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=e.timestamp;Date.now()-t>this.expireTime?e={sessionId:H(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this._resetExpTime()}},e.prototype._setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:H(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.sessionExp=setInterval(function(){e._checkEXp()},this.expireTime)},e.prototype._getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return this.disableSession?"":e&&e.sessionId?e.sessionId:""},e.prototype._resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval(function(){e._checkEXp()},this.expireTime))},e.prototype._resetSessionId=function(){var e={sessionId:H(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,e)},e.prototype._checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:H(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))},e}(),J={pv:["predefine_pageview"],sdk:["_be_active","predefine_page_alive","predefine_page_close","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append"],autotrack:["bav2b_click","bav2b_page","bav2b_beat","bav2b_page_statistics","__bav_click","__bav_page","__bav_beat","__bav_page_statistics"]},$=function(){function e(e,t,i,n){this.count={pv:0,sdk:0,autotrack:0,log:0},this.limit={pv:1,sdk:10,autotrack:10,log:3},this.errorCode={f_net:0,f_data:0},this.errorInfo={pv:{f_net:0,f_data:0},sdk:{f_net:0,f_data:0},autotrack:{f_net:0,f_data:0},log:{f_net:0,f_data:0}},this.collect=e,this.disable_tracer=t.disable_tracer||t.channel_domain,this.ready=!(!t.app_id||this.disable_tracer),this.appid=t.app_id,this.process=i,this.event=n;var r=t.channel_domain||D(d[t.channel]);this.reportUrl=t.report_url?t.report_url:""+r+f,this.listener()}return e.prototype.addCount=function(e){try{if(!this.ready)return;if(this.count[e]++,this.count[e]>=this.limit[e]){var t=[];for(var i in t=o(t,this.processTracer(this.count[e],e,"net")),this.errorInfo[e])this.errorInfo[i]&&(t=o(t,this.processTracer(this.errorInfo[e][i],e,i)));t.length&&this.sendTracer(t,!0,e,!1)}}catch(e){}},e.prototype.addErrorCount=function(e,t,i,n){var r=this;try{if(!this.ready)return;if(e&&e.length){var o=e[0].events;o&&o.length&&("f_data"===t?(n&&n.hasOwnProperty("sc")?this.errorInfo.log.f_data=o.length-n.sc:this.errorInfo.log.f_data=o.length,this.errorCode.f_data=i):o.forEach(function(e){var t="log";for(var n in J)if(-1!==J[n].indexOf(e.event)){t=n;break}r.errorInfo[t].f_net++,r.errorCode.f_net=i}))}}catch(e){}},e.prototype.clearCount=function(e){try{e?(this.count[e]=0,this.errorInfo[e]={f_net:0,f_data:0}):(this.count={pv:0,sdk:0,autotrack:0,log:0},this.errorInfo={pv:{f_net:0,f_data:0},sdk:{f_net:0,f_data:0},autotrack:{f_net:0,f_data:0},log:{f_net:0,f_data:0}})}catch(e){}},e.prototype.sendTracer=function(e,t,i,n){try{if(!this.ready||this.collect.staging)return;var r=this.event._mergeEvents(e);n&&window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify(r)):I(this.reportUrl,3e5,r,""),t?this.clearCount(i):this.clearCount()}catch(e){}},e.prototype.processTracer=function(e,t,i){try{var n={count:e,state:i,key:t,params_for_special:"applog_trace",aid:this.appid,platform:"web",_staging_flag:1,sdk_version:g};"f_net"!==i&&"f_data"!==i||(n.errorCode=this.errorCode[i]);var r=[];if(r.push(this.process("applog_trace",n,!0)),r&&r.length)return delete r[0].is_bav,r}catch(e){}},e.prototype.listener=function(){var e=this;this.ready&&(document.addEventListener("visibilitychange",function(){e.leavePage()}),M(function(){e.leavePage()}))},e.prototype.leavePage=function(){if(this.ready)try{var e=[];for(var t in this.count)if(this.count[t]){var i=this.errorInfo[t];for(var n in e=o(e,this.processTracer(this.count[t],t,"net")),i)i[n]&&(e=o(e,this.processTracer(i[n],t,n)))}e&&e.length&&this.sendTracer(e,!1,"",!0)}catch(e){}},e}(),W=function(){function e(e){this.logger=e}var t=e.prototype;return t.bridgeInject=function(){try{return AppLogBridge?(this.logger.info("AppLogBridge is injected"),!0):(this.logger.info("AppLogBridge is not inject"),!1)}catch(e){return this.logger.info("AppLogBridge is not inject"),!1}},t.hasStarted=function(e){var t=this;try{this.bridgeInject()?AppLogBridge.hasStarted(function(i){t.logger.info("AppLogBridge is started? : "+i),e(i)}):e(0)}catch(t){this.logger.info("AppLogBridge, error:"+JSON.stringify(t.stack)),e(0)}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(e){this.logger.error("setUserUniqueId error")}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(e){this.logger.error("addHeaderInfo error")}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(e){this.logger.error("setHeaderInfo error")}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(e){this.logger.error("removeHeaderInfo error")}},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t)}catch(e){this.logger.error("onEventV3 error")}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(e){this.logger.error("profileSet error")}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(e){this.logger.error("profileSetOnce error")}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(e){this.logger.error("profileIncrement error")}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(e){this.logger.error("profileUnset error")}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(e){this.logger.error("profileAppend error")}},e}(),F=function(){function e(e,t,i){this.processEvent=e,this._event=t,this.cache={},this.duration=6e4,this.profileReady=!1,this.reportUrl=(i.channel_domain||D(d[i.channel]))+"/profile/list"}return e.prototype.start=function(){this.profileReady=!0},e.prototype.report=function(e,t){void 0===t&&(t={});try{var i=[];i.push(this.processEvent(e,t));var n=this._event._mergeEvents(i);I(this.reportUrl,3e5,n)}catch(e){}},e.prototype.setProfile=function(e){var t=this._formatParams(e);t&&Object.keys(t).length&&(this._pushCache(t),this.report("__profile_set",n({},t,{profile:!0})))},e.prototype.setOnceProfile=function(e){var t=this._formatParams(e,!0);t&&Object.keys(t).length&&(this._pushCache(t),this.report("__profile_set_once",n({},t,{profile:!0})))},e.prototype.incrementProfile=function(e){e?this.report("__profile_increment",n({},e,{profile:!0})):console.warn("please check the params, must be object!!!")},e.prototype.unsetProfile=function(e){if(e){var t={};t[e]="1",this.report("__profile_unset",n({},t,{profile:!0}))}else console.warn("please check the key, must be string!!!")},e.prototype.appendProfile=function(e){if(e){var t={};for(var i in e)"string"==typeof e[i]||"Array"===Object.prototype.toString.call(e[i]).slice(8,-1)?t[i]=e[i]:console.warn("please check the value of param: "+i+", must be string or array !!!");Object.keys(t).length&&this.report("__profile_append",n({},t,{profile:!0}))}else console.warn("please check the params, must be object!!!")},e.prototype._pushCache=function(e){var t=this;Object.keys(e).forEach(function(i){t.cache[i]={val:t._clone(e[i]),timestamp:Date.now()}})},e.prototype._formatParams=function(e,t){var i=this;void 0===t&&(t=!1);try{if(!e||"[object Object]"!==Object.prototype.toString.call(e))return void console.warn("please check the params type, must be object !!!");var n={};for(var r in e)"string"==typeof e[r]||"number"==typeof e[r]||"Array"===Object.prototype.toString.call(e[r]).slice(8,-1)?n[r]=e[r]:console.warn("please check the value of params:"+r+", must be string,number,Array !!!");var o=Object.keys(n);if(!o.length)return;var a=Date.now();return o.filter(function(n){var r=i.cache[n];return t?!r:!(r&&i._compare(r.val,e[n])&&a-r.timestamp<i.duration)}).reduce(function(e,t){return e[t]=n[t],e},{})}catch(e){}},e.prototype._compare=function(e,t){try{return JSON.stringify(e)===JSON.stringify(t)}catch(e){return!1}},e.prototype._clone=function(e){try{return JSON.parse(JSON.stringify(e))}catch(t){return e}},e.prototype._unReady=function(){console.warn("sdk is not ready, please use this api after start")},e}();function Q(e,t,i){return{title:t||document.title||location.pathname,url:i||location.href,url_path:e||location.pathname}}function X(){return Date.now()}function Y(){var e=b();return window[e]?window[e].l:X()}function Z(){var e=!1;return["hidden","msHidden","webkitHidden"].forEach(function(t){void 0!==document[t]&&(e=!0)}),e}var ee=function(){function e(e,t){var i=this;this._sendEvent=function(e){void 0===e&&(e=!1);var t=e?i.options.aliveDTime:X()-i.sessionStartTime;t<0||X()-i.pageStartTime>i.options.maxDuration||(i.event("predefine_page_alive",n({},Q(i.url_path,i.title,i.url),{duration:t,is_support_visibility_change:+!!i.options.sup_vis_change,startTime:i.sessionStartTime}),"sdk"),i.sessionStartTime=X())},this._setUpTimer=function(){return i.timerHandler&&clearInterval(i.timerHandler),setInterval(function(){X()-i.sessionStartTime>i.options.aliveDTime&&i._sendEvent(!0)},1e3)},this._visibilitychange=function(){"hidden"===document.visibilityState?i.timerHandler&&(clearInterval(i.timerHandler),i._sendEvent()):"visible"===document.visibilityState&&(i.sessionStartTime=X(),i.timerHandler=i._setUpTimer())},this._beforeunload=function(){document.hidden||i._sendEvent()},this._wtest=function(){document.getElementById("wtest").innerHTML="visibilitychange"},this._dtest=function(){document.getElementById("dtest").innerHTML="dvisibilitychange"},this.event=e,this.config=t,this.isSupVisChange=Z(),this.options={maxDuration:432e5,aliveDTime:6e4,sup_vis_change:Z()},this.pageStartTime=Y(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,this.disableCallback=function(){}}return e.prototype.enable=function(e,t,i){this.url_path=e,this.url=i,this.title=t,this.disableCallback=this._enablePageAlive()},e.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now()},e.prototype._enablePageAlive=function(){var e=this;return this.timerHandler=this._setUpTimer(),document.addEventListener("visibilitychange",this._visibilitychange),M(this._beforeunload),function(){e._beforeunload(),document.removeEventListener("visibilitychange",e._visibilitychange),window.removeEventListener("beforeunload",e._beforeunload),window.removeEventListener("pagehide",e._beforeunload)}},e}(),et=function(){function e(e,t){var i=this;this._visibilitychange=function(){"hidden"===document.visibilityState?i.activeEndTime=X():"visible"===document.visibilityState&&(i.activeEndTime&&(i.totalTime+=i.activeEndTime-i.activeStartTime,i.activeTimes+=1),i.activeEndTime=void 0,i.activeStartTime=X())},this._beforeunload=function(){if(i.totalTime+=(i.activeEndTime||X())-i.activeStartTime,i.config.autotrack)try{window.sessionStorage.setItem("_tea_cache_duration",JSON.stringify({duration:i.totalTime,page_title:document.title||location.pathname}))}catch(e){}i._sendEventPageClose()},this.event=e,this.config=t,this.isSupVisChange=Z(),this.options={sup_vis_change:this.isSupVisChange},this.maxDuration=t.maxDuration||864e5,this.disableCallback=function(){},this.pageStartTime=Y(),this._resetData()}return e.prototype.enable=function(e,t,i){this.url_path=e,this.url=i,this.title=t,this.disableCallback=this._enablePageClose()},e.prototype.disable=function(){this.disableCallback()},e.prototype._resetData=function(){this.activeStartTime=void 0===this.activeStartTime?Y():Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0},e.prototype._sendEventPageClose=function(){var e=X()-this.pageStartTime;this.totalTime<0||e<0||this.totalTime>=this.maxDuration||(this.event("predefine_page_close",n({},Q(this.url_path,this.title,this.url),{active_times:this.activeTimes,duration:this.totalTime,total_duration:e,is_support_visibility_change:+!!this.options.sup_vis_change}),"sdk"),this.pageStartTime=Date.now(),this._resetData())},e.prototype._enablePageClose=function(){var e=this;return document.addEventListener("visibilitychange",this._visibilitychange),M(this._beforeunload),function(){e._beforeunload(),document.removeEventListener("visibilitychange",e._visibilitychange),window.removeEventListener("beforeunload",e._beforeunload),window.removeEventListener("pagehide",e._beforeunload)}},e}(),ei=function(){function e(e,t){this.pageAlive=new ee(e,t),this.pageClose=new et(e,t),this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this._enable(this.url_path,this.title,this.url)}return e.prototype._enable=function(e,t,i){this.pageAlive.enable(e,t,i),this.pageClose.enable(e,t,i)},e.prototype._disable=function(){this.pageAlive.disable(),this.pageClose.disable()},e.prototype.reset=function(e,t,i){this._disable(),this._enable(e,t,i)},e}(),en=function(){function e(e){var t=this;this._setInterval=function(){t._clearIntervalFunc=function(e,t){void 0===e&&(e=function(){}),void 0===t&&(t=1e3);var i,n=Date.now()+t;return i=window.setTimeout(function r(){var o=Date.now()-n;e(),n+=t,i=window.setTimeout(r,Math.max(0,t-o))},t),function(){window.clearTimeout(i)}}(function(){t._isSessionhasEvent&&t._endCurrentSession()},t.sessionInterval)},this._clearInterval=function(){t._clearIntervalFunc&&t._clearIntervalFunc()},this.sessionInterval=6e4,this._eventSenderFunc=e,this._startTime=0,this._lastTime=0,this._setInterval()}return e.prototype._endCurrentSession=function(){this._eventSenderFunc("_be_active",{start_time:this._startTime,end_time:this._lastTime,url:window.location.href,referrer:window.document.referrer},"sdk"),this._isSessionhasEvent=!1,this._startTime=0},e.prototype.process=function(){this._isSessionhasEvent||(this._isSessionhasEvent=!0,this._startTime=+new Date);var e=this._lastTime||+new Date;this._lastTime=+new Date,this._lastTime-e>this.sessionInterval&&(this._clearInterval(),this._endCurrentSession(),this._setInterval())},e}(),er=function(){function e(){}return e.prototype.sdkOnload=function(e,t,i){if(!this.sdkReady){this.sdkReady=!0;try{if(0===i.length)return;var n=i[0],r=n.header,o=n.user,a=r.app_id,s=r.app_name,c=r.sdk_version,l=o.web_id,h={events:[{event:"onload",params:JSON.stringify({app_key:e,app_id:a,app_name:s||"",sdk_version:c}),local_time_ms:Date.now()}],user:{user_unique_id:l},header:{}};setTimeout(function(){I(t,3e4,[h],"566f58151b0ed37e")},16)}catch(e){}}},e.prototype.sdkError=function(e,t,i,n){try{var r=i[0],o=r.user,a=r.header,s=[];i.forEach(function(e){e.events.forEach(function(e){s.push(e)})});var c={events:s.map(function(t){return{event:"on_error",params:JSON.stringify({error_code:n,app_key:e,app_id:a.app_id,app_name:a.app_name||"",error_event:t.event,sdk_version:a.sdk_version,local_time_ms:t.local_time_ms,tea_event_index:Date.now(),params:t.params,header:JSON.stringify(a),user:JSON.stringify(o)}),local_time_ms:Date.now()}}),user:{user_unique_id:o.user_unique_id},header:{}};setTimeout(function(){I(t,3e4,[c],"566f58151b0ed37e")},16)}catch(e){}},e}(),eo=function(){try{var e=JSON.parse(atob(window.name));return e&&e.href?e.href:""}catch(e){return""}},ea=new u(!1),es=function(e){return"__tea_sdk_ab_version_"+e},ec=function(e){var t={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date};try{t=ea.getItem(es(e))||t}catch(e){}return t},el=function(e,t){try{var i=ec(e);ea.setItem(es(e),n({},i,t))}catch(e){}},eh=function(e,t,i){void 0===i&&(i=!1),el(e,i?{ab_ext_version:t,timestamp:Date.now()}:{ab_version:t,timestamp:Date.now()})},eu={},ed=[],ep=function(e){e.length&&e.forEach(function(e){ed.push(e)})};function ef(e,t,i,n){var r=e&&e.source||window.opener||window.parent,o=e&&e.origin||n||"*",a={type:t,payload:i};r.postMessage(JSON.stringify(a),o)}function eg(e,t){eu[e]=eu[e]||[],eu[e].push(t)}function e_(e){if(ed.some(function(e){return"*"===e})||ed.some(function(t){return e.origin.indexOf(t)>-1})){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){t=void 0}if(t){var i=t.type,n=t.payload;eu[i]&&eu[i].forEach(function(t){"function"==typeof t&&t(e,n)})}}}function em(e,t){(window.opener||window.parent).postMessage("[tea-sdk]ready","*"),(window.opener||window.parent).postMessage({type:"tea:sdk:info",config:e,version:t},"*"),window.addEventListener("message",e_,!1)}function ev(e,t,i){var n=document.createElement("script");n.src=e,n.onerror=function(){i(e)},n.onload=function(){t()},document.getElementsByTagName("head")[0].appendChild(n)}window.TEAVisualEditor=window.TEAVisualEditor||{};var ey="",eb=!1;function ez(e){var t=e.event,i=e.editorUrl;e.collectInstance,e.fromSession,eb||(eb=!0,ev(i,function(){ef(t,"abEditorScriptloadSuccess")},function(){t&&ef(t,"abEditorScriptloadError"),eb=!1}))}var ew,ek,eE=function(e,t,i,n){window.TEAVisualEditor.appId=t,eg("tea:openTesterEventInspector",function(t){var i=t.data;if("string"==typeof t.data)try{i=JSON.parse(t.data)}catch(e){i=void 0}if(i){var n=i.referrer,r=i.lang,o=i.appId;window.TEAVisualEditor.__editor_ajax_domain=n||"",window.TEAVisualEditor.__ab_appId=o||"",window.TEAVisualEditor.lang=r||"",ez({event:t,editorUrl:D("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz22z1cz21z22z1cz20z4bz21z1bz1iz4bz22z1cz21z22z1cz20z49z1cz24z1cz1lz22z49z1gz1lz21z1nz1cz1az22z1mz20z4az1hz21")+"?query="+Date.now(),collectInstance:e})}})},eS=D("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1jz1mz18z1bz1cz20z4az1hz21")+"?query="+Date.now();!function(e){e[e.No=0]="No",e[e.Ing=1]="Ing",e[e.Complete=2]="Complete"}(ew||(ew={})),function(e){e[e.Var=0]="Var",e[e.All=1]="All"}(ek||(ek={}));var eT=function(){function e(e,t,i){this.appId=0,this.user={},this.header={},this.domain="",this.protocal=location.protocol,this.fetchStatus=ew.No,this.callbacks=[],this.data=null,this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.collector=e;var n=this.collector._initConfig,r=n.app_id,o=n.channel,a=n.enable_multilink,s=n.multilink_timeout_ms,c=n.ab_channel_domain,l=n.channel_domain,h=n.enable_ab_visual,u=n.ab_timeout;if(this.appId=r,this.timeout=u||3e3,this.domain=c||D(z[o||"cn"]),this.domain){this.needOverlay=a||h||!1,this.enable_ab_visual=h,this.enable_multilink=a,this.closeTime=s||500,this.Hook=t;var p=l||D(d[o]);if(this.reportUrl=""+p+f,h){!function(e,t,i,n){ep(["*"]);var r,o="";em(n,g);var a="";try{var s=window.performance.getEntriesByType("resource");if(s&&s.length&&(s.forEach(function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(a=e.name)}),a||document.currentScript&&(a=document.currentScript.src),a&&(r=a.split("/"))&&r.length)){o="https:/";for(var c=2;c<r.length&&c!==r.length-1;c++)o=o+"/"+r[c];o+="/visual-ab-core"}}catch(e){}eg("tea:openVisualABEditor",function(n){var r=n.data;if("string"==typeof n.data)try{r=JSON.parse(n.data)}catch(e){r=void 0}if(r){var a=r.lang;if(r.appId!==t)return ef(n,"appIdError"),void console.error("abtest appid is not belong the page appid please check");var s=r.version;ey=s&&o?o+(s?"."+s:".1.0.1")+".js?query="+Date.now():D(E)+"?query="+Date.now(),window.TEAVisualEditor.lang=a,i&&(window.TEAVisualEditor.__ab_domin=i),ez({event:n,editorUrl:ey,collectInstance:e})}})}(e,this.appId,c||"",i);var _=eo();if(_&&(-1!==_.indexOf("datatester")||-1!==_.indexOf("visual-editor")))return console.log("edit mode"),void this.collector.destroy()}a&&eE(e,this.appId,c||"",i),this._check(),this.wait()}else console.warn("sorry you env is not support abtest yet~")}return e.prototype.init=function(e,t){if(!this.collector.destroyInstance)if(this.domain){this.config=e;var i=e.user,r=e.header,o=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&(i[n[r]]=e[n[r]])}return i}(r,[]);this.user=n({},i),this.header=n({},r),this._fetch(n({},o),{success:t,fail:t})}else console.warn("sorry you env is not support abtest yet~")},e.prototype._check=function(){var e=this,t=function(e){var t=ec(e),i=t.timestamp;if(Date.now()-i>=2592e6){try{ea.removeItem("__tea_sdk_ab_version")}catch(e){}return null}return t}(this.appId);if(t){var i=t.ab_version,n=t.data,r=t.ab_ext_version,o=t.ab_version_multilink;this.mulilinkVersions=o||[],this.extVersions=r,i&&i.length&&(this.versions=i,this.data=n,setTimeout(function(){e._configVersions()}))}},e.prototype.wait=function(){var e=this;this.needOverlay&&(this.isWait||(this.openOverlayer(),this.isWait=!0),setTimeout(function(){e.closeOverlayer()},this.closeTime))},e.prototype.getAllVars=function(e){if("function"!=typeof e)throw Error("callback must be a function");var t={callback:e,type:ek.All};this.fetchStatus===ew.Complete?this._getAllVars(t):this.callbacks.push(t)},e.prototype._getAllVars=function(e){(0,e.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{})},e.prototype.getVids=function(){try{var e=ec(this.appId).ab_version,t="";return e&&e.length&&(t=e.join(",")),t}catch(e){return""}},e.prototype.getAbSdkVersion=function(e){e(this.getVids())},e.prototype.getVar=function(e,t,i){if(!e)throw Error("variable must not be empty");if(void 0===t)throw Error("variable no default value");if("function"!=typeof i)throw Error("callback must be a function");var n={name:e,defaultValue:t,callback:i,type:ek.Var};if(this.fetchStatus===ew.Complete){this._getVar(n,e);try{this.Hook.emit("onAbSdkVersionChange",this.getVids())}catch(e){}}else this.callbacks.push(n)},e.prototype._getVar=function(e,t){var i=e.name,n=e.defaultValue,r=e.callback,o=this.data;if(o){if("object"==typeof o[i]&&void 0!==o[i].val){var a=o[i].vid;return"$ab_url"===t?(-1===this.mulilinkVersions.indexOf(a)&&this.mulilinkVersions.push(a),this._updateMultilinkVersions()):(-1===this.versions.indexOf(a)&&this.versions.push(a),this._updateVersions()),this._abEvent(a,t,n),void r(o[i].val)}r(n)}else r(n)},e.prototype._abEvent=function(e,t,i){var n=this;try{if(e){var r={event:"abtest_exposure",ab_sdk_version:""+e,params:JSON.stringify({app_id:this.appId,ab_url:"$ab_url"===t?i:window.location.href}),local_time_ms:Date.now()},o=this.collector._config.get(),a=o.header,s=o.user;a.ab_sdk_version=""+e,a.custom=JSON.stringify(a.custom);var c={events:[r],user:s,header:a};"$ab_url"===t?window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify([c])):I(this.reportUrl,2e4,[c],""):setTimeout(function(){I(n.reportUrl,2e4,[c],"")},16)}}catch(e){}},e.prototype.openOverlayer=function(){!function(){if(!document.getElementById(w)){var e="body { opacity: 0 !important; }",t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.id=w,i.type="text/css",i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e)),t.appendChild(i)}}()},e.prototype.closeOverlayer=function(){var e;(e=document.getElementById(w))&&e.parentElement.removeChild(e)},e.prototype._setAbVersion=function(e){this.extVersions=[e],eh(this.appId,this.extVersions,!0)},e.prototype._updateVersions=function(){eh(this.appId,this.versions),this._configVersions()},e.prototype._updateMultilinkVersions=function(){el(this.appId,{ab_version_multilink:this.mulilinkVersions,timestamp:Date.now()})},e.prototype._configVersions=function(){var e=this.versions.join(",");e&&this.collector.config({ab_sdk_version:e})},e.prototype._getABconfig=function(e,t){var i=Object.keys(e);i&&i.length&&this.collector.config(e),this.init(this.collector._config.get(),t)},e.prototype._fetchComplete=function(e){var t=this;if(e){!function(e,t){el(e,{data:t})}(this.appId,e),this.data=e;var i=[];Object.keys(e).forEach(function(t){var n=e[t].vid;n&&i.push(n)}),-1!==window.location.href.indexOf("multilink=true")||(this.versions=this.versions.filter(function(e){return -1!==i.indexOf(e)}));var n=e.$ab_url,r=e.$ab_modification;if(r&&r.val&&this.enable_ab_visual){if(this.collector.destroyInstance)return;this.getVar("$ab_modification",window.location.href,function(){var e;e=r.val,window.TEAVisualEditor.__ab_config=e,ev(eS,function(){console.log("load visual render success")},function(){console.log("load visual render fail")})})}else if(n&&this.enable_multilink){var o=n.val,a=n.vid;o&&a&&this.getVar("$ab_url",o,function(){var e=window.location.href;-1!==e.indexOf("multilink=true")&&(e=t.filterUrl(e)),o!==e?setTimeout(function(){if(!t.collector.destroyInstance){var e=""+o;-1!==(e=-1===e.indexOf("http")?"https://"+e:e).indexOf("?")?e+="&multilink=true":e+="?multilink=true",window.location.href=e}},50):t.closeOverlayer()})}else this.closeOverlayer()}this.callbacks.forEach(function(e){t[e.type===ek.Var?"_getVar":"_getAllVars"](e,"")}),this.callbacks=[],this._updateVersions();try{this.Hook.emit("onAbSdkVersionChange",this.getVids())}catch(e){}this.isWait||this.closeOverlayer()},e.prototype._fetch=function(e,t){var i=this,r=void 0===t?{}:t,o=r.success,a=void 0===o?function(){}:o,s=r.fail,c=void 0===s?function(){}:s;this.fetchStatus=ew.Ing;var l=this.domain+"/service/2/abtest_config/",h=window.location.href,u=!1;-1!==h.indexOf("multilink=true")&&(h=this.filterUrl(h),u=!0);var d=u?this.mulilinkVersions:this.versions;T(l,{header:n({aid:this.appId},this.user||{},e||{},{ab_sdk_version:d.join(","),ab_url:h})},function(e){i.fetchStatus=ew.Complete;var t=e.data;"success"===e.message?(i._fetchComplete(t),a(t)):(i._fetchComplete(null),c())},function(){i.fetchStatus=ew.Complete,c(),i._fetchComplete(null)},"",this.timeout)},e.prototype.filterUrl=function(e){try{var t="";-1!==e.indexOf("&multilink=true")?t="&multilink=true":-1!==e.indexOf("?multilink=true")&&(t="\\?multilink=true");var i=RegExp(t,"g");e=e.replace(i,"")}catch(e){}return e},e}(),ex=function(e,t,i,n){if(t){var r=e.filter(function(e){return!e[0].__disable_storage__}).length;if(r>0)try{var o=n.getItem(i);if(o){var a=Object.keys(o),s=a.length+r-t;if(s>0){for(var c=a.map(function(e){var t=o[e];return{id:e,index:t&&t[0]?t[0].header.__storage_index__:+new Date}}).sort(function(e,t){return e.index-t.index}),l=0;l<s;l++){var h=c.shift();h&&h.id&&o[h.id]&&delete o[h.id]}n.setItem(i,o)}}}catch(e){}}},eI=function(){function e(e){"string"==typeof e.event_verify_url?this.url=e.event_verify_url+"/"+k:console.log("please use correct et_test url")}return e.prototype.send=function(e){this.url&&I(this.url,3e4,e)},e}(),eO=function(){return function(e,t,i,n,r){t&&(t.enable_stay_duration&&(this.stay=new ei(n,t)),t.disable_session||(this.session=new en(i)),t.channel_domain||t.disable_sdk_monitor||(this.monitor=new er),t.event_verify_url&&(this.et_test=new eI(t)),t.enable_ab_test&&(this.ab=new eT(e,r,t)),t.max_storage_num&&(this.maxStorage=ex))}}();function eA(e,t){if(void 0===t&&(t="list"),!e)return!1;if(t&&"list"===t){if(["LI","TR","DL"].includes(e.nodeName)||e.dataset&&e.dataset.hasOwnProperty("teaIdx")||e.hasAttribute&&e.hasAttribute("data-tea-idx"))return!0}else if(["A","BUTTON"].includes(e.nodeName)||e.dataset&&e.dataset.hasOwnProperty("teaContainer")||e.hasAttribute&&e.hasAttribute("data-tea-container"))return!0;return!1}function eD(e){for(var t=e;t&&!eA(t,"container");){if("HTML"===t.nodeName||"BODY"===t.nodeName)return e;t=t.parentElement}return t||e}function eC(e){var t="";return 3===e.nodeType?t=e.textContent.trim():e.dataset&&e.dataset.hasOwnProperty("teaTitle")||e.hasAttribute("ata-tea-title")?t=e.getAttribute("data-tea-title"):e.hasAttribute("title")?t=e.getAttribute("title"):"INPUT"===e.nodeName&&["button","submit"].includes(e.getAttribute("type"))?t=e.getAttribute("value"):"IMG"===e.nodeName&&e.getAttribute("alt")&&(t=e.getAttribute("alt")),t.slice(0,200)}var eM,eN,eG=function(e){if(e.children.length){var t=e.children;return![].slice.call(t).some(function(e){return e.children.length>0})}return!0},eB=function(e){for(var t=e.parentElement,i=!1;t;)"svg"===t.tagName.toLowerCase()?(t=null,i=!0):t=t.parentElement;return i};function eR(e,t,i){void 0===t&&(t=""),void 0===i&&(i={});var n=e;"/"===(n=n.split("#")[0].split("?")[0])[e.length-1]&&(n=n.substr(0,e.length-1)),n="/"===t[0]?n.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?)(\/[.\w-]+)*\/?$/,"$1"+t):n.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?(\/[.\w-]+)*?)(\/[.\w-]+)?\/?$/,"$1/"+t);var r=Object.keys(i).map(function(e){return e+"="+i[e]}).join("&");return r.length>0?n+"?"+r:n}function eU(){var e="";try{e=document.referrer?document.referrer:eN.getItem("__tea_cache_refer_key")===location.href?"":eN.getItem("__tea_cache_refer_key")}catch(e){}return{is_html:1,page_key:location.href,refer_page_key:e,page_manual_key:"",refer_page_manual_key:""}}function eL(e,t){var i=eU();return i.is_back=0,i}function ej(e,t){void 0===t&&(t=!1),function(e){var t,i;i=(t=window.history).pushState,t.pushState=function(n){"function"==typeof t.onpushstate&&t.onpushstate({state:n}),e("pushState",n,c);for(var r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];var s=i.call.apply(i,[t,n].concat(o)),c=eL();return eM=eR(location.href,o[1]),e("popstate",n,c),s},function(t){var i=t.replaceState;t.replaceState=function(n){"function"==typeof t.onreplacestate&&t.onreplacestate({state:n});for(var r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];var s=i.call.apply(i,[t,n].concat(o)),c=eL();return eM=eR(location.href,o[1]),e("replaceState",n,c),s}}(window.history)}(e),(eN=new u(!0)).setItem("__tea_cache_refer_key",location.href);var i=null;window.addEventListener("hashchange",function(n){eM!==window.location.href&&(clearTimeout(i),t)&&(eM=window.location.href,e("hashchange",n,eU()))}),window.addEventListener("popstate",function(t){eM!==window.location.href&&(i=setTimeout(function(){eM=window.location.href,e("popstate",t,eL())},10))}),e("popstate",null,eL())}"undefined"!=typeof window&&(eM=window.location.href);var eV=function(){function e(e,t){var i=this;this.clickEvent=function(e){(function(e){if(window.innerHeight,window.innerWidth,1!==e.nodeType||eB(e)||["HTML","BODY"].includes(e.tagName.toUpperCase()))return!1;var t=e;return!("none"===t.style.display||!eA(t,"container")&&!eG(t))})(e.target)&&i.eventHandel({eventType:"dom",eventName:"click"},e)},this.changeEvent=function(e){i.eventHandel({eventType:"dom",eventName:"change"},e)},this.submitEvent=function(e){i.eventHandel({eventType:"dom",eventName:"submit"},e)},this.getPageViewEvent=function(e,t,n){"pushState"===e?i.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:0}):i.eventHandel({eventType:"dom",eventName:"page_view"},n)},this.getPageLoadEvent=function(e){i.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:e})},this.config=t.getConfig().eventConfig,this.options=e,this.beatTime=e.beat,this.statistics=!1}return e.prototype.init=function(e){this.eventHandel=e;var t=this.config.mode;this.addListener(t)},e.prototype.addListener=function(e){var t=this;if("proxy-capturing"===e&&(this.config.click&&window.document.addEventListener("click",this.clickEvent,!0),this.config.change&&window.document.addEventListener("change",this.changeEvent,!0),this.config.submit&&window.document.addEventListener("submit",this.submitEvent,!0),this.config.pv&&("complete"===document.readyState?ej(this.getPageViewEvent,this.options.hashTag||this.config.hashTag):window.addEventListener("DOMContentLoaded",function(){ej(t.getPageViewEvent,t.options.hashTag||t.config.hashTag)})),this.config.beat)){try{"complete"===document.readyState?this.beatEvent(this.beatTime):window.addEventListener("load",function(){t.beatEvent(t.beatTime)});var i=0,n=null;window.addEventListener("scroll",function(){clearTimeout(n),n=setTimeout(r,500),i=document.documentElement.scrollTop||document.body.scrollTop});var r=function(){(document.documentElement.scrollTop||document.body.scrollTop)==i&&t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(e){}try{var o=window.performance&&window.performance.getEntriesByType("paint");o&&o.length?(new PerformanceObserver(function(e){var i=e.getEntries(),n=i[i.length-1],r=n.renderTime||n.loadTime;t.statistics||(t.getPageLoadEvent(r),t.statistics=!0)}).observe({entryTypes:["largest-contentful-paint"]}),setTimeout(function(){t.statistics||(t.getPageLoadEvent(o[0].startTime||0),t.statistics=!0)},2e3)):this.getPageLoadEvent(0)}catch(e){this.getPageLoadEvent(0)}}},e.prototype.removeListener=function(){window.document.removeEventListener("click",this.clickEvent,!0),window.document.removeEventListener("change",this.changeEvent,!0),window.document.removeEventListener("submit",this.submitEvent,!0)},e.prototype.beatEvent=function(e){var t,i=this;try{this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3}),this.beatTime&&(t=setInterval(function(){i.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})},e)),M(function(){i.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),i.beatTime&&clearInterval(t)})}catch(e){}},e}(),eP={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},eq=function(){function e(e){this.config=e}return e.prototype.getConfig=function(){return this.config},e.prototype.setConfig=function(e){return this.config=e},e}();function eH(e){for(var t=[];null!==e.parentElement;)t.push(e),e=e.parentElement;var i=[],n=[];return t.forEach(function(e){var t=function(e){if(null===e)return{str:"",index:0};var t=0,i=e.parentElement;if(i)for(var n=i.children,r=0;r<n.length&&n[r]!==e;r++)n[r].nodeName===e.nodeName&&t++;return{str:[e.nodeName.toLowerCase(),eA(e,"list")?"[]":""].join(""),index:t}}(e),r=t.str,o=t.index;i.unshift(r),n.unshift(o)}),{element_path:"/"+i.join("/"),positions:n}}function eK(e,t){var i={element_path:"",positions:[],texts:[]},n=function(e){if(e){var t=e.getBoundingClientRect(),i=t.width,n=t.height;return{left:t.left,top:t.top,element_width:i,element_height:n}}}(t),r=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var i=e.clientX,n=e.clientY;return{touch_x:Math.floor(i-t.left),touch_y:Math.floor(n-t.top)}}(e,n),o=n.element_width,a=n.element_height,s=r.touch_x,c=r.touch_y,l=eH(t),h=l.element_path,u=l.positions,d=function(e){var t=eD(e),i=[];return function e(t){var n=eC(t);if(n&&-1===i.indexOf(n)&&i.push(n),t.childNodes.length>0)for(var r=t.childNodes,o=0;o<r.length;o++)8!==r[o].nodeType&&e(r[o])}(t),i}(t),p=window.performance.timing.navigationStart,f=Date.now()-p;i.element_path=h,i.positions=u.map(function(e){return""+e}),i.texts=d,i.element_width=Math.floor(o),i.element_height=Math.floor(a),i.touch_x=s,i.touch_y=c,i.page_manual_key="",i.elememt_manual_key="",i.since_page_start_ms=f,i.page_start_ms=p,i.element_title=function(e){var t=eD(e),i="";return function e(t){var n=eC(t);if(n&&(i+=n),t.childNodes.length>0)for(var r=t.childNodes,o=0;o<r.length;o++)3===r[o].nodeType&&e(r[o])}(t),i}(t);var g=eD(t);return"A"===g.tagName&&(i.href=g.getAttribute("href")),"IMG"===t.tagName&&(i.src=t.getAttribute("src")),i}function eJ(e,t,i){return n({event:e},eK(t,i),{is_html:1,page_key:window.location.href,page_title:document.title})}var e$=function(){function e(e){this.eventName=e&&"tea"===e.custom?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat",static:"__bav_page_statistics"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat",static:"bav2b_page_statistics"}}return e.prototype.handleEvent=function(e,t){try{if(function(e){for(var t=e;t&&t.parentNode;){if(t.hasAttribute("data-tea-ignore"))return!0;if("HTML"===t.nodeName||"body"===t.nodeName)break;t=t.parentNode}return!1}(e.target))return null;var i="bav2b_click";switch(t){case"click":return eJ(i=this.eventName.click,e,e.target);case"change":return n({},eJ(i="bav2b_change",e,e.target),function(e,t){try{if("bav2b_change"===e)return t.hasAttribute("data-tea-track")?{value:t.value}:{}}catch(e){return{}}}(i,e.target));case"submit":return eJ(i="bav2b_submit",e,e.target)}}catch(e){return console.error(e),null}},e.prototype.handleViewEvent=function(e){e.event=this.eventName.page,e.page_title=document.title,e.page_total_width=window.innerWidth,e.page_total_height=window.innerHeight;try{var t=window.sessionStorage.getItem("_tea_cache_duration");if(t){var i=JSON.parse(t);e.refer_page_duration_ms=i?i.duration:"",e.refer_page_title=i?i.page_title:""}else e.refer_page_duration_ms="",e.refer_page_title="";e.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,e.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,e.page_start_ms=window.performance.timing.navigationStart}catch(e){console.log("page event error "+JSON.stringify(e))}return e},e.prototype.handleStatisticsEvent=function(e){var t={};t.event=this.eventName.static,t.is_html=1,t.page_key=location.href,t.refer_page_key=document.referrer||"",t.page_title=document.title,t.page_manual_key="",t.refer_page_manual_key="";try{var i=e.lcp,n=window.performance.timing,r=n.loadEventEnd-n.navigationStart;t.page_init_cost_ms=parseInt(i||(r>0?r:0)),t.page_start_ms=n.navigationStart}catch(e){console.log("page_statistics event error "+JSON.stringify(e))}return t},e.prototype.handleBeadtEvent=function(e){e.event=this.eventName.beat,e.page_key=window.location.href,e.is_html=1,e.page_title=document.title,e.page_manual_key="";try{e.page_total_width=document.documentElement.scrollWidth,e.page_total_height=document.documentElement.scrollHeight,e.scroll_width=document.documentElement.scrollLeft+window.innerWidth,e.scroll_height=document.documentElement.scrollTop+window.innerHeight,e.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,e.page_start_ms=window.performance.timing.navigationStart}catch(e){console.log("beat event error "+JSON.stringify(e))}return e},e}(),eW=function(){function e(e,t){this.logFunc=e,this.logFuncBecon=t,this.eventNameList=["report_click_event","report_change_event","report_submit_event","report_exposure_event","report_page_view_event","report_page_statistics_event","report_beat_event"]}return e.prototype.send=function(e,t){e.eventName;var i=e.eventSend,n=t.event;delete t.event,i&&"becon"===i?this.logFuncBecon(n,t,"autotrack"):this.logFunc(n,t,"autotrack")},e.prototype.get=function(e,t){fetch(e,Object.assign({headers:{"content-type":"application/json"},method:"GET"},t))},e.prototype.post=function(e,t){fetch(e,Object.assign({headers:{"content-type":"application/json"},method:"POST"},t))},e}(),eF="_TEA_VE_OPEN",eQ="_TEA_VE_APIHOST",eX="lang",eY="_VISUAL_EDITOR_V",eZ="_VISUAL_EDITOR_U";function e1(){try{var e=window.TEAVisualEditor.lang=window.TEAVisualEditor.lang||s.get(eX),t=window.TEAVisualEditor.__editor_ajax_domain=window.TEAVisualEditor.__editor_ajax_domain||s.get(eQ),i=window.TEAVisualEditor.__editor_verison=window.TEAVisualEditor.__editor_verison||s.get(eY),n=window.TEAVisualEditor.__editor_url=window.TEAVisualEditor.__editor_url||s.get(eZ),r=+new Date,o=new Date(r+18e5);s.set(eF,"1",{expires:o}),s.set(eQ,t,{expires:o}),s.set(eZ,n,{expires:o}),s.set(eX,e,{expires:o}),s.set(eY,i||"",{expires:o})}catch(e){console.log("set cookie err")}}window.TEAVisualEditor=window.TEAVisualEditor||{};var e0="",e2=window.TEAVisualEditor.__editor_url||D("1fz22z22z1nz21z4mz4bz4bz21z4fz4az1nz21z22z18z22z1nz4az1az1mz1kz4bz1nz1ez1az4bz22z1cz1az1fz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z1cz1bz1gz22z1mz20z4az1hz21");e2=e2+"?query="+Date.now();var e4=D("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z1cz1bz1gz22z1mz20z49z20z18z1lz1ez1cz20z21z4az1hz21")+"?query="+Date.now(),e5=!1;function e6(e){var t=e.event,i=e.editorUrl,n=e.autoTrackInstance;e.fromSession,e5||(e5=!0,ev(i,function(){ef(t,"editorScriptloadSuccess"),n.destroy()},function(){t&&ef(t,"editorScriptloadError"),e5=!1}))}function e3(e,t){window.TEAVisualEditor.appId=t.app_id;var i=t.channel_domain,n="";if(ep(["*"]),i){var r,o="";try{var a=window.performance.getEntriesByType("resource");if(a&&a.length&&(a.forEach(function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(o=e.name)}),o||document.currentScript&&(o=document.currentScript.src),o&&(r=o.split("/"))&&r.length)){n="https:/";for(var c=2;c<r.length&&c!==r.length-1;c++)n=n+"/"+r[c];n+="/visual-editor-rangers"}}catch(e){}}if(em(t,g),"1"===s.get(eF)){var l=function(){var e=s.get(eQ);try{e=JSON.parse(e)}catch(e){}return e}();l?(window.TEAVisualEditor.__editor_ajax_domain=l,e6({event:null,editorUrl:s.get(eZ)||e4,autoTrackInstance:e,fromSession:!1})):e6({event:null,editorUrl:e2,autoTrackInstance:e,fromSession:!1}),e1()}else try{eg("tea:openVisualEditor",function(t){var r=t.data;if("string"==typeof t.data)try{r=JSON.parse(t.data)}catch(e){r=void 0}if(r){var o=r.referrer,a=r.lang;if(o?(window.TEAVisualEditor.__editor_ajax_domain=o,e0=e4):e0=e2,i){var s=r.version;e0=n?""+n+(s?"-v"+s:"-v1.0.0")+".js":e4,window.TEAVisualEditor.__editor_verison=s}window.TEAVisualEditor.__editor_url=e0,window.TEAVisualEditor.lang=a,e6({event:t,editorUrl:e0,autoTrackInstance:e}),e1()}}),window.TEAVisualEditor.openAutotrackEditor=function(){e6({event:null,editorUrl:window.TEAVisualEditor.__editor_url,autoTrackInstance:e})}}catch(e){console.log("receive message error")}try{eg("tea:openHeatMapCore",function(t){e6({event:t,editorUrl:D(S)+"?query="+Date.now(),autoTrackInstance:e})})}catch(e){console.log("openHeatMapCore error")}}var e8,e9={hashTag:!1,impr:!1},e7=function(){function e(){this.autoTrackStart=!1}return e.prototype.start=function(e,t,i){t=Object.assign(e9,t),this.destroyed=!1,this.options=t,this.logFunc=e,this.logFuncBecon=i,this.Config=new eq(eP),this.Listener=new eV(t,this.Config),this.EventHandle=new e$(t),this.Request=new eW(this.logFunc,this.logFuncBecon),this.autoTrackStart=!0,this.init()},e.prototype.init=function(){this.Listener.init(this.handle.bind(this))},e.prototype.handle=function(e,t){"dom"===e.eventType&&this.handleDom(e,t)},e.prototype.handleDom=function(e,t){try{var i=e.eventName;if("click"===i||"change"===i||"submit"===i){var n=this.EventHandle.handleEvent(t,i);null!==n&&this.Request.send({eventType:"custom",eventName:"report_"+i+"_event",extra:{methods:"GET"}},n)}else if("page_view"===i||"page_statistics"===i){var r=void 0;r="page_view"===i?this.EventHandle.handleViewEvent(t):this.EventHandle.handleStatisticsEvent(t),this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"}},r)}else if("beat"===i){var o=this.EventHandle.handleBeadtEvent(t),a=e.eventSend;this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"},eventSend:a},o)}}catch(e){console.log("handel dom event error "+JSON.stringify(e))}},e.prototype.destroy=function(){if(!this.autoTrackStart)return console.warn("engine is undefined, make sure you have called autoTrack.start()");this.autoTrackStart=!1,this.Listener.removeListener()},e}(),te=o(["init","config","send","start","predefinePageView","beconEvent","on","resetStayDuration","autoInitializationRangers"],["profileSet","profileSetOnce","profileIncrement","profileUnset","profileAppend","getVar","getAbSdkVersion","onAbSdkVersionChange","offAbSdkVersionChange","getABconfig","openOverlayer","closeOverlayer","getAllVars","setExternalAbVersion","getToken","destroy"]),tt=(e8=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return e8+=1}),ti=function(){function e(e){var t=this;this.is_first_time=!1,this.Native=!1,this.staging=!1,this.sdkload=!1,this._getToken=!1,this.predefinePageView=function(e){if(void 0===e&&(e={}),t.sdkload){var i={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+t.is_first_time},r=n({},i,e);t.event("predefine_pageview",r,"pv")}else t.logger.warn("sdk init error, api can not call")},this.getToken=function(e,i){if(!t.sdkload)return t.logger.warn("sdk init error, api can not call, getToken will return {}"),void e({});var r=!1,o=function(){if(!r){r=!0;var i=t._config.get().user;return e(n({},i))}};i&&setTimeout(function(){o()},i),t._token.isTokenReady()?o():(t.hook.on("get-token",function(){o()}),t._getToken=!0)},this.name=e,this._isSend=!1,this.hook=new q,this.storage=new u(!1)}return e.prototype.autoInitializationRangers=function(e){},e.prototype.init=function(e){var t=this;if(!this._inited){if(this._inited=!0,!e||"object"!=typeof e)throw Error("init params is error,please check");this.logger=new P(this.name,e.log);var i=e.app_id,n=e.app_key;n||i?i&&"number"!=typeof i?this.logger.throw("app_id param is error, must be number, please check !!!"):n&&"string"!=typeof n?this.logger.warn("app_key is empty, please check!"):e.channel_domain||-1!==["cn","sg","va"].indexOf(e.channel)?(this.Native=e.Native,this.appBridge=new W(this.logger),this.storage.getItem("__tea_cache_first_"+i)?this.is_first_time=!1:(this.is_first_time=!0,this.storage.setItem("__tea_cache_first_"+i,"1")),this.sdkload=!0,e.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(i){i||t._init(e)}):this._init(e)):this.logger.throw("channel must be `cn`, `sg`,`va` !!!"):this.logger.throw("no app_key or app_id please check !!!")}},e.prototype._init=function(e){var t=this;this.autoPV=!0,this.sdkload=!0,this._initConfig=e,this._config=new V(e.app_id,e,e.configPersist||0),this.configPersist=e.configPersist||0,this._config.set("app_id",e.app_id),this.hook.on("token-ready",function(){t.callbackSend?t._isSend?t._event&&t._event.report():t.start():t._event&&t._event.report()}),this._session=new K(e.app_key||e.app_id,e),this._token=new C(e,this._config,this.hook,this._session),this.plugin=new eO(this,e,this.event.bind(this),this.beconEvent.bind(this),this.hook),this._event=new G(this,e,this._config,this._token,this.plugin,this._session,e.filter),this.tracer=new $(this,e,this._processEvent.bind(this),this._event),this._token._getToken();try{e.autotrack&&function(e,t,i){var n=new e7,r=e.autotrack;if(r){var o={};"object"==typeof r&&(o=r),n.start(t,o,i),e3(n,e)}else n.autoTrackStart&&n.destroy()}(e,this.event.bind(this),this.beconEvent.bind(this))}catch(e){}},e.prototype.config=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(i){if(i)for(var n in e)"user_unique_id"===n?t.appBridge.setUserUniqueId(e[n]):e[n]?t.appBridge.addHeaderInfo(n,e[n]):t.appBridge.removeHeaderInfo(n);else t._setConfig(e)}):this._setConfig(e):this.logger.warn("sdk init error, api can not call")},e.prototype._setConfig=function(e){if(this._inited)if(e&&"object"==typeof e){e.disable_auto_pv&&(this.autoPV=!1,delete e.disable_auto_pv),e._staging_flag&&1===e._staging_flag&&(this.staging=!0);var t=n({},e);if(this.configPersist){var i=this._config.getStore();i&&(t=Object.assign(i,e)),this._config.setStore(e)}for(var r in t){if(t.user_unique_id){"string"!=typeof t.user_unique_id&&this.logger.warn("user_unique_id must be string!!! please check");try{var o=String(t.user_unique_id);this._token._getSsid(o)}catch(e){}}this._config.set(r,t[r])}}else this.logger.warn("config params is error, please check");else this.logger.warn("config must be use after function init")},e.prototype.on=function(e,t){try{e&&"string"==typeof e&&"function"==typeof t&&this.hook.on(e,t)}catch(e){}},e.prototype.send=function(){this.start()},e.prototype.start=function(){var e=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(t){t?(e.logger.info("jsbrige\u5F00\u542F\uFF0C\u4E8B\u4EF6\u5C06\u7531\u539F\u751F sdk\u8FDB\u884C\u4E0A\u62A5"),e.predefinePageView()):e._start()}):this._start():this.logger.warn("sdk init error, api can not call")},e.prototype._start=function(){if(this._token.isTokenReady()){if(this._isSend)return void this.logger.warn("method start can not be use over one time , please check !!");this._isSend=!0,this.logger.info("userInfo:"+JSON.stringify(this._config.get("user"))),this.logger.info("sdk is ready,version is "+g+". you can report now !!!"),this._event.setReady(),this.autoPV&&this.predefinePageView(),this._getToken&&this.hook.emit("get-token"),this.profile=new F(this._processEvent.bind(this),this._event,this._initConfig),this.plugin&&this.plugin.ab&&this.plugin.ab.init(this._config.get())}else this.callbackSend=!0},e.prototype.beconEvent=function(e,t,i){var n=this;void 0===t&&(t={});var r=i||"log",o=[];o.push([e,t]),o=o.map(function(e){return n._processEvent(e[0],e[1])}),this._dealEvent(!0,o,r),this._addTracerCount(r)},e.prototype.event=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(this.sdkload){var n=r(t,1)[0],o=[];"Array"!==Object.prototype.toString.call(n).slice(8,-1)?o[0]=t:o=t,o=o.map(function(t){return e._processEvent(t[0],t[1])}),this._dealEvent(!1,o,"log"),this._addTracerCount("log")}else this.logger.warn("sdk init error, api can not call")},e.prototype._dealEvent=function(e,t,i){var n=this;if(this.sdkload)if(this.Native&&this.appBridge.bridgeInject()){if("autotrack"===i||"sdk"===i)return;this.appBridge.hasStarted(function(i){i?t&&t.length&&t.forEach(function(e){var t=e.event,i=e.params;n.appBridge.onEventV3(t,JSON.stringify(i))}):n._commonEvent(e,t)})}else this._commonEvent(e,t);else this.logger.warn("sdk init error, api can not call")},e.prototype._commonEvent=function(e,t){e?this._event.beconEvent(t):this._event.event(t),this._session._updateSessionId(),this.plugin&&this.plugin.session&&this.plugin.session.process()},e.prototype._addTracerCount=function(e){this.sdkload?this.Native||this.staging||this.tracer.addCount(e):this.logger.warn("sdk init error, api can not call")},e.prototype._processEvent=function(e,t){try{var i=e;/^event\./.test(e)&&(i=e.slice(6));var n,r=t;return"object"!=typeof r&&(r={}),r.profile?delete r.profile:r.event_index=tt(),r.local_ms?(n=r.local_ms,delete r.local_ms):n=+new Date,{event:i,params:r,local_time_ms:n,is_bav:+!!this._initConfig.autotrack}}catch(i){return{_event:e,params:t}}},e.prototype.resetStayDuration=function(e,t,i){this.sdkload?this.plugin.stay?this.plugin.stay&&this.plugin.stay.reset(e,t,i):this.logger.info("stayDuration is not init"):this.logger.warn("sdk init error, api can not call")},e.prototype.profileSet=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(i){i?t.appBridge.profileSet(JSON.stringify(e)):t.profile&&t.profile.setProfile(e)}):this.profile&&this.profile.setProfile(e):this.logger.warn("sdk init error, api can not call")},e.prototype.profileSetOnce=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(i){i?t.appBridge.profileSetOnce(JSON.stringify(e)):t.profile&&t.profile.setOnceProfile(e)}):this.profile&&this.profile.setOnceProfile(e):this.logger.warn("sdk init error, api can not call")},e.prototype.profileIncrement=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(i){i?t.appBridge.profileIncrement(JSON.stringify(e)):t.profile&&t.profile.incrementProfile(e)}):this.profile&&this.profile.incrementProfile(e):this.logger.warn("sdk init error, api can not call")},e.prototype.profileUnset=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(i){i?t.appBridge.profileUnset(e):t.profile&&t.profile.unsetProfile(e)}):this.profile&&this.profile.unsetProfile(e):this.logger.warn("sdk init error, api can not call")},e.prototype.profileAppend=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(i){i?t.appBridge.profileAppend(JSON.stringify(e)):t.profile&&t.profile.appendProfile(e)}):this.profile&&this.profile.appendProfile(e):this.logger.warn("sdk init error, api can not call")},e.prototype.setExternalAbVersion=function(e){this.sdkload?e&&this.plugin.ab&&this.plugin.ab._setAbVersion(e):this.logger.warn("sdk init error, api can not call")},e.prototype.getVar=function(e,t,i){var n=this;if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getVar return default value"),void i(t);this.hook.on("token-error",function(){n.logger.warn("sdk init error, getVar return default value"),i(t)}),this.plugin.ab&&this.plugin.ab.getVar(e,t,i)},e.prototype.getABconfig=function(e,t){if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getABconfig return null"),void t(null);this.plugin.ab&&this.plugin.ab._getABconfig(e,t)},e.prototype.getAbSdkVersion=function(e){if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getAbSdkVersion return null"),void e(null);this.plugin.ab&&this.plugin.ab.getAbSdkVersion(e)},e.prototype.onAbSdkVersionChange=function(e){this.sdkload?this.hook.on("onAbSdkVersionChange",e):this.logger.warn("sdk init error, api can not call")},e.prototype.offAbSdkVersionChange=function(e){this.sdkload?e?this.hook.off("onAbSdkVersionChange",e):this.hook.off("onAbSdkVersionChange"):this.logger.warn("sdk init error, api can not call")},e.prototype.openOverlayer=function(){this.sdkload?this.plugin.ab&&this.plugin.ab.openOverlayer():this.logger.warn("sdk init error, api can not call")},e.prototype.closeOverlayer=function(){this.sdkload?this.plugin.ab&&this.plugin.ab.closeOverlayer():this.logger.warn("sdk init error, api can not call")},e.prototype.getAllVars=function(e){var t=this;if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getAllVars return null"),void e(null);this.hook.on("token-error",function(){t.logger.warn("sdk init error, getallVar return null"),e(null)}),this.plugin.ab&&this.plugin.ab.getAllVars(e)},e.prototype.destroy=function(){this.destroyInstance||(this.destroyInstance=!0,this.hook.off("token-ready"))},e}();function tn(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var tr=function(e){var t=this;return tn(this,"_exportCollect",function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];t._isProcess?t._executeCmd.apply(t,i):(t.cmdQueue.push(i),t._processCmd())}),tn(this,"_processCmd",function(){if(0!==t.cmdQueue.length){var e,i,n,r,o;i=t.cmdQueue,n="init",r="0",o=-1,i.forEach(function(e,t){(void 0!==r?e[r]:e)===n&&(o=t)}),-1!==(e=o)&&(t._isProcess=!0,t._executeCmd.apply(t,t.cmdQueue[e]),t.cmdQueue.forEach(function(i,n){n!==e&&t._executeCmd.apply(t,i)}),t.cmdQueue=[])}}),tn(this,"_executeCmd",function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];var r,o,a=i[0];te.indexOf(a)>-1?(r=t.colloctor)[a].apply(r,i.slice(1)):(o=t.colloctor).event.apply(o,i)}),this.cmdQueue=[],this.name=e,this.colloctor=new ti(e),this._isProcess=!1,this._alias={},this._processCmd(),te.forEach(function(e){t._exportCollect[e]=t._exportCollect.bind(t,e)}),this._exportCollect},to={},ta={},ts=function(e){return ta[e]||(ta[e]=[]),ta[e]},tc=function(e){try{var t=r(e),i=t[0],n=t.slice(1);if(!i)return void console.error("the eventName is: "+i+", error, stop report, please check");var a=i.split(".");if(1===a.length)ts("default").push(o([i],n));else if(2===a.length)"event"===a[0]?ts("default").push(o([i],n)):ts(a[0]).push(o([a[1]],n));else{var s=a[0],c=[a[1],a[2]].join(".");ts(s).push(o([c],n))}}catch(e){console.log(e)}},tl=function(){th.q.forEach(function(e){var t=[].slice.call(e);"Array"===Object.prototype.toString.call(t[0]).slice(8,-1)?t.forEach(function(e){tc(e)}):tc(t)}),Object.keys(ta).forEach(function(e){ta[e].forEach(function(t){(function(e){return to[e]||(to[e]=new tr(e)),to[e]})(e).apply(void 0,o(t))}),ta[e]=[]}),th.q=[]},th=function e(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.q.push(t),tl()};th.q=[],th.l=Date.now(),th._instanceMap=to,th._instanceCmdMap=ta,te.forEach(function(e){th[e]=th.bind(null,e)}),tl();var tu=tr;t.default=th},993225:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{P:()=>Collector$1});var __assign=function(){return(__assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function __rest(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&(i[n[r]]=e[n[r]])}return i}function __values(e){var t="function"==typeof Symbol&&e[Symbol.iterator],i=0;return t?t.call(e):{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}}}function __read(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return a}function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}var commonjsGlobal="undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:{};function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var js_cookie=createCommonjsModule(function(e,t){e.exports=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function i(n){function r(){}function o(t,i,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},r.defaults,o)).expires&&(o.expires=new Date(+new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(i);/^[\{\[]/.test(a)&&(i=a)}catch(e){}i=n.write?n.write(i,t):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in o)o[c]&&(s+="; "+c,!0!==o[c]&&(s+="="+o[c].split(";")[0]));return document.cookie=t+"="+i+s}}function a(e,i){if("undefined"!=typeof document){for(var r={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),c=s.slice(1).join("=");i||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=t(s[0]);if(c=(n.read||n)(c,l)||t(c),i)try{c=JSON.parse(c)}catch(e){}if(r[l]=c,e===l)break}catch(e){}}return e?r[e]:r}}return r.set=o,r.get=function(e){return a(e,!1)},r.getJSON=function(e){return a(e,!0)},r.remove=function(t,i){o(t,"",e(i,{expires:-1}))},r.defaults={},r.withConverter=i,r}(function(){})}()}),Memory=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e}();function isSupportLS(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}function isSupportSession(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}var local={getItem:function(e){try{var t=localStorage.getItem(e),i=t;try{t&&"string"==typeof t&&(i=JSON.parse(t))}catch(e){}return i||void 0}catch(e){}},setItem:function(e,t){try{var i="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,i)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){try{return js_cookie.get(e,{domain:t||document.domain})}catch(e){return""}},setCookie:function(e,t,i,n){try{var r=n||document.domain,o=+new Date+i;js_cookie.set(e,t,{expires:new Date(o),path:"/",domain:r})}catch(e){}},isSupportLS:isSupportLS()},session={getItem:function(e){try{var t=sessionStorage.getItem(e),i=t;try{t&&"string"==typeof t&&(i=JSON.parse(t))}catch(e){}return i||void 0}catch(e){}},setItem:function(e,t){try{var i="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,i)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},isSupportSession:isSupportSession()},Storage=function(){function e(e,t){this._storage=t&&"session"===t?session:!e&&local.isSupportLS?local:new Memory}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,i,n){this._storage.setCookie(e,t,i,n)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),LOG_URL={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},WEBID_URL="/webid",TOB_URL="/tobid",REPORT_URL="/list",GIF_URL="/gif",SDK_VERSION="4.2.9",ERROR={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,TIMEOUT:5005},CACHEKEY=function(e,t){return t?"__tea_cache_tokens_"+e:"__tea_cache_events_"+e},CONFIGKEY=function(e){return"__tea_cache_config_"+e},COOKIEKEY=function(e){return"__tea_cookie_tokens_"+e},SESSIONKEY=function(e){return"__tea_session_id_"+e},CEPKEY=function(e){return"__tea_cep_plan_"+e},getNameSpace=function(){if("undefined"!=typeof window)return window.TeaAnalyticsObject},DOMAINS={cn:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},COOKIE_EXPIRE=6048e5,API="/service/2/abtest_config/",STYLE_ID="__rangers_ab_style__",STORAGE_DATA_KEY="__tea_sdk_ab_version",STORAGE_DATA_EXPRIRE=2592e6,ET_TEST_URL="v1/list_test",EDITOR_URL_NEW_ASC="1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z1cz1bz1gz22z1mz20z49z20z18z1lz1ez1cz20z21z4az1hz21",EDITOR_URL_OLD_ASC="1fz22z22z1nz21z4mz4bz4bz21z4fz4az1nz21z22z18z22z1nz4az1az1mz1kz4bz1nz1ez1az4bz22z1cz1az1fz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z1cz1bz1gz22z1mz20z4az1hz21",VISUAL_URL_ASC="1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1az1mz20z1cz4az1hz21",VISUAL_URL_RANGER="1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1jz1mz18z1bz1cz20z4az1hz21",HOT_PIC_URL="1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1fz1cz18z22z1kz18z1nz49z1az1mz20z1c",VISUAL_URL_INSPECTOR="1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz22z1cz21z22z1cz20z4bz21z1bz1iz4bz22z1cz21z22z1cz20z49z1cz24z1cz1lz22z49z1gz1lz21z1nz1cz1az22z1mz20z4az4ez4az4ez4az4cz4az1hz21";function xhr(e,t,i,n,r,o,a,s){try{var c=new XMLHttpRequest,l=s||"POST";c.open(l,""+e,!0),c.setRequestHeader("Content-Type","application/json; charset=utf-8"),r&&c.setRequestHeader("X-MCS-AppKey",""+r),a&&(c.withCredentials=!0),c.onload=function(){if(i){var e=null;if(c.responseText){try{e=JSON.parse(c.responseText)}catch(t){e={}}i(e,t)}}};try{o&&(c.timeout=o),o&&(c.ontimeout=function(){n&&n(t,ERROR.TIMEOUT)}),c.onerror=function(){c.abort(),n&&n(t,ERROR.XHR_ON)},c.send(JSON.stringify(t))}catch(e){}}catch(e){}}var isSupportBeacon=function(){return!(!window.navigator||!window.navigator.sendBeacon)},NOOP=function(){},encodePayload=function(e){var t="";for(var i in e)e.hasOwnProperty(i)&&void 0!==e[i]&&(t+="&"+i+"="+encodeURIComponent(JSON.stringify(e[i])));return"&"===t[0]?t.slice(1):t},sendByImg=function(e,t,i,n){try{var r=e.match(/\/v\d\//),o="";o=r?r[0]:-1!==e.indexOf("/v1/")?"/v1/":"/v2/";var a=e.split(o)[0];if(!a)return void n(e,t,ERROR.NO_URL);t.forEach(function(r){var o=encodePayload(r),s=new Image(1,1);s.onload=function(){s=null,i&&i()},s.onerror=function(){s=null,n&&n(e,t,ERROR.IMG_ON)},s.src=""+a+GIF_URL+"?"+o})}catch(i){n&&n(e,t,ERROR.IMG_CATCH,i.message)}},request=function(e,t,i,n,r,o,a,s,c,l){var h=window.navigator.userAgent,u=-1!==window.navigator.appName.indexOf("Microsoft Internet Explorer")&&(-1!==h.indexOf("MSIE 8.0")||-1!==h.indexOf("MSIE 9.0")),d=!!n;if(!d&&u)sendByImg(e,i,r,o);else if(!d&&s)return isSupportBeacon()?(l?l():NOOP(),void(window.navigator.sendBeacon(e,JSON.stringify(i))?r():o(e,i,ERROR.BEACON_FALSE))):void sendByImg(e,i,r,o);a&&delete i.app_key,xhr(e,i,r,o,n,t,c)};function b(e){return e?(e^16*Math.random()>>e/4).toString(10):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,b)}var webid=function(){return b().replace(/-/g,"").slice(0,19)};function decrypto(e,t,i){if("string"==typeof e&&"number"==typeof t&&"number"==typeof i){var n,r=[],o=String.fromCharCode((i=i<=25?i:i%25)+97);n=e.split(o);for(var a=0;a<n.length;a++){var s=parseInt(n[a],i),c=String.fromCharCode(s^=t);r.push(c)}return r.join("")}}var decodeUrl=function(e){return decrypto(e,64,25)},UTM=function(e,t,i,n){var r=new Storage(!1),o=new Storage(!1,"session"),a=e?"_tea_utm_cache_"+e:"_tea_utm_cache",s=e?"_$utm_from_url_"+e:"_$utm_from_url",c={},l=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],h={creative_id:Number(t.creative_id),ad_id:Number(t.ad_id),campaign_id:Number(t.campaign_id),utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4},u=n;try{var d=!1;for(var p in h)h[p]&&(-1!==l.indexOf(p)?(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data[p]=h[p]):c[p]=h[p],d=!0);if(d)o.setItem(s,"1"),r.setCookie(a,JSON.stringify(c),u,i);else{var f=r.getCookie(a,i);f&&(c=JSON.parse(f)),r.setCookie(a,f,u,i)}o.getItem(s)&&(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data.$utm_from_url=1)}catch(e){return h}return c},parseURL=function(e){var t=document.createElement("a");return t.href=e,t},parseUrlQuery=function(e){var t=parseURL(e).search;t=t.slice(1);var i={};return t.split("&").forEach(function(e){var t,n,r=e.split("=");r.length&&(t=r[0],n=r[1]);try{i[t]=decodeURIComponent(void 0===n?"":n)}catch(e){i[t]=n}}),i},client=function(e,t,i){var n,r,o=window.screen.width,a=window.screen.height,s=window.navigator.appVersion,c=window.navigator.userAgent,l=window.navigator.language,h=document.referrer,u=h?parseURL(h).hostname:"",d=parseUrlQuery(window.location.href),p="",f="",g="",_=""+parseFloat(s);-1!==(n=c.indexOf("Opera"))&&(g="Opera",_=c.substring(n+6),-1!==(n=c.indexOf("Version"))&&(_=c.substring(n+8))),-1!==c.indexOf("Edge")||-1!==c.indexOf("Edg")?(g="Microsoft Edge",-1!==c.indexOf("Edge")?(n=c.indexOf("Edge"),_=c.substring(n+5)):(n=c.indexOf("Edg"),_=c.substring(n+4))):-1!==(n=c.indexOf("MSIE"))?(g="Microsoft Internet Explorer",_=c.substring(n+5)):-1!==(n=c.indexOf("Lark"))?(g="Lark",_=c.substring(n+5,n+11)):-1!==c.indexOf("Chrome")?-1!==(n=c.indexOf("MicroMessenger"))?(g="weixin",_=c.substring(n+15,n+20)):-1!==(n=c.indexOf("MQQBrowser"))?(g="qqbrowser",_=c.substring(n+11,n+15)):-1!==(n=c.indexOf("360"))?(g="360browser",_=c.substring(c.indexOf("Chrome")+7)):-1!==c.indexOf("baidubrowser")||-1!==c.indexOf("BIDUBrowser")?(-1!==c.indexOf("baidubrowser")?(n=c.indexOf("baidubrowser"),_=c.substring(n+13,n+16)):-1!==c.indexOf("BIDUBrowser")&&(n=c.indexOf("BIDUBrowser"),_=c.substring(n+12,n+15)),g="baidubrowser"):-1!==(n=c.indexOf("xiaomi"))?-1!==c.indexOf("openlanguagexiaomi")?(g="openlanguage xiaomi",_=c.substring(n+7,n+13)):(g="xiaomi",_=c.substring(n-7,n-1)):-1!==(n=c.indexOf("TTWebView"))?(g="TTWebView",_=c.substring(n+10,n+23)):-1!==(n=c.indexOf("Chrome"))&&(g="Chrome",_=c.substring(n+7)):-1!==c.indexOf("Safari")?-1!==(n=c.indexOf("QQ"))?(g="qqbrowser",_=c.substring(n+10,n+16)):-1!==(n=c.indexOf("Safari"))&&(g="Safari",_=c.substring(n+7),-1!==(n=c.indexOf("Version"))&&(_=c.substring(n+8))):-1!==(n=c.indexOf("Firefox"))?(g="Firefox",_=c.substring(n+8)):-1!==(n=c.indexOf("MicroMessenger"))?(g="weixin",_=c.substring(n+15,n+20)):-1!==(n=c.indexOf("QQ"))&&(g="qqbrowser",_=c.substring(n+3,n+8)),-1!==(r=_.indexOf(";"))&&(_=_.substring(0,r)),-1!==(r=_.indexOf(" "))&&(_=_.substring(0,r)),-1!==(r=_.indexOf(")"))&&(_=_.substring(0,r));for(var m,v,y=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(s)?"wap":"web",b=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],z=0;z<b.length;z++){var w=b[z];if(w.r.test(c)){p=w.s;break}}function k(e,t){var i=e.exec(t);return i&&i[1]?i[1]:""}switch(/Windows/.test(p)&&(f=k(/Windows (.*)/,p),p="windows"),p){case"Mac OS X":m=c,f=(v=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?)","i").exec(m))?v.slice(1)[0]:"",p="mac";break;case"Android":f=function(e){var t=k(/Android ([\.\_\d]+)/,e);return t||(t=k(/Android\/([\.\_\d]+)/,e)),t}(c),p="android";break;case"iOS":f=(f=/OS (\d+)_(\d+)_?(\d+)?/.exec(s))?f[1]+"."+f[2]+"."+(0|f[3]):"",p="ios"}var E=UTM(e,d,t,i);return{browser:g,browser_version:_,platform:y,os_name:p,os_version:f,userAgent:c,screen_width:o,screen_height:a,device_model:function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach(function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))});else if("ios"===e||"mac"===e||"windows"===e){var i=navigator.userAgent.replace("Mozilla/5.0 (",""),n=i.indexOf(";");t=i.slice(0,n)}}catch(e){}return t.trim()}(p),language:l,referrer:h,referrer_host:u,creative_id:E.creative_id,ad_id:E.ad_id,campaign_id:E.campaign_id,utm_source:E.utm_source,utm_medium:E.utm_medium,utm_campaign:E.utm_campaign,utm_term:E.utm_term,utm_content:E.utm_content,tracer_data:E.tracer_data}},Token=function(){function e(e,t,i,n){this.enableCustomWebid=!1,this.config=e,this.cfg=t,this.storage=new Storage(!1),this.appInfo=e.app_key||e.app_id,this.isNoWebid=e.disable_webid,this.enable_ttwebid=e.enable_ttwebid||!1,this.domain=e.channel_domain||decodeUrl(LOG_URL[e.channel]),this.tokenReady=!1,this.enableCustomWebid=e.enable_custom_webid,this.checkExp=e.checkExp||!1,this.enableCookie=e.cross_subdomain||!1,this.expiresTime=e.cookie_expire||COOKIE_EXPIRE,this.fetchUrl=""+this.domain+WEBID_URL,this.hook=i,this.session=n,this.cookieDomain=e.cookie_domain||""}return e.prototype._getToken=function(){var e=this;try{if(this.tokensKey=CACHEKEY(this.appInfo,!0),this.cookieKey=COOKIEKEY(this.appInfo),this.enableCustomWebid)return void this.hook.on("custom-webid",function(){e.tokenReady=!0,e.hook.emit("token-ready")});if(this._checkEnv())return;var t=this.storage.getItem(this.tokensKey);if(this.enable_ttwebid)if(t){var i={user_unique_id:t.user_unique_id||"",timestamp:Date.now()};this.storage.setItem(this.tokensKey,i),this._setTtWid(t,!1)}else this._setTtWid(t,!0);else if(this.enableCookie){var n=this.storage.getCookie(this.cookieKey,this.cookieDomain);if(n){var r=(n=JSON.parse(decodeURIComponent(n))).user_unique_id,o=n.web_id,a=n.timestamp;this._setToken(o,r,a)}else{if(!t)return void this._requestWebId();this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(t)),this.expiresTime,this.cookieDomain),this._checkLocal(t)}}else{if(!t)return void this._requestWebId();this._checkLocal(t)}}catch(e){console.log(""+e.message)}},e.prototype._checkEnv=function(){if(-1!==window.navigator.userAgent.indexOf("miniProgram")){var e=parseUrlQuery(window.location.href);return!(!e||!e.Web_ID)&&(this._setTokenId(""+e.Web_ID),!0)}return!1},e.prototype._checkLocal=function(e){var t=e.user_unique_id,i=e.web_id,n=e.timestamp;i&&t?this._setToken(i,t,n):this._requestWebId()},e.prototype._setToken=function(e,t,i){if(this.checkExp){var n=Date.now()-parseFloat(i);if(n>7344e6)return void this._requestWebId();if(n>432e7)return void this._updateWebId(e)}this.cfg.envInfo.user.user_unique_id=t,this.cfg.envInfo.user.web_id=e,this.storage.setItem(this.tokensKey,{user_unique_id:t,web_id:e,timestamp:Date.now()}),this.tokenReady=!0},e.prototype._requestWebId=function(){this.isNoWebid?this._setTokenId(webid()):this._fetchWebId(this.fetchUrl,!1)},e.prototype._updateWebId=function(e){var t=""+this.domain+WEBID_URL+"/"+e+"/update";this._fetchWebId(t,!0)},e.prototype._fetchWebId=function(e,t){var i=this;request(e,3e3,{app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""},this.config.app_key,function(e){e&&0===e.e?i._setTokenId(e.web_id):(i.hook.emit("token-error"),console.warn("[]appid: "+i.config.app_id+", "+(t?" update":"get")+" webid error, init error~"))},function(){i.hook.emit("token-error"),console.warn("[]appid: "+i.config.app_id+", get webid error, init error~")},!0,!1,this.enable_ttwebid)},e.prototype._setTtWid=function(e,t){if(!t){var i={web_id:e.web_id||"",timestamp:Date.now()},n=e.user_unique_id||"";this.cfg.envInfo.user.user_unique_id=this.cfg.envInfo.user.user_unique_id||n,this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(i)),108e5,this.cookieDomain)}this.tokenReady=!0,this.hook.emit("token-ready")},e.prototype._setTokenId=function(e){var t=this.cfg.envInfo.user.web_id||e,i={web_id:t,user_unique_id:this.cfg.envInfo.user.user_unique_id||t,timestamp:Date.now()};this.enableCookie&&this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(i)),this.expiresTime,this.cookieDomain),this.storage.setItem(this.tokensKey,i),this.cfg.envInfo.user.web_id=this.cfg.envInfo.user.web_id||t,this.cfg.envInfo.user.user_unique_id=this.cfg.envInfo.user.user_unique_id||t,this.tokenReady=!0,this.hook.emit("token-ready")},e.prototype._setUuid=function(e){try{var t=this.storage.getItem(this.tokensKey);if(e){"string"!=typeof e&&console.warn("user_unique_id must be string!!! please check");var i=String(e);if(i===this.cfg.envInfo.user.user_unique_id)return;this.cfg.envInfo.user.user_unique_id=i,t&&t.user_unique_id?t.user_unique_id!==i&&(t.user_unique_id=i):(t={}).user_unique_id=i,t.timestamp=Date.now(),this.storage.setItem(this.tokensKey,t),this.session._resetSessionId(),this.hook.emit("token-change","uuid")}else this._clearUuid(t)}catch(e){}},e.prototype._clearUuid=function(e){this.enable_ttwebid||e&&e.web_id&&(this.cfg.envInfo.user.user_unique_id=e.web_id||void 0,e.user_unique_id=e.web_id||void 0,e.timestamp=Date.now(),this.storage.setItem(this.tokensKey,e))},e.prototype._setWebid=function(e){if(!this.enable_ttwebid){var t=this.storage.getItem(this.tokensKey);t&&t.web_id?t.web_id!==e&&(t.user_unique_id=t.web_id===t.user_unique_id?e:t.user_unique_id,t.web_id=e):((t={}).web_id=e,t.user_unique_id=e),t.timestamp=Date.now(),this.storage.setItem(this.tokensKey,t),this.cfg.envInfo.user.user_unique_id&&this.cfg.envInfo.user.user_unique_id!==this.cfg.envInfo.user.web_id||(this.cfg.envInfo.user.user_unique_id=e,this.hook.emit("token-change","uuid")),e!==this.cfg.envInfo.user.web_id&&(this.cfg.envInfo.user.web_id=e,this.hook.emit("token-change","webid"))}},e.prototype.isTokenReady=function(){return this.tokenReady},e.prototype._getTobId=function(e){request(""+this.domain+TOB_URL,3e4,{app_id:this.config.app_id,user_unique_id:this.cfg.envInfo.user.user_unique_id,web_id:this.cfg.envInfo.user.web_id},this.config.app_key,function(t){t&&0===t.e?e(t.tobid):e(null)},function(){e(null)},!0,!1,this.enable_ttwebid)},e}(),beforePageUnload=function(e){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)},splitArrayByFilter=function(e,t,i){void 0===e&&(e=[]),void 0===t&&(t=function(e){return e}),void 0===i&&(i=20);var n,r=[],o=0;return e.forEach(function(e){var a=t(e);void 0===n?n=a:(a!==n||r[o].length>=i)&&(o+=1,n=a),r[o]=r[o]||[],r[o].push(e)}),r},EventManager=function(){function e(e,t,i,n,r,o,a){this.collect=e,this.cfg=i,this.config=t,this._token=n,this.appInfo=t.app_id||t.app_key,this.debugMode=!!t.log,this.evtDataKey=CACHEKEY(this.appInfo,!1);var s=t.channel_domain||decodeUrl(LOG_URL[t.channel]);if(this.reportUrl=t.report_url?t.report_url:""+s+REPORT_URL,this.storage=new Storage(!0),this.EventStorage=new Storage(!1),this.maxStorage=t.max_storage_num||-1,this.maxReport=t.max_report||10,this.reportTime=t.reportTime||30,this.timeout=t.timeout||1e5,this.closeStorage=!0,this.plugin=r,this.session=o,this.match=a,this.filter=t.filter,this.plugin){var c=t.enable_storage,l=t.disable_storage;(c||!1===l)&&(this.closeStorage=!1)}this.addListener()}return e.prototype.addListener=function(){var e=this;window.addEventListener("unload",function(){e.report(!0)},!1),beforePageUnload(function(){e.report(!0)}),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&e.report(!0)},!1)},e.prototype.setReady=function(){this.isReady=!0,this.closeStorage||this.checkStorageEvent(),this.report()},e.prototype.event=function(e){var t=this;void 0===e&&(e=[]);try{var i=__spread(e,this.storage.getItem(this.evtDataKey)||[]);this.storage.setItem(this.evtDataKey,i),this.reportTimer&&clearTimeout(this.reportTimer),i.length>=this.maxReport?this.report(!1):this.reportTimer=setTimeout(function(){t.report(!1),t.reportTimer=null},this.reportTime)}catch(e){}},e.prototype.beconEvent=function(e){void 0===e&&(e=[]);var t=this._mergeEvents(e);this._dealData(t,!0)},e.prototype.report=function(e){if(void 0===e&&(e=!1),!this.collect.destroyInstance&&this._token.isTokenReady()&&this.isReady){var t=this.storage.getItem(this.evtDataKey)||[],i=this._mergeEvents(t);this.storage.removeItem(this.evtDataKey),this._dealData(i,e)}},e.prototype.clearEventCache=function(){this.report(!1)},e.prototype._mergeEvents=function(e){var t=this;if(!e.length)return e;var i=this.cfg.get();return i.header.custom=JSON.stringify(i.header.custom),splitArrayByFilter(e,function(e){return!t.closeStorage&&!!e.params.__disable_storage__},this.maxReport).map(function(e){return __assign({events:e.map(function(e){var n=__assign({},t.cfg.get("evtParams"),e.params);try{if(e.event&&"applog_trace"!==e.event){delete n.__disable_storage__;var r=!0,o=t.EventStorage.getItem("__tea_sdk_ab_version_"+t.appInfo);if(o&&o.uuid&&i.user.user_unique_id!==o.uuid&&(r=!1),r&&t.plugin&&t.plugin.ab&&t.plugin.ab.versions&&t.plugin.ab.extVersions){var a=[];return a=t.config.enable_multilink||-1!==window.location.href.indexOf("multilink=true")?t.plugin.ab.mulilinkVersions.concat(t.plugin.ab.extVersions):t.plugin.ab.versions.concat(t.plugin.ab.extVersions),__assign({},e,{params:JSON.stringify(n),ab_sdk_version:a.join(","),session_id:t.session._getSessionId()})}return __assign({},e,{params:JSON.stringify(n),session_id:t.session._getSessionId()})}return __assign({},e,{params:JSON.stringify(e.params)})}catch(t){return __assign({},e,{params:JSON.stringify(e.params)})}}),user:i.user,header:i.header},t.closeStorage?{}:{__disable_storage__:e[0].params.__disable_storage__},{verbose:t.debugMode?1:void 0,local_time:parseInt(""+(new Date).getTime()/1e3),user_unique_type:t.config.enable_ttwebid?t.config.user_unique_type:void 0})})},e.prototype._dealData=function(e,t){var i=this;if(!this.config.disable_track_event){if(!e.length)return e;var n=[];n=splitArrayByFilter(e,function(e){return!!e.__disable_storage__},this.maxReport),!this.closeStorage&&this.plugin.maxStorage&&this.plugin.maxStorage(n,this.maxStorage,this.evtDataKey,this.storage);var r={};n.forEach(function(e){var n=webid(),o=JSON.parse(JSON.stringify(e));try{i.filter&&(o=i.filter(o)),i.collect.eventFilter&&(o=i.collect.eventFilter(o))}catch(e){}var a=o||e;if(!i.closeStorage&&!a[0].__disable_storage__){var s=JSON.parse(JSON.stringify(e));s&&s[0]&&(s[0].header.__storage_index__=Date.now()),r[n]=s,i.EventStorage.setItem(i.evtDataKey,r)}i._send(n,a,t),i.match&&setTimeout(function(){i.match.matchEvent(a)},0)})}},e.prototype._send=function(e,t,i){var n=this;this.isSending=!0;var r=function(){n.isSending=!1};if(!this.closeStorage)try{t&&t[0]&&t[0].header.__storage_index__&&delete(t=JSON.parse(JSON.stringify(t)))[0].header.__storage_index__}catch(e){}this.plugin&&this.plugin.et_test&&this.plugin.et_test.send(t),request(this.reportUrl,this.timeout,t,this.config.app_key,function(t,i){if(r(),n.plugin&&!n.closeStorage){var o=n.EventStorage.getItem(n.evtDataKey)||{};Object.keys(o).length?(delete o[e],n.EventStorage.setItem(n.evtDataKey,o)):n.EventStorage.removeItem(n.evtDataKey)}t&&0!==t.e&&n.collect&&n.collect.tracer&&1!==n.cfg.staging&&n.collect.tracer.addErrorCount(i,"f_data",t.e,t)},function(e,t){r(),n.cfg.get("reportErrorCallback")(e,t),n.collect&&n.collect.tracer&&1!==n.cfg.staging&&n.collect.tracer.addErrorCount(e,"f_net",t),n.plugin&&n.plugin.monitor&&n.plugin.monitor.sdkError(n.config.app_key,n.reportUrl,e,t)},!1,i,this.config.enable_ttwebid,r),this.plugin&&this.plugin.monitor&&this.plugin.monitor.sdkOnload(this.config.app_key,this.reportUrl,t)},e.prototype.checkStorageEvent=function(){var e=this;try{var t=this.EventStorage.getItem(this.evtDataKey)||{},i=Object.keys(t);i.length>0&&setTimeout(function n(){for(var r=[],o=0;o<e.maxReport;o++)i.length>0&&r.push(i.shift());r.length>0&&r.forEach(function(i){e._send(i,t[i],!1)}),setTimeout(n,5)},5)}catch(e){}},e}(),undef=void 0,date=new Date,timeZoneMin=date.getTimezoneOffset(),timezone=parseInt(""+-timeZoneMin/60,10),tz_offset=60*timeZoneMin,ConfigManager=function(){function e(e,t,i){this.initConfig=t;var n=client(e,t.cookie_domain||"",t.cookie_expire||COOKIE_EXPIRE);this.configKey=CONFIGKEY(""+e),this.sessionStorage=new Storage(!1,"session"),this.localStorage=new Storage(!1,"local"),i&&(this.storage=1===i?this.sessionStorage:this.localStorage),this.envInfo={user:{user_unique_id:undef,user_type:undef,user_id:undef,user_is_auth:undef,user_is_login:undef,device_id:undef,web_id:undef,ip_addr_id:undef,ssid:undef},header:{app_id:undef,app_name:undef,app_install_id:undef,install_id:undef,app_package:undef,app_channel:undef,app_version:undef,os_name:n.os_name,os_version:n.os_version,device_model:n.device_model,ab_client:undef,ab_version:undef,ab_sdk_version:undef,traffic_type:undef,client_ip:undef,device_brand:undef,os_api:undef,access:undef,language:n.language,region:undef,app_language:undef,app_region:undef,creative_id:n.creative_id,ad_id:n.ad_id,campaign_id:n.campaign_id,log_type:undef,rnd:undef,platform:n.platform,sdk_version:SDK_VERSION,sdk_lib:"js",province:undef,city:undef,timezone:timezone,tz_offset:tz_offset,tz_name:undef,sim_region:undef,carrier:undef,resolution:n.screen_width+"x"+n.screen_height,browser:n.browser,browser_version:n.browser_version,referrer:n.referrer,referrer_host:n.referrer_host,width:n.screen_width,height:n.screen_height,screen_width:n.screen_width,screen_height:n.screen_height,utm_term:n.utm_term,utm_content:n.utm_content,utm_source:n.utm_source,utm_medium:n.utm_medium,utm_campaign:n.utm_campaign,tracer_data:JSON.stringify(n.tracer_data),custom:{},wechat_openid:undef,wechat_unionid:undef}},this.evtParams={},this.reportErrorCallback=function(){}}return e.prototype.set=function(e,t){var i=this;if(null==t&&(this.delete(e),t=void 0),"evtParams"===e||"_staging_flag"===e){var n="evtParams"===e?t:{_staging_flag:Number(t)},r=__assign({},n);Object.keys(r).forEach(function(e){i.evtParams[e]=r[e]})}else if("reportErrorCallback"===e&&"function"==typeof t)this.reportErrorCallback=t;else{var o="";if(e.indexOf(".")>-1){var a=e.split(".");o=a[0],e=a[1]}if("user_unique_id"===e&&(!t||-1!==["0","Null","None","","undefined"].indexOf(t)))return;"os_version"===e&&(e=""+t),o?"user"===o||"header"===o?this.envInfo[o][e]=t:this.envInfo.header.custom[e]=t:this.envInfo.user.hasOwnProperty(e)?["user_type","ip_addr_id"].indexOf(e)>-1?this.envInfo.user[e]=t?Number(t):t:["user_id","web_id","user_unique_id","ssid"].indexOf(e)>-1?this.envInfo.user[e]=t?String(t):t:["user_is_auth","user_is_login"].indexOf(e)>-1?this.envInfo.user[e]=!!t:"device_id"===e&&(this.envInfo.user[e]=t):this.envInfo.header.hasOwnProperty(e)?this.envInfo.header[e]=t:this.envInfo.header.custom[e]=t}},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){console.log("get config stringify error ")}},e.prototype.setStore=function(e){try{var t=this.storage.getItem(this.configKey);if(Object.keys(e).length){var i=Object.assign(e,t);this.storage.setItem(this.configKey,i)}}catch(e){}},e.prototype.getStore=function(){try{var e=this.storage.getItem(this.configKey);return Object.keys(e).length?e:null}catch(e){return null}},e.prototype.delete=function(e){try{var t=this.storage.getItem(this.configKey);t&&t.hasOwnProperty(e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){}},e}(),Logger=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}var t=e.prototype;return t.info=function(e){this.isLog&&console.log("["+this.name+"] "+e)},t.warn=function(e){this.isLog&&console.warn("["+this.name+"] "+e)},t.error=function(e){this.isLog&&console.error("["+this.name+"] "+e)},t.throw=function(e){throw this.error(this.name),Error(e)},e}(),Hook=function(){function e(){this._hooks={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var i=this;e&&t&&"function"==typeof t&&this.on(e,function n(r){t(r),i.off(e,n)})},e.prototype.off=function(e,t){if(e&&this._hooks[e]&&this._hooks[e].length)if(t){var i=this._hooks[e].indexOf(t);-1!==i&&this._hooks[e].splice(i,1)}else this._hooks[e]=[]},e.prototype.emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&__spread(this._hooks[e]).forEach(function(e){try{e(t)}catch(e){}})},e}(),sessionId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},Session=function(){function e(e,t){this.storage=new Storage(!1,"session"),this.sessionKey=SESSIONKEY(e),this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSession||this._setSessionId()}return e.prototype._updateSessionId=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=e.timestamp;Date.now()-t>this.expireTime?e={sessionId:sessionId(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this._resetExpTime()}},e.prototype._setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:sessionId(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.sessionExp=setInterval(function(){e._checkEXp()},this.expireTime)},e.prototype._getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return this.disableSession?"":e&&e.sessionId?e.sessionId:""},e.prototype._resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval(function(){e._checkEXp()},this.expireTime))},e.prototype._resetSessionId=function(){var e={sessionId:sessionId(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,e)},e.prototype._checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:sessionId(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))},e}(),EventList={pv:["predefine_pageview"],sdk:["_be_active","predefine_page_alive","predefine_page_close","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append"],autotrack:["bav2b_click","bav2b_page","bav2b_beat","bav2b_page_statistics","__bav_click","__bav_page","__bav_beat","__bav_page_statistics"]},Tracer=function(){function e(e,t,i,n){this.count={pv:0,sdk:0,autotrack:0,log:0},this.limit={pv:1,sdk:10,autotrack:10,log:3},this.errorCode={f_net:0,f_data:0},this.errorInfo={pv:{f_net:0,f_data:0},sdk:{f_net:0,f_data:0},autotrack:{f_net:0,f_data:0},log:{f_net:0,f_data:0}},this.collect=e,this.disable_tracer=t.disable_tracer||t.channel_domain,this.ready=!(!t.app_id||this.disable_tracer||t.disable_track_event),this.appid=t.app_id,this.process=i,this.event=n;var r=t.channel_domain||decodeUrl(LOG_URL[t.channel]);this.reportUrl=t.report_url?t.report_url:""+r+REPORT_URL,this.listener()}return e.prototype.addCount=function(e){try{if(!this.ready)return;if(this.count[e]++,this.count[e]>=this.limit[e]){var t=[];for(var i in t=__spread(t,this.processTracer(this.count[e],e,"net")),this.errorInfo[e])this.errorInfo[i]&&(t=__spread(t,this.processTracer(this.errorInfo[e][i],e,i)));t.length&&this.sendTracer(t,!0,e,!1)}}catch(e){}},e.prototype.addErrorCount=function(e,t,i,n){var r=this;try{if(!this.ready)return;if(e&&e.length){var o=e[0].events;o&&o.length&&("f_data"===t?(n&&n.hasOwnProperty("sc")?this.errorInfo.log.f_data=o.length-n.sc:this.errorInfo.log.f_data=o.length,this.errorCode.f_data=i):o.forEach(function(e){var t="log";for(var n in EventList)if(-1!==EventList[n].indexOf(e.event)){t=n;break}r.errorInfo[t].f_net++,r.errorCode.f_net=i}))}}catch(e){}},e.prototype.clearCount=function(e){try{e?(this.count[e]=0,this.errorInfo[e]={f_net:0,f_data:0}):(this.count={pv:0,sdk:0,autotrack:0,log:0},this.errorInfo={pv:{f_net:0,f_data:0},sdk:{f_net:0,f_data:0},autotrack:{f_net:0,f_data:0},log:{f_net:0,f_data:0}})}catch(e){}},e.prototype.sendTracer=function(e,t,i,n){try{if(!this.ready||this.collect.staging)return;var r=this.event._mergeEvents(e);n&&window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify(r)):request(this.reportUrl,3e5,r,""),t?this.clearCount(i):this.clearCount()}catch(e){}},e.prototype.processTracer=function(e,t,i){try{var n={count:e,state:i,key:t,params_for_special:"applog_trace",aid:this.appid,platform:"web",_staging_flag:1,sdk_version:SDK_VERSION};"f_net"!==i&&"f_data"!==i||(n.errorCode=this.errorCode[i]);var r=[];if(r.push(this.process("applog_trace",n,!0)),r&&r.length)return delete r[0].is_bav,r}catch(e){}},e.prototype.listener=function(){var e=this;this.ready&&(document.addEventListener("visibilitychange",function(){e.leavePage()}),beforePageUnload(function(){e.leavePage()}))},e.prototype.leavePage=function(){if(this.ready)try{var e=[];for(var t in this.count)if(this.count[t]){var i=this.errorInfo[t];for(var n in e=__spread(e,this.processTracer(this.count[t],t,"net")),i)i[n]&&(e=__spread(e,this.processTracer(i[n],t,n)))}e&&e.length&&this.sendTracer(e,!1,"",!0)}catch(e){}},e}(),AppBridge=function(){function e(e){this.logger=e}var t=e.prototype;return t.bridgeInject=function(){try{return AppLogBridge?(this.logger.info("AppLogBridge is injected"),!0):(this.logger.info("AppLogBridge is not inject"),!1)}catch(e){return this.logger.info("AppLogBridge is not inject"),!1}},t.hasStarted=function(e){var t=this;try{this.bridgeInject()?AppLogBridge.hasStarted(function(i){t.logger.info("AppLogBridge is started? : "+i),e(i)}):e(0)}catch(t){this.logger.info("AppLogBridge, error:"+JSON.stringify(t.stack)),e(0)}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(e){this.logger.error("setUserUniqueId error")}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(e){this.logger.error("addHeaderInfo error")}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(e){this.logger.error("setHeaderInfo error")}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(e){this.logger.error("removeHeaderInfo error")}},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t)}catch(e){this.logger.error("onEventV3 error")}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(e){this.logger.error("profileSet error")}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(e){this.logger.error("profileSetOnce error")}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(e){this.logger.error("profileIncrement error")}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(e){this.logger.error("profileUnset error")}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(e){this.logger.error("profileAppend error")}},e}();function stringify(e,t,i){void 0===t&&(t=""),void 0===i&&(i={});var n=e;"/"===(n=n.split("#")[0].split("?")[0])[e.length-1]&&(n=n.substr(0,e.length-1)),n="/"===t[0]?n.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?)(\/[.\w-]+)*\/?$/,"$1"+t):n.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?(\/[.\w-]+)*?)(\/[.\w-]+)?\/?$/,"$1/"+t);var r=Object.keys(i).map(function(e){return e+"="+i[e]}).join("&");return r.length>0?n+"?"+r:n}var Ruote=function(){function e(e){this.autotrack=!1,this.spa=!1,(e.spa||e.autotrack)&&(this.autotrack=!!e.autotrack,this.spa=e.spa,this.fncArray=new Map,this.setLocation(),this.hack(),this.storage=new Storage(!0),this.storage.setItem("__tea_cache_refer_key",location.href),this.listener())}return e.prototype.hack=function(){var e=this,t=window.history.pushState;history.pushState=function(i){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];"function"==typeof history.onpushstate&&history.onpushstate({state:i});var o=t.call.apply(t,__spread([history,i],n)),a=e.getPopStateChangeEventData();return e.lastLocation=stringify(location.href,n[1]),e.storage.setItem("__tea_cache_refer_key",e.lastLocation),e.sendPv(a),o};var i=history.replaceState;history.replaceState=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];"function"==typeof history.onreplacestate&&history.onreplacestate({state:t});var o=i.call.apply(i,__spread([history,t],n)),a=e.getPopStateChangeEventData();return e.lastLocation=stringify(location.href,n[1]),e.storage.setItem("__tea_cache_refer_key",e.lastLocation),e.sendPv(a),o}},e.prototype.setLocation=function(){"undefined"!=typeof window&&(this.lastLocation=window.location.href)},e.prototype.add=function(e,t){this.fncArray.get(e)||this.fncArray.set(e,t)},e.prototype.init=function(e,t){this.add(e,t),this.fncArray.get(e)(this.getPopStateChangeEventData())},e.prototype.listener=function(){var e=this,t=null;window.addEventListener("hashchange",function(i){e.lastLocation!==window.location.href&&clearTimeout(t)}),window.addEventListener("popstate",function(i){e.lastLocation!==window.location.href&&(t=setTimeout(function(){e.lastLocation=window.location.href;var t=e.getPopStateChangeEventData();e.sendPv(t)},10))})},e.prototype.getPopStateChangeEventData=function(){var e=this.pageConfig();return e.is_back=0,e},e.prototype.pageConfig=function(){var e="";try{e=document.referrer?document.referrer:this.storage.getItem("__tea_cache_refer_key")||""}catch(e){}return{is_html:1,url:location.href,referrer:e,page_key:location.href,refer_page_key:e,page_manual_key:"",refer_page_manual_key:""}},e.prototype.sendPv=function(e){this.fncArray.forEach(function(t){t(e)})},e}(),hashCode=function(e){for(var t=0,i=0,n=(e+="").length,r=0;r<n;r++)((t=31*t+e.charCodeAt(i++))>0x7fffffffffff||t<-0x800000000000)&&(t&=0xffffffffffff);return t<0&&(t+=0x7ffffffffffff),t};function getCommonParams(e,t,i){return{title:t||document.title||location.pathname,url:i||location.href,url_path:e||location.pathname}}function getCurrentTime(){return Date.now()}function getPageStartTime(){var e=getNameSpace();return window[e]?window[e].l:getCurrentTime()}function isSupVisChange(){var e=!1;return["hidden","msHidden","webkitHidden"].forEach(function(t){void 0!==document[t]&&(e=!0)}),e}var PageAlive=function(){function e(e,t){var i=this;this._sendEvent=function(e){void 0===e&&(e=!1);var t=e?i.options.aliveDTime:getCurrentTime()-i.sessionStartTime;t<0||getCurrentTime()-i.pageStartTime>i.options.maxDuration||(i.event("predefine_page_alive",__assign({},getCommonParams(i.url_path,i.title,i.url),{duration:t,is_support_visibility_change:+!!i.options.sup_vis_change,startTime:i.sessionStartTime}),"sdk"),i.sessionStartTime=getCurrentTime())},this._setUpTimer=function(){return i.timerHandler&&clearInterval(i.timerHandler),setInterval(function(){getCurrentTime()-i.sessionStartTime>i.options.aliveDTime&&i._sendEvent(!0)},1e3)},this._visibilitychange=function(){"hidden"===document.visibilityState?i.timerHandler&&(clearInterval(i.timerHandler),i._sendEvent()):"visible"===document.visibilityState&&(i.sessionStartTime=getCurrentTime(),i.timerHandler=i._setUpTimer())},this._beforeunload=function(){document.hidden||i._sendEvent()},this._wtest=function(){document.getElementById("wtest").innerHTML="visibilitychange"},this._dtest=function(){document.getElementById("dtest").innerHTML="dvisibilitychange"},this.event=e,this.config=t,this.isSupVisChange=isSupVisChange(),this.options={maxDuration:432e5,aliveDTime:6e4,sup_vis_change:isSupVisChange()},this.pageStartTime=getPageStartTime(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,this.disableCallback=function(){}}return e.prototype.enable=function(e,t,i){this.url_path=e,this.url=i,this.title=t,this.disableCallback=this._enablePageAlive()},e.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now()},e.prototype._enablePageAlive=function(){var e=this;return this.timerHandler=this._setUpTimer(),document.addEventListener("visibilitychange",this._visibilitychange),beforePageUnload(this._beforeunload),function(){e._beforeunload(),document.removeEventListener("visibilitychange",e._visibilitychange),window.removeEventListener("beforeunload",e._beforeunload),window.removeEventListener("pagehide",e._beforeunload)}},e}(),PageClose=function(){function e(e,t){var i=this;this._visibilitychange=function(){"hidden"===document.visibilityState?i.activeEndTime=getCurrentTime():"visible"===document.visibilityState&&(i.activeEndTime&&(i.totalTime+=i.activeEndTime-i.activeStartTime,i.activeTimes+=1),i.activeEndTime=void 0,i.activeStartTime=getCurrentTime())},this._beforeunload=function(){if(i.totalTime+=(i.activeEndTime||getCurrentTime())-i.activeStartTime,i.config.autotrack)try{window.sessionStorage.setItem("_tea_cache_duration",JSON.stringify({duration:i.totalTime,page_title:document.title||location.pathname}))}catch(e){}i._sendEventPageClose()},this.event=e,this.config=t,this.isSupVisChange=isSupVisChange(),this.options={sup_vis_change:this.isSupVisChange},this.maxDuration=t.maxDuration||864e5,this.disableCallback=function(){},this.pageStartTime=getPageStartTime(),this._resetData()}return e.prototype.enable=function(e,t,i){this.url_path=e,this.url=i,this.title=t,this.disableCallback=this._enablePageClose()},e.prototype.disable=function(){this.disableCallback()},e.prototype._resetData=function(){this.activeStartTime=void 0===this.activeStartTime?getPageStartTime():Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0},e.prototype._sendEventPageClose=function(){var e=getCurrentTime()-this.pageStartTime;this.totalTime<0||e<0||this.totalTime>=this.maxDuration||(this.event("predefine_page_close",__assign({},getCommonParams(this.url_path,this.title,this.url),{active_times:this.activeTimes,duration:this.totalTime,total_duration:e,is_support_visibility_change:+!!this.options.sup_vis_change}),"sdk"),this.pageStartTime=Date.now(),this._resetData())},e.prototype._enablePageClose=function(){var e=this;return document.addEventListener("visibilitychange",this._visibilitychange),beforePageUnload(this._beforeunload),function(){e._beforeunload(),document.removeEventListener("visibilitychange",e._visibilitychange),window.removeEventListener("beforeunload",e._beforeunload),window.removeEventListener("pagehide",e._beforeunload)}},e}(),StayDuration=function(){function e(e,t){this.pageAlive=new PageAlive(e,t),this.pageClose=new PageClose(e,t),this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this._enable(this.url_path,this.title,this.url)}return e.prototype._enable=function(e,t,i){this.pageAlive.enable(e,t,i),this.pageClose.enable(e,t,i)},e.prototype._disable=function(){this.pageAlive.disable(),this.pageClose.disable()},e.prototype.reset=function(e,t,i){this._disable(),this._enable(e,t,i)},e}();function selfAdjust(e,t){void 0===e&&(e=function(){}),void 0===t&&(t=1e3);var i,n=Date.now()+t;return i=window.setTimeout(function r(){var o=Date.now()-n;e(),n+=t,i=window.setTimeout(r,Math.max(0,t-o))},t),function(){window.clearTimeout(i)}}var Session$1=function(){function e(e){var t=this;this._setInterval=function(){t._clearIntervalFunc=selfAdjust(function(){t._isSessionhasEvent&&t._endCurrentSession()},t.sessionInterval)},this._clearInterval=function(){t._clearIntervalFunc&&t._clearIntervalFunc()},this.sessionInterval=6e4,this._eventSenderFunc=e,this._startTime=0,this._lastTime=0,this._setInterval()}return e.prototype._endCurrentSession=function(){this._eventSenderFunc("_be_active",{start_time:this._startTime,end_time:this._lastTime,url:window.location.href,referrer:window.document.referrer},"sdk"),this._isSessionhasEvent=!1,this._startTime=0},e.prototype.process=function(){this._isSessionhasEvent||(this._isSessionhasEvent=!0,this._startTime=+new Date);var e=this._lastTime||+new Date;this._lastTime=+new Date,this._lastTime-e>this.sessionInterval&&(this._clearInterval(),this._endCurrentSession(),this._setInterval())},e}(),SDK_USE_TYPE="npm",Monitor=function(){function e(e){this.config=e}return e.prototype.sdkOnload=function(e,t,i){if(!this.config.disable_track_event&&!this.sdkReady){this.sdkReady=!0;try{if(0===i.length)return;var n=i[0],r=n.header,o=n.user,a=r.app_id,s=r.app_name,c=r.sdk_version,l=o.web_id,h={events:[{event:"onload",params:JSON.stringify({app_key:e,app_id:a,app_name:s||"",sdk_version:c,sdk_type:SDK_USE_TYPE,sdk_config:this.config}),local_time_ms:Date.now()}],user:{user_unique_id:l},header:{}};setTimeout(function(){request(t,3e4,[h],"566f58151b0ed37e")},16)}catch(e){}}},e.prototype.sdkError=function(e,t,i,n){try{if(this.config.disable_track_event)return;var r=i[0],o=r.user,a=r.header,s=[];i.forEach(function(e){e.events.forEach(function(e){s.push(e)})});var c={events:s.map(function(t){return{event:"on_error",params:JSON.stringify({error_code:n,app_key:e,app_id:a.app_id,app_name:a.app_name||"",error_event:t.event,sdk_version:a.sdk_version,local_time_ms:t.local_time_ms,tea_event_index:Date.now(),params:t.params,header:JSON.stringify(a),user:JSON.stringify(o)}),local_time_ms:Date.now()}}),user:{user_unique_id:o.user_unique_id},header:{}};setTimeout(function(){request(t,3e4,[c],"566f58151b0ed37e")},16)}catch(e){}},e}(),getIframeUrl=function(){try{return JSON.parse(atob(window.name))||void 0}catch(e){return}};function openOverlayer(){if(!document.getElementById(STYLE_ID)){var e="body { opacity: 0 !important; }",t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.id=STYLE_ID,i.type="text/css",i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e)),t.appendChild(i)}}function closeOverlayer(){var e=document.getElementById(STYLE_ID);e&&e.parentElement.removeChild(e)}var storage=new Storage(!1),getStorageKey=function(e){return STORAGE_DATA_KEY+"_"+e},getCache=function(e){var t={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date,uuid:""};try{t=storage.getItem(getStorageKey(e))||t}catch(e){}return t},_setCache=function(e,t){try{var i=getCache(e);storage.setItem(getStorageKey(e),__assign({},i,t))}catch(e){}},setVersionCache=function(e,t,i){void 0===i&&(i=!1),_setCache(e,i?{ab_ext_version:t,timestamp:Date.now()}:{ab_version:t,timestamp:Date.now()})},setMultilinkCache=function(e,t){_setCache(e,{ab_version_multilink:t,timestamp:Date.now()})},setDataCache=function(e,t,i){_setCache(e,{data:t,uuid:i})},checkExpiration=function(e){var t=getCache(e),i=t.timestamp;if(Date.now()-i>=STORAGE_DATA_EXPRIRE){try{storage.removeItem(STORAGE_DATA_KEY)}catch(e){}return null}return t},msgQueueMap={},allowdOrigins=[],addAllowdOrigin=function(e){e.length&&e.forEach(function(e){allowdOrigins.push(e)})};function dispatchMsg(e,t,i,n){var r=e&&e.source||window.opener||window.parent,o=e&&e.origin||n||"*",a={type:t,payload:i};r.postMessage(JSON.stringify(a),o)}function receiveMsg(e,t){msgQueueMap[e]=msgQueueMap[e]||[],msgQueueMap[e].push(t)}function processMsg(e){if(allowdOrigins.some(function(e){return"*"===e})||allowdOrigins.some(function(t){return e.origin.indexOf(t)>-1})){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){t=void 0}if(t){var i=t.type,n=t.payload;msgQueueMap[i]&&msgQueueMap[i].forEach(function(t){"function"==typeof t&&t(e,n)})}}}function init(e,t){delete e.filter,(window.opener||window.parent).postMessage({type:"tea:sdk:info",config:e,version:t},"*"),window.addEventListener("message",processMsg,!1)}function loadScript(e,t,i){var n=document.createElement("script");n.src=e,n.onerror=function(){i(e)},n.onload=function(){t()},document.getElementsByTagName("head")[0].appendChild(n)}window.TEAVisualEditor=window.TEAVisualEditor||{};var VISUAL_URL="",isLoaded=!1;function loadEditorScript(e){var t=e.event,i=e.editorUrl;e.collectInstance,e.fromSession,isLoaded||(isLoaded=!0,loadScript(i,function(){dispatchMsg(t,"abEditorScriptloadSuccess")},function(){t&&dispatchMsg(t,"abEditorScriptloadError"),isLoaded=!1}))}function readyToLoadEditor(e,t,i,n){addAllowdOrigin(["*"]);var r,o="";init(n,SDK_VERSION);var a="";try{var s=window.performance.getEntriesByType("resource");if(s&&s.length&&(s.forEach(function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(a=e.name)}),a||document.currentScript&&(a=document.currentScript.src),a&&(r=a.split("/"))&&r.length)){o="https:/";for(var c=2;c<r.length&&c!==r.length-1;c++)o=o+"/"+r[c];o+="/visual-ab-core"}}catch(e){}receiveMsg("tea:openVisualABEditor",function(n){var r=n.data;if("string"==typeof n.data)try{r=JSON.parse(n.data)}catch(e){r=void 0}if(r){var a=r.lang;if(r.appId!==t)return dispatchMsg(n,"appIdError"),void console.error("abtest appid is not belong the page appid please check");var s=r.version;VISUAL_URL=s&&o?""+o+(s?"."+s:".1.0.1")+".js?query="+Date.now():decodeUrl(VISUAL_URL_ASC)+"?query="+Date.now(),window.TEAVisualEditor.lang=a,i&&(window.TEAVisualEditor.__ab_domin=i),loadEditorScript({event:n,editorUrl:VISUAL_URL,collectInstance:e})}})}var FetchStatus,RefreshFetchStatus,CallbackType,loadMuiltlink=function(e,t,i,n){window.TEAVisualEditor.appId=t,receiveMsg("tea:openTesterEventInspector",function(t){var i=t.data;if("string"==typeof t.data)try{i=JSON.parse(t.data)}catch(e){i=void 0}if(i){var n=i.referrer,r=i.lang,o=i.appId;window.TEAVisualEditor.__editor_ajax_domain=n||"",window.TEAVisualEditor.__ab_appId=o||"",window.TEAVisualEditor.lang=r||"",loadEditorScript({event:t,editorUrl:decodeUrl(VISUAL_URL_INSPECTOR)+"?query="+Date.now(),collectInstance:e})}})},VISUAL_RANGER_URL=decodeUrl(VISUAL_URL_RANGER)+"?query="+Date.now(),loadVisual=function(e){window.TEAVisualEditor.__ab_config=e,loadScript(VISUAL_RANGER_URL,function(){console.log("load visual render success")},function(){console.log("load visual render fail")})};!function(e){e[e.No=0]="No",e[e.Ing=1]="Ing",e[e.Complete=2]="Complete"}(FetchStatus||(FetchStatus={})),function(e){e[e.No=0]="No",e[e.Ing=1]="Ing",e[e.Complete=2]="Complete"}(RefreshFetchStatus||(RefreshFetchStatus={})),function(e){e[e.Var=0]="Var",e[e.All=1]="All"}(CallbackType||(CallbackType={}));var AB=function(){function e(e,t,i){this.appId=0,this.user={},this.header={},this.domain="",this.protocal=location.protocol,this.fetchStatus=FetchStatus.No,this.refreshFetchStatus=RefreshFetchStatus.Complete,this.callbacks=[],this.data=null,this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.collector=e,this.initConfig=i;var n=this.collector._initConfig,r=n.app_id,o=n.channel,a=n.enable_multilink,s=n.multilink_timeout_ms,c=n.ab_channel_domain,l=n.channel_domain,h=n.enable_ab_visual,u=n.ab_timeout;if(this.appId=r,this.timeout=u||3e3,this.domain=c||decodeUrl(DOMAINS[o||"cn"]),this.domain){this.needOverlay=a||h||!1,this.enable_ab_visual=h,this.enable_multilink=a,this.closeTime=s||500,this.Hook=t;var d=l||decodeUrl(LOG_URL[o]);this.reportUrl=""+d+REPORT_URL,this.editCheck(),h&&(readyToLoadEditor(e,this.appId,c||"",i),"visual-editor"===this.editMode)?this.collector.destroy():(a&&loadMuiltlink(e,this.appId,c||"",i),this._check(),this.wait())}else console.warn("sorry, channel in is not support abtest yet~")}return e.prototype.editCheck=function(){var e=getIframeUrl();if(e){var t=e.scenario,i=e.href;t?"heatmap"===t?(console.log("heatmap mode"),this.editMode="heatmap"):"visual-editor"===t&&(console.log("visual mode"),this.editMode="visual-editor"):i&&(-1!==i.indexOf("datatester")||-1!==i.indexOf("visual-editor"))&&(console.log("visual mode"),this.editMode="visual-editor")}},e.prototype.checkFromUrl=function(){var e=parseUrlQuery(window.location.href);return e&&e.vid?e.vid:""},e.prototype.refetch=function(){this.data={},this.versions=[],this.mulilinkVersions=[],this.extVersions=[],this.refreshFetchStatus=RefreshFetchStatus.Ing;var e=this.collector._config.get();this.init(e)},e.prototype.init=function(e,t){if(!this.collector.destroyInstance)if(this.domain){this.config=e;var i=e.user,n=e.header,r=__rest(n,[]);this.user=__assign({},i),this.header=__assign({},n),this._fetch(__assign({},r),{success:t,fail:t})}else console.warn("sorry, channel in is not support abtest yet~")},e.prototype._check=function(){var e=this,t=checkExpiration(this.appId);if(t){var i=t.ab_version,n=t.data,r=t.ab_ext_version,o=t.ab_version_multilink,a=this.checkFromUrl();a?this.mulilinkVersions.push(a):this.mulilinkVersions=o||[],this.extVersions=r,i&&i.length&&(this.versions=i,this.data=n,setTimeout(function(){e._configVersions()}))}},e.prototype.wait=function(){var e=this;this.needOverlay&&(this.isWait||(this.openOverlayer(),this.isWait=!0),setTimeout(function(){e.closeOverlayer()},this.closeTime))},e.prototype.getAllVars=function(e){if("function"!=typeof e)throw Error("callback must be a function");var t={callback:e,type:CallbackType.All};this.fetchStatus===FetchStatus.Complete&&this.refreshFetchStatus===RefreshFetchStatus.Complete?this._getAllVars(t):this.callbacks.push(t)},e.prototype._getAllVars=function(e){(0,e.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{})},e.prototype.getVids=function(){try{var e=getCache(this.appId),t=e.ab_version,i=e.ab_version_multilink,n=e.ab_ext_version,r="",o=t.concat(i).concat(n);return o&&o.length&&(r=o.join(",")),r}catch(e){return""}},e.prototype.getAbSdkVersion=function(e){e(this.getVids())},e.prototype.getVar=function(e,t,i){if(!e)throw Error("variable must not be empty");if(void 0===t)throw Error("variable no default value");if("function"!=typeof i)throw Error("callback must be a function");var n={name:e,defaultValue:t,callback:i,type:CallbackType.Var};if(this.fetchStatus===FetchStatus.Complete&&this.refreshFetchStatus===RefreshFetchStatus.Complete){this._getVar(n,e);try{this.Hook.emit("onAbSdkVersionChange",this.getVids())}catch(e){}}else this.callbacks.push(n)},e.prototype._getVar=function(e,t){var i=e.name,n=e.defaultValue,r=e.callback,o=this.data;if(o){if("object"==typeof o[i]&&void 0!==o[i].val){var a=o[i].vid;return"$ab_url"===t?(-1===this.mulilinkVersions.indexOf(a)&&this.mulilinkVersions.push(a),this._updateMultilinkVersions()):(-1===this.versions.indexOf(a)&&this.versions.push(a),this._updateVersions()),this._abEvent(a,t,n),void r(o[i].val)}r(n)}else r(n)},e.prototype._abEvent=function(e,t,i){var n=this;try{if(this.initConfig.disable_track_event)return;var r=this.collector._config.get(),o=r.header,a=r.user,s=getCache(this.appId);if(s&&s.uuid&&s.uuid!==a.user_unique_id)return;if(e){var c={event:"abtest_exposure",ab_sdk_version:""+e,params:JSON.stringify({app_id:this.appId,ab_url:"$ab_url"===t?i:window.location.href}),local_time_ms:Date.now()};o.ab_sdk_version=""+e,o.custom=JSON.stringify(o.custom);var l={events:[c],user:a,header:o};"$ab_url"===t?window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify([l])):request(this.reportUrl,2e4,[l],""):setTimeout(function(){request(n.reportUrl,2e4,[l],"")},16)}}catch(e){}},e.prototype.openOverlayer=function(){openOverlayer()},e.prototype.closeOverlayer=function(){closeOverlayer()},e.prototype._setAbVersion=function(e){this.extVersions=[e],setVersionCache(this.appId,this.extVersions,!0)},e.prototype._updateVersions=function(){setVersionCache(this.appId,this.versions),this._configVersions()},e.prototype._updateMultilinkVersions=function(){setMultilinkCache(this.appId,this.mulilinkVersions)},e.prototype._configVersions=function(){var e=this.versions.join(",");e&&this.collector.config({ab_sdk_version:e})},e.prototype._clearCache=function(){this.versions=[],this.mulilinkVersions=[]},e.prototype._getABconfig=function(e,t){var i=Object.keys(e);i&&i.length&&this.collector.config(e),this.init(this.collector._config.get(),t)},e.prototype._fetchComplete=function(e,t){var i=this;if(e&&"[object Object]"==Object.prototype.toString.call(e)){setDataCache(this.appId,e,t),this.data=e;var n=[];Object.keys(e).forEach(function(t){var i=e[t].vid;i&&n.push(i)}),-1!==window.location.href.indexOf("multilink=true")||(this.versions=this.versions.filter(function(e){return -1!==n.indexOf(e)}));var r=e.$ab_url,o=e.$ab_modification;if(o&&o.val&&this.enable_ab_visual){if(this.collector.destroyInstance)return;this.getVar("$ab_modification",window.location.href,function(){loadVisual(o.val)})}else if(r&&this.enable_multilink){var a=r.val,s=r.vid;a&&s&&this.getVar("$ab_url",a,function(){if("heatmap"!==i.editMode){var e=window.location.href;-1!==e.indexOf("multilink=true")&&(e=i.filterUrl(e)),a!==e?setTimeout(function(){if(!i.collector.destroyInstance){var e=""+a;-1!==(e=-1===e.indexOf("http")?"https://"+e:e).indexOf("?")?e+="&multilink=true":e+="?multilink=true",parseURL(e).host!==location.host&&(e=e+"&vid="+s),window.location.href=e}},50):i.closeOverlayer()}})}else this.closeOverlayer()}this.callbacks.forEach(function(e){i[e.type===CallbackType.Var?"_getVar":"_getAllVars"](e,"")}),this.callbacks=[],this._updateVersions();try{this.Hook.emit("onAbSdkVersionChange",this.getVids())}catch(e){}this.isWait||this.closeOverlayer()},e.prototype._fetch=function(e,t){var i=this,n=void 0===t?{}:t,r=n.success,o=void 0===r?function(){}:r,a=n.fail,s=void 0===a?function(){}:a;this.fetchStatus=FetchStatus.Ing;var c=""+this.domain+API,l=window.location.href,h=!1;-1!==l.indexOf("multilink=true")&&(l=this.filterUrl(l),h=!0);var u=h?this.mulilinkVersions:this.versions;xhr(c,{header:__assign({aid:this.appId},this.user||{},e||{},{ab_sdk_version:u.join(","),ab_url:l})},function(e){i.fetchStatus=FetchStatus.Complete,i.refreshFetchStatus=RefreshFetchStatus.Complete;var t=e.data;"success"===e.message?(i._fetchComplete(t,i.user.user_unique_id),o(t)):(i._fetchComplete(null,i.user.user_unique_id),s())},function(){i.fetchStatus=FetchStatus.Complete,i.refreshFetchStatus=RefreshFetchStatus.Complete,s(),i._fetchComplete(null,i.user.user_unique_id)},"",this.timeout)},e.prototype.filterUrl=function(e){try{var t="";-1!==e.indexOf("&multilink=true")?t="&multilink=true[\0-\xff]*":-1!==e.indexOf("?multilink=true")&&(t="\\?multilink=true[\0-\xff]*");var i=RegExp(t,"g");e=e.replace(i,"")}catch(e){}return e},e}(),maxStorage=function(e,t,i,n){if(t){var r=e.filter(function(e){return!e[0].__disable_storage__}).length;if(r>0)try{var o=n.getItem(i);if(o){var a=Object.keys(o),s=a.length+r-t;if(s>0){for(var c=a.map(function(e){var t=o[e];return{id:e,index:t&&t[0]?t[0].header.__storage_index__:+new Date}}).sort(function(e,t){return e.index-t.index}),l=0;l<s;l++){var h=c.shift();h&&h.id&&o[h.id]&&delete o[h.id]}n.setItem(i,o)}}}catch(e){}}},Et_Test=function(){function e(e){"string"==typeof e.event_verify_url?this.url=e.event_verify_url+"/"+ET_TEST_URL:console.log("please use correct et_test url")}return e.prototype.send=function(e){this.url&&request(this.url,3e4,e)},e}(),Plugin=function(){return function(e,t,i,n,r){t&&(t.enable_stay_duration&&(this.stay=new StayDuration(n,t)),t.disable_session||(this.session=new Session$1(i)),t.channel_domain||t.disable_sdk_monitor||(this.monitor=new Monitor(t)),t.event_verify_url&&(this.et_test=new Et_Test(t)),t.enable_ab_test&&(this.ab=new AB(e,r,t)),t.max_storage_num&&(this.maxStorage=maxStorage))}}(),Profile=function(){function e(e,t,i){this.processEvent=e,this._event=t,this.cache={},this.duration=6e4,this.config=i,this.profileReady=!1,this.reportUrl=(i.channel_domain||decodeUrl(LOG_URL[i.channel]))+"/profile/list"}return e.prototype.start=function(){this.profileReady=!0},e.prototype.report=function(e,t){void 0===t&&(t={});try{if(this.config.disable_track_event)return;var i=[];i.push(this.processEvent(e,t));var n=this._event._mergeEvents(i);request(this.reportUrl,3e5,n)}catch(e){}},e.prototype.setProfile=function(e){var t=this._formatParams(e);t&&Object.keys(t).length&&(this._pushCache(t),this.report("__profile_set",__assign({},t,{profile:!0})))},e.prototype.setOnceProfile=function(e){var t=this._formatParams(e,!0);t&&Object.keys(t).length&&(this._pushCache(t),this.report("__profile_set_once",__assign({},t,{profile:!0})))},e.prototype.incrementProfile=function(e){e?this.report("__profile_increment",__assign({},e,{profile:!0})):console.warn("please check the params, must be object!!!")},e.prototype.unsetProfile=function(e){if(e){var t={};t[e]="1",this.report("__profile_unset",__assign({},t,{profile:!0}))}else console.warn("please check the key, must be string!!!")},e.prototype.appendProfile=function(e){if(e){var t={};for(var i in e)"string"==typeof e[i]||"Array"===Object.prototype.toString.call(e[i]).slice(8,-1)?t[i]=e[i]:console.warn("please check the value of param: "+i+", must be string or array !!!");Object.keys(t).length&&this.report("__profile_append",__assign({},t,{profile:!0}))}else console.warn("please check the params, must be object!!!")},e.prototype._pushCache=function(e){var t=this;Object.keys(e).forEach(function(i){t.cache[i]={val:t._clone(e[i]),timestamp:Date.now()}})},e.prototype._formatParams=function(e,t){var i=this;void 0===t&&(t=!1);try{if(!e||"[object Object]"!==Object.prototype.toString.call(e))return void console.warn("please check the params type, must be object !!!");var n={};for(var r in e)"string"==typeof e[r]||"number"==typeof e[r]||"Array"===Object.prototype.toString.call(e[r]).slice(8,-1)?n[r]=e[r]:console.warn("please check the value of params:"+r+", must be string,number,Array !!!");var o=Object.keys(n);if(!o.length)return;var a=Date.now();return o.filter(function(n){var r=i.cache[n];return t?!r:!(r&&i._compare(r.val,e[n])&&a-r.timestamp<i.duration)}).reduce(function(e,t){return e[t]=n[t],e},{})}catch(e){}},e.prototype._compare=function(e,t){try{return JSON.stringify(e)===JSON.stringify(t)}catch(e){return!1}},e.prototype._clone=function(e){try{return JSON.parse(JSON.stringify(e))}catch(t){return e}},e.prototype._unReady=function(){console.warn("sdk is not ready, please use this api after start")},e}(),dayjs_min=createCommonjsModule(function(e,t){e.exports=function(){var e="millisecond",t="second",i="minute",n="hour",r="day",o="week",a="month",s="quarter",c="year",l="date",h="Invalid Date",u=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,d=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},f=function(e,t,i){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(i)+e},g={s:f,z:function(e){var t=-e.utcOffset(),i=Math.abs(t),n=Math.floor(i/60),r=i%60;return(t<=0?"+":"-")+f(n,2,"0")+":"+f(r,2,"0")},m:function e(t,i){if(t.date()<i.date())return-e(i,t);var n=12*(i.year()-t.year())+(i.month()-t.month()),r=t.clone().add(n,a),o=i-r<0,s=t.clone().add(n+(o?-1:1),a);return+(-(n+(i-r)/(o?r-s:s-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(h){return({M:a,y:c,w:o,d:r,D:l,h:n,m:i,s:t,ms:e,Q:s})[h]||String(h||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},_="en",m={};m[_]=p;var v=function(e){return e instanceof w},y=function(e,t,i){var n;if(!e)return _;if("string"==typeof e)m[e]&&(n=e),t&&(m[e]=t,n=e);else{var r=e.name;m[r]=e,n=r}return!i&&n&&(_=n),n||!i&&_},b=function(e,t){if(v(e))return e.clone();var i="object"==typeof t?t:{};return i.date=e,i.args=arguments,new w(i)},z=g;z.l=y,z.i=v,z.w=function(e,t){return b(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var w=function(){function p(e){this.$L=y(e.locale,null,!0),this.parse(e)}var f=p.prototype;return f.parse=function(e){this.$d=function(e){var t=e.date,i=e.utc;if(null===t)return new Date(NaN);if(z.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(u);if(n){var r=n[2]-1||0,o=(n[7]||"0").substring(0,3);return i?new Date(Date.UTC(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},f.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},f.$utils=function(){return z},f.isValid=function(){return this.$d.toString()!==h},f.isSame=function(e,t){var i=b(e);return this.startOf(t)<=i&&i<=this.endOf(t)},f.isAfter=function(e,t){return b(e)<this.startOf(t)},f.isBefore=function(e,t){return this.endOf(t)<b(e)},f.$g=function(e,t,i){return z.u(e)?this[t]:this.set(i,e)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(e,s){var h=this,u=!!z.u(s)||s,d=z.p(e),p=function(e,t){var i=z.w(h.$u?Date.UTC(h.$y,t,e):new Date(h.$y,t,e),h);return u?i:i.endOf(r)},f=function(e,t){return z.w(h.toDate()[e].apply(h.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(t)),h)},g=this.$W,_=this.$M,m=this.$D,v="set"+(this.$u?"UTC":"");switch(d){case c:return u?p(1,0):p(31,11);case a:return u?p(1,_):p(0,_+1);case o:var y=this.$locale().weekStart||0,b=(g<y?g+7:g)-y;return p(u?m-b:m+(6-b),_);case r:case l:return f(v+"Hours",0);case n:return f(v+"Minutes",1);case i:return f(v+"Seconds",2);case t:return f(v+"Milliseconds",3);default:return this.clone()}},f.endOf=function(e){return this.startOf(e,!1)},f.$set=function(o,s){var h,u=z.p(o),d="set"+(this.$u?"UTC":""),p=((h={})[r]=d+"Date",h[l]=d+"Date",h[a]=d+"Month",h[c]=d+"FullYear",h[n]=d+"Hours",h[i]=d+"Minutes",h[t]=d+"Seconds",h[e]=d+"Milliseconds",h)[u],f=u===r?this.$D+(s-this.$W):s;if(u===a||u===c){var g=this.clone().set(l,1);g.$d[p](f),g.init(),this.$d=g.set(l,Math.min(this.$D,g.daysInMonth())).$d}else p&&this.$d[p](f);return this.init(),this},f.set=function(e,t){return this.clone().$set(e,t)},f.get=function(e){return this[z.p(e)]()},f.add=function(e,s){var l,h=this;e=Number(e);var u=z.p(s),d=function(t){var i=b(h);return z.w(i.date(i.date()+Math.round(t*e)),h)};if(u===a)return this.set(a,this.$M+e);if(u===c)return this.set(c,this.$y+e);if(u===r)return d(1);if(u===o)return d(7);var p=((l={})[i]=6e4,l[n]=36e5,l[t]=1e3,l)[u]||1,f=this.$d.getTime()+e*p;return z.w(f,this)},f.subtract=function(e,t){return this.add(-1*e,t)},f.format=function(e){var t=this,i=this.$locale();if(!this.isValid())return i.invalidDate||h;var n=e||"YYYY-MM-DDTHH:mm:ssZ",r=z.z(this),o=this.$H,a=this.$m,s=this.$M,c=i.weekdays,l=i.months,u=function(e,i,r,o){return e&&(e[i]||e(t,n))||r[i].substr(0,o)},p=function(e){return z.s(o%12||12,e,"0")},f=i.meridiem||function(e,t,i){var n=e<12?"AM":"PM";return i?n.toLowerCase():n},g={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:z.s(s+1,2,"0"),MMM:u(i.monthsShort,s,l,3),MMMM:u(l,s),D:this.$D,DD:z.s(this.$D,2,"0"),d:String(this.$W),dd:u(i.weekdaysMin,this.$W,c,2),ddd:u(i.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(o),HH:z.s(o,2,"0"),h:p(1),hh:p(2),a:f(o,a,!0),A:f(o,a,!1),m:String(a),mm:z.s(a,2,"0"),s:String(this.$s),ss:z.s(this.$s,2,"0"),SSS:z.s(this.$ms,3,"0"),Z:r};return n.replace(d,function(e,t){return t||g[e]||r.replace(":","")})},f.utcOffset=function(){return-(15*Math.round(this.$d.getTimezoneOffset()/15))},f.diff=function(e,l,h){var u,d=z.p(l),p=b(e),f=6e4*(p.utcOffset()-this.utcOffset()),g=this-p,_=z.m(this,p);return _=((u={})[c]=_/12,u[a]=_,u[s]=_/3,u[o]=(g-f)/6048e5,u[r]=(g-f)/864e5,u[n]=g/36e5,u[i]=g/6e4,u[t]=g/1e3,u)[d]||g,h?_:z.a(_)},f.daysInMonth=function(){return this.endOf(a).$D},f.$locale=function(){return m[this.$L]},f.locale=function(e,t){if(!e)return this.$L;var i=this.clone(),n=y(e,t,!0);return n&&(i.$L=n),i},f.clone=function(){return z.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},p}(),k=w.prototype;return b.prototype=k,[["$ms",e],["$s",t],["$m",i],["$H",n],["$W",r],["$M",a],["$y",c],["$D",l]].forEach(function(e){k[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),b.extend=function(e,t){return e.$i||(e(t,w,b),e.$i=!0),b},b.locale=y,b.isDayjs=v,b.unix=function(e){return b(1e3*e)},b.en=m[_],b.Ls=m,b.p={},b}()}),duration=createCommonjsModule(function(e,t){var i,n,r,o,a,s,c,l,h,u,d,p,f,g,_,m,v;a=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,l=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,h={years:s=31536e6,months:c=2592e6,days:o=864e5,hours:r=36e5,minutes:6e4,seconds:1e3,milliseconds:1,weeks:6048e5},u=function(e){return e instanceof v},d=function(e,t,i){return new v(e,i,t.$l)},p=function(e){return n.p(e)+"s"},f=function(e){return e<0},g=function(e){return f(e)?Math.ceil(e):Math.floor(e)},_=function(e){return Math.abs(e)},m=function(e,t){return e?f(e)?{negative:!0,format:""+_(e)+t}:{negative:!1,format:""+e+t}:{negative:!1,format:""}},v=function(){function e(e,t,i){var n=this;if(this.$d={},this.$l=i,void 0===e&&(this.$ms=0,this.parseFromMilliseconds()),t)return d(e*h[p(t)],this);if("number"==typeof e)return this.$ms=e,this.parseFromMilliseconds(),this;if("object"==typeof e)return Object.keys(e).forEach(function(t){n.$d[p(t)]=e[t]}),this.calMilliseconds(),this;if("string"==typeof e){var r=e.match(l);if(r){var o=r.slice(2).map(function(e){return Number(e)});return this.$d.years=o[0],this.$d.months=o[1],this.$d.weeks=o[2],this.$d.days=o[3],this.$d.hours=o[4],this.$d.minutes=o[5],this.$d.seconds=o[6],this.calMilliseconds(),this}}return this}var t=e.prototype;return t.calMilliseconds=function(){var e=this;this.$ms=Object.keys(this.$d).reduce(function(t,i){return t+(e.$d[i]||0)*h[i]},0)},t.parseFromMilliseconds=function(){var e=this.$ms;this.$d.years=g(e/s),e%=s,this.$d.months=g(e/c),e%=c,this.$d.days=g(e/o),e%=o,this.$d.hours=g(e/r),e%=r,this.$d.minutes=g(e/6e4),e%=6e4,this.$d.seconds=g(e/1e3),e%=1e3,this.$d.milliseconds=e},t.toISOString=function(){var e=m(this.$d.years,"Y"),t=m(this.$d.months,"M"),i=+this.$d.days||0;this.$d.weeks&&(i+=7*this.$d.weeks);var n=m(i,"D"),r=m(this.$d.hours,"H"),o=m(this.$d.minutes,"M"),a=this.$d.seconds||0;this.$d.milliseconds&&(a+=this.$d.milliseconds/1e3);var s=m(a,"S"),c=e.negative||t.negative||n.negative||r.negative||o.negative||s.negative,l=r.format||o.format||s.format?"T":"",h=(c?"-":"")+"P"+e.format+t.format+n.format+l+r.format+o.format+s.format;return"P"===h||"-P"===h?"P0D":h},t.toJSON=function(){return this.toISOString()},t.format=function(e){var t=e||"YYYY-MM-DDTHH:mm:ss",i={Y:this.$d.years,YY:n.s(this.$d.years,2,"0"),YYYY:n.s(this.$d.years,4,"0"),M:this.$d.months,MM:n.s(this.$d.months,2,"0"),D:this.$d.days,DD:n.s(this.$d.days,2,"0"),H:this.$d.hours,HH:n.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:n.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:n.s(this.$d.seconds,2,"0"),SSS:n.s(this.$d.milliseconds,3,"0")};return t.replace(a,function(e,t){return t||String(i[e])})},t.as=function(e){return this.$ms/h[p(e)]},t.get=function(e){var t=this.$ms,i=p(e);return"milliseconds"===i?t%=1e3:t="weeks"===i?g(t/h[i]):this.$d[i],0===t?0:t},t.add=function(e,t,i){var n;return n=t?e*h[p(t)]:u(e)?e.$ms:d(e,this).$ms,d(this.$ms+n*(i?-1:1),this)},t.subtract=function(e,t){return this.add(e,t,!0)},t.locale=function(e){var t=this.clone();return t.$l=e,t},t.clone=function(){return d(this.$ms,this)},t.humanize=function(e){return i().add(this.$ms,"ms").locale(this.$l).fromNow(!e)},t.milliseconds=function(){return this.get("milliseconds")},t.asMilliseconds=function(){return this.as("milliseconds")},t.seconds=function(){return this.get("seconds")},t.asSeconds=function(){return this.as("seconds")},t.minutes=function(){return this.get("minutes")},t.asMinutes=function(){return this.as("minutes")},t.hours=function(){return this.get("hours")},t.asHours=function(){return this.as("hours")},t.days=function(){return this.get("days")},t.asDays=function(){return this.as("days")},t.weeks=function(){return this.get("weeks")},t.asWeeks=function(){return this.as("weeks")},t.months=function(){return this.get("months")},t.asMonths=function(){return this.as("months")},t.years=function(){return this.get("years")},t.asYears=function(){return this.as("years")},e}(),e.exports=function(e,t,r){i=r,n=r().$utils(),r.duration=function(e,t){return d(e,{$l:r.locale()},t)},r.isDuration=u;var o=t.prototype.add,a=t.prototype.subtract;t.prototype.add=function(e,t){return u(e)&&(e=e.asMilliseconds()),o.bind(this)(e,t)},t.prototype.subtract=function(e,t){return u(e)&&(e=e.asMilliseconds()),a.bind(this)(e,t)}}});dayjs_min.extend(duration);var ignoreList=["__cep_sdk_onboard","__cep_trigger_sdk","_be_active"],moreOP=["and","or","not"],CEP_URL="/service/2/cep_settings/",CepRule=function(){function CepRule(e,t,i){this.support=!0,this.currentPlan=1,this.shouldSendEvent=!1,this.staing=!1,this.test=!1,this.cepReady=!1,this.eventCache=[],this.storage=new Storage(!1),this.config=e;var n=e.channel_domain||decodeUrl(LOG_URL[e.channel||"cn"]);this.url=e.cep_url?""+e.cep_url:""+n+CEP_URL,this.reportUrl=""+n+REPORT_URL,this.key=CEPKEY(e.app_id),this.quotasKey="__tea_cep_plan_quotas_"+this.config.app_id,this.configManager=t,this.hook=i,this.isWait=!1,this.eventCache=[],this.test=t.staging}return CepRule.prototype.init=function(){var e=this,t=!0,i=0,n=0,r=0,o=!1,a=this.storage.getItem(this.key)||{};if(a&&Object.keys(a).length&&(o=!0,i=a.last_update_time,r=a.fetch_interval,n=a.config_version||0,t=Date.now()-i>1e3*r),t){var s=this.configManager.get(),c=s.header,l=s.user;xhr(this.url,{header:c,user:l,local_time:Date.now(),config_version:n},function(t){t&&0===t.code?(a.fetch_interval=t.fetch_interval,a.data=t.data,a.last_update_time=Date.now(),a.config_version=t.config_version,e.clearQuotas(),e.initState(t.data),e.storage.setItem(e.key,a),t.data.forEach(function(t){e.event("__cep_sdk_onboard",t.plan_id)})):(304===t.code||400===t.code)&&o?(console.log("code: "+t.code+", use old rules~"),a.last_update_time=Date.now(),e.storage.setItem(e.key,a),e.initState(a.data)):console.log("code: "+t.code+", request error\uFF0Cplease try leater")},function(){o?(e.planData=a.data,e.initState(a.data)):(e.support=!1,console.log("request error\uFF0Cplease try leater"))})}else a.last_update_time=Date.now(),this.storage.setItem(this.key,a),console.log("rule still work, use cache"),this.initState(a.data)},CepRule.prototype.initState=function(e){var t=this;e&&e.length&&(this.stateArray=new Map,this.waitArray=new Map,this.planData=e,e.forEach(function(e){var i=new Map;if(e.pattern&&e.pattern.events){var n=1===e.pattern.events.length;e.pattern.events.forEach(function(e){i.set(e.id,{id:e.id,isMatch:!1,event:null,after:e.after||null,connection:e.connection||null,window:e.window||null,matchTime:0,initTime:Date.now(),singleRule:n})}),t.stateArray.set(e.plan_id,{patternState:i,singleRule:n,pattern:{aid:e.aid,biz_id:e.biz_id,end_time:e.end_time,start_time:e.start_time,web_sdk_version:e.web_sdk_version,stage:e.stage},quotas:e.quotas})}}),this.cepReady=!0,this.dealCache(),console.log(this.stateArray))},CepRule.prototype.check=function(e){var t=Date.now();return Date.now()>1e3*e.end_time?(console.log("event rules:"+e.plan_id+" is over"),!1):t<1e3*e.start_time||t>1e3*e.end_time?(console.log("rule:"+e.plan_id+" time error"),!1):(this.staing="testing"===e.staing,!(SDK_VERSION<e.web_sdk_version)||(this.support=!1,console.log("you sdk version is old\uFF0Cplease update to "+e.web_sdk_version+" at least"),!1))},CepRule.prototype.dealCache=function(){var e=this;if(this.eventCache.length){var t=1;this.eventCache.forEach(function(i){e.matchEvent(i),t++}),t===this.eventCache.length&&(this.eventCache=[])}},CepRule.prototype.matchEvent=function(e){if(this.support&&(!this.staing||this.test)&&e&&e.length)try{if(!this.cepReady)return void this.eventCache.push(e);var t=e[0],i=t.header,n=t.user,r=t.events;r.length&&r.reverse();for(var o=0;o<r.length;o++){var a=r[o].event;if(-1!==ignoreList.indexOf(a))return!1;this.matchRule(i,n,r[o])}}catch(e){return void console.log(e.message)}},CepRule.prototype.matchRule=function(e,t,i){try{for(var n=0;n<this.planData.length;n++){var r=this.planData[n],o=r.plan_id;if(this.check(r)&&this.checkQuotas(o)&&r.pattern&&r.pattern.events){for(var a=r.pattern.events,s=0;s<a.length;s++)if(this.rule(e,t,i,a[s].condition)){var c=this.stateArray.get(o).patternState,l=c.get(a[s].id);if(this.stateArray.get(o).singleRule){this.changeStatus(o,a[s].id,i),this.publish([i],o,a[s].id);break}if(!l.isMatch){l.after&&c.get(l.after).isMatch?this.changeStatus(o,a[s].id,i):l.after||this.changeStatus(o,a[s].id,i);break}}}}this.statusCheck()}catch(e){return void console.log(e.message)}},CepRule.prototype.changeStatus=function(e,t,i){var n=this.stateArray.get(e),r=n.patternState.get(t);r.isMatch=!0,r.event=i,r.matchTime=i.local_time_ms||Date.now(),n.patternState.set(t,r),this.stateArray.set(e,n)},CepRule.prototype.statusCheck=function(){var e,t,i,n;try{for(var r=__values(this.stateArray),o=r.next();!o.done;o=r.next()){var a=__read(o.value,2),s=a[0],c=a[1],l=c.patternState;if(c.isSingle)break;try{for(var h=__values(l),u=h.next();!u.done;u=h.next()){var d=__read(u.value,2),p=d[0],f=d[1];if(f.after&&(!f.after||l.get(f.after).isMatch)){if("NOT_FOLLOWED_BY"===f.connection){f.isMatch?this.reset(s,p):Date.now()-l.get(f.after).matchTime>f.window?this.publish([l.get(f.after).event,f.event],s,p):this.startWait(s,p,f);break}f.isMatch?f.matchTime-l.get(f.after).matchTime<=f.window?this.publish([l.get(f.after).event,f.event],s,p):this.reset(s,p):Date.now()-l.get(f.after).matchTime>f.window?this.reset(s,p):this.startWait(s,p,f);break}}}catch(e){i={error:e}}finally{try{u&&!u.done&&(n=h.return)&&n.call(h)}finally{if(i)throw i.error}}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},CepRule.prototype.startWait=function(e,t,i){var n=this;try{this.waitArray.get(e)||this.waitArray.set(e,new Map);var r=this.waitArray.get(e);if(!r.get(t)){var o=setTimeout(function(){var r,o=n.stateArray.get(e).patternState,a=o.get(t);"NOT_FOLLOWED_BY"===a.connection?!a.isMatch&&o.get(a.after).isMatch||a.matchTime-o.get(a.after).matchTime>i.window?((r=n.waitArray.get(e).get(t)).triggerWait=!0,n.waitArray.set(e,n.waitArray.get(e).set(t,r)),n.publish([o.get(a.after).event],e,t)):n.reset(e,t):"FOLLOWED_BY"===a.connection&&(a.isMatch&&o.get(a.after).isMatch?((r=n.waitArray.get(e).get(t)).triggerWait=!0,n.waitArray.set(e,n.waitArray.get(e).set(t,r)),n.publish([o.get(a.after).event],e,t)):n.reset(e,t))},i.window);r.set(t,{waitFn:o,triggerWait:!1}),this.waitArray.set(e,r)}}catch(e){console.log(e.message,e.stack)}},CepRule.prototype.rule=function(e,t,i,n){var r=this;try{var o=i.event,a=i.params;if(a=JSON.parse(a),-1!==moreOP.indexOf(n.op)){if(n.conditions&&n.conditions.length){var s=n.conditions,c=0,l=new Map;l.set(c,{op:n.op,result:void 0,resultList:[],resultKey:[],resultLength:s.length}),function i(n,s){for(var h=0;h<n.length;h++)if(c++,-1!==moreOP.indexOf(n[h].op)&&n[h].hasOwnProperty("conditions"))l.set(c,{op:n[h].op,result:void 0,fatherKey:s,resultList:[],resultKey:[],resultLength:n[h].conditions.length}),i(n[h].conditions,c);else{var u=r.scope(n[h].key),d=u.scope,p=u.key,f=u.key2,g=d?"header"===d?f?JSON.parse(e[f])[p]:e[p]:"user"===d?t[p]:a[p]:o,_=r.calculate(n[h].op,g,n[h].value);l.set(c,{op:n[h].op,result:_,fatherKey:s})}}(s,c);for(var h=l.get(0);void 0===h.result||h.resultList.length<h.resultLength;)l.forEach(function(e,t){if(void 0!==e.result&&void 0!==e.fatherKey){var i=l.get(e.fatherKey);i.resultList.length<i.resultLength&&-1===i.resultKey.indexOf(t)&&(i.resultKey.push(t),i.resultList.push(e.result),l.set(e.fatherKey,i))}}),l.forEach(function(e){e.resultList&&e.resultList.length===e.resultLength&&("and"===e.op&&(e.result=-1===e.resultList.indexOf(!1)),"or"===e.op&&(e.result=-1!==e.resultList.indexOf(!0)))});return l.get(0).result}return!1}var u=this.scope(n.key),d=u.scope,p=u.key,f=u.key2,g=d?"header"===d?f?JSON.parse(e[f])[p]:e[p]:"user"===d?t[p]:a[p]:o;return this.calculate(n.op,g,n.value)}catch(e){return console.log(e.message),!1}},CepRule.prototype.publish=function(e,t,i){try{var n=this.configManager.get().user,r={biz_id:this.stateArray.get(t).pattern.biz_id,plan_id:t,uid:n.user_id||"",did:n.device_id||"",uuid:n.user_unique_id,events:e,extra:{url:window.location.href}};this.hook.emit("__cep_match",r),(window.opener||window.parent).postMessage({type:"__cep_match",data:r},"*"),this.event("__cep_trigger_sdk",t),this.addQuotas(t),this.reset(t,i),console.log(this.stateArray)}catch(e){return void console.log(e.message)}},CepRule.prototype.addQuotas=function(e){var t=this.stateArray.get(e).quotas;if(t&&t.length){var i=this.storage.getItem(this.quotasKey)||{};i[e]||(i[e]={value:0,lastTime:Date.now()});var n=i[e].value;0===n&&(i[e].lastTime=Date.now()),i[e].value=n+1,this.storage.setItem(this.quotasKey,i)}},CepRule.prototype.checkQuotas=function(e){var t=this.stateArray.get(e).quotas,i=this.storage.getItem(this.quotasKey)||{};if(i[e]||(i[e]={value:0,lastTime:Date.now()}),t&&t.length){var n=t[0].granularity,r=t[0].value;if("per_keyid"!==t[0].type)return!0;var o=this.release(n);return"all"===o?!(i[e].value>=r)||(console.log("plan:"+e+" \u8FBE\u5230\u89E6\u53D1\u4E0A\u9650\u4E86, \u672C\u6B21\u4E0D\u518D\u89E6\u53D1"),!1):Date.now()-i[e].lastTime>=o?(i[e].value=0,i[e].lastTime=Date.now(),this.storage.setItem(this.quotasKey,i),!0):!(i[e].value>=r)||(console.log("plan:"+e+" \u8FBE\u5230\u89E6\u53D1\u4E0A\u9650\u4E86~\uFF0C \u672C\u6B21\u4E0D\u518D\u89E6\u53D1"),!1)}return!0},CepRule.prototype.clearQuotas=function(){this.storage.setItem(this.quotasKey,null)},CepRule.prototype.release=function(e){if("all"===e)return e;var t=dayjs_min.duration(e);return t?t.asMilliseconds():"all"},CepRule.prototype.reset=function(e,t){var i=this.stateArray.get(e);if(i.singleRule){var n=i.patternState.get(t);n.isMatch=!1,n.event=null,n.matchTime=0,n.initTime=Date.now(),i.patternState.set(t,n)}else i.patternState.forEach(function(e){e.isMatch=!1,e.event=null,e.matchTime=0,e.initTime=Date.now()});this.stateArray.set(e,i);var r=this.waitArray.get(e);r&&r.get(t)&&(clearTimeout(r.get(t).waitFn),r.delete(t))},CepRule.prototype.event=function(e,t){try{var i={event:e,params:JSON.stringify({plan_id:t||"",biz_id:this.stateArray.get(t).pattern.biz_id}),local_time_ms:Date.now()},n=this.configManager.get(),r=n.header,o=n.user;r.custom=JSON.stringify(r.custom);var a={events:[i],user:o,header:r};xhr(this.reportUrl,[a])}catch(e){return void console.log(e.message)}},CepRule.prototype.scope=function(e){var t="",i="";if(e.indexOf(".")>-1){var n=e.split(".");t=n[0],e=n[1],"header"===t&&"custom"===e&&(e=n[2],i=n[1])}return{scope:t,key:e,key2:i}},CepRule.prototype.calculate=function(op,paramA,paramB){try{if("="===op)return paramA===paramB;if(-1!==["=","<",">",">=","<=","!="].indexOf(op))return eval(""+paramA+op+paramB);if(-1!==["in","contains"].indexOf(op))return -1!==paramB.indexOf(paramA);if(-1!==["is not null","is null"].indexOf(op))return"is null"===op?null==paramA:null!=paramA;if(-1!==["startswith","endswith"].indexOf(op)){if("startswith"===op)return 0===paramA.indexOf(paramB);var start=paramA.length-paramB.length;return paramA.substr(start,paramB.length)===paramB}}catch(e){return console.log(e.message),!1}},CepRule}();function isNeedElement(e,t){if(void 0===t&&(t="list"),!e)return!1;if(t&&"list"===t){if(["LI","TR","DL"].includes(e.nodeName)||e.dataset&&e.dataset.hasOwnProperty("teaIdx")||e.hasAttribute&&e.hasAttribute("data-tea-idx"))return!0}else if(["A","BUTTON"].includes(e.nodeName)||e.dataset&&e.dataset.hasOwnProperty("teaContainer")||e.hasAttribute&&e.hasAttribute("data-tea-container"))return!0;return!1}function getContainer(e){for(var t=e;t&&!isNeedElement(t,"container");){if("HTML"===t.nodeName||"BODY"===t.nodeName)return e;t=t.parentElement}return t||e}function getNodeText(e){var t="";return 3===e.nodeType?t=e.textContent.trim():e.dataset&&e.dataset.hasOwnProperty("teaTitle")||e.hasAttribute("ata-tea-title")?t=e.getAttribute("data-tea-title"):e.hasAttribute("title")?t=e.getAttribute("title"):"INPUT"===e.nodeName&&["button","submit"].includes(e.getAttribute("type"))?t=e.getAttribute("value"):"IMG"===e.nodeName&&e.getAttribute("alt")&&(t=e.getAttribute("alt")),t.slice(0,200)}function getText(e){var t=getContainer(e),i=[];return function e(t){var n=getNodeText(t);if(n&&-1===i.indexOf(n)&&i.push(n),t.childNodes.length>0)for(var r=t.childNodes,o=0;o<r.length;o++)8!==r[o].nodeType&&e(r[o])}(t),i}function getTextSingle(e){var t=getContainer(e),i="";return function e(t){var n=getNodeText(t);if(n&&(i+=n),t.childNodes.length>0)for(var r=t.childNodes,o=0;o<r.length;o++)3===r[o].nodeType&&e(r[o])}(t),i}function ignore(e){for(var t=e;t&&t.parentNode;){if(t.hasAttribute("data-tea-ignore"))return!0;if("HTML"===t.nodeName||"body"===t.nodeName)break;t=t.parentNode}return!1}var elementLevel=function(e){if(e.children.length){var t=e.children;return![].slice.call(t).some(function(e){return e.children.length>0})}return!0},isSVG=function(e){if("svg"===e.tagName.toLowerCase())return!0;for(var t=e.parentElement,i=!1;t;)"svg"===t.tagName.toLowerCase()?(t=null,i=!0):t=t.parentElement;return i};function isTrack(e,t){if(window.innerHeight,window.innerWidth,1!==e.nodeType||!t.svg&&isSVG(e)||["HTML","BODY"].includes(e.tagName.toUpperCase()))return!1;var i=e;return"none"!==i.style.display&&(!!isNeedElement(i,"container")||!!elementLevel(i))}var Listener=function(){function e(e,t,i){var n=this;this.clickEvent=function(e){isTrack(e.target,n.options)&&n.eventHandel({eventType:"dom",eventName:"click"},e)},this.changeEvent=function(e){n.eventHandel({eventType:"dom",eventName:"change"},e)},this.submitEvent=function(e){n.eventHandel({eventType:"dom",eventName:"submit"},e)},this.getPageViewEvent=function(e,t){n.eventHandel({eventType:"dom",eventName:"beat"},__assign({beat_type:0},e)),n.eventHandel({eventType:"dom",eventName:"page_view"},e)},this.getPageLoadEvent=function(e){n.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:e})},this.config=t.getConfig().eventConfig,this.options=e,this.beatTime=e.beat,this.statistics=!1,this.route=i}return e.prototype.init=function(e){this.eventHandel=e;var t=this.config.mode;this.addListener(t)},e.prototype.addListener=function(e){var t=this;if("proxy-capturing"===e&&(this.config.click&&window.document.addEventListener("click",this.clickEvent,!0),this.config.change&&window.document.addEventListener("change",this.changeEvent,!0),this.config.submit&&window.document.addEventListener("submit",this.submitEvent,!0),this.config.pv&&this.route.init("autotrack",this.getPageViewEvent),this.config.beat)){try{"complete"===document.readyState?this.beatEvent(this.beatTime):window.addEventListener("load",function(){t.beatEvent(t.beatTime)});var i=0,n=null;window.addEventListener("scroll",function(){clearTimeout(n),n=setTimeout(r,500),i=document.documentElement.scrollTop||document.body.scrollTop});var r=function(){(document.documentElement.scrollTop||document.body.scrollTop)==i&&t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(e){}try{var o=window.performance&&window.performance.getEntriesByType("paint");o&&o.length?(new PerformanceObserver(function(e){var i=e.getEntries(),n=i[i.length-1],r=n.renderTime||n.loadTime;t.statistics||(t.getPageLoadEvent(r),t.statistics=!0)}).observe({entryTypes:["largest-contentful-paint"]}),setTimeout(function(){t.statistics||(t.getPageLoadEvent(o[0].startTime||0),t.statistics=!0)},2e3)):this.getPageLoadEvent(0)}catch(e){this.getPageLoadEvent(0)}}},e.prototype.removeListener=function(){window.document.removeEventListener("click",this.clickEvent,!0),window.document.removeEventListener("change",this.changeEvent,!0),window.document.removeEventListener("submit",this.submitEvent,!0)},e.prototype.beatEvent=function(e){var t,i=this;try{this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3}),this.beatTime&&(t=setInterval(function(){i.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})},e)),beforePageUnload(function(){i.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),i.beatTime&&clearInterval(t)})}catch(e){}},e}(),defaultConfig={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},Config=function(){function e(e){this.config=e}return e.prototype.getConfig=function(){return this.config},e.prototype.setConfig=function(e){return this.config=e},e}();function getPositionData(e){if(e){var t=e.getBoundingClientRect(),i=t.width,n=t.height;return{left:t.left,top:t.top,element_width:i,element_height:n}}}function getEventData(e,t){void 0===e&&(e={}),void 0===t&&(t={});var i=e.clientX,n=e.clientY,r=t.left,o=t.top;return{touch_x:Math.floor(i-r>=0?i-r:0),touch_y:Math.floor(n-o>=0?n-o:0)}}function getXpath(e){for(var t=[];null!==e.parentElement;)t.push(e),e=e.parentElement;var i=[],n=[];return t.forEach(function(e){var t=getXpathIndex(e),r=t.str,o=t.index;i.unshift(r),n.unshift(o)}),{element_path:"/"+i.join("/"),positions:n}}function getXpathIndex(e){if(null===e)return{str:"",index:0};var t=0,i=e.parentElement;if(i)for(var n=i.children,r=0;r<n.length&&n[r]!==e;r++)n[r].nodeName===e.nodeName&&t++;return{str:[e.nodeName.toLowerCase(),isNeedElement(e,"list")?"[]":""].join(""),index:t}}function getElementData(e,t,i){var n={element_path:"",positions:[],texts:[]},r=getPositionData(t),o=getEventData(e,r),a=r.element_width,s=r.element_height,c=o.touch_x,l=o.touch_y,h=getXpath(t),u=h.element_path,d=h.positions,p=getText(t),f=window.performance.timing.navigationStart,g=Date.now()-f,_=d.map(function(e){return""+e}),m=null;window.TEAVisualEditor.getOriginXpath&&(m=window.TEAVisualEditor.getOriginXpath({xpath:u,positions:_})),n.element_path=m&&m.xpath||u,n.positions=m&&m.positions||_,i&&!i.text&&(n.texts=p,n.element_title=getTextSingle(t)),n.element_width=Math.floor(a),n.element_height=Math.floor(s),n.touch_x=c,n.touch_y=l,n.page_manual_key="",n.elememt_manual_key="",n.since_page_start_ms=g,n.page_start_ms=f;var v=getContainer(t);return"A"===v.tagName&&(n.href=v.getAttribute("href")),"IMG"===t.tagName&&(n.src=t.getAttribute("src")),n}function getEventData$1(e,t,i,n){return __assign({event:e},getElementData(t,i,n),{is_html:1,page_key:window.location.href,page_title:document.title})}function getExtraEventData(e,t){try{if("bav2b_change"===e)return t.hasAttribute("data-tea-track")?{value:t.value}:{}}catch(e){return{}}}var EventHandle=function(){function e(e){this.ignore={text:!1},this.eventName=e&&"tea"===e.custom?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat",static:"__bav_page_statistics"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat",static:"bav2b_page_statistics"},e&&!1===e.text&&(this.ignore.text=!0)}return e.prototype.handleEvent=function(e,t){try{if(ignore(e.target))return null;var i="bav2b_click";switch(t){case"click":return getEventData$1(i=this.eventName.click,e,e.target,this.ignore);case"change":return __assign({},getEventData$1(i="bav2b_change",e,e.target),getExtraEventData(i,e.target));case"submit":return getEventData$1(i="bav2b_submit",e,e.target)}}catch(e){return console.error(e),null}},e.prototype.handleViewEvent=function(e){e.event=this.eventName.page,e.page_title=document.title,e.page_total_width=window.innerWidth,e.page_total_height=window.innerHeight;try{var t=window.sessionStorage.getItem("_tea_cache_duration");if(t){var i=JSON.parse(t);e.refer_page_duration_ms=i?i.duration:"",e.refer_page_title=i?i.page_title:""}else e.refer_page_duration_ms="",e.refer_page_title="";e.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,e.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,e.page_start_ms=window.performance.timing.navigationStart}catch(e){console.log("page event error "+JSON.stringify(e))}return e},e.prototype.handleStatisticsEvent=function(e){var t={};t.event=this.eventName.static,t.is_html=1,t.page_key=location.href,t.refer_page_key=document.referrer||"",t.page_title=document.title,t.page_manual_key="",t.refer_page_manual_key="";try{var i=e.lcp,n=window.performance.timing,r=n.loadEventEnd-n.navigationStart;t.page_init_cost_ms=parseInt(i||(r>0?r:0)),t.page_start_ms=n.navigationStart}catch(e){console.log("page_statistics event error "+JSON.stringify(e))}return t},e.prototype.handleBeadtEvent=function(e){e.event=this.eventName.beat,e.is_html=1,e.page_title=document.title,e.page_manual_key="";try{e.page_total_width=document.documentElement.scrollWidth,e.page_total_height=document.documentElement.scrollHeight,e.scroll_width=document.documentElement.scrollLeft+window.innerWidth,e.scroll_height=document.documentElement.scrollTop+window.innerHeight,e.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,e.page_start_ms=window.performance.timing.navigationStart}catch(e){console.log("beat event error "+JSON.stringify(e))}return e},e}(),Request=function(){function e(e,t){this.logFunc=e,this.logFuncBecon=t,this.eventNameList=["report_click_event","report_change_event","report_submit_event","report_exposure_event","report_page_view_event","report_page_statistics_event","report_beat_event"]}return e.prototype.send=function(e,t){e.eventName;var i=e.eventSend,n=t.event;delete t.event,i&&"becon"===i?this.logFuncBecon(n,t,"autotrack"):this.logFunc(n,t,"autotrack")},e.prototype.get=function(e,t){fetch(e,Object.assign({headers:{"content-type":"application/json"},method:"GET"},t))},e.prototype.post=function(e,t){fetch(e,Object.assign({headers:{"content-type":"application/json"},method:"POST"},t))},e}(),COOKIE_KEY="_TEA_VE_OPEN",COOKIE_KEY_HOST="_TEA_VE_APIHOST",COOKIE_LANG="lang",COOKIE_EDIT_VERISON="_VISUAL_EDITOR_V",COOKIE_EDIT_URL="_VISUAL_EDITOR_U";function checkSession(){return"1"===js_cookie.get(COOKIE_KEY)}function checkSessionHost(){var e=js_cookie.get(COOKIE_KEY_HOST);try{e=JSON.parse(e)}catch(e){}return e}function checkEditUrl(){return js_cookie.get(COOKIE_EDIT_URL)}function setSession(){try{var e=window.TEAVisualEditor.lang=window.TEAVisualEditor.lang||js_cookie.get(COOKIE_LANG),t=window.TEAVisualEditor.__editor_ajax_domain=window.TEAVisualEditor.__editor_ajax_domain||js_cookie.get(COOKIE_KEY_HOST),i=window.TEAVisualEditor.__editor_verison=window.TEAVisualEditor.__editor_verison||js_cookie.get(COOKIE_EDIT_VERISON),n=window.TEAVisualEditor.__editor_url=window.TEAVisualEditor.__editor_url||js_cookie.get(COOKIE_EDIT_URL),r=+new Date,o=new Date(r+18e5);js_cookie.set(COOKIE_KEY,"1",{expires:o}),js_cookie.set(COOKIE_KEY_HOST,t,{expires:o}),js_cookie.set(COOKIE_EDIT_URL,n,{expires:o}),js_cookie.set(COOKIE_LANG,e,{expires:o}),js_cookie.set(COOKIE_EDIT_VERISON,i||"",{expires:o})}catch(e){console.log("set cookie err")}}window.TEAVisualEditor=window.TEAVisualEditor||{};var EDITOR_URL="",EDITOR_URL_OLD=window.TEAVisualEditor.__editor_url||decodeUrl(EDITOR_URL_OLD_ASC);EDITOR_URL_OLD=EDITOR_URL_OLD+"?query="+Date.now();var EDITOR_URL_NEW=decodeUrl(EDITOR_URL_NEW_ASC)+"?query="+Date.now(),isLoaded$1=!1;function loadEditorScript$1(e){var t=e.event,i=e.editorUrl,n=e.autoTrackInstance;e.fromSession,isLoaded$1||(isLoaded$1=!0,loadScript(i,function(){dispatchMsg(t,"editorScriptloadSuccess"),n.destroy()},function(){t&&dispatchMsg(t,"editorScriptloadError"),isLoaded$1=!1}))}function readyToLoadEditor$1(e,t){window.TEAVisualEditor.appId=t.app_id;var i=t.channel_domain,n="";if(addAllowdOrigin(["*"]),i){var r,o="";try{var a=window.performance.getEntriesByType("resource");if(a&&a.length&&(a.forEach(function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(o=e.name)}),o||document.currentScript&&(o=document.currentScript.src),o&&(r=o.split("/"))&&r.length)){n="https:/";for(var s=2;s<r.length&&s!==r.length-1;s++)n=n+"/"+r[s];n+="/visual-editor-rangers"}}catch(e){}}if(init(t,SDK_VERSION),checkSession()){var c=checkSessionHost();c?(window.TEAVisualEditor.__editor_ajax_domain=c,loadEditorScript$1({event:null,editorUrl:checkEditUrl()||EDITOR_URL_NEW,autoTrackInstance:e,fromSession:!1})):loadEditorScript$1({event:null,editorUrl:EDITOR_URL_OLD,autoTrackInstance:e,fromSession:!1}),setSession()}else try{receiveMsg("tea:openVisualEditor",function(t){var r=t.data;if("string"==typeof t.data)try{r=JSON.parse(t.data)}catch(e){r=void 0}if(r){var o=r.referrer,a=r.lang;if(o?(window.TEAVisualEditor.__editor_ajax_domain=o,EDITOR_URL=EDITOR_URL_NEW):EDITOR_URL=EDITOR_URL_OLD,i){var s=r.version;EDITOR_URL=n?""+n+(s?"-v"+s:"-v1.0.0")+".js":EDITOR_URL_NEW,window.TEAVisualEditor.__editor_verison=s}window.TEAVisualEditor.__editor_url=EDITOR_URL,window.TEAVisualEditor.lang=a,loadEditorScript$1({event:t,editorUrl:EDITOR_URL,autoTrackInstance:e}),setSession()}}),window.TEAVisualEditor.openAutotrackEditor=function(){loadEditorScript$1({event:null,editorUrl:window.TEAVisualEditor.__editor_url,autoTrackInstance:e})}}catch(e){console.log("receive message error")}try{receiveMsg("tea:openHeatMapCore",function(t){loadEditorScript$1({event:t,editorUrl:decodeUrl(HOT_PIC_URL)+".js?query="+Date.now(),autoTrackInstance:e})})}catch(e){console.log("openHeatMapCore error")}}var lastEventId,defaultOpt={hashTag:!1,impr:!1},AutoTrack=function(){function e(){this.autoTrackStart=!1}return e.prototype.start=function(e,t,i,n){t=Object.assign(defaultOpt,t),this.destroyed=!1,this.options=t,this.logFunc=e,this.logFuncBecon=i,this.Config=new Config(defaultConfig),this.Listener=new Listener(t,this.Config,n),this.EventHandle=new EventHandle(t),this.Request=new Request(this.logFunc,this.logFuncBecon),this.autoTrackStart=!0,this.init()},e.prototype.init=function(){this.Listener.init(this.handle.bind(this))},e.prototype.handle=function(e,t){"dom"===e.eventType&&this.handleDom(e,t)},e.prototype.handleDom=function(e,t){try{var i=e.eventName;if("click"===i||"change"===i||"submit"===i){var n=this.EventHandle.handleEvent(t,i);null!==n&&this.Request.send({eventType:"custom",eventName:"report_"+i+"_event",extra:{methods:"GET"}},n)}else if("page_view"===i||"page_statistics"===i){var r=void 0;r="page_view"===i?this.EventHandle.handleViewEvent(t):this.EventHandle.handleStatisticsEvent(t),this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"}},r)}else if("beat"===i){var o=this.EventHandle.handleBeadtEvent(t),a=e.eventSend;this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"},eventSend:a},o)}}catch(e){console.log("handel dom event error "+JSON.stringify(e))}},e.prototype.destroy=function(){if(!this.autoTrackStart)return console.warn("engine is undefined, make sure you have called autoTrack.start()");this.autoTrackStart=!1,this.Listener.removeListener()},e}(),exportAutoTrack=function(e,t,i,n){var r=new AutoTrack,o=e.autotrack;if(o){var a={};"object"==typeof o&&(a=o),r.start(t,a,i,n),readyToLoadEditor$1(r,e)}else r.autoTrackStart&&r.destroy();return null},exportMethods=["profileSet","profileSetOnce","profileIncrement","profileUnset","profileAppend","getVar","getAbSdkVersion","onAbSdkVersionChange","offAbSdkVersionChange","getABconfig","openOverlayer","closeOverlayer","getAllVars","setExternalAbVersion","getToken","destroy"],Methods=__spread(["init","config","send","start","predefinePageView","beconEvent","on","clearEventCache","resetStayDuration","autoInitializationRangers","setWebIDviaUnionID","setWebIDviaOpenID","filterEvent"],exportMethods),getIndex=(lastEventId=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return lastEventId+=1}),Collector=function(){function e(e){var t=this;this.is_first_time=!1,this.Native=!1,this.staging=!1,this.sdkload=!1,this.initPv=!0,this.predefinePageView=function(e,i){if(void 0===e&&(e={}),t.sdkload){var n={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+t.is_first_time},r=__assign({},n,e);i?t.beconEvent("predefine_pageview",r,"pv"):t.event("predefine_pageview",r,"pv")}else t.logger.warn("sdk init error, api can not call")},this.getToken=function(e,i){if(!t.sdkload)return t.logger.warn("sdk init error, api can not call, getToken will return {}"),void e({});var n=!1,r=function(i){if(!n){n=!0;var r=t._config.get().user;return i&&(r.tobid=i),e(__assign({},r))}};i&&setTimeout(function(){r()},i);try{t._token._getTobId(function(e){r(e)})}catch(e){r()}},this.name=e,this._isSend=!1,this.hook=new Hook,this.storage=new Storage(!1)}return e.prototype.autoInitializationRangers=function(e){},e.prototype.init=function(e){var t=this;if(!this._inited)if(this._inited=!0,e&&"object"==typeof e){this.logger=new Logger(this.name,e.log);var i=e.app_id,n=e.app_key;n||i?i&&"number"!=typeof i?this.logger.warn("app_id param is error, must be number, please check !!!"):n&&"string"!=typeof n?this.logger.warn("app_key is empty, please check!"):(e.channel_domain||-1!==["cn","sg","va"].indexOf(e.channel)||(this.logger.warn("channel must be `cn`, `sg`,`va` !!!"),e.channel="cn"),this.Native=e.Native,this._initConfig=e,this.appBridge=new AppBridge(this.logger),this.storage.getItem("__tea_cache_first_"+i)?this.is_first_time=!1:(this.is_first_time=!0,this.storage.setItem("__tea_cache_first_"+i,"1")),this.sdkload=!0,e.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(i){i||t._init(e)}):this._init(e)):this.logger.warn("no app_key or app_id please check !!!")}else console.warn("init params is error,please check")},e.prototype._init=function(e){var t=this;this.autoPV=!0,this.sdkload=!0,this._initConfig=e,this._config=new ConfigManager(e.app_id,e,e.configPersist||0),this.configPersist=e.configPersist||0,this._config.set("app_id",e.app_id),this.hook.on("token-ready",function(){t.callbackSend?t._isSend?t._event&&t._event.report():t.start():t._event&&t._event.report()}),this._session=new Session(e.app_key||e.app_id,e),this._token=new Token(e,this._config,this.hook,this._session),this.plugin=new Plugin(this,e,this.event.bind(this),this.beconEvent.bind(this),this.hook),e.cep&&(this.match=new CepRule(e,this._config,this.hook)),this._event=new EventManager(this,e,this._config,this._token,this.plugin,this._session,this.match),this.tracer=new Tracer(this,e,this._processEvent.bind(this),this._event),this.spaView=new Ruote(e),this._token._getToken();try{e.autotrack&&exportAutoTrack(e,this.event.bind(this),this.beconEvent.bind(this),this.spaView)}catch(e){console.log("e")}},e.prototype.config=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(i){if(i)for(var n in e)"user_unique_id"===n?t.appBridge.setUserUniqueId(e[n]):e[n]?t.appBridge.addHeaderInfo(n,e[n]):t.appBridge.removeHeaderInfo(n);else t._setConfig(e)}):this._setConfig(e):this.logger.warn("sdk init error, api can not call")},e.prototype._setConfig=function(e){if(this._inited)if(e&&"object"==typeof e){e.disable_auto_pv&&(this.autoPV=!1,delete e.disable_auto_pv),e._staging_flag&&1===e._staging_flag&&(this.staging=!0);var t=__assign({},e);if(this.configPersist){var i=this._config.getStore();i&&(t=Object.assign(i,e)),this._config.setStore(e)}for(var n in t)"user_unique_id"!==n?"web_id"!==n?this._config.set(n,t[n]):this._token._setWebid(t[n]):this._token._setUuid(t[n])}else this.logger.warn("config params is error, please check");else this.logger.warn("config must be use after function init")},e.prototype.on=function(e,t){try{e&&"string"==typeof e&&"function"==typeof t&&this.hook.on(e,t)}catch(e){}},e.prototype.send=function(){this.start()},e.prototype.start=function(){var e=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(t){t?(e.logger.info("jsbrige\u5F00\u542F\uFF0C\u4E8B\u4EF6\u5C06\u7531\u539F\u751F sdk\u8FDB\u884C\u4E0A\u62A5"),e.predefinePageView()):e._start()}):this._start():this.logger.warn("sdk init error, api can not call")},e.prototype._start=function(){var e=this;if(this._token.isTokenReady()){if(this._isSend)return void this.logger.warn("method start can not be use over one time , please check !!");this._isSend=!0,this.logger.info("userInfo:"+JSON.stringify(this._config.get("user"))),this.logger.info("sdk is ready,version is "+SDK_VERSION+". you can report now !!!"),this.match&&this.match.init(),this._event.setReady(),this.autoPV&&(this.predefinePageView(),this.initPv=!1),this._initConfig.spa&&this.spaView.add("spa",this.predefinePageView),this.hook.on("token-change",function(t){e.initPv||"webid"!==t||e._initConfig.enable_custom_webid||e.predefinePageView({},!0),e.logger.info("token change, new userinfo:"+JSON.stringify(e._config.get("user"))),"uuid"===t&&e.plugin&&e.plugin.ab&&e.plugin.ab.refetch()});try{(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(e){}this.profile=new Profile(this._processEvent.bind(this),this._event,this._initConfig),this.plugin&&this.plugin.ab&&this.plugin.ab.init(this._config.get())}else this.callbackSend=!0},e.prototype.beconEvent=function(e,t,i){var n=this;void 0===t&&(t={});var r=i||"log",o=[];o.push([e,t]),o=o.map(function(e){return n._processEvent(e[0],e[1])}),this._dealEvent(!0,o,r),this._addTracerCount(r)},e.prototype.event=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(this.sdkload){var n=__read(t,1)[0],r=[];"Array"!==Object.prototype.toString.call(n).slice(8,-1)?r[0]=t:r=t,r=r.map(function(t){return e._processEvent(t[0],t[1])}),this._dealEvent(!1,r,"log"),this._addTracerCount("log")}else this.logger.warn("sdk init error, api can not call")},e.prototype._dealEvent=function(e,t,i){var n=this;if(this.sdkload)if(this.Native&&this.appBridge.bridgeInject()){if("autotrack"===i||"sdk"===i)return;this.appBridge.hasStarted(function(i){i?t&&t.length&&t.forEach(function(e){var t=e.event,i=e.params;n.appBridge.onEventV3(t,JSON.stringify(i))}):n._commonEvent(e,t)})}else this._commonEvent(e,t);else this.logger.warn("sdk init error, api can not call")},e.prototype._commonEvent=function(e,t){e?this._event.beconEvent(t):this._event.event(t),this._session._updateSessionId(),this.plugin&&this.plugin.session&&this.plugin.session.process()},e.prototype._addTracerCount=function(e){this.sdkload?this.Native||this.staging||this.tracer.addCount(e):this.logger.warn("sdk init error, api can not call")},e.prototype._processEvent=function(e,t){try{var i=e;/^event\./.test(e)&&(i=e.slice(6));var n,r=t;return"object"!=typeof r&&(r={}),r.profile?delete r.profile:r.event_index=getIndex(),r.local_ms?(n=r.local_ms,delete r.local_ms):n=+new Date,{event:i,params:r,local_time_ms:n,is_bav:+!!this._initConfig.autotrack}}catch(i){return{event:e,params:t}}},e.prototype.filterEvent=function(e){this.eventFilter=e},e.prototype.clearEventCache=function(){this._event.clearEventCache()},e.prototype.setWebIDviaUnionID=function(e){if(e){var t=hashCode(e);this.config({web_id:""+t,wechat_unionid:e}),this.hook.emit("custom-webid")}},e.prototype.setWebIDviaOpenID=function(e){if(e){var t=hashCode(e);this.config({web_id:""+t,wechat_openid:e}),this.hook.emit("custom-webid")}},e.prototype.resetStayDuration=function(e,t,i){this.sdkload?this.plugin.stay?this.plugin.stay&&this.plugin.stay.reset(e,t,i):this.logger.info("stayDuration is not init"):this.logger.warn("sdk init error, api can not call")},e.prototype.profileSet=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(i){i?t.appBridge.profileSet(JSON.stringify(e)):t.profile&&t.profile.setProfile(e)}):this.profile&&this.profile.setProfile(e):this.logger.warn("sdk init error, api can not call")},e.prototype.profileSetOnce=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(i){i?t.appBridge.profileSetOnce(JSON.stringify(e)):t.profile&&t.profile.setOnceProfile(e)}):this.profile&&this.profile.setOnceProfile(e):this.logger.warn("sdk init error, api can not call")},e.prototype.profileIncrement=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(i){i?t.appBridge.profileIncrement(JSON.stringify(e)):t.profile&&t.profile.incrementProfile(e)}):this.profile&&this.profile.incrementProfile(e):this.logger.warn("sdk init error, api can not call")},e.prototype.profileUnset=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(i){i?t.appBridge.profileUnset(e):t.profile&&t.profile.unsetProfile(e)}):this.profile&&this.profile.unsetProfile(e):this.logger.warn("sdk init error, api can not call")},e.prototype.profileAppend=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(i){i?t.appBridge.profileAppend(JSON.stringify(e)):t.profile&&t.profile.appendProfile(e)}):this.profile&&this.profile.appendProfile(e):this.logger.warn("sdk init error, api can not call")},e.prototype.setExternalAbVersion=function(e){this.sdkload?e&&this.plugin.ab&&this.plugin.ab._setAbVersion(e):this.logger.warn("sdk init error, api can not call")},e.prototype.getVar=function(e,t,i){var n=this;if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getVar return default value"),void i(t);this.hook.on("token-error",function(){n.logger.warn("sdk init error, getVar return default value"),i(t)}),this.plugin.ab&&this.plugin.ab.getVar(e,t,i)},e.prototype.getABconfig=function(e,t){if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getABconfig return null"),void t(null);this.plugin.ab&&this.plugin.ab._getABconfig(e,t)},e.prototype.getAbSdkVersion=function(e){if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getAbSdkVersion return null"),void e(null);this.plugin.ab&&this.plugin.ab.getAbSdkVersion(e)},e.prototype.onAbSdkVersionChange=function(e){this.sdkload?this.hook.on("onAbSdkVersionChange",e):this.logger.warn("sdk init error, api can not call")},e.prototype.offAbSdkVersionChange=function(e){this.sdkload?e?this.hook.off("onAbSdkVersionChange",e):this.hook.off("onAbSdkVersionChange"):this.logger.warn("sdk init error, api can not call")},e.prototype.openOverlayer=function(){this.sdkload?this.plugin.ab&&this.plugin.ab.openOverlayer():this.logger.warn("sdk init error, api can not call")},e.prototype.closeOverlayer=function(){this.sdkload?this.plugin.ab&&this.plugin.ab.closeOverlayer():this.logger.warn("sdk init error, api can not call")},e.prototype.getAllVars=function(e){var t=this;if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getAllVars return null"),void e(null);this.hook.on("token-error",function(){t.logger.warn("sdk init error, getallVar return null"),e(null)}),this.plugin.ab&&this.plugin.ab.getAllVars(e)},e.prototype.destroy=function(){this.destroyInstance||(this.destroyInstance=!0,this.hook.off("token-ready"))},e}();function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var CollectAsync=function(e){var t=this;return _defineProperty(this,"_exportCollect",function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];t._isProcess?t._executeCmd.apply(t,i):(t.cmdQueue.push(i),t._processCmd())}),_defineProperty(this,"_processCmd",function(){if(0!==t.cmdQueue.length){var e,i,n,r,o;i=t.cmdQueue,n="init",r="0",o=-1,i.forEach(function(e,t){(void 0!==r?e[r]:e)===n&&(o=t)}),-1!==(e=o)&&(t._isProcess=!0,t._executeCmd.apply(t,t.cmdQueue[e]),t.cmdQueue.forEach(function(i,n){n!==e&&t._executeCmd.apply(t,i)}),t.cmdQueue=[])}}),_defineProperty(this,"_executeCmd",function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];var r,o,a=i[0];Methods.indexOf(a)>-1?(r=t.colloctor)[a].apply(r,i.slice(1)):(o=t.colloctor).event.apply(o,i)}),this.cmdQueue=[],this.name=e,this.colloctor=new Collector(e),this._isProcess=!1,this._alias={},this._processCmd(),Methods.forEach(function(e){t._exportCollect[e]=t._exportCollect.bind(t,e)}),this._exportCollect},insMap={},CmdMap={},getInstance=function(e){return insMap[e]||(insMap[e]=new CollectAsync(e)),insMap[e]},getCmdArray=function(e){return CmdMap[e]||(CmdMap[e]=[]),CmdMap[e]},processCmdArray=function(e){try{var t=__read(e),i=t[0],n=t.slice(1);if(!i)return void console.error("the eventName is: "+i+", error, stop report, please check");var r=i.split(".");if(1===r.length)getCmdArray("default").push(__spread([i],n));else if(2===r.length)"event"===r[0]?getCmdArray("default").push(__spread([i],n)):getCmdArray(r[0]).push(__spread([r[1]],n));else{var o=r[0],a=[r[1],r[2]].join(".");getCmdArray(o).push(__spread([a],n))}}catch(e){console.log(e)}},processCmd=function(){defaultClient.q.forEach(function(e){var t=[].slice.call(e);"Array"===Object.prototype.toString.call(t[0]).slice(8,-1)?t.forEach(function(e){processCmdArray(e)}):processCmdArray(t)}),Object.keys(CmdMap).forEach(function(e){CmdMap[e].forEach(function(t){getInstance(e).apply(void 0,__spread(t))}),CmdMap[e]=[]}),defaultClient.q=[]},defaultClient=function e(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.q.push(t),processCmd()};defaultClient.q=[],defaultClient.l=Date.now(),defaultClient._instanceMap=insMap,defaultClient._instanceCmdMap=CmdMap,Methods.forEach(function(e){defaultClient[e]=defaultClient.bind(null,e)}),processCmd();var Collector$1=CollectAsync,__WEBPACK_DEFAULT_EXPORT__=defaultClient},432829:function(e,t,i){i.d(t,{P:()=>nU});var n=function(){return(n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function r(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return a}function o(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e}var a,s,c,l,h=function(){function e(){this._hooks={},this._cache=[],this._hooksCache={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var i=this;e&&t&&"function"==typeof t&&this.on(e,function n(r){t(r),i.off(e,n)})},e.prototype.off=function(e,t){if(e&&this._hooks[e]&&this._hooks[e].length)if(t){var i=this._hooks[e].indexOf(t);-1!==i&&this._hooks[e].splice(i,1)}else this._hooks[e]=[]},e.prototype.emit=function(e,t,i){i?e&&(-1!==this._cache.indexOf(i)?this._emit(e,t):(this._hooksCache.hasOwnProperty(i)||(this._hooksCache[i]={}),this._hooksCache[i].hasOwnProperty(e)||(this._hooksCache[i][e]=[]),this._hooksCache[i][e].push(t))):this._emit(e,t)},e.prototype._emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&o(this._hooks[e]).forEach(function(e){try{e(t)}catch(e){}})},e.prototype.set=function(e){e&&-1===this._cache.indexOf(e)&&this._cache.push(e)},e}(),u=function(e){return null!=e&&"[object Object]"==Object.prototype.toString.call(e)},d=function(e){return Array.isArray(e)},p=(a=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return a+=1}),f=function(e){return function(e,t,i){if("string"==typeof e&&"number"==typeof i){var n,r=[],o=String.fromCharCode((i=i<=25?i:i%25)+97);n=e.split(o);for(var a=0;a<n.length;a++){var s=parseInt(n[a],i),c=String.fromCharCode(s^=64);r.push(c)}return r.join("")}}(e,64,25)},g=function(){return!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)},_=function(e){g()?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)},m=function(e,t,i){var n=document.createElement("script");n.src=e,n.onerror=function(){i(e)},n.onload=function(){t()},document.getElementsByTagName("head")[0].appendChild(n)},v=function(){var e=0;return["hidden","msHidden","webkitHidden"].forEach(function(t){void 0!==document[t]&&(e=1)}),e},y=function(e,t){void 0===e&&(e=function(){}),void 0===t&&(t=1e3);var i,n=Date.now()+t;return i=window.setTimeout(function r(){var o=Date.now()-n;e(),n+=t,i=window.setTimeout(r,Math.max(0,t-o))},t),function(){window.clearTimeout(i)}},b=function(e){var t=document.createElement("a");return t.href=e,t},z=function(e){var t={};try{var i=b(e).search;if(!i)return t;(i=i.slice(1)).split("&").forEach(function(e){var i,n,r=e.split("=");r.length&&(i=r[0],n=r[1]);try{t[i]=decodeURIComponent(void 0===n?"":n)}catch(e){t[i]=n}})}catch(e){}return t},w=function(e){for(var t=0,i=0,n=(e+="").length,r=0;r<n;r++)((t=31*t+e.charCodeAt(i++))>0x7fffffffffff||t<-0x800000000000)&&(t&=0xffffffffffff);return t<0&&(t+=0x7ffffffffffff),t},k=(function(e,t){e.exports=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function i(n){function r(){}function o(t,i,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},r.defaults,o)).expires&&(o.expires=new Date(+new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(i);/^[\{\[]/.test(a)&&(i=a)}catch(e){}i=n.write?n.write(i,t):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in o)o[c]&&(s+="; "+c,!0!==o[c]&&(s+="="+o[c].split(";")[0]));return document.cookie=t+"="+i+s}}function a(e,i){if("undefined"!=typeof document){for(var r={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),c=s.slice(1).join("=");i||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=t(s[0]);if(c=(n.read||n)(c,l)||t(c),i)try{c=JSON.parse(c)}catch(e){}if(r[l]=c,e===l)break}catch(e){}}return e?r[e]:r}}return r.set=o,r.get=function(e){return a(e,!1)},r.getJSON=function(e){return a(e,!0)},r.remove=function(t,i){o(t,"",e(i,{expires:-1}))},r.defaults={},r.withConverter=i,r}(function(){})}()}(s={exports:{}},s.exports),s.exports),E=function(e,t){try{return e?k.get(e):k.get()}catch(e){return""}},S=function(e,t,i,n){try{var r=n||document.domain,o=+new Date+(i||6048e5);k.set(e,t,{expires:new Date(o),path:"/",domain:r})}catch(e){}},T=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e.prototype.getCookie=function(e,t){return E(e)},e.prototype.setCookie=function(e,t,i,n){S(e,t,i,n)},e}(),x={getItem:function(e){try{var t=localStorage.getItem(e),i=t;try{t&&"string"==typeof t&&(i=JSON.parse(t))}catch(e){}return i||{}}catch(e){}return{}},setItem:function(e,t){try{var i="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,i)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return E(e)},setCookie:function(e,t,i,n){S(e,t,i,n)},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},I={getItem:function(e){try{var t=sessionStorage.getItem(e),i=t;try{t&&"string"==typeof t&&(i=JSON.parse(t))}catch(e){}return i||{}}catch(e){}return{}},setItem:function(e,t){try{var i="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,i)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return E(e)},setCookie:function(e,t,i,n){S(e,t,i,n)},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},O=function(){function e(e,t){this._storage=t&&"session"===t?I:!e&&x.isSupportLS?x:new T}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,i,n){this._storage.setCookie(e,t,i,n)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),A=function(){function e(e,t,i){this.appid=e,this.domain=t,this.userAgent=window.navigator.userAgent,this.appVersion=window.navigator.appVersion,this.cookie_expire=i}return e.prototype.init=function(){var e,t=window.navigator.userAgent,i=window.navigator.language,n=document.referrer,r=n?b(n).hostname:"",o=z(window.location.href),a=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(this.appVersion)?"wap":"web",s=(null==(e=window.navigator.connection)?void 0:e.effectiveType)||"";this.utm=function(e,t,i,n){var r=new O(!1),o=new O(!1,"session"),a=e?"_tea_utm_cache_"+e:"_tea_utm_cache",s=e?"_$utm_from_url_"+e:"_$utm_from_url",c={},l=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],h={ad_id:Number(t.ad_id)||void 0,campaign_id:Number(t.campaign_id)||void 0,creative_id:Number(t.creative_id)||void 0,utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4};try{var u=!1;for(var d in h)h[d]&&(-1!==l.indexOf(d)?(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data[d]=h[d]):c[d]=h[d],u=!0);if(u)o.setItem(s,"1"),r.setCookie(a,JSON.stringify(c),n,i);else{var p=r.getCookie(a,i);p&&(c=JSON.parse(p))}o.getItem(s)&&(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data.$utm_from_url=1)}catch(e){return h}return c}(this.appid,o,this.domain,this.cookie_expire);var c=this.browser(),l=this.os();return{browser:c.browser,browser_version:c.browser_version,platform:a,os_name:l.os_name,os_version:l.os_version,userAgent:t,screen_width:window.screen&&window.screen.width,screen_height:window.screen&&window.screen.height,device_model:this.getDeviceModel(l.os_name),language:i,referrer:n,referrer_host:r,network_type:s,utm:this.utm,latest_data:this.last(n,r)}},e.prototype.last=function(e,t){var i="",n="",r="",o=location.hostname,a=!1;if(e&&t&&o!==t){i=e,n=t,a=!0;var s=z(e);s.keyword&&(r=s.keyword)}return{$latest_referrer:i,$latest_referrer_host:n,$latest_search_keyword:r,isLast:a}},e.prototype.browser=function(){var e,t,i="",n=""+parseFloat(this.appVersion),r=this.userAgent;return -1!==r.indexOf("Edge")||-1!==r.indexOf("Edg")?(i="Microsoft Edge",-1!==r.indexOf("Edge")?(e=r.indexOf("Edge"),n=r.substring(e+5)):(e=r.indexOf("Edg"),n=r.substring(e+4))):-1!==(e=r.indexOf("MSIE"))?(i="Microsoft Internet Explorer",n=r.substring(e+5)):-1!==(e=r.indexOf("MetaSr"))?(i="sougoubrowser",n=r.substring(e+7,e+10)):-1!==r.indexOf("MQQBrowser")||-1!==r.indexOf("QQBrowser")?(i="qqbrowser",-1!==r.indexOf("MQQBrowser")?(e=r.indexOf("MQQBrowser"),n=r.substring(e+11,e+15)):-1!==r.indexOf("QQBrowser")&&(e=r.indexOf("QQBrowser"),n=r.substring(e+10,e+25))):-1!==r.indexOf("Chrome")?-1!==(e=r.indexOf("MicroMessenger"))?(i="weixin",n=r.substring(e+15,e+20)):-1!==(e=r.indexOf("360"))?(i="360browser",n=r.substring(r.indexOf("Chrome")+7)):-1!==r.indexOf("baidubrowser")||-1!==r.indexOf("BIDUBrowser")?(-1!==r.indexOf("baidubrowser")?(e=r.indexOf("baidubrowser"),n=r.substring(e+13,e+16)):-1!==r.indexOf("BIDUBrowser")&&(e=r.indexOf("BIDUBrowser"),n=r.substring(e+12,e+15)),i="baidubrowser"):-1!==(e=r.indexOf("xiaomi"))?-1!==r.indexOf("openlanguagexiaomi")?(i="openlanguage xiaomi",n=r.substring(e+7,e+13)):(i="xiaomi",n=r.substring(e-7,e-1)):-1!==(e=r.indexOf("TTWebView"))?(i="TTWebView",n=r.substring(e+10,e+23)):-1!==(e=r.indexOf("Chrome"))?(i="Chrome",n=r.substring(e+7)):-1!==(e=r.indexOf("Chrome"))&&(i="Chrome",n=r.substring(e+7)):-1!==r.indexOf("Safari")?-1!==(e=r.indexOf("QQ"))?(i="qqbrowser",n=r.substring(e+10,e+16)):-1!==(e=r.indexOf("Safari"))&&(i="Safari",n=r.substring(e+7),-1!==(e=r.indexOf("Version"))&&(n=r.substring(e+8))):-1!==(e=r.indexOf("Firefox"))?(i="Firefox",n=r.substring(e+8)):-1!==(e=r.indexOf("MicroMessenger"))?(i="weixin",n=r.substring(e+15,e+20)):-1!==(e=r.indexOf("QQ"))&&(i="qqbrowser",n=r.substring(e+3,e+8)),-1!==(t=n.indexOf(";"))&&(n=n.substring(0,t)),-1!==(t=n.indexOf(" "))&&(n=n.substring(0,t)),-1!==(t=n.indexOf(")"))&&(n=n.substring(0,t)),{browser:i,browser_version:n}},e.prototype.os=function(){for(var e,t,i="",n="",r=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows",r:/(Windows|Windows NT)/},{s:"Android",r:/Android/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"chromeOS",r:/CrOS/},{s:"OpenHarmony",r:/Harmony/},{s:"Linux",r:/(Linux|X11)/},{s:"Sun OS",r:/SunOS/}],o=0;o<r.length;o++){var a=r[o];if(a.r.test(this.userAgent)){"Mac OS X"===(i=a.s)&&this.isNewIpad()&&(i="iOS");break}}var s=function(e,t){var i=e.exec(t);return i&&i[1]?i[1]:""},c=function(e,t){var i=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:"+e+")","i").exec(t);return i?i.slice(1)[0]:""};switch(/Windows/.test(i)&&(n=s(/Windows (.*)/,i),i="windows"),i){case"Mac OS X":n=c("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent),i="mac";break;case"Android":(t=s(/Android ([\.\_\d]+)/,e=this.userAgent))||(t=s(/Android\/([\.\_\d]+)/,e)),n=t,i="android";break;case"iOS":n=this.isNewIpad()?c("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent):(n=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.appVersion))?n[1]+"."+n[2]+"."+(0|n[3]):"",i="ios";break;case"chromeOS":var l=this.userAgent.indexOf("x86_64");n=this.userAgent.substring(l+7,l+16);break;case"OpenHarmony":n=function(e){var t=s(/OpenHarmony\s*([\d\.]+)/,e);return t||(t=s(/OpenHarmony\s*([\d\.]+)/,e)),t}(this.userAgent),i="OpenHarmony"}return{os_name:i,os_version:n}},e.prototype.getDeviceModel=function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach(function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))});else if("ios"===e||"mac"===e||"windows"===e)if(this.isNewIpad())t="iPad";else{var i=navigator.userAgent.replace("Mozilla/5.0 (",""),n=i.indexOf(";");t=-1===n?"":i.slice(0,n)}}catch(e){}return t.trim()},e.prototype.isNewIpad=function(){return void 0!==this.userAgent&&"MacIntel"===navigator.platform&&"number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>1},e}(),D={cn:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},C={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az28z1gz1hz1gz1cz18z1nz1gz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",my:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z19z1bz49z1kz27z4az1jz18z20z1iz1mz1dz1dz1gz1az1cz4az1az1mz1k"},M="5.3.3",N=(f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z1cz1bz1gz22z1mz20z49z20z18z1lz1ez1cz20z21z4az1hz21"),f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1az1mz20z1cz4az1hz21"),f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1jz1mz18z1bz1cz20z4az1hz21"),f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1fz1cz18z22z1kz18z1nz49z1az1mz20z1c")),G=(f("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz22z1cz21z22z1cz20z49z1cz24z1cz1lz22z49z1gz1lz21z1nz1cz1az22z1mz20"),["1fz22z22z1nz21z4mz4bz4bz1bz18z22z18z4az19z27z22z1cz1bz18z1lz1az1cz4az1lz1cz22","1fz22z22z1nz21z4mz4bz4bz22z1cz18z49z24z18z4az22z1gz1iz22z1mz1iz49z20z1mz25z4az1lz1cz22","1fz22z22z1nz21z4mz4bz4bz22z1cz18z4az22z1gz1iz22z1mz1iz49z1cz23z4az1lz1cz22","1fz22z22z1nz21z4mz4bz4bz22z1cz18z4az22z1gz1iz22z1mz1iz49z23z21z22z21z4az1lz1cz22","1fz22z22z1nz21z4mz4bz4bz1gz1mz49z21z1ez4az22z1gz1iz22z1mz1iz49z20z1mz25z4az1lz1cz22","1fz22z22z1nz21z4mz4bz4bz1gz1mz49z24z18z4az22z1gz1iz22z1mz1iz49z20z1mz25z4az1lz1cz22"].map(function(e){return f(e)})),B=function(){function e(e,t){this.collector=e,this.config=t,this.eventNameWhiteList=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure","__bav_slide"],this.paramsNameWhiteList=["$inactive","$inline","$target_uuid_list","$source_uuid","$is_spider","$source_id","$is_first_time","_staging_flag"],this.regStr=RegExp("^[a-zA-Z0-9][a-z0-9A-Z_.-]{1,255}$")}return e.prototype.checkVerify=function(e){var t=this;if(!e||!e.length)return!1;var i=e[0];if(!i)return!1;var n=i.events,r=i.header;if(!n||!n.length)return!1;var o=!0;return n.forEach(function(e){if(!e)return o=!1,void(e.checkEvent="\u4E8B\u4EF6\u5F02\u5E38");t.checkEventName(e.event)||(o=!1,e.checkEvent="\u4E8B\u4EF6\u540D\u4E0D\u80FD\u4EE5 $ or __\u5F00\u5934"),t.checkEventParams(e.params)||(o=!1,e.checkParams="\u5C5E\u6027\u540D\u4E0D\u80FD\u4EE5 $ or __\u5F00\u5934")}),this.checkEventParams(r)||(o=!1),o},e.prototype.checkEventName=function(e){return!!e&&this.calculate(e,"event")},e.prototype.checkEventParams=function(e){var t=e;if("string"==typeof e&&(t=JSON.parse(t)),!Object.keys(t).length)return!0;for(var i in t)return!!this.calculate(i,"params")&&(!("string"==typeof t[i]&&t[i].length>1024)||(console.warn("params: "+i+" can not over 1024 byte, please check;"),!1));return!0},e.prototype.calculate=function(e,t){return -1!==("event"===t?this.eventNameWhiteList:this.paramsNameWhiteList).indexOf(e)||!RegExp("^\\$").test(e)&&!RegExp("^__").test(e)||(console.warn(("event"===t?"event":"params")+" name: "+e+" can not start with $ or __, pleace check;"),!1)},e}();!function(e){e.Init="init",e.Config="config",e.Start="start",e.Ready="ready",e.UnReady="un-ready",e.TokenComplete="token-complete",e.TokenStorage="token-storage",e.TokenFetch="token-fetch",e.TokenError="token-error",e.ConfigUuid="config-uuid",e.ConfigWebId="config-webid",e.ConfigDiD="config-device-id",e.ConfigDomain="config-domain",e.CustomWebId="custom-webid",e.TokenChange="token-change",e.TokenReset="token-reset",e.ConfigTransform="config-transform",e.EnvTransform="env-transform",e.SessionReset="session-reset",e.SessionResetTime="session-reset-time",e.SetSessionId="set-session-id",e.Event="event",e.Events="events",e.EventNow="event-now",e.CleanEvents="clean-events",e.BeconEvent="becon-event",e.SubmitBefore="submit-before",e.SubmitScuess="submit-scuess",e.SubmitAfter="submit-after",e.SubmitError="submit-error",e.SubmitVerify="submit-verify",e.CustomHeader="custom-request-header",e.SDKInnerError="sdk-inner-error",e.SDKRunTimeError="sdk-run-time-error",e.LogSetting="log-setting",e.LogSettingReady="log-setting-ready",e.Stay="stay",e.ResetStay="reset-stay",e.StayReady="stay-ready",e.SetStay="set-stay",e.RouteChange="route-change",e.RouteReady="route-ready",e.Ab="ab",e.AbVar="ab-var",e.AbAllVars="ab-all-vars",e.AbConfig="ab-config",e.AbExternalVersion="ab-external-version",e.AbVersionChangeOn="ab-version-change-on",e.AbVersionChangeOff="ab-version-change-off",e.AbOpenLayer="ab-open-layer",e.AbCloseLayer="ab-close-layer",e.AbReady="ab-ready",e.AbComplete="ab-complete",e.AbTimeout="ab-timeout",e.AbVerify="ab-verify",e.Profile="profile",e.ProfileSet="profile-set",e.ProfileSetOnce="profile-set-once",e.ProfileUnset="profile-unset",e.ProfileIncrement="profile-increment",e.ProfileAppend="profile-append",e.ProfileClear="profile-clear",e.Autotrack="autotrack",e.AutotrackReady="autotrack-ready",e.CepReady="cep-ready",e.TracerReady="tracer-ready",e.sessionRecord="session-record",e.SessionRecordStart="session-record-start",e.SessionRecordPause="session-record-pause",e.SessionRecordEnd="session-record-end",e.SessionRecordReport="session-record-report",e.DestoryInstance="destory-instance",e.VisualCollectReady="visual-collect-ready",e.VisualApiReady="visual-api-ready",e.VisualApiUpdate="visual-api-update"}(c||(c={})),function(e){e.DEBUGGER_MESSAGE="debugger-message",e.DEBUGGER_MESSAGE_SDK="debugger-message-sdk",e.DEBUGGER_MESSAGE_FETCH="debugger-message-fetch",e.DEBUGGER_MESSAGE_FETCH_RESULT="debugger-message-fetch-result",e.DEBUGGER_MESSAGE_EVENT="debugger-message-event",e.DEVTOOL_WEB_READY="devtool-web-ready"}(l||(l={}));var R=c,U=void 0,L=(new Date).getTimezoneOffset(),j=parseInt(""+-L/60,10),V=60*L,P=7776e6,q=function(){function e(e,t){var i=this;this.is_first_time=!0,this.configPersist=!1,this.initConfig=t,this.collect=e;var n=new A(t.app_id,t.cookie_domain||"",t.cookie_expire||P).init();this.eventCheck=new B(e,t);var r="__tea_cache_first_"+t.app_id;this.configKey="__tea_cache_config_"+t.app_id,this.sessionStorage=new O(!1,"session"),this.localStorage=new O(!1,"local"),t.configPersist&&(this.configPersist=!0,this.storage=1===t.configPersist?this.sessionStorage:this.localStorage);var o=this.localStorage.getItem(r);o&&1==o?this.is_first_time=!1:(this.is_first_time=!0,this.localStorage.setItem(r,"1")),this.envInfo={user:{user_unique_id:U,user_type:U,user_id:U,user_is_auth:U,user_is_login:U,device_id:U,web_id:U,ip_addr_id:U,user_unique_id_type:U},header:{app_id:U,app_name:U,app_install_id:U,install_id:U,app_package:U,app_channel:U,app_version:U,ab_version:U,os_name:n.os_name,os_version:n.os_version,device_model:n.device_model,ab_client:U,traffic_type:U,client_ip:U,device_brand:U,os_api:U,access:U,language:n.language,region:U,app_language:U,app_region:U,creative_id:n.utm.creative_id,ad_id:n.utm.ad_id,campaign_id:n.utm.campaign_id,log_type:U,rnd:U,platform:n.platform,sdk_version:M,sdk_lib:"js",province:U,city:U,timezone:j,tz_offset:V,tz_name:U,sim_region:U,carrier:U,resolution:n.screen_width+"x"+n.screen_height,browser:n.browser,browser_version:n.browser_version,referrer:n.referrer,referrer_host:n.referrer_host,width:n.screen_width,height:n.screen_height,screen_width:n.screen_width,screen_height:n.screen_height,utm_term:n.utm.utm_term,utm_content:n.utm.utm_content,utm_source:n.utm.utm_source,utm_medium:n.utm.utm_medium,utm_campaign:n.utm.utm_campaign,tracer_data:JSON.stringify(n.utm.tracer_data),custom:n.network_type?{network_type:n.network_type}:{},wechat_unionid:U,wechat_openid:U}},this.ab_version="",this.evtParams={},this.reportErrorCallback=function(){},this.isLast=!1,this.setCustom(n),this.initDomain(),this.initABData(),this.collect.on("route-change",function(e){i.changeReferInfo(e.config)})}return e.prototype.initDomain=function(){var e=this.initConfig.channel_domain;if(e)this.domain=e;else{var t=this.initConfig.channel;this.domain=f(C[t])}},e.prototype.setDomain=function(e){this.domain=e},e.prototype.getDomain=function(){return this.domain},e.prototype.initABData=function(){var e="__tea_sdk_ab_version_"+this.initConfig.app_id,t=null;if(this.initConfig.ab_cross){var i=this.localStorage.getCookie(e,this.initConfig.ab_cookie_domain);t=i?JSON.parse(i):null}else t=this.localStorage.getItem(e);this.setAbCache(t)},e.prototype.setAbCache=function(e){this.ab_cache=e},e.prototype.getAbCache=function(){return this.ab_cache},e.prototype.setAbVersion=function(e){this.ab_version=e},e.prototype.getAbVersion=function(){return this.ab_version},e.prototype.clearAbCache=function(){this.ab_version="",this.ab_cache={}},e.prototype.getUrl=function(e){var t="";switch(e){case"event":t="/list";break;case"webid":t="/webid";break;case"tobid":t="/tobid"}var i="";return this.initConfig.caller&&(i="?sdk_version="+M+"&sdk_name=web&app_id="+this.initConfig.app_id+"&caller="+this.initConfig.caller),""+this.getDomain()+t+i},e.prototype.setCustom=function(e){if(e&&e.latest_data&&e.latest_data.isLast)for(var t in delete e.latest_data.isLast,this.isLast=!0,e.latest_data)this.envInfo.header.custom[t]=e.latest_data[t]},e.prototype.changeReferInfo=function(e){var t=e;this.envInfo.header.referrer=t.referrer;var i="";try{i=new URL(t.referrer).host}catch(e){}this.envInfo.header.referrer_host=i||this.envInfo.header.referrer_host},e.prototype.set=function(e){var t=this;Object.keys(e).forEach(function(i){void 0!==e[i]&&null!==e[i]||t.delete(i);try{t.eventCheck.calculate(i,"config")}catch(e){}if("traffic_type"===i&&t.isLast&&(t.envInfo.header.custom.$latest_traffic_source_type=e[i]),"evtParams"===i)t.evtParams=n(n({},t.evtParams||{}),e.evtParams||{});else if("_staging_flag"===i)t.evtParams=n(n({},t.evtParams||{}),{_staging_flag:e._staging_flag});else if("reportErrorCallback"===i&&"function"==typeof e[i])t.reportErrorCallback=e[i];else{var r="",o="";if(i.indexOf(".")>-1){var a=i.split(".");r=a[0],o=a[1]}r?"user"===r||"header"===r?t.envInfo[r][o]=e[i]:(t.envInfo.header.custom[o]=e[i],t.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6DFB\u52A0\u4E86Custom",level:"info",time:Date.now(),infoType:"sdk",secType:"HEADER",common:"custom"})):Object.hasOwnProperty.call(t.envInfo.user,i)?(["user_type","ip_addr_id"].indexOf(i)>-1?t.envInfo.user[i]=e[i]?Number(e[i]):e[i]:["user_id","web_id","user_unique_id","user_unique_id_type"].indexOf(i)>-1?t.envInfo.user[i]=e[i]?String(e[i]):e[i]:["user_is_auth","user_is_login"].indexOf(i)>-1?t.envInfo.user[i]=!!e[i]:"device_id"===i&&(t.envInfo.user[i]=e[i]),t.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u4FEE\u6539\u4E86\u516C\u5171\u53C2\u6570",level:"info",time:Date.now(),infoType:"sdk",secType:"USER",common:i})):Object.hasOwnProperty.call(t.envInfo.header,i)?(t.envInfo.header[i]=e[i],t.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u4FEE\u6539\u4E86\u516C\u5171\u53C2\u6570",level:"info",time:Date.now(),infoType:"sdk",secType:"HEADER",common:i})):(t.envInfo.header.custom[i]=e[i],t.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6DFB\u52A0\u4E86Custom",level:"info",time:Date.now(),infoType:"sdk",secType:"HEADER",common:"custom"}))}})},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:Object.hasOwnProperty.call(this.envInfo.user,e)?this.envInfo.user[e]:Object.hasOwnProperty.call(this.envInfo.header,e)?this.envInfo.header[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){console.log("get config stringify error "),this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.setStore=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};if(t&&Object.keys(e).length){var i=Object.assign(e,t);this.storage.setItem(this.configKey,i)}}catch(e){console.log("setStore error"),this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.getStore=function(){try{if(!this.configPersist)return null;var e=this.storage.getItem(this.configKey)||{};return e&&Object.keys(e).length?e:null}catch(e){return this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message}),null}},e.prototype.delete=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};t&&Object.hasOwnProperty.call(t,e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message}),console.log("delete error")}},e}(),H=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}return e.prototype.info=function(e){this.isLog&&console.log("%c %s","color: yellow; background-color: black;","[AppLog WEB SDK] [instance: "+this.name+"] "+e)},e.prototype.warn=function(e){this.isLog&&console.warn("[AppLog WEB SDK] [instance: "+this.name+"] "+e)},e.prototype.error=function(e){this.isLog&&console.error("[AppLog WEB SDK] [instance: "+this.name+"] "+e)},e.prototype.throw=function(e){throw this.error(this.name),Error(e)},e}(),K=function(){function e(){this.spiderBot=["Baiduspider","googlebot","360Spider","haosouspider","YoudaoBot","Sogou News Spider","Yisouspider","Googlebot","Headless","Applebot","Bingbot","PetalBot"]}return e.prototype.checkSpider=function(e){if(!e.enable_spider)return!1;var t=window.navigator.userAgent;if(!t)return!0;var i=!1;return this.spiderBot.forEach(function(e){-1!==t.indexOf(e)&&(i=!0)}),i},e}(),J=function(){function e(e,t){this.collect=e,this.native=t}var t=e.prototype;return t.bridgeInject=function(){try{return!!this.native&&(AppLogBridge?(console.log("AppLogBridge is injected"),!0):(console.log("AppLogBridge is not inject"),!1))}catch(e){return console.log("AppLogBridge is not inject"),!1}},t.bridgeReady=function(){var e=this;return new Promise(function(t,i){try{e.bridgeInject()?AppLogBridge.hasStarted(function(e){console.log("AppLogBridge is started? : "+e),e?t(!0):i(!1)}):i(!1)}catch(e){console.log("AppLogBridge, error:"+JSON.stringify(e.stack)),i(!1)}})},t.setNativeAppId=function(e){try{AppLogBridge.setNativeAppId(JSON.stringify(e)),console.log("change bridge appid, event report with appid: "+e)}catch(e){console.error("setNativeAppId error")}},t.setConfig=function(e){var t=this;try{Object.keys(e).forEach(function(i){"user_unique_id"===i?t.setUserUniqueId(e[i]):e[i]?t.addHeaderInfo(i,e[i]):t.removeHeaderInfo(i)})}catch(e){console.error("setConfig error")}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(e){console.error("setUserUniqueId error")}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(e){console.error("addHeaderInfo error")}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(e){console.error("setHeaderInfo error")}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(e){console.error("removeHeaderInfo error")}},t.reportPv=function(e){this.onEventV3("predefine_pageview",e)},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t),this.collect.emit(DebuggerMesssge.DEBUGGER_MESSAGE,{type:DebuggerMesssge.DEBUGGER_MESSAGE_EVENT,info:"bridge\u57CB\u70B9\u4E0A\u62A5",time:Date.now(),data:[{events:[{event:e,params:t}]}],code:200,status:"success"})}catch(e){console.error("onEventV3 error")}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(e){console.error("profileSet error")}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(e){console.error("profileSetOnce error")}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(e){console.error("profileIncrement error")}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(e){console.error("profileUnset error")}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(e){console.error("profileAppend error")}},e}(),$=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},W=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;this.collect=e,this.storage=new O(!1,"session"),this.sessionKey="__tea_session_id_"+t.app_id,this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSessionTimeCheck=t.disable_session_check,this.disableSession||(this.setSessionId(),this.collect.on(R.SessionReset,function(e){i.resetSessionId(e)}),this.collect.on(R.SessionResetTime,function(){i.updateSessionIdTime()}))},e.prototype.updateSessionIdTime=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=e.timestamp;Date.now()-t>this.expireTime?e={sessionId:$(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this.resetExpTime()}},e.prototype.setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:$(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.disableSessionTimeCheck||(this.sessionExp=setInterval(function(){e.checkEXp()},this.expireTime))},e.prototype.getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return this.disableSession?"":e&&e.sessionId?e.sessionId:""},e.prototype.resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval(function(){e.checkEXp()},this.expireTime))},e.prototype.resetSessionId=function(e){var t={sessionId:e||$(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,t)},e.prototype.checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:$(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))},e}(),F=function(){function e(){this.eventLimit=50,this.enable_ttwebid=!1,this.eventCache=[],this.beconEventCache=[]}return e.prototype.apply=function(e,t){var i=this;this.collect=e,this.config=t,this.configManager=e.configManager,this.eventCheck=new B(e,t),this.cacheStorgae=new O(!0),this.localStorage=new O(!1),this.maxReport=t.max_report||10,this.reportTime=t.reportTime||t.report_time||30,this.timeout=t.timeout||1e5,this.enable_ttwebid=t.enable_ttwebid,this.reportUrl=t.report_url||this.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+this.configManager.get("app_id"),this.beconKey="__tea_cache_events_becon_"+this.configManager.get("app_id"),this.abKey="__tea_sdk_ab_version_"+this.configManager.get("app_id"),this.refer_key="__tea_cache_refer_"+this.configManager.get("app_id"),this.pageId=$(),this.collect.on(R.Ready,function(){i.reportAll(!1)}),this.collect.on(R.ConfigDomain,function(){i.reportUrl=i.configManager.getUrl("event")}),this.collect.on(R.Event,function(e){i.event(e)}),this.collect.on(R.BeconEvent,function(e){i.beconEvent(e)}),this.collect.on(R.CleanEvents,function(){i.reportAll(!1)});var n=this.linster();this.collect.on(R.DestoryInstance,function(){n&&n()})},e.prototype.linster=function(){var e=this,t=function(){e.reportAll(!0)};window.addEventListener("unload",t,!1),_(t);var i=function(){"hidden"===document.visibilityState&&e.reportAll(!0)};return document.addEventListener("visibilitychange",i,!1),function(){window.removeEventListener("unload",t),window.removeEventListener("pagehide",t,!1),window.removeEventListener("beforeunload",t,!1),document.removeEventListener("visibilitychange",i,!1)}},e.prototype.reportAll=function(e){this.report(e),this.reportBecon()},e.prototype.event=function(e){var t=this;try{if(this.collect.destroy||this.collect.sdkStop)return;if(this.config.enable_ios_sendbeacon&&g())return void this.beconEvent(e);var i=this.cacheStorgae.getItem(this.eventKey)||[],n=e;this.config.batch_event&&(n=this.batchEvent(e));var r=o(n,i);if(this.cacheStorgae.setItem(this.eventKey,r),this.reportTimeout&&clearTimeout(this.reportTimeout),r.length>=this.maxReport)this.report(!1);else{var a=this.reportTime;this.reportTimeout=setTimeout(function(){t.report(!1),t.reportTimeout=null},a)}}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message,infoType:"sdk"})}},e.prototype.beconEvent=function(e){if(!this.collect.destroy&&!this.collect.sdkStop){var t=o(e,this.cacheStorgae.getItem(this.beconKey)||[]);this.cacheStorgae.setItem(this.beconKey,t),this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(t)),!0))}},e.prototype.reportBecon=function(){if(!this.collect.destroy&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var e=this.cacheStorgae.getItem(this.beconKey)||[];e&&e.length&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))}},e.prototype.report=function(e){if(!this.collect.destroy&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var t=this.cacheStorgae.getItem(this.eventKey)||[];t.length&&(this.cacheStorgae.removeItem(this.eventKey),this.config.batch_event?this.send([t],e):this.sliceEvent(t,e))}},e.prototype.batchEvent=function(e){var t=[];if(e.length>this.eventLimit)for(var i=0;i<e.length;i+=this.eventLimit){var n=e.slice(i,i+this.eventLimit),r=this.merge(n);t.push(r)}else t=r=this.merge(e);return t},e.prototype.sliceEvent=function(e,t){if(e.length>this.eventLimit)for(var i=0;i<e.length;i+=this.eventLimit){var n=e.slice(i,i+this.eventLimit),r=this.split(this.merge(n));this.send(r,t)}else r=this.split(this.merge(e)),this.send(r,t)},e.prototype.handleRefer=function(){var e="";try{if(this.config.spa||this.config.autotrack){var t=this.localStorage.getItem(this.refer_key)||{};e=t.routeChange?t.refer_key:this.configManager.get("referrer")}else e=this.configManager.get("referrer")}catch(t){e=document.referrer}return e},e.prototype.merge=function(e,t){var i=this,r=this.configManager.get(),o=r.header,a=r.user;this.config.enable_pageid&&(o.custom.page_id=this.pageId),o.custom=JSON.stringify(o.custom);var s=this.configManager.get("evtParams"),c=this.configManager.get("user_unique_id_type"),h=[];try{var u=e.filter(function(e){try{Object.keys(s).length&&!t&&(e.params=n(n({},s),e.params)),c&&(e.params.$user_unique_id_type=c);var r=i.configManager.getAbCache(),o=a[i.config.ab_user_mode]||a.user_unique_id;return r&&r.uuid&&r.uuid===o&&i.configManager.getAbVersion()&&(e.ab_sdk_version=i.configManager.getAbVersion()),e.session_id=i.collect.sessionManager.getSessionId(),e.params=JSON.stringify(e.params),e}catch(t){return console.warn("filter merge event: "+(e&&e.event)+" error, pls check",t&&t.message),i.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u5904\u7406Event\u6570\u636E\u5F02\u5E38",level:"error",time:Date.now(),data:t.message,infoType:"sdk"}),!1}}),d=JSON.parse(JSON.stringify({events:u,user:a,header:o}));d.local_time=Math.floor(Date.now()/1e3),d.user_unique_type=this.config.enable_ttwebid?this.config.user_unique_type:void 0,d.verbose=1,h.push(d)}catch(e){console.warn("event merge error, pls check",e&&e.message)}return h},e.prototype.split=function(e){return e=e.map(function(e){var t=[];return t.push(e),t})},e.prototype.blockEvent=function(e){try{var t=this.blockList;if(this.config.enable_logsetting){var i=this.blockList,n=this.logSetting.getSettingData("blocklist_events").block_event;t=i.concat(n.filter(function(e){return -1===i.indexOf(e)}))}return!(t&&t.length&&t.includes(e))}catch(e){return!0}},e.prototype.whiteEvent=function(e){var t;try{return null==(t=this.whiteList)||!t.length||!!this.whiteList.includes(e)}catch(e){return!0}},e.prototype.customAllowFilter=function(e,t){try{if(t||!this.config.enable_logsetting||!this.config.enable_logsetting_header_custom)return JSON.stringify(e);var i=this.logSetting.getSettingData().header_custom_allow,n={};if(i&&i.length&&Object.keys(e).length){var r=new Set(i);for(var o in e)r.has(o)&&(n[o]=e[o])}return JSON.stringify(n)}catch(t){return this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CcustomAllowFilter\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message,infoType:"sdk"}),JSON.stringify(e)}},e.prototype.paramsAllowFilter=function(e,t){try{if(t||!this.config.enable_logsetting||!this.config.enable_logsetting_params)return JSON.stringify(e.params);var i=this.logSetting.getSettingData().params_block,n=e.event,r=e.params,o={};if(i&&i[n]&&i[n].length){var a=new Set(i[n]);for(var s in r)!this.logSetting.getPredefineParamsList().has(s)&&a.has(s)||(o[s]=r[s]);return JSON.stringify(o)}return JSON.stringify(e.params)}catch(t){return this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CparamsAllowFilter\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message,infoType:"sdk"}),JSON.stringify(e.params)}},e.prototype.send=function(e,t){var i=this;e.length&&(this.config.disable_track_event||e.forEach(function(e){try{var n=JSON.parse(JSON.stringify(e));i.config.filter&&((n=i.config.filter(n))||console.warn("filter must return data !!")),i.collect.eventFilter&&n&&((n=i.collect.eventFilter(n))||console.warn("filterEvent api must return data !!"));var r=n||e,o=JSON.parse(JSON.stringify(r));if(i.eventCheck.checkVerify(o),!r.length)return;var a=!0;if(r.forEach(function(e){e.events.length||(a=!1)}),!a)return;i.collect.emit(R.SubmitBefore,r),i.collect.requestManager.useRequest({url:i.reportUrl,data:r,success:function(e,t){e&&0!==e.e?(i.collect.emit(R.SubmitError,{type:"f_data",eventData:t,errorCode:e.e,response:e}),i.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u5931\u8D25",time:Date.now(),data:o,code:e.e,msg:e.m||"",failType:"\u6570\u636E\u5F02\u5E38\u5931\u8D25",status:"fail"})):(i.collect.emit(R.SubmitScuess,{eventData:t,res:e}),i.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u6210\u529F",time:Date.now(),data:o,code:200,status:"success"}))},fail:function(e,t){i.configManager.get("reportErrorCallback")(e,t),i.collect.emit(R.SubmitError,{type:"f_net",eventData:e,errorCode:t}),i.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u7F51\u7EDC\u5F02\u5E38",time:Date.now(),data:o,code:t,failType:"\u7F51\u7EDC\u5F02\u5E38\u5931\u8D25",status:"fail"})},timeout:i.timeout,useBeacon:t,withCredentials:i.enable_ttwebid,zip:!0}),i.collect.emit(R.SubmitAfter,r)}catch(e){console.warn("something error, "+JSON.stringify(e.stack)),i.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK\u53D1\u9001\u57CB\u70B9\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message,infoType:"sdk"})}}))},e}(),Q=function(){return(function e(t){return t?(t^16*Math.random()>>t/4).toString(10):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e)})().replace(/-/g,"").slice(0,19)},X=function(){function e(){this.cacheToken={},this.enableCookie=!1,this.enable_ttwebid=!1,this.enableCustomWebid=!1}return e.prototype.apply=function(e,t){var i=this;this.collect=e,this.config=t,this.configManager=this.collect.configManager,this.storage=new O(!1),this.tokenKey="__tea_cache_tokens_"+t.app_id,this.enable_ttwebid=t.enable_ttwebid,this.enableCustomWebid=t.enable_custom_webid,this.collect.on(R.ConfigUuid,function(e){i.setUuid(e)}),this.collect.on(R.ConfigWebId,function(e){i.setWebId(e)}),this.collect.on(R.ConfigDiD,function(e){i.setDeviceId(e)}),this.enableCookie=t.cross_subdomain,this.expiresTime=t.cookie_expire||6048e5,this.cookieDomain=t.cookie_domain||"",this.checkStorage()},e.prototype.checkStorage=function(){var e=this;if(this.enableCookie){var t=this.storage.getCookie(this.tokenKey,this.cookieDomain);this.cacheToken=t&&"string"==typeof t?JSON.parse(t):{}}else this.cacheToken=this.storage.getItem(this.tokenKey)||{};this.tokenType=this.cacheToken&&this.cacheToken._type_?this.cacheToken._type_:"default","custom"!==this.tokenType||this.enableCustomWebid?this.enableCustomWebid?this.collect.on(R.CustomWebId,function(){e.tokenReady=!0,e.collect.emit(R.TokenComplete)}):this.checkEnv()||(this.enable_ttwebid?this.completeTtWid(this.cacheToken):this.check()):this.remoteWebid()},e.prototype.check=function(){this.cacheToken&&this.cacheToken.web_id?this.complete(this.cacheToken):this.config.disable_webid?this.complete({web_id:Q(),user_unique_id:this.configManager.get("user_unique_id")||Q()}):this.remoteWebid()},e.prototype.checkEnv=function(){var e=window.navigator.userAgent;if(-1!==e.indexOf("miniProgram")||-1!==e.indexOf("MiniProgram")){var t=z(window.location.href);return!(!t||!t.Web_ID)&&(this.complete({web_id:""+t.Web_ID,user_unique_id:this.configManager.get("user_unique_id")||""+t.Web_ID}),!0)}return!1},e.prototype.remoteWebid=function(){var e=this,t=this.configManager.getUrl("webid"),i={app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""};this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u53D1\u8D77WebID\u8BF7\u6C42",logType:"fetch",level:"info",time:Date.now(),data:i,infoType:"sdk"}),this.collect.requestManager.useRequest({url:t,data:i,success:function(t){var i;if(t&&0===t.e)i=t.web_id,e.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"WebID\u8BF7\u6C42\u6210\u529F",logType:"fetch",level:"info",time:Date.now(),data:t,infoType:"sdk"});else{var n=Q();i=n,e.collect.configManager.set({localWebId:n}),e.collect.emit(R.TokenError),e.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"WebID\u8BF7\u6C42\u8FD4\u56DE\u503C\u5F02\u5E38\uFF0C\u91C7\u7528\u672C\u5730\u751F\u6210",logType:"fetch",level:"warn",time:Date.now(),data:t,infoType:"sdk"}),e.collect.logger.warn("appid: "+e.config.app_id+" get webid error, use local webid~")}e.complete({web_id:e.configManager.get("web_id")||i,user_unique_id:e.configManager.get("user_unique_id")||i})},fail:function(){var t=Q();e.complete({web_id:e.configManager.get("web_id")||t,user_unique_id:e.configManager.get("user_unique_id")||t}),e.collect.configManager.set({localWebId:t}),e.collect.emit(R.TokenError),e.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"WebID\u8BF7\u6C42\u7F51\u7EDC\u5F02\u5E38\uFF0C\u91C7\u7528\u672C\u5730\u751F\u6210",logType:"fetch",level:"error",time:Date.now(),data:{localWebId:t},infoType:"sdk"}),e.collect.logger.warn("appid: "+e.config.app_id+", get webid error, use local webid~")},timeout:3e5})},e.prototype.complete=function(e){var t=e.web_id,i=e.user_unique_id,r=e.device_id;if(e.timestamp=Date.now(),this.collect.configManager.set({web_id:t,user_unique_id:i}),this.config.enable_device_id){var o=this.configManager.get("device_id")||r||t;this.collect.configManager.set({device_id:o}),e=n(n({},e),{device_id:o})}else(null==e?void 0:e.device_id)&&delete e.device_id;this.setStorage(e),this.tokenReady=!0,this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u5B8C\u6210\u7528\u6237\u4FE1\u606F\u8BBE\u7F6E",logType:"info",level:"info",time:Date.now(),data:{web_id:t,user_unique_id:i},infoType:"sdk"}),this.collect.emit(R.TokenComplete)},e.prototype.completeTtWid=function(e){var t=e.user_unique_id||"",i=this.configManager.get("user_unique_id");(i||t)&&this.configManager.set({user_unique_id:i||t}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(R.TokenComplete)},e.prototype.setUuid=function(e){if(e&&-1===["null","undefined","Null","None"].indexOf(e)){var t=String(e),i=this.configManager.get("user_unique_id"),n=this.cacheToken&&this.cacheToken.user_unique_id;(t!==i||t!==n)&&(this.configManager.set({user_unique_id:t}),this.cacheToken||(this.cacheToken={}),this.cacheToken.user_unique_id=t,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(R.TokenChange,"uuid"),this.collect.emit(R.SessionReset))}else this.clearUuid()},e.prototype.clearUuid=function(){this.config.enable_ttwebid||this.configManager.get("web_id")&&this.configManager.get("user_unique_id")!==this.configManager.get("web_id")&&(this.configManager.set({user_unique_id:this.configManager.get("web_id")}),this.cacheToken&&this.cacheToken.web_id&&(this.cacheToken.user_unique_id=this.cacheToken.web_id,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken)),this.collect.emit(R.TokenReset,"uuid"))},e.prototype.setWebId=function(e){if(e&&!this.config.enable_ttwebid){this.cacheToken&&this.cacheToken.web_id?this.cacheToken.web_id!==e&&(this.cacheToken.user_unique_id=this.cacheToken.web_id===this.cacheToken.user_unique_id?e:this.cacheToken.user_unique_id,this.cacheToken.web_id=e):(this.cacheToken={},this.cacheToken.web_id=e,this.cacheToken.user_unique_id=e),this.cacheToken.timestamp=Date.now();var t=this.configManager.get("web_id"),i=this.configManager.get("user_unique_id");i&&i!==t||(this.configManager.set({user_unique_id:e}),this.collect.emit(R.TokenChange,"uuid")),t!==e&&(this.configManager.set({web_id:e}),this.collect.emit(R.TokenChange,"webid")),this.setStorage(this.cacheToken)}},e.prototype.setDeviceId=function(e){this.configManager.set({device_id:e}),this.config.enable_device_id&&this.cacheToken&&(this.cacheToken.device_id=e,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken))},e.prototype.setStorage=function(e){e._type_=this.enableCustomWebid?"custom":"default",delete e["diss".split("").reverse().join("")],this.enableCookie||this.enable_ttwebid?(this.storage.setCookie(this.tokenKey,e,this.expiresTime,this.cookieDomain),this.enable_ttwebid&&(delete e.web_id,this.storage.setItem(this.tokenKey,e))):this.storage.setItem(this.tokenKey,e),this.cacheToken=e},e.prototype.getReady=function(){return this.tokenReady},e.prototype.getTobId=function(){var e=this;return new Promise(function(t){var i={app_id:e.config.app_id,user_unique_id:e.configManager.get("user_unique_id"),web_id:e.configManager.get("web_id"),user_unique_id_type:e.configManager.get("user_unique_id_type")};e.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u53D1\u8D77GetToken\u8BF7\u6C42",logType:"fetch",level:"info",time:Date.now(),data:i,infoType:"sdk"}),e.collect.requestManager.useRequest({url:e.configManager.getUrl("tobid"),data:i,success:function(i){i&&0===i.e?(t(i.tobid),e.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"GetToken\u8BF7\u6C42\u6210\u529F",logType:"fetch",level:"info",time:Date.now(),data:i,infoType:"sdk"})):(t(""),e.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"GetToken\u8BF7\u6C42\u5931\u8D25",logType:"fetch",level:"error",time:Date.now(),data:i,infoType:"sdk"}))},fail:function(){t(""),e.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"GetToken\u8BF7\u6C42\u5931\u8D25",logType:"fetch",level:"error",time:Date.now(),infoType:"sdk"})},time:3e4,withCredentials:e.enable_ttwebid})})},e}();function Y(e){for(var t=e.length;--t>=0;)e[t]=0}var Z=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),ee=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),et=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),ei=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),en=Array(576);Y(en);var er=Array(60);Y(er);var eo=Array(512);Y(eo);var ea=Array(256);Y(ea);var es=Array(29);Y(es);var ec,el,eh,eu=Array(30);function ed(e,t,i,n,r){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=e&&e.length}function ep(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}Y(eu);var ef=function(e){return e<256?eo[e]:eo[256+(e>>>7)]},eg=function(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},e_=function(e,t,i){e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,eg(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)},em=function(e,t,i){e_(e,i[2*t],i[2*t+1])},ev=function(e,t){var i=0;do i|=1&e,e>>>=1,i<<=1;while(--t>0);return i>>>1},ey=function(e,t,i){var n,r,o=Array(16),a=0;for(n=1;n<=15;n++)a=a+i[n-1]<<1,o[n]=a;for(r=0;r<=t;r++){var s=e[2*r+1];0!==s&&(e[2*r]=ev(o[s]++,s))}},eb=function(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},ez=function(e){e.bi_valid>8?eg(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},ew=function(e,t,i,n){var r=2*t,o=2*i;return e[r]<e[o]||e[r]===e[o]&&n[t]<=n[i]},ek=function(e,t,i){for(var n=e.heap[i],r=i<<1;r<=e.heap_len&&(r<e.heap_len&&ew(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!ew(t,n,e.heap[r],e.depth));)e.heap[i]=e.heap[r],i=r,r<<=1;e.heap[i]=n},eE=function(e,t,i){var n,r,o,a,s=0;if(0!==e.sym_next)do n=(255&e.pending_buf[e.sym_buf+s++])+((255&e.pending_buf[e.sym_buf+s++])<<8),r=e.pending_buf[e.sym_buf+s++],0===n?em(e,r,t):(em(e,(o=ea[r])+256+1,t),0!==(a=Z[o])&&e_(e,r-=es[o],a),em(e,o=ef(--n),i),0!==(a=ee[o])&&e_(e,n-=eu[o],a));while(s<e.sym_next);em(e,256,t)},eS=function(e,t){var i,n,r,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,c=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=573,i=0;i<c;i++)0!==o[2*i]?(e.heap[++e.heap_len]=l=i,e.depth[i]=0):o[2*i+1]=0;for(;e.heap_len<2;)o[2*(r=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[r]=0,e.opt_len--,s&&(e.static_len-=a[2*r+1]);for(t.max_code=l,i=e.heap_len>>1;i>=1;i--)ek(e,o,i);r=c;do i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],ek(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=n,o[2*r]=o[2*i]+o[2*n],e.depth[r]=(e.depth[i]>=e.depth[n]?e.depth[i]:e.depth[n])+1,o[2*i+1]=o[2*n+1]=r,e.heap[1]=r++,ek(e,o,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var i,n,r,o,a,s,c=t.dyn_tree,l=t.max_code,h=t.stat_desc.static_tree,u=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,f=t.stat_desc.max_length,g=0;for(o=0;o<=15;o++)e.bl_count[o]=0;for(c[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;i<573;i++)(o=c[2*c[2*(n=e.heap[i])+1]+1]+1)>f&&(o=f,g++),c[2*n+1]=o,n>l||(e.bl_count[o]++,a=0,n>=p&&(a=d[n-p]),s=c[2*n],e.opt_len+=s*(o+a),u&&(e.static_len+=s*(h[2*n+1]+a)));if(0!==g){do{for(o=f-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[f]--,g-=2}while(g>0);for(o=f;0!==o;o--)for(n=e.bl_count[o];0!==n;)(r=e.heap[--i])>l||(c[2*r+1]!==o&&(e.opt_len+=(o-c[2*r+1])*c[2*r],c[2*r+1]=o),n--)}}(e,t),ey(o,l,e.bl_count)},eT=function(e,t,i){var n,r,o=-1,a=t[1],s=0,c=7,l=4;for(0===a&&(c=138,l=3),t[2*(i+1)+1]=65535,n=0;n<=i;n++)r=a,a=t[2*(n+1)+1],++s<c&&r===a||(s<l?e.bl_tree[2*r]+=s:0!==r?(r!==o&&e.bl_tree[2*r]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,o=r,0===a?(c=138,l=3):r===a?(c=6,l=3):(c=7,l=4))},ex=function(e,t,i){var n,r,o=-1,a=t[1],s=0,c=7,l=4;for(0===a&&(c=138,l=3),n=0;n<=i;n++)if(r=a,a=t[2*(n+1)+1],!(++s<c&&r===a)){if(s<l)do em(e,r,e.bl_tree);while(0!=--s);else 0!==r?(r!==o&&(em(e,r,e.bl_tree),s--),em(e,16,e.bl_tree),e_(e,s-3,2)):s<=10?(em(e,17,e.bl_tree),e_(e,s-3,3)):(em(e,18,e.bl_tree),e_(e,s-11,7));s=0,o=r,0===a?(c=138,l=3):r===a?(c=6,l=3):(c=7,l=4)}},eI=!1,eO=function(e,t,i,n){e_(e,0+ +!!n,3),ez(e),eg(e,i),eg(e,~i),i&&e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i},eA=function(e){eI||(function(){var e,t,i,n,r,o=Array(16);for(i=0,n=0;n<28;n++)for(es[n]=i,e=0;e<1<<Z[n];e++)ea[i++]=n;for(ea[i-1]=n,r=0,n=0;n<16;n++)for(eu[n]=r,e=0;e<1<<ee[n];e++)eo[r++]=n;for(r>>=7;n<30;n++)for(eu[n]=r<<7,e=0;e<1<<ee[n]-7;e++)eo[256+r++]=n;for(t=0;t<=15;t++)o[t]=0;for(e=0;e<=143;)en[2*e+1]=8,e++,o[8]++;for(;e<=255;)en[2*e+1]=9,e++,o[9]++;for(;e<=279;)en[2*e+1]=7,e++,o[7]++;for(;e<=287;)en[2*e+1]=8,e++,o[8]++;for(ey(en,287,o),e=0;e<30;e++)er[2*e+1]=5,er[2*e]=ev(e,5);ec=new ed(en,Z,257,286,15),el=new ed(er,ee,0,30,15),eh=new ed([],et,0,19,7)}(),eI=!0),e.l_desc=new ep(e.dyn_ltree,ec),e.d_desc=new ep(e.dyn_dtree,el),e.bl_desc=new ep(e.bl_tree,eh),e.bi_buf=0,e.bi_valid=0,eb(e)},eD=eO,eC=function(e,t,i,n){var r,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,i=0xf3ffc07f;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),eS(e,e.l_desc),eS(e,e.d_desc),a=function(e){var t;for(eT(e,e.dyn_ltree,e.l_desc.max_code),eT(e,e.dyn_dtree,e.d_desc.max_code),eS(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*ei[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),r=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=r&&(r=o)):r=o=i+5,i+4<=r&&-1!==t?eO(e,t,i,n):4===e.strategy||o===r?(e_(e,2+ +!!n,3),eE(e,en,er)):(e_(e,4+ +!!n,3),function(e,t,i,n){var r;for(e_(e,t-257,5),e_(e,i-1,5),e_(e,n-4,4),r=0;r<n;r++)e_(e,e.bl_tree[2*ei[r]+1],3);ex(e,e.dyn_ltree,t-1),ex(e,e.dyn_dtree,i-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),eE(e,e.dyn_ltree,e.dyn_dtree)),eb(e),n&&ez(e)},eM=function(e,t,i){return e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=i,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(ea[i]+256+1)]++,e.dyn_dtree[2*ef(t)]++),e.sym_next===e.sym_end},eN=function(e){e_(e,2,3),em(e,256,en),function(e){16===e.bi_valid?(eg(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)},eG=function(e,t,i,n){for(var r=65535&e,o=e>>>16&65535,a=0;0!==i;){i-=a=i>2e3?2e3:i;do o=o+(r=r+t[n++]|0)|0;while(--a);r%=65521,o%=65521}return r|o<<16},eB=new Uint32Array(function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?0xedb88320^e>>>1:e>>>1;t[i]=e}return t}()),eR=function(e,t,i,n){var r=eB,o=n+i;e^=-1;for(var a=n;a<o;a++)e=e>>>8^r[255&(e^t[a])];return -1^e},eU={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},eL=0,ej=1,eV=2,eP=3,eq=4,eH=5,eK=6,eJ=0,e$=1,eW=2,eF=-2,eQ=-3,eX=-4,eY=-5,eZ=-1,e1=1,e0=2,e2=3,e4=4,e5=0,e6=2,e3=8,e8=eA,e9=eD,e7=eC,te=eM,tt=eN,ti=eL,tn=ej,tr=eP,to=eq,ta=eH,ts=eJ,tc=e$,tl=eF,th=eQ,tu=eY,td=eZ,tp=e1,tf=e0,tg=e2,t_=e4,tm=e6,tv=e3,ty=286,tb=30,tz=19,tw=573,tk=15,tE=function(e,t){return e.msg=eU[t],t},tS=function(e){return 2*e-9*(e>4)},tT=function(e){for(var t=e.length;--t>=0;)e[t]=0},tx=function(e){var t,i,n,r=e.w_size;n=t=e.hash_size;do i=e.head[--n],e.head[n]=i>=r?i-r:0;while(--t);n=t=r;do i=e.prev[--n],e.prev[n]=i>=r?i-r:0;while(--t)},tI=function(e,t,i){return(t<<e.hash_shift^i)&e.hash_mask},tO=function(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))},tA=function(e,t){e7(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,tO(e.strm)},tD=function(e,t){e.pending_buf[e.pending++]=t},tC=function(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},tM=function(e,t,i,n){var r=e.avail_in;return r>n&&(r=n),0===r?0:(e.avail_in-=r,t.set(e.input.subarray(e.next_in,e.next_in+r),i),1===e.state.wrap?e.adler=eG(e.adler,t,r,i):2===e.state.wrap&&(e.adler=eR(e.adler,t,r,i)),e.next_in+=r,e.total_in+=r,r)},tN=function(e,t){var i,n,r=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,l=e.window,h=e.w_mask,u=e.prev,d=e.strstart+258,p=l[o+a-1],f=l[o+a];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do if(l[(i=t)+a]===f&&l[i+a-1]===p&&l[i]===l[o]&&l[++i]===l[o+1]){o+=2,i++;do;while(l[++o]===l[++i]&&l[++o]===l[++i]&&l[++o]===l[++i]&&l[++o]===l[++i]&&l[++o]===l[++i]&&l[++o]===l[++i]&&l[++o]===l[++i]&&l[++o]===l[++i]&&o<d);if(n=258-(d-o),o=d-258,n>a){if(e.match_start=t,a=n,n>=s)break;p=l[o+a-1],f=l[o+a]}}while((t=u[t&h])>c&&0!=--r);return a<=e.lookahead?a:e.lookahead},tG=function(e){var t,i,n,r=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=r+(r-262)&&(e.window.set(e.window.subarray(r,r+r-i),0),e.match_start-=r,e.strstart-=r,e.block_start-=r,e.insert>e.strstart&&(e.insert=e.strstart),tx(e),i+=r),0===e.strm.avail_in)break;if(t=tM(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=t,e.lookahead+e.insert>=3)for(n=e.strstart-e.insert,e.ins_h=e.window[n],e.ins_h=tI(e,e.ins_h,e.window[n+1]);e.insert&&(e.ins_h=tI(e,e.ins_h,e.window[n+3-1]),e.prev[n&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=n,n++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)},tB=function(e,t){var i,n,r,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,s=e.strm.avail_in;do{if(i=65535,r=e.bi_valid+42>>3,e.strm.avail_out<r||(r=e.strm.avail_out-r,i>(n=e.strstart-e.block_start)+e.strm.avail_in&&(i=n+e.strm.avail_in),i>r&&(i=r),i<o&&(0===i&&t!==to||t===ti||i!==n+e.strm.avail_in)))break;a=+(t===to&&i===n+e.strm.avail_in),e9(e,0,0,a),e.pending_buf[e.pending-4]=i,e.pending_buf[e.pending-3]=i>>8,e.pending_buf[e.pending-2]=~i,e.pending_buf[e.pending-1]=~i>>8,tO(e.strm),n&&(n>i&&(n=i),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,i-=n),i&&(tM(e.strm,e.strm.output,e.strm.next_out,i),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i)}while(0===a);return(s-=e.strm.avail_in)&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==ti&&t!==to&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(r=e.window_size-e.strstart,e.strm.avail_in>r&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,r+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),r>e.strm.avail_in&&(r=e.strm.avail_in),r&&(tM(e.strm,e.window,e.strstart,r),e.strstart+=r,e.insert+=r>e.w_size-e.insert?e.w_size-e.insert:r),e.high_water<e.strstart&&(e.high_water=e.strstart),r=e.bi_valid+42>>3,o=(r=e.pending_buf_size-r>65535?65535:e.pending_buf_size-r)>e.w_size?e.w_size:r,((n=e.strstart-e.block_start)>=o||(n||t===to)&&t!==ti&&0===e.strm.avail_in&&n<=r)&&(i=n>r?r:n,a=+(t===to&&0===e.strm.avail_in&&i===n),e9(e,e.block_start,i,a),e.block_start+=i,tO(e.strm)),a?3:1)},tR=function(e,t){for(var i,n;;){if(e.lookahead<262){if(tG(e),e.lookahead<262&&t===ti)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=tI(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-262&&(e.match_length=tN(e,i)),e.match_length>=3)if(n=te(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do e.strstart++,e.ins_h=tI(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=tI(e,e.ins_h,e.window[e.strstart+1]);else n=te(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(tA(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===to?(tA(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(tA(e,!1),0===e.strm.avail_out)?1:2},tU=function(e,t){for(var i,n,r;;){if(e.lookahead<262){if(tG(e),e.lookahead<262&&t===ti)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=tI(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-262&&(e.match_length=tN(e,i),e.match_length<=5&&(e.strategy===tp||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-3,n=te(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=r&&(e.ins_h=tI(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(tA(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=te(e,0,e.window[e.strstart-1]))&&tA(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=te(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===to?(tA(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(tA(e,!1),0===e.strm.avail_out)?1:2};function tL(e,t,i,n,r){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=n,this.func=r}var tj=[new tL(0,0,0,0,tB),new tL(4,4,8,4,tR),new tL(4,5,16,8,tR),new tL(4,6,32,32,tR),new tL(4,4,16,16,tU),new tL(8,16,32,32,tU),new tL(8,16,128,128,tU),new tL(8,32,128,256,tU),new tL(32,128,258,1024,tU),new tL(32,258,258,4096,tU)];function tV(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=tv,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*tw),this.dyn_dtree=new Uint16Array(2*(2*tb+1)),this.bl_tree=new Uint16Array(2*(2*tz+1)),tT(this.dyn_ltree),tT(this.dyn_dtree),tT(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(tk+1),this.heap=new Uint16Array(2*ty+1),tT(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*ty+1),tT(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var tP=function(e){if(!e)return 1;var t=e.state;return t&&t.strm===e&&(42===t.status||57===t.status||69===t.status||73===t.status||91===t.status||103===t.status||113===t.status||666===t.status)?0:1},tq=function(e){if(tP(e))return tE(e,tl);e.total_in=e.total_out=0,e.data_type=tm;var t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?42:113,e.adler=+(2!==t.wrap),t.last_flush=-2,e8(t),ts},tH=function(e){var t,i=tq(e);return i===ts&&((t=e.state).window_size=2*t.w_size,tT(t.head),t.max_lazy_match=tj[t.level].max_lazy,t.good_match=tj[t.level].good_length,t.nice_match=tj[t.level].nice_length,t.max_chain_length=tj[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),i},tK={deflateInit2:function(e,t,i,n,r,o){if(!e)return tl;var a=1;if(t===td&&(t=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),r<1||r>9||i!==tv||n<8||n>15||t<0||t>9||o<0||o>t_||8===n&&1!==a)return tE(e,tl);8===n&&(n=9);var s=new tV;return e.state=s,s.strm=e,s.status=42,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=r+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<r+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=t,s.strategy=o,s.method=i,tH(e)},deflateSetHeader:function(e,t){return tP(e)||2!==e.state.wrap?tl:(e.state.gzhead=t,ts)},deflate:function(e,t){if(tP(e)||t>ta||t<0)return e?tE(e,tl):tl;var i=e.state;if(!e.output||0!==e.avail_in&&!e.input||666===i.status&&t!==to)return tE(e,0===e.avail_out?tu:tl);var n=i.last_flush;if(i.last_flush=t,0!==i.pending){if(tO(e),0===e.avail_out)return i.last_flush=-1,ts}else if(0===e.avail_in&&tS(t)<=tS(n)&&t!==to)return tE(e,tu);if(666===i.status&&0!==e.avail_in)return tE(e,tu);if(42===i.status&&0===i.wrap&&(i.status=113),42===i.status){var r=tv+(i.w_bits-8<<4)<<8;if(r|=(i.strategy>=tf||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(r|=32),tC(i,r+=31-r%31),0!==i.strstart&&(tC(i,e.adler>>>16),tC(i,65535&e.adler)),e.adler=1,i.status=113,tO(e),0!==i.pending)return i.last_flush=-1,ts}if(57===i.status){if(e.adler=0,tD(i,31),tD(i,139),tD(i,8),i.gzhead)tD(i,+!!i.gzhead.text+2*!!i.gzhead.hcrc+4*!!i.gzhead.extra+8*!!i.gzhead.name+16*!!i.gzhead.comment),tD(i,255&i.gzhead.time),tD(i,i.gzhead.time>>8&255),tD(i,i.gzhead.time>>16&255),tD(i,i.gzhead.time>>24&255),tD(i,9===i.level?2:4*(i.strategy>=tf||i.level<2)),tD(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(tD(i,255&i.gzhead.extra.length),tD(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=eR(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(tD(i,0),tD(i,0),tD(i,0),tD(i,0),tD(i,0),tD(i,9===i.level?2:4*(i.strategy>=tf||i.level<2)),tD(i,3),i.status=113,tO(e),0!==i.pending)return i.last_flush=-1,ts}if(69===i.status){if(i.gzhead.extra){for(var o=i.pending,a=(65535&i.gzhead.extra.length)-i.gzindex;i.pending+a>i.pending_buf_size;){var s=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+s),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>o&&(e.adler=eR(e.adler,i.pending_buf,i.pending-o,o)),i.gzindex+=s,tO(e),0!==i.pending)return i.last_flush=-1,ts;o=0,a-=s}var c=new Uint8Array(i.gzhead.extra);i.pending_buf.set(c.subarray(i.gzindex,i.gzindex+a),i.pending),i.pending+=a,i.gzhead.hcrc&&i.pending>o&&(e.adler=eR(e.adler,i.pending_buf,i.pending-o,o)),i.gzindex=0}i.status=73}if(73===i.status){if(i.gzhead.name){var l,h=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>h&&(e.adler=eR(e.adler,i.pending_buf,i.pending-h,h)),tO(e),0!==i.pending)return i.last_flush=-1,ts;h=0}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,tD(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>h&&(e.adler=eR(e.adler,i.pending_buf,i.pending-h,h)),i.gzindex=0}i.status=91}if(91===i.status){if(i.gzhead.comment){var u,d=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>d&&(e.adler=eR(e.adler,i.pending_buf,i.pending-d,d)),tO(e),0!==i.pending)return i.last_flush=-1,ts;d=0}u=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,tD(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>d&&(e.adler=eR(e.adler,i.pending_buf,i.pending-d,d))}i.status=103}if(103===i.status){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(tO(e),0!==i.pending))return i.last_flush=-1,ts;tD(i,255&e.adler),tD(i,e.adler>>8&255),e.adler=0}if(i.status=113,tO(e),0!==i.pending)return i.last_flush=-1,ts}if(0!==e.avail_in||0!==i.lookahead||t!==ti&&666!==i.status){var p=0===i.level?tB(i,t):i.strategy===tf?function(e,t){for(var i;;){if(0===e.lookahead&&(tG(e),0===e.lookahead)){if(t===ti)return 1;break}if(e.match_length=0,i=te(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(tA(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===to?(tA(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(tA(e,!1),0===e.strm.avail_out)?1:2}(i,t):i.strategy===tg?function(e,t){for(var i,n,r,o,a=e.window;;){if(e.lookahead<=258){if(tG(e),e.lookahead<=258&&t===ti)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=a[r=e.strstart-1])===a[++r]&&n===a[++r]&&n===a[++r]){o=e.strstart+258;do;while(n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&r<o);e.match_length=258-(o-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=te(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=te(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(tA(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===to?(tA(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(tA(e,!1),0===e.strm.avail_out)?1:2}(i,t):tj[i.level].func(i,t);if(3!==p&&4!==p||(i.status=666),1===p||3===p)return 0===e.avail_out&&(i.last_flush=-1),ts;if(2===p&&(t===tn?tt(i):t!==ta&&(e9(i,0,0,!1),t===tr&&(tT(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),tO(e),0===e.avail_out))return i.last_flush=-1,ts}return t!==to?ts:i.wrap<=0?tc:(2===i.wrap?(tD(i,255&e.adler),tD(i,e.adler>>8&255),tD(i,e.adler>>16&255),tD(i,e.adler>>24&255),tD(i,255&e.total_in),tD(i,e.total_in>>8&255),tD(i,e.total_in>>16&255),tD(i,e.total_in>>24&255)):(tC(i,e.adler>>>16),tC(i,65535&e.adler)),tO(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?ts:tc)},deflateEnd:function(e){if(tP(e))return tl;var t=e.state.status;return e.state=null,113===t?tE(e,th):ts},deflateSetDictionary:function(e,t){var i=t.length;if(tP(e))return tl;var n=e.state,r=n.wrap;if(2===r||1===r&&42!==n.status||n.lookahead)return tl;if(1===r&&(e.adler=eG(e.adler,t,i,0)),n.wrap=0,i>=n.w_size){0===r&&(tT(n.head),n.strstart=0,n.block_start=0,n.insert=0);var o=new Uint8Array(n.w_size);o.set(t.subarray(i-n.w_size,i),0),t=o,i=n.w_size}var a=e.avail_in,s=e.next_in,c=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,tG(n);n.lookahead>=3;){var l=n.strstart,h=n.lookahead-2;do n.ins_h=tI(n,n.ins_h,n.window[l+3-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++;while(--h);n.strstart=l,n.lookahead=2,tG(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=s,e.input=c,e.avail_in=a,n.wrap=r,ts}},tJ=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t$={assign:function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw TypeError(i+"must be non-object");for(var n in i)tJ(i,n)&&(e[n]=i[n])}}return e},flattenChunks:function(e){for(var t=0,i=0,n=e.length;i<n;i++)t+=e[i].length;for(var r=new Uint8Array(t),o=0,a=0,s=e.length;o<s;o++){var c=e[o];r.set(c,a),a+=c.length}return r}},tW=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){tW=!1}for(var tF=new Uint8Array(256),tQ=0;tQ<256;tQ++)tF[tQ]=tQ>=252?6:tQ>=248?5:tQ>=240?4:tQ>=224?3:tQ>=192?2:1;tF[254]=tF[254]=1;var tX={string2buf:function(e){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);var t,i,n,r,o,a=e.length,s=0;for(r=0;r<a;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<a&&56320==(64512&(n=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(n-56320),r++),s+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Uint8Array(s),o=0,r=0;o<s;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<a&&56320==(64512&(n=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(n-56320),r++),i<128?t[o++]=i:(i<2048?t[o++]=192|i>>>6:(i<65536?t[o++]=224|i>>>12:(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63),t[o++]=128|i>>>6&63),t[o++]=128|63&i);return t},buf2string:function(e,t){var i,n,r=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));var o=Array(2*r);for(n=0,i=0;i<r;){var a=e[i++];if(a<128)o[n++]=a;else{var s=tF[a];if(s>4)o[n++]=65533,i+=s-1;else{for(a&=2===s?31:3===s?15:7;s>1&&i<r;)a=a<<6|63&e[i++],s--;s>1?o[n++]=65533:a<65536?o[n++]=a:(a-=65536,o[n++]=55296|a>>10&1023,o[n++]=56320|1023&a)}}}return function(e,t){if(t<65534&&e.subarray&&tW)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));for(var i="",n=0;n<t;n++)i+=String.fromCharCode(e[n]);return i}(o,n)},utf8border:function(e,t){(t=t||e.length)>e.length&&(t=e.length);for(var i=t-1;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+tF[e[i]]>t?i:t}},tY=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},tZ=Object.prototype.toString,t1=eL,t0=eV,t2=eP,t4=eq,t5=eJ,t6=e$,t3=eZ,t8=e5,t9=e3;function t7(e){this.options=t$.assign({level:t3,method:t9,chunkSize:16384,windowBits:15,memLevel:8,strategy:t8},e||{});var t,i=this.options;i.raw&&i.windowBits>0?i.windowBits=-i.windowBits:i.gzip&&i.windowBits>0&&i.windowBits<16&&(i.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new tY,this.strm.avail_out=0;var n=tK.deflateInit2(this.strm,i.level,i.method,i.windowBits,i.memLevel,i.strategy);if(n!==t5)throw Error(eU[n]);if(i.header&&tK.deflateSetHeader(this.strm,i.header),i.dictionary){if(t="string"==typeof i.dictionary?tX.string2buf(i.dictionary):"[object ArrayBuffer]"===tZ.call(i.dictionary)?new Uint8Array(i.dictionary):i.dictionary,(n=tK.deflateSetDictionary(this.strm,t))!==t5)throw Error(eU[n]);this._dict_set=!0}}function ie(e,t){var i=new t7(t);if(i.push(e,!0),i.err)throw i.msg||eU[i.err];return i.result}t7.prototype.push=function(e,t){var i,n,r=this.strm,o=this.options.chunkSize;if(this.ended)return!1;for(n=t===~~t?t:!0===t?t4:t1,"string"==typeof e?r.input=tX.string2buf(e):"[object ArrayBuffer]"===tZ.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(o),r.next_out=0,r.avail_out=o),(n===t0||n===t2)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if((i=tK.deflate(r,n))===t6)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=tK.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===t5;if(0!==r.avail_out){if(n>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},t7.prototype.onData=function(e){this.chunks.push(e)},t7.prototype.onEnd=function(e){e===t5&&(this.result=t$.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var it=function(e,t){return(t=t||{}).gzip=!0,ie(e,t)},ii=function(e,t){var i,n,r,o,a,s,c,l,h,u,d,p,f,g,_,m,v,y,b,z,w,k,E,S,T=e.state;i=e.next_in,E=e.input,n=i+(e.avail_in-5),r=e.next_out,S=e.output,o=r-(t-e.avail_out),a=r+(e.avail_out-257),s=T.dmax,c=T.wsize,l=T.whave,h=T.wnext,u=T.window,d=T.hold,p=T.bits,f=T.lencode,g=T.distcode,_=(1<<T.lenbits)-1,m=(1<<T.distbits)-1;e:do for(p<15&&(d+=E[i++]<<p,p+=8,d+=E[i++]<<p,p+=8),v=f[d&_];;){if(d>>>=y=v>>>24,p-=y,0==(y=v>>>16&255))S[r++]=65535&v;else{if(!(16&y)){if(0==(64&y)){v=f[(65535&v)+(d&(1<<y)-1)];continue}if(32&y){T.mode=16191;break e}e.msg="invalid literal/length code",T.mode=16209;break e}for(b=65535&v,(y&=15)&&(p<y&&(d+=E[i++]<<p,p+=8),b+=d&(1<<y)-1,d>>>=y,p-=y),p<15&&(d+=E[i++]<<p,p+=8,d+=E[i++]<<p,p+=8),v=g[d&m];;){if(d>>>=y=v>>>24,p-=y,!(16&(y=v>>>16&255))){if(0==(64&y)){v=g[(65535&v)+(d&(1<<y)-1)];continue}e.msg="invalid distance code",T.mode=16209;break e}if(z=65535&v,p<(y&=15)&&(d+=E[i++]<<p,(p+=8)<y&&(d+=E[i++]<<p,p+=8)),(z+=d&(1<<y)-1)>s){e.msg="invalid distance too far back",T.mode=16209;break e}if(d>>>=y,p-=y,z>(y=r-o)){if((y=z-y)>l&&T.sane){e.msg="invalid distance too far back",T.mode=16209;break e}if(w=0,k=u,0===h){if(w+=c-y,y<b){b-=y;do S[r++]=u[w++];while(--y);w=r-z,k=S}}else if(h<y){if(w+=c+h-y,(y-=h)<b){b-=y;do S[r++]=u[w++];while(--y);if(w=0,h<b){b-=y=h;do S[r++]=u[w++];while(--y);w=r-z,k=S}}}else if(w+=h-y,y<b){b-=y;do S[r++]=u[w++];while(--y);w=r-z,k=S}for(;b>2;)S[r++]=k[w++],S[r++]=k[w++],S[r++]=k[w++],b-=3;b&&(S[r++]=k[w++],b>1&&(S[r++]=k[w++]))}else{w=r-z;do S[r++]=S[w++],S[r++]=S[w++],S[r++]=S[w++],b-=3;while(b>2);b&&(S[r++]=S[w++],b>1&&(S[r++]=S[w++]))}break}}break}while(i<n&&r<a);i-=b=p>>3,d&=(1<<(p-=b<<3))-1,e.next_in=i,e.next_out=r,e.avail_in=i<n?n-i+5:5-(i-n),e.avail_out=r<a?a-r+257:257-(r-a),T.hold=d,T.bits=p},ir=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),io=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ia=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),is=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ic=function(e,t,i,n,r,o,a,s){var c,l,h,u,d,p,f,g,_,m=s.bits,v=0,y=0,b=0,z=0,w=0,k=0,E=0,S=0,T=0,x=0,I=null,O=new Uint16Array(16),A=new Uint16Array(16),D=null;for(v=0;v<=15;v++)O[v]=0;for(y=0;y<n;y++)O[t[i+y]]++;for(w=m,z=15;z>=1&&0===O[z];z--);if(w>z&&(w=z),0===z)return r[o++]=0x1400000,r[o++]=0x1400000,s.bits=1,0;for(b=1;b<z&&0===O[b];b++);for(w<b&&(w=b),S=1,v=1;v<=15;v++)if(S<<=1,(S-=O[v])<0)return -1;if(S>0&&(0===e||1!==z))return -1;for(A[1]=0,v=1;v<15;v++)A[v+1]=A[v]+O[v];for(y=0;y<n;y++)0!==t[i+y]&&(a[A[t[i+y]]++]=y);if(0===e?(I=D=a,p=20):1===e?(I=ir,D=io,p=257):(I=ia,D=is,p=0),x=0,y=0,v=b,d=o,k=w,E=0,h=-1,u=(T=1<<w)-1,1===e&&T>852||2===e&&T>592)return 1;for(;;){f=v-E,a[y]+1<p?(g=0,_=a[y]):a[y]>=p?(g=D[a[y]-p],_=I[a[y]-p]):(g=96,_=0),c=1<<v-E,b=l=1<<k;do r[d+(x>>E)+(l-=c)]=f<<24|g<<16|_;while(0!==l);for(c=1<<v-1;x&c;)c>>=1;if(0!==c?(x&=c-1,x+=c):x=0,y++,0==--O[v]){if(v===z)break;v=t[i+a[y]]}if(v>w&&(x&u)!==h){for(0===E&&(E=w),d+=b,S=1<<(k=v-E);k+E<z&&!((S-=O[k+E])<=0);)k++,S<<=1;if(T+=1<<k,1===e&&T>852||2===e&&T>592)return 1;r[h=x&u]=w<<24|k<<16|d-o}}return 0!==x&&(r[d+x]=v-E<<24|4194304),s.bits=w,0},il=eq,ih=eH,iu=eK,id=eJ,ip=e$,ig=eW,i_=eF,im=eQ,iv=eX,iy=eY,ib=e3,iz=function(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)};function iw(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var ik,iE,iS=function(e){if(!e)return 1;var t=e.state;return+(!t||t.strm!==e||t.mode<16180||t.mode>16211)},iT=function(e){if(iS(e))return i_;var t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=16180,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,id},ix=function(e){if(iS(e))return i_;var t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,iT(e)},iI=function(e,t){if(iS(e))return i_;var i,n=e.state;return t<0?(i=0,t=-t):(i=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?i_:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,ix(e))},iO=!0,iA=function(e){if(iO){ik=new Int32Array(512),iE=new Int32Array(32);for(var t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ic(1,e.lens,0,288,ik,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ic(2,e.lens,0,32,iE,0,e.work,{bits:5}),iO=!1}e.lencode=ik,e.lenbits=9,e.distcode=iE,e.distbits=5},iD=function(e,t,i,n){var r,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(t.subarray(i-o.wsize,i),0),o.wnext=0,o.whave=o.wsize):((r=o.wsize-o.wnext)>n&&(r=n),o.window.set(t.subarray(i-n,i-n+r),o.wnext),(n-=r)?(o.window.set(t.subarray(i-n,i),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0},iC={inflateReset:ix,inflateInit2:function(e,t){if(!e)return i_;var i=new iw;e.state=i,i.strm=e,i.window=null,i.mode=16180;var n=iI(e,t);return n!==id&&(e.state=null),n},inflate:function(e,t){var i,n,r,o,a,s,c,l,h,u,d,p,f,g,_,m,v,y,b,z,w,k,E,S,T=0,x=new Uint8Array(4),I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(iS(e)||!e.output||!e.input&&0!==e.avail_in)return i_;16191===(i=e.state).mode&&(i.mode=16192),a=e.next_out,r=e.output,c=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,l=i.hold,h=i.bits,u=s,d=c,k=id;e:for(;;)switch(i.mode){case 16180:if(0===i.wrap){i.mode=16192;break}for(;h<16;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}if(2&i.wrap&&35615===l){0===i.wbits&&(i.wbits=15),i.check=0,x[0]=255&l,x[1]=l>>>8&255,i.check=eR(i.check,x,2,0),l=0,h=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",i.mode=16209;break}if((15&l)!==ib){e.msg="unknown compression method",i.mode=16209;break}if(h-=4,w=8+(15&(l>>>=4)),0===i.wbits&&(i.wbits=w),w>15||w>i.wbits){e.msg="invalid window size",i.mode=16209;break}i.dmax=1<<i.wbits,i.flags=0,e.adler=i.check=1,i.mode=512&l?16189:16191,l=0,h=0;break;case 16181:for(;h<16;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}if(i.flags=l,(255&i.flags)!==ib){e.msg="unknown compression method",i.mode=16209;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=16209;break}i.head&&(i.head.text=l>>8&1),512&i.flags&&4&i.wrap&&(x[0]=255&l,x[1]=l>>>8&255,i.check=eR(i.check,x,2,0)),l=0,h=0,i.mode=16182;case 16182:for(;h<32;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}i.head&&(i.head.time=l),512&i.flags&&4&i.wrap&&(x[0]=255&l,x[1]=l>>>8&255,x[2]=l>>>16&255,x[3]=l>>>24&255,i.check=eR(i.check,x,4,0)),l=0,h=0,i.mode=16183;case 16183:for(;h<16;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}i.head&&(i.head.xflags=255&l,i.head.os=l>>8),512&i.flags&&4&i.wrap&&(x[0]=255&l,x[1]=l>>>8&255,i.check=eR(i.check,x,2,0)),l=0,h=0,i.mode=16184;case 16184:if(1024&i.flags){for(;h<16;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}i.length=l,i.head&&(i.head.extra_len=l),512&i.flags&&4&i.wrap&&(x[0]=255&l,x[1]=l>>>8&255,i.check=eR(i.check,x,2,0)),l=0,h=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&i.flags&&((p=i.length)>s&&(p=s),p&&(i.head&&(w=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(n.subarray(o,o+p),w)),512&i.flags&&4&i.wrap&&(i.check=eR(i.check,n,p,o)),s-=p,o+=p,i.length-=p),i.length))break e;i.length=0,i.mode=16186;case 16186:if(2048&i.flags){if(0===s)break e;p=0;do w=n[o+p++],i.head&&w&&i.length<65536&&(i.head.name+=String.fromCharCode(w));while(w&&p<s);if(512&i.flags&&4&i.wrap&&(i.check=eR(i.check,n,p,o)),s-=p,o+=p,w)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&i.flags){if(0===s)break e;p=0;do w=n[o+p++],i.head&&w&&i.length<65536&&(i.head.comment+=String.fromCharCode(w));while(w&&p<s);if(512&i.flags&&4&i.wrap&&(i.check=eR(i.check,n,p,o)),s-=p,o+=p,w)break e}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&i.flags){for(;h<16;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}if(4&i.wrap&&l!==(65535&i.check)){e.msg="header crc mismatch",i.mode=16209;break}l=0,h=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=16191;break;case 16189:for(;h<32;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}e.adler=i.check=iz(l),l=0,h=0,i.mode=16190;case 16190:if(0===i.havedict)return e.next_out=a,e.avail_out=c,e.next_in=o,e.avail_in=s,i.hold=l,i.bits=h,ig;e.adler=i.check=1,i.mode=16191;case 16191:if(t===ih||t===iu)break e;case 16192:if(i.last){l>>>=7&h,h-=7&h,i.mode=16206;break}for(;h<3;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}switch(i.last=1&l,h-=1,3&(l>>>=1)){case 0:i.mode=16193;break;case 1:if(iA(i),i.mode=16199,t===iu){l>>>=2,h-=2;break e}break;case 2:i.mode=16196;break;case 3:e.msg="invalid block type",i.mode=16209}l>>>=2,h-=2;break;case 16193:for(l>>>=7&h,h-=7&h;h<32;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",i.mode=16209;break}if(i.length=65535&l,l=0,h=0,i.mode=16194,t===iu)break e;case 16194:i.mode=16195;case 16195:if(p=i.length){if(p>s&&(p=s),p>c&&(p=c),0===p)break e;r.set(n.subarray(o,o+p),a),s-=p,o+=p,c-=p,a+=p,i.length-=p;break}i.mode=16191;break;case 16196:for(;h<14;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}if(i.nlen=257+(31&l),h-=5,i.ndist=1+(31&(l>>>=5)),h-=5,i.ncode=4+(15&(l>>>=5)),l>>>=4,h-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=16209;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;h<3;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}i.lens[I[i.have++]]=7&l,l>>>=3,h-=3}for(;i.have<19;)i.lens[I[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,E={bits:i.lenbits},k=ic(0,i.lens,0,19,i.lencode,0,i.work,E),i.lenbits=E.bits,k){e.msg="invalid code lengths set",i.mode=16209;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;m=(T=i.lencode[l&(1<<i.lenbits)-1])>>>16&255,v=65535&T,!((_=T>>>24)<=h);){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}if(v<16)l>>>=_,h-=_,i.lens[i.have++]=v;else{if(16===v){for(S=_+2;h<S;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}if(l>>>=_,h-=_,0===i.have){e.msg="invalid bit length repeat",i.mode=16209;break}w=i.lens[i.have-1],p=3+(3&l),l>>>=2,h-=2}else if(17===v){for(S=_+3;h<S;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}h-=_,w=0,p=3+(7&(l>>>=_)),l>>>=3,h-=3}else{for(S=_+7;h<S;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}h-=_,w=0,p=11+(127&(l>>>=_)),l>>>=7,h-=7}if(i.have+p>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=16209;break}for(;p--;)i.lens[i.have++]=w}}if(16209===i.mode)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=16209;break}if(i.lenbits=9,E={bits:i.lenbits},k=ic(1,i.lens,0,i.nlen,i.lencode,0,i.work,E),i.lenbits=E.bits,k){e.msg="invalid literal/lengths set",i.mode=16209;break}if(i.distbits=6,i.distcode=i.distdyn,E={bits:i.distbits},k=ic(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,E),i.distbits=E.bits,k){e.msg="invalid distances set",i.mode=16209;break}if(i.mode=16199,t===iu)break e;case 16199:i.mode=16200;case 16200:if(s>=6&&c>=258){e.next_out=a,e.avail_out=c,e.next_in=o,e.avail_in=s,i.hold=l,i.bits=h,ii(e,d),a=e.next_out,r=e.output,c=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,l=i.hold,h=i.bits,16191===i.mode&&(i.back=-1);break}for(i.back=0;m=(T=i.lencode[l&(1<<i.lenbits)-1])>>>16&255,v=65535&T,!((_=T>>>24)<=h);){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}if(m&&0==(240&m)){for(y=_,b=m,z=v;m=(T=i.lencode[z+((l&(1<<y+b)-1)>>y)])>>>16&255,v=65535&T,!(y+(_=T>>>24)<=h);){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}l>>>=y,h-=y,i.back+=y}if(l>>>=_,h-=_,i.back+=_,i.length=v,0===m){i.mode=16205;break}if(32&m){i.back=-1,i.mode=16191;break}if(64&m){e.msg="invalid literal/length code",i.mode=16209;break}i.extra=15&m,i.mode=16201;case 16201:if(i.extra){for(S=i.extra;h<S;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}i.length+=l&(1<<i.extra)-1,l>>>=i.extra,h-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;m=(T=i.distcode[l&(1<<i.distbits)-1])>>>16&255,v=65535&T,!((_=T>>>24)<=h);){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}if(0==(240&m)){for(y=_,b=m,z=v;m=(T=i.distcode[z+((l&(1<<y+b)-1)>>y)])>>>16&255,v=65535&T,!(y+(_=T>>>24)<=h);){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}l>>>=y,h-=y,i.back+=y}if(l>>>=_,h-=_,i.back+=_,64&m){e.msg="invalid distance code",i.mode=16209;break}i.offset=v,i.extra=15&m,i.mode=16203;case 16203:if(i.extra){for(S=i.extra;h<S;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}i.offset+=l&(1<<i.extra)-1,l>>>=i.extra,h-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=16209;break}i.mode=16204;case 16204:if(0===c)break e;if(p=d-c,i.offset>p){if((p=i.offset-p)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=16209;break}p>i.wnext?(p-=i.wnext,f=i.wsize-p):f=i.wnext-p,p>i.length&&(p=i.length),g=i.window}else g=r,f=a-i.offset,p=i.length;p>c&&(p=c),c-=p,i.length-=p;do r[a++]=g[f++];while(--p);0===i.length&&(i.mode=16200);break;case 16205:if(0===c)break e;r[a++]=i.length,c--,i.mode=16200;break;case 16206:if(i.wrap){for(;h<32;){if(0===s)break e;s--,l|=n[o++]<<h,h+=8}if(d-=c,e.total_out+=d,i.total+=d,4&i.wrap&&d&&(e.adler=i.check=i.flags?eR(i.check,r,d,a-d):eG(i.check,r,d,a-d)),d=c,4&i.wrap&&(i.flags?l:iz(l))!==i.check){e.msg="incorrect data check",i.mode=16209;break}l=0,h=0}i.mode=16207;case 16207:if(i.wrap&&i.flags){for(;h<32;){if(0===s)break e;s--,l+=n[o++]<<h,h+=8}if(4&i.wrap&&l!==(0|i.total)){e.msg="incorrect length check",i.mode=16209;break}l=0,h=0}i.mode=16208;case 16208:k=ip;break e;case 16209:k=im;break e;case 16210:return iv;default:return i_}return e.next_out=a,e.avail_out=c,e.next_in=o,e.avail_in=s,i.hold=l,i.bits=h,(i.wsize||d!==e.avail_out&&i.mode<16209&&(i.mode<16206||t!==il))&&iD(e,e.output,e.next_out,d-e.avail_out),u-=e.avail_in,d-=e.avail_out,e.total_in+=u,e.total_out+=d,i.total+=d,4&i.wrap&&d&&(e.adler=i.check=i.flags?eR(i.check,r,d,e.next_out-d):eG(i.check,r,d,e.next_out-d)),e.data_type=i.bits+64*!!i.last+128*(16191===i.mode)+256*(16199===i.mode||16194===i.mode),(0===u&&0===d||t===il)&&k===id&&(k=iy),k},inflateEnd:function(e){if(iS(e))return i_;var t=e.state;return t.window&&(t.window=null),e.state=null,id},inflateGetHeader:function(e,t){if(iS(e))return i_;var i=e.state;return 0==(2&i.wrap)?i_:(i.head=t,t.done=!1,id)},inflateSetDictionary:function(e,t){var i,n=t.length;return iS(e)||0!==(i=e.state).wrap&&16190!==i.mode?i_:16190===i.mode&&eG(1,t,n,0)!==i.check?im:iD(e,t,n,n)?(i.mode=16210,iv):(i.havedict=1,id)}},iM=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},iN=Object.prototype.toString,iG=eL,iB=eq,iR=eJ,iU=e$,iL=eW,ij=eF,iV=eQ,iP=eX;function iq(e){this.options=t$.assign({chunkSize:65536,windowBits:15,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new tY,this.strm.avail_out=0;var i=iC.inflateInit2(this.strm,t.windowBits);if(i!==iR||(this.header=new iM,iC.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=tX.string2buf(t.dictionary):"[object ArrayBuffer]"===iN.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=iC.inflateSetDictionary(this.strm,t.dictionary))!==iR)))throw Error(eU[i])}iq.prototype.push=function(e,t){var i,n,r,o=this.strm,a=this.options.chunkSize,s=this.options.dictionary;if(this.ended)return!1;for(n=t===~~t?t:!0===t?iB:iG,"[object ArrayBuffer]"===iN.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;;){for(0===o.avail_out&&(o.output=new Uint8Array(a),o.next_out=0,o.avail_out=a),(i=iC.inflate(o,n))===iL&&s&&((i=iC.inflateSetDictionary(o,s))===iR?i=iC.inflate(o,n):i===iV&&(i=iL));o.avail_in>0&&i===iU&&o.state.wrap>0&&0!==e[o.next_in];)iC.inflateReset(o),i=iC.inflate(o,n);switch(i){case ij:case iV:case iL:case iP:return this.onEnd(i),this.ended=!0,!1}if(r=o.avail_out,o.next_out&&(0===o.avail_out||i===iU))if("string"===this.options.to){var c=tX.utf8border(o.output,o.next_out),l=o.next_out-c,h=tX.buf2string(o.output,c);o.next_out=l,o.avail_out=a-l,l&&o.output.set(o.output.subarray(c,c+l),0),this.onData(h)}else this.onData(o.output.length===o.next_out?o.output:o.output.subarray(0,o.next_out));if(i!==iR||0!==r){if(i===iU)return i=iC.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===o.avail_in)break}}return!0},iq.prototype.onData=function(e){this.chunks.push(e)},iq.prototype.onEnd=function(e){e===iR&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=t$.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var iH,iK={gzip:it},iJ=function(){return!(!window.navigator||!window.navigator.sendBeacon)},i$=function(){function e(e,t){var i=this;this.collector=e,this.config=t,this.requestType=t.request_type||"xhr",this.supportBeacon=iJ(),this.errorCode={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005},this.customHeader=t.custom_request_header||{},this.collector.on("custom-request-header",function(e){i.setRequestHeader(e)})}return e.prototype.setRequestHeader=function(e){this.customHeader=Object.assign(this.customHeader,e)},e.prototype.useFetch=function(e){var t=e.url,i=e.data,n=e.method,r=e.success,o=e.fail,a={"Content-Type":"application/json; charset=utf-8"};if(Object.keys(this.customHeader).length)for(var s in this.customHeader)a[s]=this.customHeader[s];window.fetch?fetch(t,{method:n||"POST",headers:a,body:JSON.stringify(i)}).then(function(e){return e.json()}).then(function(e){r&&r(e)}).catch(function(e){o&&o(i,e)}):(this.requestType="xhr",console.log("your brwoser not support fetch, use xhr"),this.useRequest({url:t,data:i,method:n,success:r,fail:o}))},e.prototype.useBeacon=function(e){var t=e.url,i=e.data,n=e.success,r=e.fail;window.navigator.sendBeacon(t,JSON.stringify(i))?n&&n():r&&r(i,this.errorCode.BEACON_FALSE)},e.prototype.useRequest=function(e){var t=this,i=e.url,n=e.data,r=e.method,o=e.success,a=e.fail,s=e.timeout,c=e.useBeacon,l=e.withCredentials,h=e.app_key,u=e.forceXhr,d=e.zip;if(c&&this.supportBeacon)this.useBeacon({url:i,data:n,method:r,success:o,fail:a});else if("fetch"!==this.requestType||u)try{var p=new XMLHttpRequest,f=r||"POST";if(p.open(f,""+i,!0),p.setRequestHeader("Content-Type","application/json; charset=utf-8"),h&&p.setRequestHeader("X-MCS-AppKey",""+h),Object.keys(this.customHeader).length)for(var g in this.customHeader)p.setRequestHeader(g,this.customHeader[g]);l&&(p.withCredentials=!0),s&&(p.timeout=s,p.ontimeout=function(){a&&a(n,t.errorCode.TIMEOUT)}),p.onload=function(){if(o){var e=null;if(p.responseText){try{e=JSON.parse(p.responseText)}catch(t){e={}}o(e,n)}}},p.onerror=function(){p.abort(),a&&a(n,t.errorCode.XHR_ON)};try{var _=JSON.stringify(n);if(this.config.need_zip&&d){var m=(new TextEncoder).encode(_),v=iK.gzip(m);p.setRequestHeader("Content-Encoding","gzip"),p.send(v)}else p.send(_)}catch(e){this.collector.emit("sdk-inner-error",{type:"sdk_error_send",eventData:n,errorCode:1e3,msg:e.message||e.stack||"sdk_error_send"})}}catch(e){this.collector.emit("sdk-inner-error",{type:"sdk_error_request",eventData:n,errorCode:1001,msg:e.message||e.stack||"sdk_error_request"})}else this.useFetch({url:i,data:n,method:r,success:o,fail:a})},e}(),iW=function(){function e(e,t){if(this.devToolReady=!1,this.devToolOrigin="*",this.sendAlready=!1,!t.disable_debug&&"Microsoft Internet Explorer"!==e.configManager.get("browser")){this.collect=e,this.config=t,this.app_id=t.app_id;var i=e.adapters.storage;this.cacheStorgae=new i(!1),this.loadUrl=t.devtool_url||f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z21z22z18z22z1gz1az4az18z1nz1nz1jz1mz1ez1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz18z1nz1nz1jz1mz1ez49z21z1bz1iz49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1bz1cz24z22z1mz1mz1jz4bz1bz1cz19z23z1ez49z25z1cz19z4az24z4ez4az4cz4az4cz4az1hz21"),this.filterEvent=new Set(["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure","bav2b_page","bav2b_beat","bav2b_page_statistics","bav2b_click","bav2b_page_exposure","_be_active","predefine_pageview","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append","predefine_page_alive","predefine_page_close","abtest_exposure"]),this.load()}}return e.prototype.loadScript=function(e){try{var t=document.createElement("script");t.src=e,t.onerror=function(){console.log("load DevTool render fail")},t.onload=function(){console.log("load DevTool render success")},document.getElementsByTagName("body")[0].appendChild(t)}catch(e){console.log("devTool load fail, "+e.message)}},e.prototype.parseUrl=function(){var e={};try{var t=window.location.href.split("?")[1].split("&");t.length&&t.forEach(function(t){var i=t.split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])})}catch(e){}return e},e.prototype.load=function(){try{var e=this.parseUrl();if(e.open_devtool_web&&e.app_id){if(parseInt(e.app_id)!==this.app_id)return}else if(!this.getStorage())return;this.loadBaseInfo(),this.loadHook(),this.setStorage(),this.addLintener(),this.loadDebuggerModule(),this.loadDevTool()}catch(e){console.log("debug fail, "+e.message)}},e.prototype.getStorage=function(){var e=this.cacheStorgae.getItem("__applog_open_devtool_web");return e&&parseInt(e)===this.app_id},e.prototype.setStorage=function(){this.cacheStorgae.setItem("__applog_open_devtool_web",this.app_id)},e.prototype.loadDevTool=function(){this.loadScript(this.loadUrl)},e.prototype.loadBaseInfo=function(){if(this.log=[],this.event=[],this.info=[{title:"\u57FA\u672C\u4FE1\u606F",key:"base",type:1,content:[{name:"app_id",desc:"APP_ID",value:this.config.app_id},{name:"channel",desc:"CHANNEL",value:this.config.channel},{name:"domain",desc:"\u4E0A\u62A5\u57DF\u540D",value:this.collect.configManager.getDomain()},{name:"sdk_version",desc:"SDK\u7248\u672C",value:M},{name:"sdk_type",desc:"SDK\u5F15\u5165\u65B9\u5F0F",value:"npm"}]},{title:"\u7528\u6237\u4FE1\u606F",key:"user",type:2,content:[{name:"uuid",desc:"UUID",value:this.collect.configManager.get("user").user_unique_id||""},{name:"web_id",desc:"WEB_ID",value:this.collect.configManager.get("user").web_id||""}]},{title:"\u516C\u5171\u53C2\u6570\u4FE1\u606F",type:2,key:"common",content:[{name:"browser",desc:"\u6D4F\u89C8\u5668",value:this.collect.configManager.get("browser")},{name:"browser_version",desc:"\u6D4F\u89C8\u5668\u7248\u672C",value:this.collect.configManager.get("browser_version")},{name:"platform",desc:"\u5E73\u53F0",value:this.collect.configManager.get("platform")},{name:"device_model",desc:"\u8BBE\u5907\u578B\u53F7",value:this.collect.configManager.get("device_model")},{name:"os_name",desc:"\u64CD\u4F5C\u7CFB\u7EDF",value:this.collect.configManager.get("os_name")},{name:"os_version",desc:"\u64CD\u4F5C\u7CFB\u7EDF\u7248\u672C",value:this.collect.configManager.get("os_version")},{name:"resolution",desc:"\u5C4F\u5E55\u5206\u8FA8\u7387",value:this.collect.configManager.get("resolution")},{name:"referrer",desc:"\u6765\u6E90",value:this.collect.configManager.get("referrer")},{name:"custom",desc:"\u81EA\u5B9A\u4E49\u4FE1\u606F",value:JSON.stringify(this.collect.configManager.get("custom"))}]},{title:"\u914D\u7F6E\u4FE1\u606F",key:"config",type:3,content:[{name:"autotrack",desc:"\u5168\u57CB\u70B9",value:!!this.config.autotrack},{name:"stay",desc:"\u505C\u7559\u65F6\u957F",value:!!this.config.enable_stay_duration}]},{title:"A/B\u914D\u7F6E\u4FE1\u606F",key:"ab",type:4,content:[{name:"ab",desc:"A/B\u5B9E\u9A8C",value:!!this.config.enable_ab_test}]}],this.config.enable_ab_test){var e=this.getInfo("ab");e.content=[{name:"ab",desc:"A/B\u5B9E\u9A8C",value:!!this.config.enable_ab_test},{name:"vid",desc:"\u5DF2\u66DD\u5149VID",value:this.collect.configManager.getAbVersion()},{name:"ab_domain",desc:"A/B\u57DF\u540D",value:this.config.ab_channel_domain||f(D[this.config.channel])},{name:"all_values",desc:"\u5168\u90E8\u914D\u7F6E",value:this.collect.configManager.getAbCache()}],this.setInfo("ab",e)}if(this.config.enable_native||this.config.Native){var t={title:"\u5BA2\u6237\u7AEF\u4FE1\u606F",type:3,content:[{name:"native",desc:"\u662F\u5426\u6253\u901A",value:!!this.collect.bridgeReport}]};this.setInfo("native",t)}if(M.includes("tob")){var i=this.getInfo("user");i.content.push({name:"sid",desc:"DISS".split("").reverse().join(""),value:"\u70B9\u51FB\u83B7\u53D6"}),this.setInfo("user",i)}},e.prototype.getInfo=function(e){var t=null;return this.info.forEach(function(i){i.key===e&&(t=i)}),t},e.prototype.setInfo=function(e,t){var i=!1;this.info.forEach(function(n){n.key===e&&(i=!0,n=t)}),i||this.info.push(t)},e.prototype.getSecondInfo=function(e,t){var i=this.getInfo(e),n=null;return i.content.forEach(function(e){e.name===t&&(n=e)}),n},e.prototype.setSecondInfo=function(e,t,i){var n=this.getInfo(e),r=!1;if(n.content.forEach(function(e){e.name===t&&(e.value=i,r=!0)}),!r){var o={name:t,value:i,desc:t.toLocaleUpperCase()};n.content.push(o)}this.setInfo(e,n)},e.prototype.loadHook=function(){var e=this;this.collect.on(l.DEBUGGER_MESSAGE,function(t){switch(t.type){case l.DEBUGGER_MESSAGE_SDK:var i={time:t.time,type:t.logType||"sdk",infoType:t.infoType||"sdk",level:t.level,name:t.info,show:!0,levelShow:!0,needDesc:!!t.data};if(t.data&&(i.desc={content:JSON.stringify(t.data)}),e.updateLog(i),t.secType&&"AB"===t.secType)e.setSecondInfo("ab","vid",e.collect.configManager.getAbVersion()),e.setSecondInfo("ab","all_values",e.collect.configManager.getAbCache());else if("USER"===t.secType)e.setSecondInfo("user","user_unique_id"===t.common?"uuid":t.common,e.collect.configManager.get(t.common));else if("HEADER"===t.secType){var n=e.collect.configManager.get(t.common);e.setSecondInfo("common",t.common,"custom"===t.common?JSON.stringify(n):n)}return void e.updateInfo();case l.DEBUGGER_MESSAGE_EVENT:if(t.data&&t.data.length){var r=t.data[0],o=r.events;if(!o.length)return;o.forEach(function(i){i.checkShow=!0,i.searchShow=!0,i.focusShow=!0,i.status=t.status,i.type=e.filterEvent.has(i.event)?"sdk":"cus",i.verifyType=t.verifyType?"verify":"no",i.info="","fail"===t.status&&(i.info={message:"code: "+t.code+"\uFF0C msg: "+(t.msg||t.failType)})}),e.updateEvent(r)}return}})},e.prototype.addLintener=function(){var e=this;window.addEventListener("message",function(t){if(t&&t.data&&"devtool:web:ready"===t.data.type){if(e.devToolOrigin=t.origin,e.devToolReady=!0,e.sendAlready)return;e.sendData("devtool:web:init",{info:e.info,log:e.log,event:e.event,sdk_type:M.includes("tob")?"tob":"inner",appId:e.app_id}),e.sendAlready=!0}t&&t.data&&"devtool:web:ssid"===t.data.type&&e.collect.getToken(function(t){e.setSecondInfo("user","sid",t.tobid),e.updateInfo()})})},e.prototype.sendData=function(e,t){try{var i={type:e,payload:t};window&&window.postMessage(i,this.devToolOrigin)}catch(e){}},e.prototype.updateInfo=function(){this.devToolReady&&this.sendData("devtool:web:info",this.info)},e.prototype.updateLog=function(e){this.devToolReady?this.sendData("devtool:web:log",e):this.log.push(e)},e.prototype.updateEvent=function(e){this.devToolReady?this.sendData("devtool:web:event",e):this.event.push(e)},e.prototype.loadDebuggerModule=function(){var e="#debugger-applog-web {\n      position: fixed;\n      width: 45px;\n      height: 45px;\n      background-image: url("+f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1bz1cz24z22z1mz1mz1jz4bz18z1nz1nz1jz1mz1ez4az1nz1lz1e")+");\n      bottom: 5%;\n      right: 10%;\n      cursor: pointer;\n      z-index:100;\n      background-size: 45px;\n    }",t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.appendChild(document.createTextNode(e)),t.appendChild(i);var n=document.createElement("div");n.innerHTML='<div id="debugger-applog-web" class="debugger-applog-web"></div>';var r=document.createElement("div");r.innerHTML='<div id="debugger-container" class="debugger-container"></div>',document.getElementsByTagName("body")[0].appendChild(n),document.getElementsByTagName("body")[0].appendChild(r);var o=document.getElementById("debugger-applog-web");o&&o.addEventListener("click",function(){window&&window.postMessage({type:"devtool:web:open-draw"},location.origin)})},e}(),iF={autotrack:{src:{cn:f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z21z22z18z22z1gz1az4az18z1nz1nz1jz1mz1ez1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz18z1nz1nz1jz1mz1ez49z21z1bz1iz49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz4hz4bz1nz1jz23z1ez1gz1lz4bz18z23z22z1mz22z20z18z1az1iz4az1hz21"),sg:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-sg/log-sdk/collect/5/plugin/autotrack.js",va:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-us/log-sdk/collect/5/plugin/autotrack.js"},object:"LogAutoTrack"},ab:{src:{cn:f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z21z22z18z22z1gz1az4az18z1nz1nz1jz1mz1ez1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz18z1nz1nz1jz1mz1ez49z21z1bz1iz49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz4hz4bz1nz1jz23z1ez1gz1lz4bz18z19z4az1hz21"),sg:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-sg/log-sdk/collect/5/plugin/ab.js",va:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-us/log-sdk/collect/5/plugin/ab.js"},object:"LogAb"},stay:{src:{cn:f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z21z22z18z22z1gz1az4az18z1nz1nz1jz1mz1ez1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz18z1nz1nz1jz1mz1ez49z21z1bz1iz49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz4hz4bz1nz1jz23z1ez1gz1lz4bz21z22z18z27z4az1hz21"),sg:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-sg/log-sdk/collect/5/plugin/stay.js",va:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-us/log-sdk/collect/5/plugin/stay.js"},object:"LogStay"},route:{src:{cn:f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z21z22z18z22z1gz1az4az18z1nz1nz1jz1mz1ez1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz18z1nz1nz1jz1mz1ez49z21z1bz1iz49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz4hz4bz1nz1jz23z1ez1gz1lz4bz20z1mz23z22z1cz4az1hz21"),sg:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-sg/log-sdk/collect/5/plugin/route.js",va:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-us/log-sdk/collect/5/plugin/route.js"},object:"LogRoute"},tracer:{src:{cn:f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z21z22z18z22z1gz1az4az18z1nz1nz1jz1mz1ez1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz18z1nz1nz1jz1mz1ez49z21z1bz1iz49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz4hz4bz1nz1jz23z1ez1gz1lz4bz22z20z18z1az1cz20z4az1hz21"),sg:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-sg/log-sdk/collect/5/plugin/tracer.js",va:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-us/log-sdk/collect/5/plugin/tracer.js"},object:"LogTracer"},retry:{src:{cn:f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z21z22z18z22z1gz1az4az18z1nz1nz1jz1mz1ez1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz18z1nz1nz1jz1mz1ez49z21z1bz1iz49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz4hz4bz1nz1jz23z1ez1gz1lz4bz20z1cz22z20z27z4az1hz21"),sg:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-sg/log-sdk/collect/5/plugin/retry.js",va:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-us/log-sdk/collect/5/plugin/retry.js"},object:"LogRetry"},visual:{src:{cn:f("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z21z22z18z22z1gz1az4az18z1nz1nz1jz1mz1ez1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz18z1nz1nz1jz1mz1ez49z21z1bz1iz49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz4hz4bz1nz1jz23z1ez1gz1lz4bz24z1gz21z23z18z1jz4az1hz21"),sg:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-sg/log-sdk/collect/5/plugin/visual.js",va:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-us/log-sdk/collect/5/plugin/visual.js"},object:"LogVisual"}},iQ=["ab","autotrack","Stay","store","et","profile","cep","heartbeat","monitor","route","tracer"],iX=function(){function e(e){this.disableAutoPageView=!1,this.bridgeReport=!1,this.staging=!1,this.pluginInstances=[],this.sended=!1,this.started=!1,this.destroy=!1,this.sdkReady=!1,this.adapters={},this.loadType="base",this.sdkStop=!1,this.name=e,this.hook=new h,this.remotePlugin=new Map,this.Types=R,this.adapters.storage=O,this.loadType="full"}return e.usePlugin=function(t,i,n){if(i){for(var r=!1,o=0,a=e.plugins.length;o<a;o++)if(e.plugins[o].name===i){e.plugins[o].plugin=t,e.plugins[o].options=n||{},r=!0;break}r||e.plugins.push({name:i,plugin:t,options:n})}else e.plugins.push({plugin:t})},e.prototype.usePlugin=function(e,t,i){e&&("full"===this.loadType&&iQ.includes(e)?console.info("your sdk version has "+e+" plugin already ~"):t?"string"==typeof t?this.remotePlugin.get(e)||this.remotePlugin.set(e,{src:t,call:i}):this.remotePlugin.get(e)||this.remotePlugin.set(e,{instance:t}):this.remotePlugin.get(e)||this.remotePlugin.set(e,"sdk"))},e.prototype.init=function(t){var i,n=this;(this.logger=new H(this.name,t.log),this.inited)?this.logger.warn("[instance: "+this.name+"], every instance's api: init,  can be call only one time!"):t&&u(t)?t.app_id&&"number"==typeof(i=t.app_id)&&!isNaN(i)?!t.app_key||function(e){return"string"==typeof e}(t.app_key)?(t.channel_domain||-1!==["cn","sg","va","my"].indexOf(t.channel)||(this.logger.warn("channel must be `cn`, `sg`,`va`, `my` !"),t.channel="cn"),this.spider=new K,this.spider.checkSpider(t)?this.logger.warn("your env may be a spider, can not report!"):(this.appBridge=new J(this,t.enable_native),this.requestManager=new i$(this,t),this.bridgeReport=this.appBridge.bridgeInject(),this.configManager=new q(this,t),this.debugger=new iW(this,t),this.initConfig=t,this.emit(R.Init),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CInit",data:t,level:"info",time:Date.now(),infoType:"cus"}),this.destroy=!1,t.disable_auto_pv&&(this.disableAutoPageView=!0),this.bridgeReport||(this.configManager.set({app_id:t.app_id}),this.eventManager=new F,this.tokenManager=new X,this.sessionManager=new W,Promise.all([new Promise(function(e){n.once(R.TokenComplete,function(){e(!0)})}),new Promise(function(e){n.once(R.Start,function(){e(!0)})})]).then(function(){try{e.plugins.reduce(function(e,t){var i=t.plugin,r=t.options,o=Object.assign(n.initConfig,r),a=new i;return a.apply(n,o),e.push(a),n.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK\u52A0\u8F7D"+t.name+"\u63D2\u4EF6",level:"info",time:Date.now(),infoType:"sdk"}),e},n.pluginInstances)}catch(e){console.warn("load plugin error, "+e.message),n.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK\u52A0\u8F7D\u63D2\u4EF6\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message,infoType:"sdk"})}n.sdkReady=!0,n.emit(R.Ready),n.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u7528\u6237\u4FE1\u606F\u521D\u59CB\u5316\u5B8C\u6210",time:Date.now(),secType:"USER",level:"info",data:n.configManager.get("user"),infoType:"sdk"}),n.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u521D\u59CB\u5316\u5B8C\u6210",time:Date.now(),level:"info",data:n.configManager.get("user"),infoType:"sdk"}),n.logger.info("appid: "+t.app_id+", userInfo:"+JSON.stringify(n.configManager.get("user"))),n.logger.info("appid: "+t.app_id+", sdk is ready, version type is "+n.loadType+", version is "+M+", you can report now !!!"),t.disable_auto_pv&&(n.disableAutoPageView=!0);try{"full"===n.loadType&&(t.enable_ab_test||t.autotrack)&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(e){n.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message,infoType:"sdk"})}n.pageView(),n.on(R.TokenChange,function(e){"webid"===e&&n.pageView(),n.logger.info("appid: "+t.app_id+" token change, new userInfo:"+JSON.stringify(n.configManager.get("user"))),n.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u8BBE\u7F6E\u4E86\u7528\u6237\u4FE1\u606F",time:Date.now(),secType:"USER",level:"info",data:n.configManager.get("user"),infoType:"sdk"})}),n.on(R.TokenReset,function(){n.logger.info("appid: "+t.app_id+" token reset, new userInfo:"+JSON.stringify(n.configManager.get("user"))),n.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u91CD\u7F6E\u4E86\u7528\u6237\u4FE1\u606F",time:Date.now(),secType:"USER",level:"info",data:n.configManager.get("user"),infoType:"sdk"})}),n.on(R.RouteChange,function(e){e.init||t.disable_route_report||n.pageView()})}),this.tokenManager.apply(this,t),this.eventManager.apply(this,t),this.sessionManager.apply(this,t)),this.inited=!0)):this.logger.warn("app_key param is error, must be string, please check!"):this.logger.warn("app_id param is error, must be number, please check!"):this.logger.warn("init params error,please check!")},e.prototype.config=function(e){if(!this.inited)return console.warn("config must be use after function init"),void this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK\u6267\u884CConfig\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:"config must be use after function init",infoType:"sdk"});if(!e||!u(e))return console.warn("config params is error, please check"),void this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK\u6267\u884CConfig\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:"config params is error, please check",infoType:"sdk"});if(this.bridgeReport)this.appBridge.setConfig(e);else{e._staging_flag&&1===e._staging_flag&&(this.staging=!0),e.disable_auto_pv&&(this.disableAutoPageView=!0,delete e.disable_auto_pv);var t=n({},e),i=this.initConfig.configPersist||this.initConfig.config_persist||!1;if(this.initConfig&&i){var r=this.configManager.getStore();r&&(t=Object.assign(r,e)),this.configManager.setStore(e)}t.web_id,t.user_unique_id;var o=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&(i[n[r]]=e[n[r]])}return i}(t,["web_id","user_unique_id"]);this.configManager.set(o),t.hasOwnProperty("web_id")&&this.emit(R.ConfigWebId,t.web_id),t.hasOwnProperty("user_unique_id")&&this.emit(R.ConfigUuid,t.user_unique_id),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CConfig",level:"info",time:Date.now(),data:t,infoType:"cus"})}},e.prototype.setUserUniqueID=function(e){this.config({user_unique_id:e})},e.prototype.setHeaderInfo=function(e,t){var i={};i[e]=t,this.config(i)},e.prototype.removeHeaderInfo=function(e){var t={};t[e]=void 0,this.config(t)},e.prototype.setDomain=function(e){this.configManager&&this.configManager.setDomain(e),this.emit(R.ConfigDomain)},e.prototype.getConfig=function(e){var t;return null==(t=this.configManager)?void 0:t.get(e)},e.prototype.send=function(){this.start()},e.prototype.start=function(){this.inited&&!this.sended&&(this.sended=!0,this.started=!0,this.emit(R.Start),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CStart",level:"info",time:Date.now(),infoType:"cus"}),this.bridgeReport&&(this.pageView(),this.emit(R.Ready)))},e.prototype.event=function(e,t){var i=this;try{var n=[];if(Array.isArray(e))e.forEach(function(e){var t=i.processEvent(e[0],e[1]||{});t&&n.push(t)});else{var r=this.processEvent(e,t);if(!r)return;n.push(r)}this.bridgeReport?n.forEach(function(e){var t=e.event,n=e.params;i.appBridge.onEventV3(t,JSON.stringify(n))}):n.length&&(this.emit(R.Event,n),this.emit(R.SessionResetTime)),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CEvent",level:"info",time:Date.now(),data:e,infoType:"cus"})}catch(e){this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CEvent\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message,infoType:"sdk"})}},e.prototype.beconEvent=function(e,t){if(Array.isArray(e))console.warn("beconEvent not support batch report, please check");else{var i=[],n=this.processEvent(e,t||{});n&&(i.push(n),i.length&&(this.emit(R.BeconEvent,i),this.emit(R.SessionResetTime)),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CBeacon Event",level:"info",time:Date.now(),data:e,infoType:"sdk"}))}},e.prototype.beaconEvent=function(e,t){this.beconEvent(e,t)},e.prototype.processEvent=function(e,t){void 0===t&&(t={});try{if(!e)return console.warn("eventName is null\uFF0C please check"),null;var i=e;/^event\./.test(e)&&(i=e.slice(6));var n=t;"object"!=typeof n&&(n={}),n.profile?delete n.profile:n.event_index=p();var r=void 0;return n.local_ms?(r=n.local_ms,delete n.local_ms):r=+new Date,{event:i,params:n,local_time_ms:r,is_bav:this.initConfig&&this.initConfig.autotrack?1:0}}catch(i){return this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:i.message,infoType:"sdk"}),{event:e,params:t}}},e.prototype.filterEvent=function(e){this.eventFilter=e},e.prototype.on=function(e,t){this.hook.on(e,t)},e.prototype.once=function(e,t){this.hook.once(e,t)},e.prototype.off=function(e,t){this.hook.off(e,t)},e.prototype.emit=function(e,t,i){this.hook.emit(e,t,i)},e.prototype.set=function(e){this.hook.set(e)},e.prototype.stop=function(){this.sdkStop=!0},e.prototype.reStart=function(){this.sdkStop=!1},e.prototype.pageView=function(){this.disableAutoPageView||this.predefinePageView()},e.prototype.predefinePageView=function(e){if(void 0===e&&(e={}),this.inited){var t={title:document.title||location.pathname,url:location.href,url_path:this.handlePath(),time:Date.now(),referrer:window.document.referrer,$is_first_time:""+(this.configManager&&this.configManager.is_first_time||!1)},i=n(n({},t),e);this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u4E0A\u62A5PV",level:"info",time:Date.now(),infoType:"sdk"}),this.event("predefine_pageview",i)}else console.warn("predefinePageView must be use after function init")},e.prototype.handlePath=function(){var e=location.pathname;try{if(this.initConfig.allow_hash){var t=new URL(location.href).hash.match(/#\/([^?#]+)/i);return t&&t.length?t[1]:location.pathname}}catch(t){e=location.pathname}return e},e.prototype.clearEventCache=function(){this.emit(R.CleanEvents)},e.prototype.setWebIDviaUnionID=function(e){if(e){var t=w(e);this.config({web_id:""+t,wechat_unionid:e}),this.emit(R.CustomWebId)}},e.prototype.setWebId=function(e){this.config({web_id:""+e})},e.prototype.setWebIDviaOpenID=function(e){if(e){var t=w(e);this.config({web_id:""+t,wechat_openid:e}),this.emit(R.CustomWebId)}},e.prototype.setNativeAppId=function(e){this.bridgeReport&&this.appBridge.setNativeAppId(e)},e.prototype.setRequestHeaders=function(e){this.emit(R.CustomHeader,e)},e.prototype.getSessionId=function(){return $()},e.prototype.setSessionId=function(e){this.emit(R.SessionReset,e)},e.prototype.resetStayDuration=function(e,t,i){this.emit(R.ResetStay,{url_path:e,title:t,url:i},R.Stay)},e.prototype.resetStayParams=function(e,t,i){void 0===e&&(e=""),void 0===t&&(t=""),void 0===i&&(i=""),this.emit(R.SetStay,{url_path:e,title:t,url:i},R.Stay)},e.prototype.getToken=function(e,t){var i=this;if(this.inited){var r=!1,o=function(t){if(!r){r=!0;var o=i.configManager.get().user;return t&&(o.tobid=t,o["diss".split("").reverse().join("")]=t),e(n({},o))}},a=function(){i.tokenManager.getTobId().then(function(e){o(e)})};this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CGetToken",level:"info",time:Date.now(),infoType:"cus"}),this.sdkReady?a():(t&&setTimeout(function(){o()},t),this.on(R.Ready,function(){a()}))}else console.warn("getToken must be use after function init")},e.prototype.profileSet=function(e){this.bridgeReport?this.appBridge.profileSet(JSON.stringify(e)):this.emit(R.ProfileSet,e,R.Profile),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileSet",level:"info",time:Date.now(),data:e,infoType:"cus"})},e.prototype.profileSetOnce=function(e){this.bridgeReport?this.appBridge.profileSetOnce(JSON.stringify(e)):this.emit(R.ProfileSetOnce,e,R.Profile),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileSetOnce",level:"info",time:Date.now(),data:e,infoType:"cus"})},e.prototype.profileIncrement=function(e){this.bridgeReport?this.appBridge.profileIncrement(JSON.stringify(e)):this.emit(R.ProfileIncrement,e,R.Profile),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileIncrement",level:"info",time:Date.now(),data:e,infoType:"cus"})},e.prototype.profileUnset=function(e){this.bridgeReport?this.appBridge.profileUnset(e):this.emit(R.ProfileUnset,e,R.Profile),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileUnset",level:"info",time:Date.now(),data:e,infoType:"cus"})},e.prototype.profileAppend=function(e){this.bridgeReport?this.appBridge.profileAppend(JSON.stringify(e)):this.emit(R.ProfileAppend,e,R.Profile),this.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileAppend",level:"info",time:Date.now(),data:e,infoType:"cus"})},e.prototype.setExternalAbVersion=function(e){this.emit(R.AbExternalVersion,"string"==typeof e&&e?(""+e).trim():null,R.Ab)},e.prototype.getVar=function(e,t,i){this.emit(R.AbVar,{name:e,defaultValue:t,callback:i},R.Ab)},e.prototype.getABconfig=function(e,t){this.emit(R.AbConfig,{params:e,callback:t},R.Ab)},e.prototype.getABConfig=function(e,t){this.emit(R.AbConfig,{params:e,callback:t},R.Ab)},e.prototype.getAbSdkVersion=function(){return this.configManager.getAbVersion()},e.prototype.onAbSdkVersionChange=function(e){var t=this;return this.emit(R.AbVersionChangeOn,e,R.Ab),function(){t.emit(R.AbVersionChangeOff,e,R.Ab)}},e.prototype.offAbSdkVersionChange=function(e){this.emit(R.AbVersionChangeOff,e,R.Ab)},e.prototype.openOverlayer=function(){this.emit(R.AbOpenLayer,"",R.Ab)},e.prototype.closeOverlayer=function(){this.emit(R.AbCloseLayer,"",R.Ab)},e.prototype.getAllVars=function(e){this.emit(R.AbAllVars,e,R.Ab)},e.prototype.destoryInstace=function(){this.destroy||(this.destroy=!0,this.off(R.TokenComplete),this.emit(R.DestoryInstance))},e.prototype.destroyInstance=function(){this.destroy||(this.destroy=!0,this.off(R.TokenComplete),this.emit(R.DestoryInstance))},e.plugins=[],e}(),iY="__rangers_ab_style__";!function(e){e[e.Var=0]="Var",e[e.All=1]="All"}(iH||(iH={}));var iZ=function(){function e(){this.fetchStatus="no",this.refreshFetchStatus="complete",this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.enable_multilink=!1,this.enable_ab_visual=!1,this.editMode=!1,this.callbacks=[],this.data=null,this.changeListener=new Map,this.readyStatus=!1,this.exposureCache=[]}return e.prototype.apply=function(e,t){var i=this;if(t.enable_ab_test){this.collect=e,this.config=t;var n=t.enable_multilink,r=t.ab_channel_domain,o=t.enable_ab_visual,a=t.ab_cross,s=t.ab_cookie_domain,c=t.ab_timeout,l=r||f(D[t.channel||"cn"]),h=e.adapters.storage,u=this.collect.Types;this.types=u,this.cacheStorgae=new h(!1),this.timeout=c||3e3,this.enable_multilink=n,this.enable_ab_visual=o,this.abKey="__tea_sdk_ab_version_"+t.app_id,this.ab_cross=a,this.ab_cookie_domain=s||"",this.fetchUrl=l+"/service/2/abtest_config/",this.reportUrl=""+e.configManager.getUrl("event"),this.exposureLimit=t.exposure_limit||20,this.ab_batch_time=t.ab_batch_time||500,this.ab_user_mode=t.ab_user_mode||"user_unique_id",this.callbackMap=new Map,this.collect.on(u.TokenChange,function(e){"uuid"===e&&i.readyStatus&&(i.clearCache(),i.fetchAB())}),this.collect.on(u.TokenReset,function(e){"uuid"===e&&i.readyStatus&&(i.clearCache(),i.fetchAB())}),this.collect.on(u.AbVar,function(e){var t=e.name,n=e.defaultValue,r=e.callback;i.getVar(t,n,r)}),this.collect.on(u.AbAllVars,function(e){i.getAllVars(e)}),this.collect.on(u.AbConfig,function(e){var t=e.params,n=e.callback;i.getABconfig(t,n)}),this.collect.on(u.AbExternalVersion,function(e){i.setExternalAbVersion(e)}),this.collect.on(u.AbOpenLayer,function(){i.openOverlayer()}),this.collect.on(u.AbCloseLayer,function(){i.closeOverlayer()}),this.collect.on(u.AbVersionChangeOn,function(e){i.changeListener.set(e,e)}),this.collect.on(u.AbVersionChangeOff,function(e){i.changeListener.get(e)&&i.changeListener.delete(e)}),this.loadMode(),(this.enable_ab_visual||this.enable_multilink)&&this.openOverlayer(this.config.multilink_timeout_ms||500),this.checkLocal(),this.ready("ab"),this.readyStatus||(this.fetchAB(),this.readyStatus=!0),this.collect.emit(u.AbReady)}},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var i=this.collect.hook._hooksCache[e];if(!Object.keys(i).length)return;var n=function(e){i[e].length&&i[e].forEach(function(i){t.collect.hook.emit(e,i)})};for(var r in i)n(r)}},e.prototype.loadMode=function(){var e=function(){try{return JSON.parse(atob(window.name))||void 0}catch(e){return}}(),t="";if(e){var i=e.scenario,n=e.href;i?(this.editMode=!0,t=i):n&&(-1!==n.indexOf("datatester")||-1!==n.indexOf("visual-editor"))&&(this.editMode=!0,t="visual-editor")}this.enable_ab_visual&&"visual-editor"===t&&this.collect.destoryInstace()},e.prototype.checkLocal=function(){var e=this.getABCache(),t=e.ab_version,i=e.ab_ext_version,n=e.ab_version_multilink,r=e.data,o=this.checkFromUrl();o?this.mulilinkVersions.push(o):this.mulilinkVersions=n||[],this.extVersions=i||[],this.versions=t||[],this.data=r;var a=this.versions.concat(this.extVersions);this.enable_multilink&&(a=a.concat(this.mulilinkVersions)),this.configVersions(a.join(","))},e.prototype.checkFromUrl=function(){var e=z(window.location.href);return e&&e.vid?e.vid:""},e.prototype.updateVersions=function(){var e=this.extVersions.length?this.versions.concat(this.extVersions):this.versions;this.enable_multilink&&(e=e.concat(this.mulilinkVersions)),this.configVersions(e.join(",")),this.updateABCache(),this.changeListener.size>0&&this.changeListener.forEach(function(t){"function"==typeof t&&t(e)})},e.prototype.configVersions=function(e){this.collect.configManager.setAbVersion(e)},e.prototype.getVar=function(e,t,i){if(!e)throw Error("getVar key must not be empty");if(void 0===t&&console.warn("getVar defaultValue is illegal, please check!"),"function"!=typeof i)throw Error("getVar callback must be a function");var n={name:e,defaultValue:t,callback:i,type:iH.Var};this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8C03\u7528GetVar",level:"info",time:Date.now(),data:e,infoType:"cus"}),"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealVar(n,e):(this.callbackMap.get(e),this.callbackMap.set(e,n))},e.prototype.getRealVar=function(e,t){var i=e.name,n=e.defaultValue,r=e.callback,o=this.data;if(o){var a=o[i];if(a&&u(a)){var s=o[i].vid;return"$ab_url"===t?this.mulilinkVersions.includes(s)||this.mulilinkVersions.push(s):this.versions.includes(s)||this.versions.push(s),this.updateVersions(),this.fechEvent(s,t||i,n,r,a.val),void this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK\u6267\u884CGetVar\uFF0C\u5E76\u66DD\u5149\u4E86\u5B9E\u9A8C"+i,level:"info",time:Date.now(),data:o[i],infoType:"sdk"})}this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK\u6267\u884CGerVar\u9ED8\u8BA4\u56DE\u8C03",level:"info",time:Date.now(),data:this.data,infoType:"sdk"}),r(n)}else r(n)},e.prototype.getAllVars=function(e){if("function"!=typeof e)throw Error("getAllVars callback must be a function");var t={callback:e,type:iH.All};this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8C03\u7528GetAllVars",level:"info",time:Date.now(),infoType:"cus"}),"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealAllVars(t):this.callbackMap.set("allVars",t)},e.prototype.getRealAllVars=function(e){(0,e.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{}),this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u6267\u884CGetAllVars",level:"info",time:Date.now(),data:this.data,infoType:"sdk"})},e.prototype.fechEvent=function(e,t,i,n,r){try{if(this.config.disable_track_event||!e)return;var o=this.collect.configManager.get(),a=o.header,s=o.user,c=this.getABCache(),h=s[this.ab_user_mode]||s.user_unique_id;if(c&&c.uuid&&c.uuid!==h)return;var u={event:"abtest_exposure",ab_sdk_version:""+e,params:JSON.stringify({app_id:this.config.appId,ab_url:"$ab_url"===t?i:window.location.href}),local_time_ms:Date.now()};a.custom=JSON.stringify(a.custom);var d={events:[u],user:s,header:a};this.reportExposure(d,t),n&&n(r)}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message,infoType:"sdk"})}},e.prototype.reportExposure=function(e,t){var i=this;this.exposureCache.push(e),this.reportTimeout&&clearTimeout(this.reportTimeout),this.exposureCache.length>=this.exposureLimit?this.report(t):this.reportTimeout=setTimeout(function(){i.report(t),clearTimeout(i.reportTimeout)},this.ab_batch_time)},e.prototype.report=function(e){var t=this;this.collect.requestManager.useRequest({url:this.reportUrl,data:this.exposureCache,timeout:2e4,useBeacon:"$ab_url"===e,zip:!0}),this.exposureCache.forEach(function(e){t.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_EVENT,info:"\u66DD\u5149\u57CB\u70B9\u4E0A\u62A5\u6210\u529F",time:Date.now(),data:[e],code:200,status:"success",infoType:"sdk"})}),this.collect.emit(this.types.AbVerify,this.exposureCache),this.exposureCache=[]},e.prototype.setExternalAbVersion=function(e){this.extVersions=[e],this.updateVersions()},e.prototype.getABconfig=function(e,t){var i=Object.keys(e);i&&i.length&&this.collect.configManager.set(e),this.fetchAB(t)},e.prototype.get=function(e){if(this.ab_cross){var t=this.cacheStorgae.getCookie(e,this.ab_cookie_domain);return t?JSON.parse(t):{}}return this.cacheStorgae.getItem(e)},e.prototype.set=function(e,t){this.ab_cross?this.cacheStorgae.setCookie(e,t,2592e6,this.ab_cookie_domain):this.cacheStorgae.setItem(e,t),this.collect.configManager.setAbCache(t)},e.prototype.getABCache=function(e){var t={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date,uuid:""};return t=this.get(this.abKey)||t,e?t[e]:t},e.prototype.updateABCache=function(){var e=this.getABCache();e.ab_version_multilink=this.mulilinkVersions,e.ab_ext_version=this.extVersions,e.ab_version=this.versions,e.timestamp=Date.now(),this.set(this.abKey,e)},e.prototype.setAbCache=function(e){var t=this.getABCache();t.data=this.data,t.uuid=e,t.timestamp=Date.now(),this.set(this.abKey,t)},e.prototype.clearCache=function(){this.refreshFetchStatus="ing",this.data={},this.extVersions=[],this.mulilinkVersions=[],this.versions=[],this.collect.configManager.clearAbCache()},e.prototype.openOverlayer=function(e){var t=this;if(function(){if(!document.getElementById(iY)){var e="body { opacity: 0 !important; }",t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.id=iY,i.type="text/css",i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e)),t.appendChild(i)}}(),e)var i=setTimeout(function(){t.closeOverlayer(),clearTimeout(i)},e)},e.prototype.closeOverlayer=function(){var e;(e=document.getElementById(iY))&&e.parentElement.removeChild(e)},e.prototype.fetchComplete=function(e,t){var i=this;try{if(e&&"[object Object]"==Object.prototype.toString.call(e)){var n=this.collect.configManager.get().user;if(t&&t!==n.user_unique_id)return;this.data=e,this.setAbCache(t);var r=[];Object.keys(e).forEach(function(t){var i=e[t].vid;i&&r.push(i)}),this.versions=this.versions.filter(function(e){return r.includes(e)});var o=e.$ab_url,a=e.$ab_modification;if(a&&a.val&&this.enable_ab_visual){if(this.collect.destroy)return;this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884C\u53EF\u89C6\u5316\u5B9E\u9A8C",level:"info",logType:"fetch",time:Date.now(),infoType:"sdk",data:{$ab_modification:a}})}else if(o&&this.enable_multilink){this.mulilinkVersions=this.mulilinkVersions.filter(function(e){return r.includes(e)}),this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884C\u591A\u94FE\u63A5\u5B9E\u9A8C",level:"info",logType:"fetch",time:Date.now(),infoType:"sdk",data:{$ab_url:o}});var s=o.val,c=o.vid;s&&c&&this.getVar("$ab_url",s,function(){i.editMode||(s!==window.location.href?setTimeout(function(){if(!i.collect.destroy){var e=""+s;e=-1===e.indexOf("http")?"https://"+e:e,b(e).host!==location.host?e=e+"&vid="+c:window.history.replaceState("","",e),window.location.href=e}},100):i.closeOverlayer())})}this.updateVersions()}else this.closeOverlayer();this.callbackMap.forEach(function(e){return i[e.type===iH.Var?"getRealVar":"getRealAllVars"](e,"")})}catch(e){}},e.prototype.fetchAB=function(e){var t=this,i=this.collect.configManager.get(),r={header:n(n(n({aid:this.config.app_id},i.user||{}),i.header||{}),{ab_sdk_version:this.collect.configManager.getAbVersion(),ab_url:window.location.href})};this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u53D1\u8D77AB\u5B9E\u9A8C\u8BF7\u6C42",level:"info",logType:"fetch",time:Date.now(),data:r,infoType:"sdk"});var o=i.user[this.ab_user_mode]||i.user.user_unique_id;this.collect.requestManager.useRequest({url:this.fetchUrl,data:r,success:function(i){t.fetchStatus="complete",t.refreshFetchStatus="complete";var n=i.data;"success"===i.message?(t.fetchComplete(n,o),e&&e(n)):(t.fetchComplete(null,o),e&&e(null)),t.collect.emit(t.types.AbComplete,n),t.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5B9E\u9A8C\u8BF7\u6C42\u6210\u529F",level:"info",logType:"fetch",time:Date.now(),data:n,infoType:"sdk"})},fail:function(){t.fetchStatus="complete",t.refreshFetchStatus="complete",t.fetchComplete(null,o),t.collect.emit(t.types.AbTimeout),e&&e(null),t.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5B9E\u9A8C\u8BF7\u6C42\u7F51\u7EDC\u5F02\u5E38",level:"error",logType:"fetch",time:Date.now(),infoType:"sdk"})},timeout:this.timeout})},e}(),i1=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;t.event_verify_url&&("string"==typeof t.event_verify_url?(this.collect=e,this.url=t.event_verify_url+"/v1/list_test",e.on(e.Types.SubmitBefore,function(e){i.verify(e)}),e.on(e.Types.AbVerify,function(e){i.verify(e)})):console.log("please use correct et_test url"))},e.prototype.verify=function(e){this.collect.requestManager.useBeacon({url:this.url,data:e}),this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_EVENT,info:"SDK Report ByteIo Verify Request",time:Date.now(),data:e,code:200,status:"success",verifyType:!0})},e}();function i0(e,t,i){if(void 0===t&&(t="list"),!e)return!1;if(t&&"list"===t){if(["LI","TR","DL"].includes(e.nodeName)||e.dataset&&e.dataset.hasOwnProperty("teaIdx")||e.hasAttribute&&e.hasAttribute("data-tea-idx"))return!0}else if(["A","BUTTON"].includes(e.nodeName)||e.dataset&&e.dataset.hasOwnProperty("teaContainer")||e.hasAttribute&&e.hasAttribute("data-tea-container")||i&&e.hasAttribute&&e.hasAttribute(i))return!0;return!1}var i2=function(e,t){return!!i8(e,t)};function i4(e,t){for(var i=e;i&&!i0(i,"container",t.container_attr||"");){if("HTML"===i.nodeName||"BODY"===i.nodeName)return e;i=i.parentElement}return i||e}var i5=function(e){if(!e)return"";var t="";try{e.textContent?t=e.textContent.trim().replace(/\s+/g,","):e.innerText&&(t=e.innerText.trim().replace(/\s+/g,",")),"input"!==e.tagName&&"INPUT"!==e.tagName||(t=e.value||"")}finally{return t}};function i6(e){try{for(var t=e;t&&t.parentNode;){if(t.hasAttribute("data-tea-ignore")||t.classList&&t.classList.contains("applog-web-devtools-con"))return!0;if("HTML"===t.nodeName||"body"===t.nodeName)break;t=t.parentNode}return!1}catch(e){return!1}}var i3=function(e,t){return e.hasAttribute?e.hasAttribute(t):e.attributes?!(!e.attributes[t]||!e.attributes[t].specified):void 0},i8=function(e,t){if("string"==typeof t)return i3(e,t);if(d(t)){for(var i=!1,n=0;n<t.length;n++)if(i3(e,t[n])){i=!0;break}return i}},i9=function(e,t){var i={};if("string"==typeof t)i3(e,t)&&(i[t]=e.getAttribute(t));else if(d(t))for(var n=0;n<t.length;n++)i3(e,t[n])&&(i[t[n]]=e.getAttribute(t[n]));return i};function i7(e){var t=[];if(!e)return{element_path:"",positions:[]};for(;null!==e.parentElement;)t.push(e),e=e.parentElement;var i=[],n=[];return t.forEach(function(e){var t=function(e){if(null===e)return{str:"",index:0};var t=0,i=e.parentElement;if(i)for(var n=i.children,r=0;r<n.length&&n[r]!==e;r++)n[r].nodeName===e.nodeName&&t++;return{str:[e.nodeName.toLowerCase(),i0(e,"list")?"[]":""].join(""),index:t}}(e),r=t.str,o=t.index;i.unshift(r),n.unshift(o)}),{element_path:"/"+i.join("/"),positions:n}}var ne=function(){function e(e,t){this.maxDuration=432e5,this.aliveDTime=6e4,this.options={aliveName:"predefine_page_alive",params:{},container:null},this.focusState=!0,this.collect=e,this.config=t,this.pageStartTime=Date.now(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,u(t.enable_stay_duration)&&(this.options=Object.assign(this.options,t.enable_stay_duration)),this.hard=this.options.mode&&"hard"===this.options.mode,this.focusState=document.hasFocus(),this.aliveDTime=this.options.aliveTime||6e4}return e.prototype.setParams=function(e,t,i){this.set_path=e,this.set_url=i,this.set_title=t},e.prototype.enable=function(e,t,i){this.url_path=e,this.url=i,this.title=t,this.disableCallback=this.enablePageAlive(),this.hard&&(this.removeMode=this.hardMode())},e.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now(),this.hard&&this.removeMode&&this.removeMode()},e.prototype.sendEvent=function(e,t){void 0===t&&(t=!1);var i=t?this.aliveDTime:Date.now()-this.sessionStartTime;if(!(i<0||i>this.aliveDTime||Date.now()-this.pageStartTime>this.maxDuration)&&(!t||"hidden"!==document.visibilityState)&&(!this.hard||this.focusState)){var r=n({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),duration:i,is_support_visibility_change:v(),startTime:this.sessionStartTime,hidden:document.visibilityState,leave:e,mode:this.hard?"hard":"normal",focusState:this.focusState,aliveType:this.options.container?"dom":"page"},this.options.params);this.options.container&&(r=Object.assign(r,{element_path:i7(this.options.container).element_path,aliveType:this.options.container?"dom":"page"})),this.collect.beconEvent(this.options.aliveName,r),this.sessionStartTime=Date.now()}},e.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},e.prototype.setUpTimer=function(){var e=this;return this.timerHandler&&clearInterval(this.timerHandler),setInterval(function(){Date.now()-e.sessionStartTime>e.aliveDTime&&e.sendEvent(!1,!0)},1e3)},e.prototype.visibilitychange=function(){"hidden"===this.getDisplayStatus()?this.timerHandler&&(clearInterval(this.timerHandler),this.sendEvent(!1)):"visible"===this.getDisplayStatus()&&(this.sessionStartTime=Date.now(),this.timerHandler=this.setUpTimer())},e.prototype.getDisplayStatus=function(){if(!this.options.container)return document.visibilityState;try{var e=window.getComputedStyle(this.options.container);return"none"!==e.display&&"hidden"!==e.visibility&&"0"!==e.opacity?"visible":"hidden"}catch(e){return"visible"}},e.prototype.beforeunload=function(){document.hidden||this.sendEvent(!0)},e.prototype.muition=function(){var e=this;new MutationObserver(function(t){t.forEach(function(t){e.visibilitychange()})}).observe(this.options.container,{attributes:!0,attributeFilter:["style"]})},e.prototype.enablePageAlive=function(){var e=this;this.timerHandler=this.setUpTimer();var t=this.visibilitychange.bind(this),i=this.beforeunload.bind(this);return this.options.container?this.muition():document.addEventListener("visibilitychange",t),window.addEventListener("pagehide",i),function(){e.beforeunload(),document.removeEventListener("visibilitychange",t),window.removeEventListener("pagehide",i)}},e.prototype.hardMode=function(){var e=this,t=function(){e.timerHandler&&(clearInterval(e.timerHandler),e.sendEvent(!1)),e.focusState=!1},i=function(){e.focusState=!0,e.sessionStartTime=Date.now(),e.timerHandler=e.setUpTimer()};return window.addEventListener("blur",t),window.addEventListener("focus",i),function(){window.removeEventListener("blur",t),window.removeEventListener("focus",i)}},e}(),nt=function(){function e(e,t){var i=this;this.maxDuration=432e5,this.aliveDTime=6e4,this.options={closeName:"predefine_page_close",params:{}},this.focusState=!0,this.visibilitychange=function(){"hidden"===document.visibilityState?i.activeEndTime=Date.now():"visible"===document.visibilityState&&(i.activeEndTime&&(i.totalTime+=i.activeEndTime-i.activeStartTime,i.activeTimes+=1),i.activeEndTime=void 0,i.activeStartTime=Date.now())},this.beforeunload=function(){if(i.totalTime+=(i.activeEndTime||Date.now())-i.activeStartTime,i.config.autotrack)try{window.sessionStorage.setItem("_tea_cache_duration",JSON.stringify({duration:i.totalTime,page_title:document.title||location.pathname}))}catch(e){}i.sendEventPageClose()},this.collect=e,this.config=t,this.maxDuration=t.maxDuration||t.max_duration||864e5,this.pageStartTime=Date.now(),u(t.enable_stay_duration)&&(this.options=Object.assign(this.options,t.enable_stay_duration)),this.hard=this.options.mode&&"hard"===this.options.mode,this.focusState=document.hasFocus(),this.resetData()}return e.prototype.setParams=function(e,t,i){this.set_path=e,this.set_url=i,this.set_title=t},e.prototype.resetParams=function(e,t,i){this.url_path=e,this.url=i,this.title=t},e.prototype.enable=function(e,t,i){this.url_path=e,this.url=i,this.title=t,this.disableCallback=this.enablePageClose(),this.hard&&(this.removeMode=this.hardMode())},e.prototype.disable=function(){this.disableCallback(),this.hard&&this.removeMode&&this.removeMode(),this.resetData()},e.prototype.resetData=function(){this.activeStartTime=void 0===this.activeStartTime?this.pageStartTime:Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0,this.resetParams(location.pathname,document.title,location.href)},e.prototype.sendEventPageClose=function(){var e=Date.now()-this.pageStartTime;this.totalTime<0||e<0||this.totalTime>=this.maxDuration||this.hard&&!this.focusState||(this.collect.beconEvent(this.options.closeName,n({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),active_times:this.activeTimes,duration:this.totalTime,total_duration:e,is_support_visibility_change:v(),mode:this.hard?"hard":"normal",focusState:this.focusState},this.options.params)),this.pageStartTime=Date.now(),this.resetData())},e.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},e.prototype.enablePageClose=function(){var e=this,t=this.visibilitychange.bind(this),i=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",t),window.addEventListener("pagehide",i),function(){e.beforeunload(),document.removeEventListener("visibilitychange",t),window.removeEventListener("pagehide",i)}},e.prototype.hardMode=function(){var e=this,t=function(){e.focusState=!1},i=function(){e.focusState=!0};return window.addEventListener("blur",t),window.addEventListener("focus",i),function(){window.removeEventListener("blur",t),window.removeEventListener("focus",i)}},e}(),ni=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;if(this.collect=e,this.config=t,this.config.enable_stay_duration){this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this.pageAlive=new ne(e,t),this.pageClose=new nt(e,t);var n=this.collect.Types;this.collect.on(n.DestoryInstance,function(){i.disable()}),this.collect.on(n.ResetStay,function(e){var t=e.url_path,n=e.title,r=e.url;i.resetStayDuration(t,n,r)}),this.collect.on(n.RouteChange,function(e){e.init||t.disable_route_report||i.resetStayDuration()}),this.collect.on(n.SetStay,function(e){var t=e.url_path,n=e.title,r=e.url;i.setStayParmas(t,n,r)}),this.enable(this.url_path,this.title,this.url),this.ready(n.Stay),this.collect.emit(n.StayReady)}},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var i=this.collect.hook._hooksCache[e];if(!Object.keys(i).length)return;var n=function(e){i[e].length&&i[e].forEach(function(i){t.collect.hook.emit(e,i)})};for(var r in i)n(r)}},e.prototype.enable=function(e,t,i){this.pageAlive.enable(e,t,i),this.pageClose.enable(e,t,i)},e.prototype.disable=function(){this.pageAlive.disable(),this.pageClose.disable()},e.prototype.setStayParmas=function(e,t,i){void 0===e&&(e=""),void 0===t&&(t=""),void 0===i&&(i=""),this.pageAlive.setParams(e,t,i),this.pageClose.setParams(e,t,i),this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884C resetStayParams",level:"info",time:Date.now(),data:{url_path:e,title:t,url:i}})},e.prototype.reset=function(e,t,i){this.disable(),this.enable(e,t,i)},e.prototype.resetStayDuration=function(e,t,i){this.reset(e,t,i),this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884C resetStayDuration",level:"info",time:Date.now(),data:{url_path:e,title:t,url:i}})},e}(),nn=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;this.collect=e,this.config=t,this.duration=6e4,this.reportUrl=e.configManager.getDomain()+"/profile/list";var n=e.Types;this.eventCheck=new B(e,t),this.cache={},this.collect.on(n.ProfileSet,function(e){i.setProfile(e)}),this.collect.on(n.ProfileSetOnce,function(e){i.setOnceProfile(e)}),this.collect.on(n.ProfileUnset,function(e){i.unsetProfile(e)}),this.collect.on(n.ProfileIncrement,function(e){i.incrementProfile(e)}),this.collect.on(n.ProfileAppend,function(e){i.appendProfile(e)}),this.collect.on(n.ProfileClear,function(){i.cache={}}),this.ready(n.Profile)},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var i=this.collect.hook._hooksCache[e];if(!Object.keys(i).length)return;var n=function(e){i[e].length&&i[e].forEach(function(i){t.collect.hook.emit(e,i)})};for(var r in i)n(r)}},e.prototype.report=function(e,t){void 0===t&&(t={});try{if(this.config.disable_track_event)return;var i=[];i.push(this.collect.processEvent(e,t));var n=this.collect.eventManager.merge(i);this.collect.requestManager.useRequest({url:this.reportUrl,data:n}),this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u6210\u529F",time:Date.now(),data:n,code:200,status:"success"})}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.setProfile=function(e){var t=this.formatParams(e);t&&Object.keys(t).length&&(this.pushCache(t),this.report("__profile_set",n(n({},t),{profile:!0})))},e.prototype.setOnceProfile=function(e){var t=this.formatParams(e,!0);t&&Object.keys(t).length&&(this.pushCache(t),this.report("__profile_set_once",n(n({},t),{profile:!0})))},e.prototype.incrementProfile=function(e){e?this.report("__profile_increment",n(n({},e),{profile:!0})):console.warn("please check the params, must be object!!!")},e.prototype.unsetProfile=function(e){if(e){var t={};t[e]="1",this.report("__profile_unset",n(n({},t),{profile:!0}))}else console.warn("please check the key, must be string!!!")},e.prototype.appendProfile=function(e){if(e){var t={};for(var i in e)"string"==typeof e[i]||"Array"===Object.prototype.toString.call(e[i]).slice(8,-1)?t[i]=e[i]:console.warn("please check the value of param: "+i+", must be string or array !!!");Object.keys(t).length&&this.report("__profile_append",n(n({},t),{profile:!0}))}else console.warn("please check the params, must be object!!!")},e.prototype.pushCache=function(e){var t=this;Object.keys(e).forEach(function(i){t.cache[i]={val:t.clone(e[i]),timestamp:Date.now()}})},e.prototype.formatParams=function(e,t){var i=this;void 0===t&&(t=!1);try{if(!e||"[object Object]"!==Object.prototype.toString.call(e))return void console.warn("please check the params type, must be object !!!");var n={};for(var r in e)"string"==typeof e[r]||"number"==typeof e[r]||"Array"===Object.prototype.toString.call(e[r]).slice(8,-1)?n[r]=e[r]:console.warn("please check the value of params:"+r+", must be string,number,Array !!!");var o=Object.keys(n);if(!o.length||!this.eventCheck.checkEventParams(n))return;var a=Date.now();return o.filter(function(n){var r=i.cache[n];return t?!r:!(r&&i.compare(r.val,e[n])&&a-r.timestamp<i.duration)}).reduce(function(e,t){return e[t]=n[t],e},{})}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message}),console.log("error")}},e.prototype.compare=function(e,t){try{return JSON.stringify(e)===JSON.stringify(t)}catch(e){return this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message}),!1}},e.prototype.clone=function(e){try{return JSON.parse(JSON.stringify(e))}catch(t){return this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message}),e}},e.prototype.unReady=function(){console.warn("sdk is not ready, please use this api after start")},e}(),nr=function(){function e(){var e=this;this.setInterval=function(){e.clearIntervalFunc=y(function(){e.isSessionhasEvent&&e.endCurrentSession()},e.sessionInterval)},this.clearInterval=function(){e.clearIntervalFunc&&e.clearIntervalFunc()}}return e.prototype.apply=function(e,t){var i=this;if(this.collect=e,!t.disable_heartbeat){this.sessionInterval=6e4,this.startTime=0,this.lastTime=0,this.setInterval();var n=this.collect.Types;this.collect.on(n.SessionResetTime,function(){i.process()})}},e.prototype.endCurrentSession=function(){this.collect.event("_be_active",{start_time:this.startTime,end_time:this.lastTime,url:window.location.href,referrer:window.document.referrer,title:document.title||location.pathname}),this.isSessionhasEvent=!1,this.startTime=0},e.prototype.process=function(){this.isSessionhasEvent||(this.isSessionhasEvent=!0,this.startTime=+new Date);var e=this.lastTime||+new Date;this.lastTime=+new Date,this.lastTime-e>this.sessionInterval&&(this.clearInterval(),this.endCurrentSession(),this.setInterval())},e}(),no=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;t.channel_domain||t.disable_track_event||t.disable_sdk_monitor||(this.collect=e,this.config=t,this.url=e.configManager.getUrl("event"),this.collect.on(e.Types.Ready,function(){i.sdkOnload()}),this.collect.on(e.Types.SubmitError,function(e){var t=e.type,n=e.eventData,r=e.errorCode,o=e.response;"f_data"===t&&i.sdkError(n,r,o)}),this.collect.on(e.Types.SDKInnerError,function(e){var t=e.type,n=e.eventData,r=e.errorCode,o=e.msg;i.sdkInnerError(t,n,r,o)}))},e.prototype.sdkOnload=function(){var e=this;try{var t=this.collect.configManager.get(),i=t.header,n=t.user,r=i.app_id,o=i.app_name,a=i.sdk_version,s=n.web_id,c={events:[{event:"onload",params:JSON.stringify({app_id:r,app_name:o||"",sdk_version:a,sdk_type:"npm",sdk_config:this.config,sdk_desc:"TOC",url:location.href}),local_time_ms:Date.now()}],user:{user_unique_id:s},header:{}};setTimeout(function(){e.collect.requestManager.useRequest({url:e.url,data:[c],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})},16)}catch(e){}},e.prototype.sdkError=function(e,t,i){var n=this;try{var r=e[0],o=r.user,a=r.header,s=[];e.forEach(function(e){e.events.forEach(function(e){s.push(e)})});var c={events:s.map(function(e){return{event:"on_error",params:JSON.stringify({type:"sdk_event_error",error_code:t,app_id:a.app_id,app_name:a.app_name||"",error_event:e.event,sdk_version:a.sdk_version,local_time_ms:e.local_time_ms,tea_event_index:Date.now(),params:e.params,header:a,user:o,err_msg:i.m||""}),local_time_ms:Date.now()}}),user:{user_unique_id:o.user_unique_id},header:{}};setTimeout(function(){n.collect.requestManager.useRequest({url:n.url,data:[c],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})},16)}catch(e){}},e.prototype.sdkInnerError=function(e,t,i,n){var r=this;try{var o=t[0],a=o.user,s=o.header,c=[];t.forEach(function(e){e.events.forEach(function(e){c.push(e)})});var l={events:c.map(function(t){return{event:"on_error",params:JSON.stringify({type:e,error_code:i,app_id:s.app_id,app_name:s.app_name||"",error_event:t.event,sdk_version:s.sdk_version,local_time_ms:t.local_time_ms,tea_event_index:Date.now(),params:t.params,header:s,user:a,ua:window.navigator.userAgent,err_msg:n}),local_time_ms:Date.now()}}),user:a,header:{}};setTimeout(function(){r.collect.requestManager.useRequest({url:r.url,data:[l],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})},16)}catch(e){}},e}(),na=function(e){if(e.children.length){var t=e.children;return![].slice.call(t).some(function(e){return e.children.length>0})}return!0},ns=function(e){if("svg"===e.tagName.toLowerCase())return!0;for(var t=e.parentElement,i=!1;t;)"svg"===t.tagName.toLowerCase()?(t=null,i=!0):t=t.parentElement;return i};function nc(e,t){if(window.innerHeight,window.innerWidth,1!==e.nodeType||!t.svg&&ns(e)||["HTML","BODY"].includes(e.tagName.toUpperCase()))return!1;var i=e;return"none"!==i.style.display&&(!!i0(i,"container",t.container_attr||"")||!!(function(e,t){for(var i=e,n=!1;i&&!i0(i,"container",t.container_attr||"");){if("HTML"===i.nodeName||"BODY"===i.nodeName)return n;i=i.parentElement}return!0}(i,t)||na(i)||t.svg))}var nl=function(){function e(e,t,i){var r=this;this.statistics=!1,this.pageView=!1,this.clickEvent=function(e){nc(e.target,r.options)&&r.eventHandel({eventType:"dom",eventName:"click"},e)},this.changeEvent=function(e){r.eventHandel({eventType:"dom",eventName:"change"},e)},this.submitEvent=function(e){r.eventHandel({eventType:"dom",eventName:"submit"},e)},this.getPageViewEvent=function(e,t){t&&"pushState"===t&&r.eventHandel({eventType:"dom",eventName:"beat"},n({beat_type:0},e)),r.eventHandel({eventType:"dom",eventName:"page_view"},e)},this.getPageLoadEvent=function(e){r.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:e})},this.config=i.getConfig().eventConfig,this.collect=t,this.options=e,this.beatTime=e.beat,this.domContainer=e.container||document}return e.prototype.init=function(e){this.eventHandel=e;var t=this.config.mode;this.addListener(t)},e.prototype.addListener=function(e){var t=this;if("proxy-capturing"===e){if(this.config.click&&(d(this.domContainer)?this.domContainer.forEach(function(e){e.addEventListener("click",t.clickEvent,!0)}):this.domContainer.addEventListener("click",this.clickEvent,!0)),this.config.pv){this.collect.on("route-change",function(e){var i=e.config,n=e.name;t.getPageViewEvent(i,n),t.pageView=!0});var i=setTimeout(function(){t.pageView||(t.getPageViewEvent(t.getDefaultConfig()),t.pageView=!0,clearTimeout(i))},2e3)}if(this.config.beat){try{"complete"===document.readyState?this.beatEvent(this.beatTime):window.addEventListener("load",function(){t.beatEvent(t.beatTime)});var n=0,r=null;window.addEventListener("scroll",function(){clearTimeout(r),r=setTimeout(o,500),n=document.documentElement.scrollTop||document.body.scrollTop});var o=function(){(document.documentElement.scrollTop||document.body.scrollTop)==n&&t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(e){}try{var a=window.performance&&window.performance.getEntriesByType("paint");if(a&&a.length){new PerformanceObserver(function(e){var i=e.getEntries(),n=i[i.length-1],r=n.renderTime||n.loadTime;t.statistics||(t.getPageLoadEvent(r),t.statistics=!0)}).observe({entryTypes:["largest-contentful-paint"]});var s=setTimeout(function(){t.statistics||(t.getPageLoadEvent(a[0].startTime||0),t.statistics=!0,clearTimeout(s))},2e3)}else this.getPageLoadEvent(0)}catch(e){this.getPageLoadEvent(0)}}}},e.prototype.removeListener=function(){var e=this;d(this.domContainer)?this.domContainer.forEach(function(t){t.removeEventListener("click",e.clickEvent,!0)}):this.domContainer.removeEventListener("click",this.clickEvent,!0)},e.prototype.beatEvent=function(e){var t,i=this;try{this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3}),this.beatTime&&(t=setInterval(function(){i.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})},e)),_(function(){i.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),i.beatTime&&clearInterval(t)})}catch(e){}},e.prototype.getDefaultConfig=function(){return{is_html:1,url:location.href,referrer:document.referrer,page_key:location.href,refer_page_key:document.referrer,page_title:document.title||location.pathname,page_manual_key:"",refer_page_manual_key:"",refer_page_title:"",page_path:location.pathname,page_host:location.host}},e}(),nh={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},nu=function(){function e(e,t){this.config=e,this.config.eventConfig=Object.assign(this.config.eventConfig,t)}return e.prototype.getConfig=function(){return this.config},e.prototype.setConfig=function(e){return this.config=e},e}();function nd(e,t,i,n){var r={},o=function(e){if(e){var t=e.getBoundingClientRect(),i=t.width,n=t.height;return{left:t.left,top:t.top,element_width:i,element_height:n}}}(t=i4(t,i)),a=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var i=e.clientX,n=e.clientY,r=t.left,o=t.top;return{touch_x:Math.floor(i-r>=0?i-r:0),touch_y:Math.floor(n-o>=0?n-o:0)}}(e,o),s=o.element_width,c=o.element_height,l=a.touch_x,h=a.touch_y,u=i7(t),d=u.element_path,p=u.positions,f=function(e,t){var i=i4(e,t),n=[];return function e(t){var i=function(e){var t="";return 3===e.nodeType?t=e.textContent.trim():e.dataset&&e.dataset.hasOwnProperty("teaTitle")||e.hasAttribute("ata-tea-title")?t=e.getAttribute("data-tea-title"):"INPUT"===e.nodeName&&["button","submit"].includes(e.getAttribute("type"))?t=e.getAttribute("value"):"IMG"===e.nodeName&&e.getAttribute("alt")&&(t=e.getAttribute("alt")),t.slice(0,200)}(t);if(i&&-1===n.indexOf(i)&&n.push(i),t.childNodes.length>0)for(var r=t.childNodes,o=0;o<r.length;o++)8!==r[o].nodeType&&e(r[o])}(i),n}(t,i),g=window.performance.timing.navigationStart,_=Date.now()-g,m=p.map(function(e){return""+e}),v=null;if(window.TEAVisualEditor&&window.TEAVisualEditor.getOriginXpath&&(v=window.TEAVisualEditor.getOriginXpath({xpath:d,positions:m})),r.element_path=v&&v.xpath||d,r.positions=v&&v.positions||m,n&&!n.text&&(r.texts=f,r.element_title=t.getAttribute("data-tea-title")||t.getAttribute("title")||i5(t)),r.element_id=t.getAttribute("id")||"",r.element_class_name=t.getAttribute("class")||"",r.element_type=t.nodeType,r.element_width=Math.floor(s),r.element_height=Math.floor(c),r.touch_x=l,r.touch_y=h,r.page_manual_key="",r.elememt_manual_key="",r.since_page_start_ms=_,r.page_start_ms=g,r.page_path=location.pathname,r.page_host=location.host,i.track_attr&&i2(t,i.track_attr)){var y=i9(t,i.track_attr);for(var b in y)r[b]=y[b]}if(i.custom_attr)try{if(i2(t,i.custom_attr)){y=i9(t,i.custom_attr),b=decodeURIComponent(y[i.custom_attr]);var z=JSON.parse(b);if(Object.keys(z))for(var w in z)r[w]=z[w]}}catch(e){console.log("custom attr error")}var k=i4(t,i);return"A"===k.tagName&&(r.href=k.getAttribute("href")),"IMG"===t.tagName&&(r.src=t.getAttribute("src")),r}var np=function(e,t,i,r,o){return n(n({event:e},nd(t,i,r,o)),{is_html:1,page_key:window.location.href,page_title:document.title})},nf=function(){function e(e,t){this.ignore={text:!1},this.initConfig=e,this.options=t,this.eventName=t&&"tea"===t.custom?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat",static:"__bav_page_statistics",exposure:"__bav_page_exposure",scroll:"__bav_slide"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat",static:"bav2b_page_statistics",exposure:"bav2b_exposure",scroll:"$bav2b_slide"},t&&!1===t.text&&(this.ignore.text=!0),t&&t.exposure&&t.exposure.eventName&&(this.eventName.exposure=t.exposure.eventName)}return e.prototype.handleEvent=function(e,t){try{if(i6(e.target))return null;var i="bav2b_click";switch(t){case"click":return i=e.target.getAttribute("data-applog-click-event")||this.eventName.click||"",np(i,e,e.target,this.options,this.ignore);case"exposure":return i=e.target.getAttribute("data-applog-exposure-event")||this.eventName.exposure||"",np(i,e,e.target||e,this.options,this.ignore);case"change":return n(n({},np(i="bav2b_change",e,e.target,this.options)),function(e,t){try{if("bav2b_change"===e)return t.hasAttribute("data-tea-track")?{value:t.value}:{}}catch(e){return{}}}(i,e.target));case"submit":return np(i="bav2b_submit",e,e.target,this.options)}}catch(e){return console.error(e),null}},e.prototype.handleViewEvent=function(e){e.event=this.eventName.page,e.page_title=document.title,e.page_total_width=window.innerWidth,e.page_total_height=window.innerHeight;try{var t=window.sessionStorage.getItem("_tea_cache_duration");if(t){var i=JSON.parse(t);e.refer_page_duration_ms=i?i.duration:""}e.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,e.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,e.page_start_ms=window.performance.timing.navigationStart}catch(e){console.log("page event error "+JSON.stringify(e))}return e},e.prototype.handleStatisticsEvent=function(e){var t={};t.event=this.eventName.static,t.is_html=1,t.page_key=location.href,t.refer_page_key=document.referrer||"",t.page_title=document.title,t.page_manual_key=this.initConfig.autotrack.page_manual_key||"",t.refer_page_manual_key="";try{var i=e.lcp,n=window.performance.timing,r=n.loadEventEnd-n.navigationStart;t.page_init_cost_ms=parseInt(i||(r>0?r:0)),t.page_start_ms=n.navigationStart}catch(e){console.log("page_statistics event error "+JSON.stringify(e))}return t},e.prototype.handleBeadtEvent=function(e){e.event=this.eventName.beat,e.page_key=window.location.href,e.is_html=1,e.page_title=document.title,e.page_manual_key=this.initConfig.autotrack.page_manual_key||"";try{e.page_viewport_width=window.innerWidth,e.page_viewport_height=window.innerHeight,e.page_total_width=document.documentElement.scrollWidth,e.page_total_height=document.documentElement.scrollHeight,e.scroll_width=document.documentElement.scrollLeft+window.innerWidth,e.scroll_height=document.documentElement.scrollTop+window.innerHeight,e.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,e.page_start_ms=window.performance.timing.navigationStart}catch(e){console.log("beat event error "+JSON.stringify(e))}return e},e.prototype.handleExposureEvent=function(e,t){if(i6(t.target))return null;var i=np(e.event||this.eventName.exposure,t,t.target||t,this.options,this.ignore);if(i.$exposure_type=e.exposureType,this.options.exposure.callback){var n=this.options.exposure.callback(i);return n||Object.keys(n).length?n:(console.warn("exposure callback must return data!"),i)}return i},e.prototype.handleScrollEvent=function(e,t){var i=np(e.event||this.eventName.scroll,t,t.target||t,this.options,this.ignore);if(i=Object.assign(i,e.params),!this.options.scroll.callback||(i=this.options.scroll.callback(i))||Object.keys(i).length)return i;console.warn("scroll callback must return data!")},e}(),ng=function(){function e(e){this.collect=e,this.eventNameList=["report_click_event","report_change_event","report_submit_event","report_exposure_event","report_page_view_event","report_page_statistics_event","report_beat_event"]}return e.prototype.send=function(e,t){var i=t.event;delete t.event,e&&"becon"===e.eventSend?this.collect.beconEvent(i,t):this.collect.event(i,t)},e.prototype.get=function(e,t){fetch(e,Object.assign({headers:{"content-type":"application/json"},method:"GET"},t))},e.prototype.post=function(e,t){fetch(e,Object.assign({headers:{"content-type":"application/json"},method:"POST"},t))},e}(),n_={},nm=[],nv=function(e){e.length&&e.forEach(function(e){nm.push(e)})};function ny(e,t,i,n){var r=e&&e.source||window.opener||window.parent,o=e&&e.origin||n||"*",a={type:t,payload:i};r.postMessage(JSON.stringify(a),o)}function nb(e){if(nm.some(function(t){return e.origin.indexOf(t)>-1})){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){t=void 0}if(t){var i=t.type,n=t.payload;n_[i]&&n_[i].forEach(function(t){"function"==typeof t&&t(e,n)})}}}var nz=!1;function nw(e,t){window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.appId=t.app_id;var i=t.channel_domain,n="";if(nv(G),i){var r=void 0,o="";try{var a=window.performance.getEntriesByType("resource");if(a&&a.length&&(a.forEach(function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(o=e.name)}),o&&(r=o.split("/"))&&r.length)){n="https:/";for(var s=2;s<r.length&&s!==r.length-1;s++)n=n+"/"+r[s];n&&n.indexOf("/5.0")&&(n=n.split("/5.0")[0]||n)}}catch(e){}}!function(e,t){var i={};if(Object.keys(e).length)for(var n in e){if("filter"===n||"autotrack"===n||"enable_stay_duration"===n)break;i[n]=e[n]}var r=e.domain;(window.opener||window.parent).postMessage({type:"tea:sdk:info",config:i,version:t},r),window.addEventListener("message",nb,!1)}(t,M);try{!function(e,t){n_[e]=n_[e]||[],n_[e].push(t)}("tea:openHeatMapCore",function(i){var n=N,r=i.data.app_id;r&&r!==t.app_id||function(e){var t=e.event,i=e.editorUrl,n=e.autoTrackInstance;nz||(nz=!0,m(i,function(){ny(t,"editorScriptloadSuccess"),n.destroy()},function(){t&&ny(t,"editorScriptloadError"),nz=!1}))}({event:i,editorUrl:n+".js?query="+Date.now(),autoTrackInstance:e})})}catch(e){console.log("openHeatMapCore error")}}var nk,nE=function(){function e(e,t){this._instance=null,this._intersection=e,this.config=t,this._intersection&&this.init()}return e.prototype.init=function(){var e=this;if(window.MutationObserver)try{if(this._instance=new MutationObserver(function(t){t.forEach(function(t){"attributes"===t.type&&e.attributeChangeObserve(t),"childList"===t.type&&e.modifyNodeObserve(t)})}),!document||!document.body)return void console.warn("please use sdk api init after body element");var t=!1!==this.config.autotrack.exposure.attributes;this._instance.observe(document.body,{childList:!0,attributes:t,subtree:!0,attributeOldValue:!1})}catch(e){console.log("your browser cannot support MutationObserver\uFF0Cso cannot report exposure event, please update")}else console.log("your browser cannot support MutationObserver\uFF0Cso cannot report exposure event, please update")},e.prototype.attributeChangeObserve=function(e){e.target.hasAttribute("data-exposure")?this.exposureAdd(e,"mutation"):this.exposureRemove(e)},e.prototype.modifyNodeObserve=function(e){var t=this;Array.prototype.forEach.call(e.addedNodes,function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t.exposureAdd(e,"intersect"),t.mapChild(e,t.exposureAdd.bind(t))}),Array.prototype.forEach.call(e.removedNodes,function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t.exposureRemove(e),t.mapChild(e,t.exposureRemove.bind(t))})},e.prototype.mapChild=function(e,t){var i=this;1===e.nodeType&&e.children.length&&Array.prototype.forEach.call(e.children,function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t(e),i.mapChild(e,t)})},e.prototype.exposureAdd=function(e,t){try{this._intersection&&this._intersection.exposureAdd(e,t)}catch(e){console.log("intersection error",JSON.stringify(e.message))}},e.prototype.exposureRemove=function(e){try{this._intersection&&this._intersection.exposureRemove(e)}catch(e){console.log("intersection error",JSON.stringify(e.message))}},e._exposure_observer=null,e}();!function(e){e[e.EXPOSURE_ONCE=0]="EXPOSURE_ONCE",e[e.LIFECYCLE_SHOW_NEW=3]="LIFECYCLE_SHOW_NEW",e[e.RESUME_FORM_PAGE=6]="RESUME_FORM_PAGE",e[e.RESUME_FORM_BACK=7]="RESUME_FORM_BACK",e[e.NOT_EXPOSURE=-1]="NOT_EXPOSURE"}(nk||(nk={}));var nS,nT=function(){function e(t,i,n){var r=this;this.backStatus=!1,this.instance=this.buildObserver(),this.collect=t,this.observeMap=e._observer_map,i.autotrack.exposure.ratio?this.ratio=i.autotrack.exposure.ratio:0===i.autotrack.exposure.ratio?this.ratio=0:this.ratio=.5,this.timeLimit=i.autotrack.exposure.stay||0,this.exposureType=nk.NOT_EXPOSURE,this.eventHandle=n,this.hashMap=new Map,this.backStatus=!1,this.lastState=null,this.collect.on("re-start-sdk",function(){r.visibilitychange()}),this.addListen()}return e.prototype.buildObserver=function(){var t=this;if(e._observer_instance)return console.log("your browser cannot support IntersectionObserver\uFF0C so cannot report exposure event, please update"),null;if(window.IntersectionObserver){for(var i=[],n=0;n<=1;n+=.01)i.push(n);i.push(1);try{e._observer_instance=new IntersectionObserver(function(e){e.forEach(function(e){var i=e.target.observeId,n=t.observeMap.get(i),r=(e.target,e.isIntersecting,e.intersectionRatio);if(n.intersectionRatio=r,r<=.1&&(e.target.backStatus=!1),t.observeMap.set(i,n),r<t.ratio)return n.isIntersecting=!1,n.added=!1,n.exposured=!1,n.startTime=Date.now(),void t.observeMap.set(i,n);if(!n.added){if(n.startTime=Date.now(),n.added=!0,n.isIntersecting=!0,t.timeLimit){var o=setTimeout(function(){try{if(n.isIntersecting&&!n.exposured&&t.observeMap.get(i)){var r=t.observeMap.get(i).intersectionRatio;t.exposureEvent(e,r,i,n)}}catch(e){console.log("IntersectionObserver setTimeout error\uFF0Cmsg: "+JSON.stringify(e))}},t.timeLimit);n.wait=o}t.observeMap.set(i,n)}Date.now()-n.startTime>=t.timeLimit&&!n.exposured&&t.exposureEvent(e,r,i,n)})},{threshold:i})}catch(e){console.log("IntersectionObserver error\uFF0Cmsg: "+JSON.stringify(e))}return e._observer_instance}return console.log("your browser cannot support IntersectionObserver\uFF0C so cannot report exposure event, please update"),null},e.prototype.exposureAdd=function(e,t){var i="mutation"===t?e.target:e,n=i.observeId,r=Q();if(n||this.observeMap.has(n)){var o=this.observeMap.get(n);if(o&&i!==o.instance)this.unobserve(i),this.observeMap.delete(n),i.observeId=r,i.visible=!1,this.observeMap.set(r,{instance:i.cloneNode(!0),isIntersecting:!1}),this.observe(i);else{if(!0===i.visible)return;this.handleBoundingExposure(i)}}else i.observeId=r,i.visible=!1,this.observeMap.set(r,{instance:i.cloneNode(!0),isIntersecting:!1}),this.observe(i)},e.prototype.exposureRemove=function(e){this.observeMap.has(e.observeId)&&(this.observeMap.delete(e.observeId),this.unobserve(e),e.observeId="",e.visible=!1)},e.prototype.exposureEvent=function(e,t,i,n){if(t>=this.ratio){if("0"===e.target.style.opacity||"hidden"===e.target.style.visibility||!0===n.exposured)return;n.startWait&&clearTimeout(n.startWait);var r=e.target.getAttribute("data-exposure-event");this.eventHandle({eventType:"dom",eventName:"exposure",event:r,exposureType:this.getExposureType(e.target)},e),e.target.visible=!0,e.target.hasExposure=!0,n.startTime=Date.now(),n.exposured=!0}else n.startTime=Date.now(),n.exposured=!1;this.observeMap.set(i,n)},e.prototype.observe=function(e){this.instance&&this.instance.observe(e)},e.prototype.unobserve=function(e){this.instance&&this.instance.unobserve(e)},e.prototype.getExposureDomToExposure=function(){var e=this;Array.prototype.forEach.call(document.querySelectorAll("[data-exposure]"),function(t){e.handleBoundingExposure(t)})},e.prototype.visibilitychange=function(){var e=this,t=null;"visible"===document.visibilityState?this.timeLimit?t=setTimeout(function(){e.getExposureDomToExposure()},this.timeLimit):this.getExposureDomToExposure():(clearTimeout(t),this.customType=void 0)},e.prototype.handleBoundingExposure=function(e){if(this.getBoundingRatio(e)>=this.ratio){e.visible=!0;var t=e.getAttribute&&e.getAttribute("data-exposure-event");this.eventHandle({eventType:"dom",eventName:"exposure",event:t,exposureType:this.customType||nk.RESUME_FORM_BACK},e)}},e.prototype.getBoundingRatio=function(e){var t=e.getBoundingClientRect(),i=t.top,n=t.left,r=t.width,o=t.height,a=window.innerWidth||document.documentElement.clientWidth,s=window.innerHeight||document.documentElement.clientHeight;return i>=0&&n>=0&&i<=s&&n<=a?(r>a?a:r)*(s-i)/(r*o):0},e.prototype.getExposureType=function(e){return e.visible?!1!==e.backStatus&&(this.backStatus||this.customType||2===window.performance.navigation.type)?this.exposureType=nk.RESUME_FORM_PAGE:this.exposureType=nk.LIFECYCLE_SHOW_NEW:(e.hasExposure,!1!==e.backStatus&&(this.backStatus||this.customType||2===window.performance.navigation.type)?this.exposureType=nk.RESUME_FORM_PAGE:this.exposureType=nk.EXPOSURE_ONCE),this.exposureType},e.prototype.addListen=function(){var e=this;this.collect.on("set-exposure-type",function(t){e.customType=t});var t,i,n,r,a=this.visibilitychange.bind(this);if(t=document,i="visibilitychange",n=a,r=!1,t.addEventListener?t.addEventListener(i,n,r):t.attachEven?t.attachEven("on"+i,n):t["on"+i]=n,window.addEventListener("hashchange",function(t){var i=e.hashMap.get(t.oldURL);i&&location.href===i.prev?(e.backStatus=!0,e.exposureType=nk.RESUME_FORM_PAGE):(e.backStatus=!1,e.hashMap.set(location.href,{current:t.newURL,prev:t.oldURL}))}),this.collect.bridgeReport){var s=window.history.pushState;history.pushState=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];"function"==typeof history.onpushstate&&history.onpushstate({state:t});var r=s.call.apply(s,o([history,t],i));return e.lastState=t,r};var c=history.replaceState;history.replaceState=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];"function"==typeof history.onreplacestate&&history.onreplacestate({state:t});var r=c.call.apply(c,o([history,t],i));return e.lastState=t,r}}else this.collect.on("STATE_CHANGE",function(t){e.lastState=t});return window.addEventListener("popstate",function(t){var i=t.state;i&&i.current&&e.lastState&&e.lastState.back&&i.current===e.lastState.back?(e.backStatus=!0,e.exposureType=nk.RESUME_FORM_PAGE):e.backStatus=!1}),function(){!function(e,t,i,n){e.addEventListener?e.removeEventListener(t,i,n):e.attachEven&&e.detachEven("on"+t,i)}(document,"visibilitychange",a,!1)}},e._observer_instance=null,e._observer_map=new Map,e}(),nx=function(){function e(e,t,i){t.autotrack&&t.autotrack.exposure&&(this._intersection=new nT(e,t,i),this._observer=new nE(this._intersection,t),this._intersection&&this._observer?this.initObserver():console.log("your browser version cannot support exposure event, please update~"))}return e.prototype.initObserver=function(){var e=this;Array.prototype.forEach.call(document.querySelectorAll("[data-exposure]"),function(t){e._intersection.exposureAdd(t,"intersect")})},e}();!function(e){e[e.SCROLL_UP=1]="SCROLL_UP",e[e.SCROLL_DOWN=2]="SCROLL_DOWN",e[e.SCROLL_LEFT=3]="SCROLL_LEFT",e[e.SCROLL_RIGHT=4]="SCROLL_RIGHT",e[e.NOT_SCROLL=-1]="NOT_SCROLL"}(nS||(nS={}));var nI,nO=function(){function e(e,t){this.distance=30,e.autotrack&&e.autotrack.scroll&&(e.autotrack.scroll.distance&&(this.distance=e.autotrack.scroll.distance),this.eventHandle=t,this.addLinstenr(),this.mutation())}return e.prototype.addLinstenr=function(){var e=this;Array.prototype.forEach.call(document.querySelectorAll("[data-scroll]"),function(t){e.scrollHandle(t)})},e.prototype.mutation=function(){var e=this;if(window.MutationObserver)try{var t=new MutationObserver(function(t){t.forEach(function(t){"childList"===t.type&&e.modifyNodeObserve(t)})});if(!document||!document.body)return void console.warn("please use sdk api init after body element");t.observe(document.body,{childList:!0,attributes:!0,subtree:!0,attributeOldValue:!1})}catch(e){console.log("your browser cannot support MutationObserver")}else console.log("your browser cannot support MutationObserver")},e.prototype.modifyNodeObserve=function(e){var t=this;Array.prototype.forEach.call(e.addedNodes,function(e){1===e.nodeType&&e.hasAttribute("data-scroll")&&t.scrollHandle(e),t.mapChild(e,t.scrollHandle.bind(t))}),Array.prototype.forEach.call(e.removedNodes,function(e){1===e.nodeType&&e.hasAttribute("data-scroll")&&t.scrollHandle(e,"remove"),t.mapChild(e,t.scrollHandle.bind(t))})},e.prototype.mapChild=function(e,t){var i=this;1===e.nodeType&&e.children.length&&Array.prototype.forEach.call(e.children,function(e){1===e.nodeType&&e.hasAttribute("data-scroll")&&t(e),i.mapChild(e,t)})},e.prototype.scrollHandle=function(e,t){var i=this;try{var n=e.scrollTop,r=e.scrollLeft,o=null,a=0,s=0,c=function(t){clearTimeout(o),o=setTimeout(function(){var o=e.scrollTop,u=e.scrollLeft,d=t.target&&t.target.getAttribute("data-scroll-event")||"";1===h||2===h?o===c&&(s=c-n,Math.abs(s)>=i.distance&&i.distance&&i.eventHandle({eventType:"dom",eventName:"scroll",event:d,params:{$direction:h,$offsetY:s,$offsetX:a}},t)):3!==h&&4!==h||u===l&&(a=l-r,Math.abs(a)>=i.distance&&i.distance&&i.eventHandle({eventType:"dom",eventName:"scroll",event:d,params:{$direction:h,$offsetY:s,$offsetX:a}},t)),n=c,r=l},100);var c=e.scrollTop,l=e.scrollLeft,h=nS.NOT_SCROLL;c>n?h=nS.SCROLL_DOWN:c<n?h=nS.SCROLL_UP:l>r?h=nS.SCROLL_LEFT:l<r&&(h=nS.SCROLL_RIGHT)};return"remove"===t?e.removeEventListener("scroll",c,!1):e.addEventListener("scroll",c,!1),function(){e.removeEventListener("scroll",c,!1)}}catch(e){console.warn("scroll event error",JSON.stringify(e))}},e}(),nA={hashTag:!1,impr:!1},nD=function(){function e(){}return e.prototype.apply=function(e,t){if(this.autoTrackStart=!1,this.collect=e,this.config=t,t.autotrack){var i=e.Types;this.ready(i.Autotrack),this.collect.emit(i.AutotrackReady)}},e.prototype.ready=function(e){this.collect.set(e);var t=this.config.autotrack;t=Object.assign(nA,t="object"==typeof t?t:{}),this.destroyed=!1,this.options=t,this.Config=new nu(nh,this.options),this.Exposure=new nx(this.collect,this.config,this.handle.bind(this)),this.Scroll=new nO(this.config,this.handle.bind(this)),this.Listener=new nl(t,this.collect,this.Config),this.EventHandle=new nf(this.config,t),this.Request=new ng(this.collect),this.autoTrackStart=!0,this.init(),nw(this,this.config)},e.prototype.init=function(){this.Listener.init(this.handle.bind(this));try{"base"===this.collect.loadType&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(e){}},e.prototype.handle=function(e,t){try{if(this.config.autotrack.collect_url&&!this.config.autotrack.collect_url())return}catch(e){}"dom"===e.eventType&&this.handleDom(e,t)},e.prototype.handleDom=function(e,t){try{var i,n=e.eventName;if("click"===n||"change"===n||"submit"===n)(i=this.EventHandle.handleEvent(t,n))&&this.Request.send({eventType:"custom"},i);else if("page_view"===n||"page_statistics"===n){var r=void 0;(r="page_view"===n?this.EventHandle.handleViewEvent(t):this.EventHandle.handleStatisticsEvent(t))&&this.Request.send({eventType:"custom"},r)}else if("beat"===n){var o=this.EventHandle.handleBeadtEvent(t),a=e.eventSend;o&&this.Request.send({eventType:"custom",eventSend:a},o)}else"exposure"===n?(i=this.EventHandle.handleExposureEvent(e,t))&&this.Request.send({eventType:"custom"},i):"scroll"===n&&(i=this.EventHandle.handleScrollEvent(e,t))&&this.Request.send({eventType:"custom"},i)}catch(e){console.log("handel dom event error "+JSON.stringify(e))}},e.prototype.destroy=function(){if(!this.autoTrackStart)return console.warn("engine is undefined, make sure you have called autoTrack.start()");this.autoTrackStart=!1,this.Listener.removeListener()},e}();!function(e){e.Net="net",e.FailNet="f_net",e.FailData="f_data"}(nI||(nI={}));var nC={pv:["predefine_pageview"],sdk:["_be_active","predefine_page_alive","predefine_page_close","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append"],autotrack:["bav2b_click","bav2b_page","bav2b_beat","bav2b_page_statistics","__bav_click","__bav_page","__bav_beat","__bav_page_statistics"]},nM=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;if(t.app_id&&t.enable_tracer&&!t.disable_track_event){this.limit={pv:1,sdk:3,autotrack:3,log:3},this.errorCode={f_net:0,f_data:0},this.tracerCache=new Map,this.collect=e,this.appid=t.app_id,this.reportUrl=e.configManager.getUrl("event");var n=this.collect.Types;this.collect.on(n.Event,function(){i.addCount("log")}),this.collect.on(n.SubmitError,function(e){var t=e.type,n=e.eventDate,r=e.errorCode,o=e.response;i.addErrorCount(n,t,r,o)}),this.listener(),this.collect.emit(n.TracerReady)}},e.prototype.addCount=function(e,t,i){void 0===t&&(t="net"),void 0===i&&(i=1);try{this.tracerCache||(this.tracerCache=new Map);var n=void 0;if(this.tracerCache.has(e))(r=this.tracerCache.get(e)).has(t)?(n=r.get(t).params.count,n++,r.set(t,this.processTracer(n,e,t))):(n=i,r.set(t,this.processTracer(i,e,t)));else{var r=new Map;n=i,r.set(t,this.processTracer(i,e,t)),this.tracerCache.set(e,r)}"net"===t&&n>=this.limit[e]&&this.report(!1)}catch(e){console.log(e)}},e.prototype.addErrorCount=function(e,t,i,n){var r=this;try{if(e&&e.length){var o=e[0].events;o&&o.length&&("f_data"===t?(n&&n.hasOwnProperty("sc")?this.addCount("log",t,o.length-n.sc):this.addCount("log",t,o.length),this.errorCode[t]=i):o.forEach(function(e){var n="log";for(var o in nC)if(-1!==nC[o].indexOf(e.event)){n=o;break}r.addCount(n,t,1),r.errorCode[t]=i}))}}catch(e){}},e.prototype.report=function(e){if(this.tracerCache){var t=[];this.tracerCache.forEach(function(e){console.log(e),e.forEach(function(e){t.push(e)})}),t&&t.length&&this.sendTracer(t,e)}},e.prototype.sendTracer=function(e,t){try{var i=this.collect.eventManager.merge(e);this.collect.requestManager.useRequest({url:this.reportUrl,data:i,useBeacon:t}),this.tracerCache=null}catch(e){}},e.prototype.processTracer=function(e,t,i){var n={count:e,state:i,key:t,params_for_special:"applog_trace",aid:this.appid,platform:"web",_staging_flag:1,sdk_version:M};"f_net"!==i&&"f_data"!==i||(n.errorCode=this.errorCode[i]);var r=this.collect.processEvent("applog_trace",n);if(r&&r.event)return delete r.is_bav,r},e.prototype.listener=function(){var e=this;document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&e.leavePage()}),_(function(){e.leavePage()})},e.prototype.leavePage=function(){this.report(!0)},e}(),nN=function(){function e(){this.retryWaitTime=3e3,this.retryStatus=!1,this.retryCacheStatus=!1}return e.prototype.apply=function(e,t){var i=this;if(t.enable_storage&&!t.disable_storage&&(this.collect=e,this.config=t,!this.collect.destroy)){var n=e.Types,r=e.adapters.storage;this.storage=new r(!1),this.eventUrl=this.collect.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+t.app_id,this.storageNum=t.storage_num||50,this.retryNum=t.retry_num||3,this.retryInterval=1e3,e.on(n.SubmitError,function(e){"f_data"!==e.type&&i.storeData(e)}),e.on(n.Ready,function(){i.checkStorage()})}},e.prototype.retryRightNow=function(e){var t=this;if(this.retryStatus)this.errorCache.push(e);else{var i=0;this.retryStatus=!0;var n=setInterval(function(){if(3===i)return t.storeData(t.errorCache),t.retryStatus=!1,void clearInterval(n);var r=e.eventData;t.fetchData(r,function(){t.retryStatus=!1,clearInterval(n),t.retryCacheStatus&&t.errorCache.splice(0,1),t.errorCache.length&&(t.retryCacheStatus=!0,t.retryRightNow(t.errorCache[0]))},function(){i++})},this.retryInterval)}},e.prototype.storeData=function(e){var t=this.storage.getItem(this.eventKey),i=e.eventData;Object.keys(t).length!==this.storageNum&&(t[Date.now()]=i,this.storage.setItem(this.eventKey,t))},e.prototype.checkStorage=function(){var e=this;try{if(!window.navigator.onLine)return;var t=this.storage.getItem(this.eventKey);if(!t||!Object.keys(t).length)return;var i={events:[{event:"ontest",params:{app_id:this.config.app_id},local_time_ms:Date.now()}],user:{user_unique_id:this.collect.configManager.get("web_id")},header:{}};this.fetchData([i],function(){var i=JSON.parse(JSON.stringify(t)),n=function(n){e.fetchData(t[n],function(){delete i[n],e.storage.setItem(e.eventKey,i)},function(){},!1)};for(var r in t)n(r)},function(){console.log("network error\uFF0Ccompensate report fail")},!0)}catch(e){console.warn("error check storage")}},e.prototype.fetchData=function(e,t,i,n){this.collect.requestManager.useRequest({url:this.eventUrl,data:e,timeout:3e4,success:t,fail:i,app_key:n?"566f58151b0ed37e":""})},e}(),nG="undefined"!=typeof window?(window.LogPluginObject||(window.LogPluginObject={}),window.LogPluginObject):null,nB=function(){function e(){}return e.prototype.apply=function(e,t){this._plugin={},this.config=t,this.collect=e,this.channel=t.channel||"cn",this.loadExtend()},e.prototype.loadExtend=function(){var e=this;try{this.collect.remotePlugin.forEach(function(t,i){if("sdk"===t)if(iF.hasOwnProperty(i)){var n=iF[i].object,r=iF[i].src[e.channel]+"?query="+Date.now();e.exist(i,n,r)}else console.warn("your "+i+" is not exist\uFF0Cplease check plugin name");else"object"==typeof t&&(t.src?e.exist(i,t.call,t.src):e.process(i,t.instance,"INSTANCE"))})}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message}),console.log("load extend error")}},e.prototype.exist=function(e,t,i){var n=this;nG[t]?(this.process(e,nG[t]),console.log("\u5DF2\u6709"+e+"\u63D2\u4EF6\uFF0C\u907F\u514D\u91CD\u590D\u52A0\u8F7D~")):this.loadPlugin(e,i,function(){n.process(e,nG[t]),console.log(" %c %s %s %s","color: yellow; background-color: black;","\u2013","load plugin:"+e+" success","-")},function(){console.log(" %c %s %s %s","color: red; background-color: yellow;","\u2013","load plugin:"+e+" error","-")})},e.prototype.process=function(e,t,i){try{if(i){var n=new t;n.apply&&n.apply(this.collect,this.config),console.log("excude "+e+" success")}else t&&t(this.collect,this.config)}catch(t){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message}),console.log("excude "+e+" error, message:"+t.message)}},e.prototype.loadPlugin=function(e,t,i,n){var r=this;try{var o=document.createElement("script");o.src=t,this._plugin[e]||(this._plugin[e]=[]),this._plugin[e].push(i),o.onerror=function(){n(t)},o.onload=function(){r._plugin[e].forEach(function(e){e()})},document.getElementsByTagName("head")[0].appendChild(o)}catch(e){this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e}(),nR=function(){function e(){this.autotrack=!1,this.spa=!1,this.cache={},this.allowHash=!1}return e.prototype.apply=function(e,t){if(t.spa||t.autotrack){var i=e.Types;this.collect=e,this.config=t,this.appid=t.app_id,this.allowHash=t.allow_hash,this.fncArray=new Map,this.setKey(),this.setLocation(),this.hack(),this.init(),this.listener(),e.emit(i.RouteReady)}},e.prototype.setKey=function(){var e=this.collect.adapters.storage;this.storage=new e(!1),this.cache_key="__tea_cache_refer_"+this.appid,this.cache={refer_key:"",refer_title:document.title||location.pathname,refer_manual_key:"",routeChange:!1},this.config.autotrack&&"object"==typeof this.config.autotrack&&this.config.autotrack.page_manual_key&&(this.cache.refer_manual_key=this.config.autotrack.page_manual_key),this.storage.setItem(this.cache_key,this.cache)},e.prototype.hack=function(){var e=this,t=window.history.pushState;history.pushState=function(i){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];"function"==typeof history.onpushstate&&history.onpushstate({state:i});var a=t.call.apply(t,o([history,i],n));if(e.collect.sdkStop||e.collect.destroy)return a;if(!(e.lastLocation===location.href||e.config.disable_spa_query&&e.pathEquel())){e.setReferCache(e.lastLocation);var s=e.getPopStateChangeEventData();return e.lastLocation=location.href,e.sendPv(s,"pushState"),a}};var i=history.replaceState;history.replaceState=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];"function"==typeof history.onreplacestate&&history.onreplacestate({state:t});var a=i.call.apply(i,o([history,t],n));if(e.collect.sdkStop||e.collect.destroy)return a;if(!(e.lastLocation===location.href||e.config.disable_spa_query&&e.pathEquel())){e.setReferCache(e.lastLocation);var s=e.getPopStateChangeEventData();return e.lastLocation=location.href,e.sendPv(s),a}}},e.prototype.setLocation=function(){"undefined"!=typeof window&&(this.lastLocation=window.location.href)},e.prototype.getLocation=function(){return this.lastLocation},e.prototype.pathEquel=function(){try{return new URL(this.lastLocation).origin+new URL(this.lastLocation).pathname===new URL(location.href).origin+new URL(location.href).pathname}catch(e){return!1}},e.prototype.init=function(){var e=this.getPopStateChangeEventData();this.collect.emit("route-change",{config:e,init:!0})},e.prototype.listener=function(){var e=this;window.addEventListener("hashchange",function(t){if(!e.collect.sdkStop&&!e.collect.destroy&&e.lastLocation!==window.location.href&&(!e.config.disable_spa_query||!e.pathEquel())&&e.allowHash){e.setReferCache(e.lastLocation),e.lastLocation=window.location.href;var i=e.getPopStateChangeEventData();e.sendPv(i)}}),window.addEventListener("popstate",function(t){if(!e.collect.sdkStop&&!e.collect.destroy&&!(e.lastLocation===window.location.href||e.config.disable_spa_query&&e.pathEquel())){e.setReferCache(e.lastLocation),e.lastLocation=window.location.href;var i=e.getPopStateChangeEventData();e.sendPv(i)}})},e.prototype.getPopStateChangeEventData=function(){var e=this.pageConfig();return e.is_back=0,e},e.prototype.pageConfig=function(){try{var e=this.storage.getItem(this.cache_key)||{},t=!1,i=this.storage.getItem("__tea_cache_first_"+this.appid);return t=!i||1!=i,{is_html:1,url:location.href,referrer:this.handleRefer(),page_key:location.href,refer_page_key:this.handleRefer(),page_title:document.title||location.pathname,page_manual_key:this.config.autotrack&&this.config.autotrack.page_manual_key||"",refer_page_manual_key:e&&e.refer_manual_key||"",refer_page_title:e&&e.refer_title||"",page_path:location.pathname,page_host:location.host,is_first_time:""+t}}catch(e){return this.collect.emit(l.DEBUGGER_MESSAGE,{type:l.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message}),{}}},e.prototype.sendPv=function(e,t){this.collect.emit("route-change",{config:e,init:!1})},e.prototype.handleRefer=function(){var e="";try{var t=this.storage.getItem(this.cache_key)||{};e=t.routeChange?t.refer_key:this.collect.configManager.get("referrer")}catch(t){e=document.referrer}return e},e.prototype.setReferCache=function(e){var t=this.storage.getItem(this.cache_key)||{};t.refer_key=e,t.routeChange=!0,this.storage.setItem(this.cache_key,t)},e}();iX.usePlugin(nB,"extend"),iX.usePlugin(i1,"et"),iX.usePlugin(iZ,"ab"),iX.usePlugin(ni,"stay"),iX.usePlugin(nD,"autotrack"),iX.usePlugin(nn,"profile"),iX.usePlugin(nN,"retry"),iX.usePlugin(nr,"heartbeat"),iX.usePlugin(no,"monitor"),iX.usePlugin(nR,"route"),iX.usePlugin(nM,"tracer"),new iX("default");var nU=iX}}]);