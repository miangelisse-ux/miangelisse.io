"use strict";(window.webpackChunkweb=window.webpackChunkweb||[]).push([["24545"],{763886:function(){},666742:function(e,t,a){a.d(t,{i:()=>l});var n=a(580182),r=a(911620);class l extends n.w{type=r.V.KeyZ;keydown(e,t){t.actionManager.redo()}enable(e){return e.shiftKey&&e.metaKey}}},366216:function(e,t,a){a.d(t,{$:()=>l});var n=a(580182),r=a(911620);class l extends n.w{type=r.V.KeyZ;keydown(e,t){t.actionManager.undo()}enable(e){return e.metaKey}}},166413:function(e,t,a){a.d(t,{l:()=>n});class n{keyMap=new Map;constructor(e,t){this.keyMap=e,this.keyConfigEnum=t}enable(e){return!0}getKey(e,t){let a=this.keyMap.get(e.code);if(!a)return null;for(let n of a)if(n.enable(e,t))return n;return null}registerHotkey(e,t,a=!0){let{keyMap:n}=this,r=n.get(e);if(r)return void(a?r.unshift(t):r.push(t));n.set(e,[t])}registerHotkeys(e,t){let{keyMap:a}=this;a.set(e,t)}}},911620:function(e,t,a){var n,r;a.d(t,{V:()=>n}),(r=n||(n={})).Enter="Enter",r.Escape="Escape",r.Space="Space",r.Delete="Delete",r.Backspace="Backspace",r.ArrowLeft="ArrowLeft",r.ArrowRight="ArrowRight",r.ArrowUp="ArrowUp",r.ArrowDown="ArrowDown",r.Period="Period",r.Comma="Comma",r.Tab="Tab",r.SquareBracketLeft="BracketLeft",r.SquareBracketRight="BracketRight",r.KeyA="KeyA",r.KeyB="KeyB",r.KeyC="KeyC",r.KeyD="KeyD",r.KeyE="KeyE",r.KeyF="KeyF",r.KeyG="KeyG",r.KeyH="KeyH",r.KeyI="KeyI",r.KeyJ="KeyJ",r.KeyK="KeyK",r.KeyL="KeyL",r.KeyM="KeyM",r.KeyN="KeyN",r.KeyO="KeyO",r.KeyP="KeyP",r.KeyQ="KeyQ",r.KeyR="KeyR",r.KeyS="KeyS",r.KeyT="KeyT",r.KeyU="KeyU",r.KeyV="KeyV",r.KeyW="KeyW",r.KeyX="KeyX",r.KeyY="KeyY",r.KeyZ="KeyZ",r.Digit0="Digit0",r.Digit1="Digit1",r.Digit2="Digit2",r.Digit3="Digit3",r.Digit4="Digit4",r.Digit5="Digit5",r.Digit6="Digit6",r.Digit7="Digit7",r.Digit8="Digit8",r.Digit9="Digit9",r.Minus="Minus",r.Plus="Plus"},489597:function(e,t,a){var n,r;a.d(t,{k:()=>n}),(r=n||(n={})).Default="default",r.Text="text",r.ViewOnly="viewOnly"},90854:function(e,t,a){var n=a(166413);a(489597),a(192657),n.l},192657:function(e,t,a){a.d(t,{C:()=>tn});var n,r,l=a(911620),i=a(666742),o=a(366216),s=a(580182);class c extends s.w{enable(e){return!0}type=l.V.Enter;keydown(e,t){}}var d=a(455360),p=a(944379),g=a(541340),u=a(266096);class x extends s.w{type=l.V.ArrowRight;keydown(e,t){if(e.preventDefault(),t.auxiliaryManager.selectManager.selectNodes.size>0){let a=[...t.auxiliaryManager.selectManager.selectNodes],n=u.e.getMoveNodes(a,t),r=e.shiftKey?10:1;t.actionManager.execAction(new p.M),t.actionManager.execAction(new g.d({idList:a.map(e=>e.id),dx:r,dy:0})),u.e.updateLines(n,t),t.actionManager.execAction(new d.q)}t.renderManager.addAuxiliaryDrawTask()}enable(e){return!0}}class y extends s.w{type=l.V.ArrowLeft;keydown(e,t){if(e.preventDefault(),t.auxiliaryManager.selectManager.selectNodes.size>0){let a=[...t.auxiliaryManager.selectManager.selectNodes],n=u.e.getMoveNodes(a,t),r=e.shiftKey?-10:-1;t.actionManager.execAction(new p.M),t.actionManager.execAction(new g.d({idList:a.map(e=>e.id),dx:r,dy:0})),u.e.updateLines(n,t),t.actionManager.execAction(new d.q)}t.renderManager.addAuxiliaryDrawTask()}enable(e){return!0}}class f extends s.w{type=l.V.ArrowUp;keydown(e,t){if(e.preventDefault(),t.auxiliaryManager.selectManager.selectNodes.size>0){let a=[...t.auxiliaryManager.selectManager.selectNodes],n=u.e.getMoveNodes(a,t),r=e.shiftKey?-10:-1;t.actionManager.execAction(new p.M),t.actionManager.execAction(new g.d({idList:a.map(e=>e.id),dx:0,dy:r})),u.e.updateLines(n,t),t.actionManager.execAction(new d.q)}t.renderManager.addAuxiliaryDrawTask()}enable(e){return!0}}class h extends s.w{type=l.V.ArrowDown;keydown(e,t){if(e.preventDefault(),t.auxiliaryManager.selectManager.selectNodes.size>0){let a=[...t.auxiliaryManager.selectManager.selectNodes],n=u.e.getMoveNodes(a,t),r=e.shiftKey?10:1;t.actionManager.execAction(new p.M),t.actionManager.execAction(new g.d({idList:a.map(e=>e.id),dx:0,dy:r})),u.e.updateLines(n,t),t.actionManager.execAction(new d.q)}t.renderManager.addAuxiliaryDrawTask()}enable(e){return!0}}class M{}class w{}var T=a(988382),A=a(589405),P=a(175005),b=a(457063),m=a(797615);class S extends w{enable(e,t){return e.type===m.Jq.Table&&0!==e.tableStatus.selectCols.length}handle(e,t){let{tableStatus:a,tableProps:n}=e,r=[],l=[...a.selectCols];for(let e=0;e<n.rows.length;e++)for(let t of a.selectCols)r.push(n.cellMatrix.getCell(e,t));let i=T.P.getSelectedCellsWithText(r);if(0===i.length){t.actionManager.execAction(P.O.selectNode([])),t.actionManager.execAction(new A.O({id:e.id,indexList:l,isRow:!1}));let n=0===Math.min(...a.selectCols)?0:Math.min(...a.selectCols)-1;t.actionManager.execAction(P.O.selectTableRowCol(e.id,[n]))}else{let a=[];for(let e of i){let t=e.textProps.clone();t.text="";let n={i:e.i,j:e.j,textProps:t};a.push(n)}let n={id:e.id,infos:a};t.actionManager.execAction(new b.g(n))}}}class K extends w{enable(e,t){return e.type===m.Jq.Table&&0!==e.tableStatus.selectRows.length}handle(e,t){let{tableStatus:a,tableProps:n}=e,r=[],l=[...a.selectRows];for(let e=0;e<n.columns.length;e++)for(let t of a.selectRows)r.push(n.cellMatrix.getCell(t,e));let i=T.P.getSelectedCellsWithText(r);if(0===i.length){t.actionManager.execAction(P.O.selectNode([])),t.actionManager.execAction(new A.O({id:e.id,indexList:l,isRow:!0}));let n=0===Math.min(...a.selectRows)?0:Math.min(...a.selectRows)-1;t.actionManager.execAction(P.O.selectTableRowCol(e.id,[n],!0))}else{let a=[];for(let e of i){let t=e.textProps.clone();t.text="";let n={i:e.i,j:e.j,textProps:t};a.push(n)}let n={id:e.id,infos:a};t.actionManager.execAction(new b.g(n))}t.actionManager.execAction(new d.q)}}class C extends w{enable(e,t){return e.type===m.Jq.Table&&0!==e.tableStatus.selectCells.length}handle(e,t){let{tableStatus:a,tableProps:n}=e,r=[];for(let e of a.selectCells)r.push(n.cellMatrix.getCell(e.i,e.j));if(1===r.length){let a=r[0],{textProps:n}=a;if(!n||""===n.text){let n=T.P.getPreviousCell(e,a.i,a.j);t.actionManager.execAction(P.O.selectTableCell(e.id,[n]))}}let l=T.P.getSelectedCellsWithText(r),i=[];for(let e of l){let t=e.textProps.clone();t.text="";let a={i:e.i,j:e.j,textProps:t};i.push(a)}let o={id:e.id,infos:i};t.actionManager.execAction(new b.g(o))}}class k extends w{enable(e,t){return e.type===m.Jq.TableER&&0!==e.tableStatus.selectCells.length}handle(e,t){let{tableStatus:a,tableProps:n}=e,r=[],l=new Set;for(let e of a.selectCells)l.add(e.i);for(let e=0;e<n.columns.length;e++)for(let t of l.values())r.push(n.cellMatrix.getCell(t,e));let i=T.P.getSelectedCellsWithText(r);if(0===i.length){let a,r=Array.from(l).sort((e,t)=>e-t),i=r.includes(0),o=r.filter(e=>0!==e);if(o.length===n.rows.length-1&&(o=o.slice(1)),t.actionManager.execAction(P.O.selectNode([])),o.length>0&&t.actionManager.execAction(new A.O({id:e.id,indexList:o,isRow:!0})),i)a={i:0,j:0};else{let e=r[0];a=e>0?{i:e-1,j:0}:{i:0,j:0}}t.actionManager.execAction(P.O.selectTableCell(e.id,[a]))}else{let a=[];for(let n of i){let r=n.textProps.clone();r.text="";let l={i:n.i,j:n.j,textProps:r};a.push(l);let i={id:e.id,infos:a};t.actionManager.execAction(new b.g(i))}}}}class D extends w{enable(e,t){return e.type===m.Jq.TableER&&0!==e.tableStatus.selectRows.length}handle(e,t){let{tableStatus:a,tableProps:n}=e,r=[];for(let e=0;e<n.columns.length;e++)for(let t of a.selectRows)r.push(n.cellMatrix.getCell(t,e));let l=T.P.getSelectedCellsWithText(r);if(0===l.length){let r,l=[...a.selectRows].sort((e,t)=>e-t),i=l.includes(0),o=l.filter(e=>0!==e);if(o.length===n.rows.length-1&&(o=o.slice(1)),t.actionManager.execAction(P.O.selectNode([])),o.length>0&&t.actionManager.execAction(new A.O({id:e.id,indexList:o,isRow:!0})),i)r=0;else{let e=l[0];r=e>0?e-1:0}t.actionManager.execAction(P.O.selectTableRowCol(e.id,[r],!0))}else{let a=[];for(let n of l){let r=n.textProps.clone();r.text="";let l={i:n.i,j:n.j,textProps:r};a.push(l);let i={id:e.id,infos:a};t.actionManager.execAction(new b.g(i))}}}}var v=a(976780),V=a(513665);class N extends w{enable(e,t){return e.type===m.Jq.TableUML&&0!==e.tableStatus.selectRows.length}handle(e,t){let{tableStatus:a,tableProps:n}=e,r=[],l=e.getProp(v.d.TableUML),i=n.rows.length;for(let e=0;e<n.columns.length;e++)for(let t of a.selectRows)r.push(n.cellMatrix.getCell(t,e));let o=T.P.getSelectedCellsWithText(r);if(0===o.length){let n,r=[...a.selectRows].sort((e,t)=>e-t),o=r.includes(0),s=r.filter(e=>0!==e),c=0,d=0;for(let e of s)l.umlType===m.fq.UML_ClASS?e>0&&e<1+l.propertyNum?c++:e>l.propertyNum&&d++:d++;let p=[];for(let e of s){if(l.umlType===m.fq.UML_ClASS){let t=l.propertyNum,a=i-1-t;if(c===t&&1===e||d===a&&e===l.propertyNum+1)continue}else if(l.umlType===m.fq.UML_INTERFACE&&d===i-1&&1===e)continue;p.push(e)}if(t.actionManager.execAction(P.O.selectNode([])),p.length>0&&t.actionManager.execAction(new A.O({id:e.id,indexList:p,isRow:!0})),l.umlType===m.fq.UML_ClASS&&c>0){let a=l.propertyNum-c,n=l.clone();n.propertyNum=a;let r={id:e.id,props:[n]};t.actionManager.execAction(new V.x(r))}if(o)n=0;else{let e=r[0];n=e>0?e-1:0}t.actionManager.execAction(P.O.selectTableRowCol(e.id,[n],!0))}else{let a=[];for(let n of o){let r=n.textProps.clone();r.text="";let l={i:n.i,j:n.j,textProps:r};a.push(l);let i={id:e.id,infos:a};t.actionManager.execAction(new b.g(i))}}}}class q extends w{enable(e,t){return e.type===m.Jq.TableUML&&0!==e.tableStatus.selectCells.length}handle(e,t){let{tableStatus:a,tableProps:n}=e,r=[],l=e.getProp(v.d.TableUML),i=n.rows.length,o=new Set;for(let e of a.selectCells)o.add(e.i);for(let e=0;e<n.columns.length;e++)for(let t of o.values())r.push(n.cellMatrix.getCell(t,e));let s=T.P.getSelectedCellsWithText(r);if(0===s.length){let a,n=Array.from(o).sort((e,t)=>e-t),r=n.includes(0),s=n.filter(e=>0!==e),c=0,d=0;for(let e of s)l.umlType===m.fq.UML_ClASS?e>0&&e<1+l.propertyNum?c++:e>l.propertyNum&&d++:d++;let p=[];for(let e of s){if(l.umlType===m.fq.UML_ClASS){let t=l.propertyNum,a=i-1-t;if(c===t&&1===e||d===a&&e===l.propertyNum+1)continue}else if(l.umlType===m.fq.UML_INTERFACE&&d===i-1&&1===e)continue;p.push(e)}if(t.actionManager.execAction(P.O.selectNode([])),p.length>0&&t.actionManager.execAction(new A.O({id:e.id,indexList:p,isRow:!0})),l.umlType===m.fq.UML_ClASS&&c>0){let a=l.propertyNum-c,n=l.clone();n.propertyNum=a;let r={id:e.id,props:[n]};t.actionManager.execAction(new V.x(r))}if(r)a={i:0,j:0};else{let e=n[0];a=e>0?{i:e-1,j:0}:{i:0,j:0}}t.actionManager.execAction(P.O.selectTableCell(e.id,[a]))}else{let a=[];for(let n of s){let r=n.textProps.clone();r.text="";let l={i:n.i,j:n.j,textProps:r};a.push(l);let i={id:e.id,infos:a};t.actionManager.execAction(new b.g(i))}}}}var L=a(805433);class R extends M{handlers=[new S,new K,new C,new k,new D,new N,new q];table=null;enable(e,t){let a=t.getSelectNodes();if(1!==a.size)return!1;let n=[...a][0];return!!L.G.isTableLike(n.type)&&!!n.tableStatus.hasSelectItem()&&(this.table=n,!0)}process(e,t){if(this.table){for(let e of(t.actionManager.execAction(new p.M),t.actionManager.execAction(P.O.selectNode([])),this.handlers))if(e.enable(this.table,t)){e.handle(this.table,t),t.actionManager.execAction(new d.q);return}t.actionManager.execAction(new d.q),t.auxiliaryManager.refreshSelectStatus()}}}var I=a(298809);class E{}class B extends E{enable(e){return e.lockedStatusProps.locked}handle(e,t){}afterHandle(e){}}var O=a(140512);class U extends E{rootSet=new Set;enable(e){return e.type===m.Jq.MindMapNode}handle(e,t,a){O.R.traverseMindMapTree([e],e=>{t.unshift(e.id)}),e.mindMapParent&&e.mindMapRoot&&this.rootSet.add(e.mindMapRoot)}afterHandle(e){for(let t of this.rootSet)O.R.updateMindMapTreeAndSendMsg(t,e)}}class z extends E{enable(e){return!0}handle(e,t,a){t.push(e.id),a.nodeManager.getConnectedLines(e.id).forEach(e=>t.push(e.id))}afterHandle(e){}}class J extends M{handlers=[new B,new U,new z];enable(e,t){return!0}process(e,t){let a=[];for(let e of t.getSelectNodes())this.handleDeleteNode(e,a,t);if(0===a.length)return;let n=[];a.forEach(e=>n.push({id:e})),t.actionManager.execAction(new p.M),t.actionManager.execAction(P.O.selectNode([])),t.actionManager.execAction(new I.q(n)),this.afterHandleDelete(t),t.actionManager.execAction(new d.q),t.auxiliaryManager.refreshSelectStatus()}handleDeleteNode(e,t,a){for(let n of this.handlers)if(n.enable(e))return void n.handle(e,t,a)}afterHandleDelete(e){for(let t of this.handlers)t.afterHandle(e)}}class F extends s.w{type=l.V.Delete;processors=[new R,new J];keydown(e,t){for(let a of this.processors)if(a.enable(e,t))return void a.process(e,t)}enable(e){return!0}}var j=a(799473),H=a(797379);class G extends s.w{type=l.V.KeyR;keydown(e,t){t.toolManager.setCurrentTool(j.w.SHAPE,{shapeType:H.DY.roundRect}),t.setCursor("crosshair"),t.refresh()}enable(e){return!0}}var Y=a(202843),Z=a(268283),_=a(334918),W=a(785545);class X{static createCopy(e){let t=Array.from(e.auxiliaryManager.selectManager.selectNodes);if(0===t.length)return;let a=r.Node;if(1===t.length){let e=t[0];e.type===m.Jq.StickyNote?a=r.StickyNote:(e.type===m.Jq.Table||e.type===m.Jq.Section)&&(a=r.TableSection)}let n=e.auxiliaryManager.selectManager.getSelectBounds(),l=e.auxiliaryManager.selectManager.optionHelper;e.execAction(new p.M);let i=[],o=new Z.j;for(let n of(o.start={snapTo:0,attachType:0},o.end={snapTo:0,attachType:0},t)){let t=n.serializeTo();t.id=e.idGenerator.genId(t.type),t.zIndex=e.idGenerator.genZIndex(t.parentId),i.push(t.id);let l=t.propList.find(e=>e.type===v.d.Base);if(l&&(a===r.Node?(l.x+=$,l.y+=$):a===r.TableSection?l.x=l.x+l.width+ee:a===r.StickyNote&&(l.x=l.x+l.width+Q)),t.type===m.Jq.Connector){let e=t.propList.find(e=>e.type===v.d.LineAttach);e&&(e.start={...o.start},e.end={...o.end})}e.execAction(new _.C([{id:t.id,props:t.propList,zIndex:t.zIndex,type:t.type,parentId:t.parentId}]))}e.execAction(P.O.selectNode(i)),W.D.pasteNodeIntoContainer(e,Array.from(t)),e.execAction(new d.q),l.startWorking(i,n.minX,n.minY)}}let $=20,Q=40,ee=64;(n=r||(r={}))[n.Node=0]="Node",n[n.StickyNote=1]="StickyNote",n[n.TableSection=2]="TableSection";class et extends s.w{type=l.V.KeyD;enable(e,t){return t?e.metaKey:e.ctrlKey}keydown(e,t){e.preventDefault(),X.createCopy(t)}}class ea extends s.w{type=l.V.KeyA;keydown(e,t){let{nodeMap:a}=t.nodeManager,n=new Set;for(let[e,r]of a)r.parent===t.nodeManager.root&&n.add(r);t.auxiliaryManager.setSelectNodes(n),t.renderManager.addAuxiliaryDrawTask()}enable(e,t){return t?e.metaKey:e.ctrlKey}}class en extends s.w{type=l.V.KeyD;keydown(e,t){t.toolManager.setCurrentTool(j.w.SHAPE,{shapeType:H.DY.diamond}),t.setCursor("crosshair"),t.refresh()}enable(e){return!0}}class er extends s.w{type=l.V.KeyS;keydown(e,t){t.toolManager.setCurrentTool(j.w.SHAPE,{shapeType:H.DY.rect}),t.setCursor("crosshair"),t.refresh()}enable(e){return!0}}class el extends s.w{type=l.V.KeyD;keydown(e,t){t.toolManager.setCurrentTool(j.w.SHAPE,{shapeType:H.DY.ellipse}),t.setCursor("crosshair"),t.refresh()}enable(e){return!0}}var ei=a(937093);class eo extends s.w{type=l.V.KeyA;keydown(e,t){t.toolManager.setCurrentTool(j.w.LINE,{shapeType:ei.SP.PolyLine}),t.setCursor("crosshair"),t.refresh()}enable(e){return!0}}class es extends s.w{type=l.V.KeyL;keydown(e,t){t.toolManager.setCurrentTool(j.w.LINE,{shapeType:ei.SP.SimpleLine}),t.setCursor("crosshair"),t.refresh()}enable(e){return!0}}class ec extends s.w{type=l.V.KeyA;keydown(e,t){if(t.auxiliaryManager.selectManager.selectNodes.size>0){let e=[...t.auxiliaryManager.selectManager.selectNodes],a=u.e.getMoveNodes(e,t);t.actionManager.execAction(new p.M);let n=t.auxiliaryManager.selectManager.getSelectBounds();for(let e of a){let a=e.baseProps.clone();a.x=n.minX-e.parent.globalBaseProps.x,t.actionManager.execAction(new V.x({id:e.id,props:[a]}))}u.e.updateLines(a,t),t.actionManager.execAction(new d.q)}t.renderManager.addAuxiliaryDrawTask()}enable(e){return e.altKey}}class ed extends s.w{type=l.V.KeyD;keydown(e,t){if(t.auxiliaryManager.selectManager.selectNodes.size>0){let e=[...t.auxiliaryManager.selectManager.selectNodes],a=u.e.getMoveNodes(e,t);t.actionManager.execAction(new p.M);let n=t.auxiliaryManager.selectManager.getSelectBounds();for(let e of a){let a=e.baseProps.clone();a.x=n.maxX-e.parent.globalBaseProps.x-a.width,t.actionManager.execAction(new V.x({id:e.id,props:[a]}))}u.e.updateLines(a,t),t.actionManager.execAction(new d.q)}t.renderManager.addAuxiliaryDrawTask()}enable(e){return e.altKey}}class ep extends s.w{type=l.V.KeyW;keydown(e,t){if(t.auxiliaryManager.selectManager.selectNodes.size>0){let e=[...t.auxiliaryManager.selectManager.selectNodes],a=u.e.getMoveNodes(e,t);t.actionManager.execAction(new p.M);let n=t.auxiliaryManager.selectManager.getSelectBounds();for(let e of a){let a=e.baseProps.clone();a.y=n.minY-e.parent.globalBaseProps.y,t.actionManager.execAction(new V.x({id:e.id,props:[a]}))}u.e.updateLines(a,t),t.actionManager.execAction(new d.q)}t.renderManager.addAuxiliaryDrawTask()}enable(e){return e.altKey}}class eg extends s.w{type=l.V.KeyS;keydown(e,t){if(t.auxiliaryManager.selectManager.selectNodes.size>0){let e=[...t.auxiliaryManager.selectManager.selectNodes],a=u.e.getMoveNodes(e,t);t.actionManager.execAction(new p.M);let n=t.auxiliaryManager.selectManager.getSelectBounds();for(let e of a){let a=e.baseProps.clone();a.y=n.maxY-e.parent.globalBaseProps.y-a.height,t.actionManager.execAction(new V.x({id:e.id,props:[a]}))}u.e.updateLines(a,t),t.actionManager.execAction(new d.q)}t.renderManager.addAuxiliaryDrawTask()}enable(e){return e.altKey}}class eu extends s.w{type=l.V.KeyH;keydown(e,t){if(t.auxiliaryManager.selectManager.selectNodes.size>0){let e=[...t.auxiliaryManager.selectManager.selectNodes],a=u.e.getMoveNodes(e,t);t.actionManager.execAction(new p.M);let n=t.auxiliaryManager.selectManager.getSelectBounds();for(let e of a){let a=e.baseProps.clone();a.x=n.minX-e.parent.globalBaseProps.x-.5*a.width+.5*(n.maxX-n.minX),t.actionManager.execAction(new V.x({id:e.id,props:[a]}))}u.e.updateLines(a,t),t.actionManager.execAction(new d.q)}t.renderManager.addAuxiliaryDrawTask()}enable(e){return e.altKey}}class ex extends s.w{type=l.V.KeyV;keydown(e,t){if(t.auxiliaryManager.selectManager.selectNodes.size>0){let e=[...t.auxiliaryManager.selectManager.selectNodes],a=u.e.getMoveNodes(e,t);t.actionManager.execAction(new p.M);let n=t.auxiliaryManager.selectManager.getSelectBounds();for(let e of a){let a=e.baseProps.clone();a.y=n.minY-e.parent.globalBaseProps.y-.5*a.height+.5*(n.maxY-n.minY),t.actionManager.execAction(new V.x({id:e.id,props:[a]}))}u.e.updateLines(a,t),t.actionManager.execAction(new d.q)}t.renderManager.addAuxiliaryDrawTask()}enable(e,t){return e.altKey}}class ey extends s.w{type=l.V.KeyH;keydown(e,t){if(t.auxiliaryManager.selectManager.selectNodes.size>0){let e=[...t.auxiliaryManager.selectManager.selectNodes],a=u.e.getMoveNodes(e,t),n=a.sort((e,t)=>e.globalBaseProps.x-t.globalBaseProps.x);t.actionManager.execAction(new p.M);let r=t.auxiliaryManager.selectManager.getSelectBounds(),l=(r.maxX-r.minX-.5*n[0].baseProps.width-.5*n[n.length-1].baseProps.width)/(n.length-1),i=0;for(let e of n){let a=e.baseProps.clone();a.x=a.x=r.minX-e.parent.globalBaseProps.x+l*i,i++,t.actionManager.execAction(new V.x({id:e.id,props:[a]}))}u.e.updateLines(a,t),t.actionManager.execAction(new d.q)}t.renderManager.addAuxiliaryDrawTask()}enable(e){return e.altKey&&e.ctrlKey}}class ef extends s.w{type=l.V.KeyV;keydown(e,t){if(t.auxiliaryManager.selectManager.selectNodes.size>0){let e=[...t.auxiliaryManager.selectManager.selectNodes],a=u.e.getMoveNodes(e,t),n=a.sort((e,t)=>e.globalBaseProps.y-t.globalBaseProps.y);t.actionManager.execAction(new p.M);let r=t.auxiliaryManager.selectManager.getSelectBounds(),l=(r.maxY-r.minY-.5*n[0].baseProps.height-.5*n[n.length-1].baseProps.height)/(n.length-1),i=0;for(let e of n){let a=e.baseProps.clone();a.y=a.y=r.minY-e.parent.globalBaseProps.y+l*i,i++,t.actionManager.execAction(new V.x({id:e.id,props:[a]}))}u.e.updateLines(a,t),t.actionManager.execAction(new d.q)}t.renderManager.addAuxiliaryDrawTask()}enable(e){return e.altKey&&e.ctrlKey}}var eh=a(917519);class eM extends s.w{type=l.V.KeyB;enable(e,t){return t?e.metaKey:e.ctrlKey}keydown(e,t){let a=Array.from(t.getSelectNodes());if(0===a.length)return;let n=(0,eh.fm)(a),r=(0,eh.sT)(a);if(!n&&!r)return;let l=(n?(0,eh.oo)(a):(0,eh.cR)(a)).some(e=>!e.bold),i={type:v.d.Text,bold:l};n?(0,eh.xn)(a,t,i):(0,eh.uV)(a,t,i)}}class ew extends s.w{type=l.V.KeyI;enable(e,t){return t?e.metaKey:e.ctrlKey}keydown(e,t){let a=Array.from(t.getSelectNodes());if(0===a.length)return;let n=(0,eh.fm)(a),r=(0,eh.sT)(a);if(!n&&!r)return;let l=(n?(0,eh.oo)(a):(0,eh.cR)(a)).some(e=>!e.italic),i={type:v.d.Text,italic:l};n?(0,eh.xn)(a,t,i):(0,eh.uV)(a,t,i)}}class eT extends s.w{type=l.V.KeyU;enable(e,t){return t?e.metaKey:e.ctrlKey}keydown(e,t){let a=Array.from(t.getSelectNodes());if(0===a.length)return;let n=(0,eh.fm)(a),r=(0,eh.sT)(a);if(!n&&!r)return;let l=(n?(0,eh.oo)(a):(0,eh.cR)(a)).some(e=>!e.underline),i={type:v.d.Text,underline:l};n?(0,eh.xn)(a,t,i):(0,eh.uV)(a,t,i)}}class eA extends s.w{type=l.V.KeyX;enable(e,t){return(t?e.metaKey:e.ctrlKey)&&e.shiftKey}keydown(e,t){e.preventDefault();let a=Array.from(t.getSelectNodes());if(0===a.length)return;let n=(0,eh.fm)(a),r=(0,eh.sT)(a);if(!n&&!r)return;let l=(n?(0,eh.oo)(a):(0,eh.cR)(a)).some(e=>!e.strikeThrough),i={type:v.d.Text,strikeThrough:l};n?(0,eh.xn)(a,t,i):(0,eh.uV)(a,t,i)}}var eP=a(335342);class eb extends s.w{type=l.V.KeyL;enable(e,t){return(t?e.metaKey:e.ctrlKey)&&e.shiftKey}keydown(e,t){e.preventDefault();let a=Array.from(t.getSelectNodes());if(0===a.length)return;let n=(0,eh.fm)(a),r=(0,eh.sT)(a);if(!n&&!r)return;let l={type:v.d.Text,horizonAlign:eP.Z.TOP_OR_LEFT};n?(0,eh.xn)(a,t,l):(0,eh.uV)(a,t,l)}}class em extends s.w{type=l.V.KeyR;enable(e,t){return(t?e.metaKey:e.ctrlKey)&&e.shiftKey}keydown(e,t){e.preventDefault();let a=Array.from(t.getSelectNodes());if(0===a.length)return;let n=(0,eh.fm)(a),r=(0,eh.sT)(a);if(!n&&!r)return;let l={type:v.d.Text,horizonAlign:eP.Z.BOTTOM_OR_RIGHT};n?(0,eh.xn)(a,t,l):(0,eh.uV)(a,t,l)}}class eS extends s.w{type=l.V.KeyE;enable(e,t){return(t?e.metaKey:e.ctrlKey)&&e.shiftKey}keydown(e,t){e.preventDefault();let a=Array.from(t.getSelectNodes());if(0===a.length)return;let n=(0,eh.fm)(a),r=(0,eh.sT)(a);if(!n&&!r)return;let l={type:v.d.Text,horizonAlign:eP.Z.CENTER};n?(0,eh.xn)(a,t,l):(0,eh.uV)(a,t,l)}}class eK extends s.w{type=l.V.Period;enable(e,t){return(t?e.metaKey:e.ctrlKey)&&e.shiftKey}keydown(e,t){let a=Array.from(t.getSelectNodes());if(0===a.length)return;let n=(0,eh.fm)(a),r=(0,eh.sT)(a),l=(0,eh.eV)(a);if(!n&&!r||!l)return;let i=n?(0,eh.oo)(a):(0,eh.cR)(a);if(0===i.length)return;let o=i.some(e=>e.textParagraphProps.some(e=>!e.quote));n?(0,eh.xn)(a,t,void 0,{quote:o}):(0,eh.uV)(a,t,void 0,{quote:o})}}class eC extends s.w{type=l.V.Digit8;enable(e,t){return(t?e.metaKey:e.ctrlKey)&&e.shiftKey}keydown(e,t){let a=Array.from(t.getSelectNodes());if(0===a.length)return;let n=(0,eh.fm)(a),r=(0,eh.sT)(a),l=(0,eh.eV)(a);if(!n&&!r||!l)return;let i=n?(0,eh.oo)(a):(0,eh.cR)(a);if(0===i.length)return;let o=i.some(e=>e.textParagraphProps.some(e=>e.listType!==m.P0.UNORDERED));n?(0,eh.xn)(a,t,void 0,{listType:o?m.P0.UNORDERED:m.P0.PARAGRAPH}):(0,eh.uV)(a,t,void 0,{listType:o?m.P0.UNORDERED:m.P0.PARAGRAPH})}}class ek extends s.w{type=l.V.Digit7;enable(e,t){return(t?e.metaKey:e.ctrlKey)&&e.shiftKey}keydown(e,t){let a=Array.from(t.getSelectNodes());if(0===a.length)return;let n=(0,eh.fm)(a),r=(0,eh.sT)(a),l=(0,eh.eV)(a);if(!n&&!r||!l)return;let i=n?(0,eh.oo)(a):(0,eh.cR)(a);if(0===i.length)return;let o=i.some(e=>e.textParagraphProps.some(e=>e.listType!==m.P0.ORDERED));n?(0,eh.xn)(a,t,void 0,{listType:o?m.P0.ORDERED:m.P0.PARAGRAPH}):(0,eh.uV)(a,t,void 0,{listType:o?m.P0.ORDERED:m.P0.PARAGRAPH})}}class eD extends s.w{type=l.V.Period;enable(e){return e.shiftKey&&e.altKey}keydown(e,t){let a=Array.from(t.getSelectNodes());if(0===a.length)return;let n=(0,eh.fm)(a),r=(0,eh.sT)(a);if(!n&&!r)return;let l=n?(0,eh.oo)(a):(0,eh.cR)(a);if(0===l.length)return;let i=l[0].textCharProps[0]?.fontSize??l[0].fontSize,o=!0;for(let e of l)if(0===e.textCharProps.length){if(e.fontSize!==i){o=!1;break}i=e.fontSize}else for(let t of e.textCharProps){if(t.fontSize!==i){o=!1;break}i=t.fontSize}if(!o)return;let s={type:v.d.Text,fontSize:i+1};n?(0,eh.xn)(a,t,s):(0,eh.uV)(a,t,s)}}class ev extends s.w{type=l.V.Comma;enable(e){return e.shiftKey&&e.altKey}keydown(e,t){let a=Array.from(t.getSelectNodes());if(0===a.length)return;let n=(0,eh.fm)(a),r=(0,eh.sT)(a);if(!n&&!r)return;let l=n?(0,eh.oo)(a):(0,eh.cR)(a);if(0===l.length)return;let i=l[0].textCharProps[0]?.fontSize??l[0].fontSize,o=!0;for(let e of l)if(0===e.textCharProps.length){if(e.fontSize!==i){o=!1;break}i=e.fontSize}else for(let t of e.textCharProps){if(t.fontSize!==i){o=!1;break}i=t.fontSize}if(!o||i<=4)return;let s={type:v.d.Text,fontSize:i-1};n?(0,eh.xn)(a,t,s):(0,eh.uV)(a,t,s)}}var eV=a(578588);class eN extends s.w{type=l.V.KeyE;keydown(e,t){t.toolManager.setCurrentTool(j.w.ERASER),t.setCursor(`${eV.W.Eraser}`),t.refresh()}enable(e){return!0}}class eq extends s.w{type=l.V.KeyP;keydown(e,t){t.toolManager.setCurrentTool(j.w.PEN,{paintType:m.Y_.Mark}),t.setCursor(`${eV.W.PenMark}`),t.refresh()}enable(e){return!0}}class eL extends s.w{type=l.V.KeyP;keydown(e,t){t.toolManager.setCurrentTool(j.w.PEN,{paintType:m.Y_.Highlight}),t.setCursor(`${eV.W.PenHighlight}`),t.refresh()}enable(e){return e.shiftKey}}var eR=a(318440);class eI extends s.w{type=l.V.KeyV;keydown(e,t){t.toolManager.resetTool(),t.refresh(),t.removeAuxiliaryGraphic(eR.T.PreviewPaintBrushStroke)}enable(e){return!0}}class eE extends s.w{type=l.V.KeyH;enable(e){return!0}keydown(e,t){t.toolManager.currentTool.tool===j.w.HAND_TOOL?t.toolManager.setCurrentTool(j.w.DEFAULT):t.toolManager.setCurrentTool(j.w.HAND_TOOL),t.refresh()}}var eB=a(873411),eO=a(800866);class eU{static group(e,t){let a=t.idGenerator.genId(m.Jq.DirectFocusGroup),n=[];n.push(a);let r=0;for(let t of e)t.zIndex>r&&(r=t.zIndex);let l=t.auxiliaryManager.selectManager.getSelectBounds(),i=new eB.s;i.x=l.minX,i.y=l.minY,i.width=l.maxX-l.minX,i.height=l.maxY-l.minY;let o=e[0].parent;i.x-=o.globalBaseProps.x,i.y-=o.globalBaseProps.y,t.actionManager.execAction(new p.M),t.actionManager.execAction(new _.C([{id:a,type:m.Jq.DirectFocusGroup,zIndex:r,props:[i],parentId:o.id,path:o.getPath(!0)}]));let s=t.nodeManager.getNode(a);if(!s)return void t.actionManager.execAction(new d.q);for(let a of e.sort((e,t)=>e.zIndex-t.zIndex)){if(a.parent===s)continue;let e=a.parent.children.indexOf(a),l=r+0,i={id:a.id,fromPath:a.getPath(),toPath:s.getPath(!0),fromIndex:e,toIndex:l};t.actionManager.execAction(new eO.h(i)),t.actionManager.execAction(P.O.selectNode(n))}t.actionManager.execAction(new d.q)}static unGroup(e,t){let a=e.filter(e=>e.type===m.Jq.DirectFocusGroup);if(0===a.length)return;let n=[];for(let t of e)t.type!==m.Jq.DirectFocusGroup&&n.push(t.id);for(let e of a)for(let t of e.children)n.push(t.id);for(let e of(t.actionManager.execAction(new p.M),a)){let a=e.parent;if(!a)continue;let r=[...e.children.sort((e,t)=>e.zIndex-t.zIndex)];for(let n of r){let l=r.indexOf(n),i=a.children.length,o={id:n.id,fromPath:e.getPath(),toPath:a.getPath(!0),fromIndex:l,toIndex:i};t.actionManager.execAction(new eO.h(o))}t.actionManager.execAction(new I.q([{id:e.id}])),t.actionManager.execAction(P.O.selectNode(n))}t.actionManager.execAction(new d.q)}static collectAllChildren(e){let t=[];return e.forEach(e=>{t.push(e),e.children&&e.type===m.Jq.DirectFocusGroup&&(t=t.concat(this.collectAllChildren(e.children)))}),t}}class ez extends s.w{type=l.V.KeyG;keydown(e,t){e.preventDefault();let a=[...t.auxiliaryManager.selectManager.selectNodes];0!==a.length&&eU.group(a,t)}enable(e,t){return(t?e.metaKey:e.ctrlKey)&&!e.shiftKey}}class eJ extends s.w{type=l.V.KeyG;keydown(e,t){e.preventDefault();let a=[...t.auxiliaryManager.selectManager.selectNodes];a.some(e=>e.type===m.Jq.DirectFocusGroup)&&0!==a.length&&eU.unGroup(a,t)}enable(e,t){return(t?e.metaKey:e.ctrlKey)&&e.shiftKey}}class eF{static sameLayerNodeForwardDiffMove(e,t,a){if(a<0||0===t.length&&0===a)return;let n=t[0].parent,r=(n?.children.length||0)-1;for(let l of[...t.sort((e,t)=>t.zIndex-e.zIndex)]){let t=l.zIndex,i=Math.min(t+a,r);i!==t&&e.actionManager.execAction(new eO.h({id:l.id,fromIndex:t,toIndex:i,fromPath:n?.getPath(!0),toPath:n?.getPath(!0)})),i===r&&r--}}static sameLayerNodeBackwardDiffMove(e,t,a){if(a<0||0===t.length&&0===a)return;let n=t[0].parent,r=0;for(let l of[...t.sort((e,t)=>e.zIndex-t.zIndex)]){let t=l.zIndex,i=Math.max(t-a,r);i!==t&&e.actionManager.execAction(new eO.h({id:l.id,fromIndex:t,toIndex:i,fromPath:n?.getPath(!0),toPath:n?.getPath(!0)})),i===r&&r++}}static sendToBack(e,t){let a=new Map;for(let n of(this.buildParentChildrenMap(t,a),a)){let t=n[0],a=(e.nodeManager.getNode(t)||e.nodeManager.root).children.length;this.sameLayerNodeBackwardDiffMove(e,n[1],a)}}static sendBackward(e,t){let a=new Map;for(let n of(this.buildParentChildrenMap(t,a),a))this.sameLayerNodeBackwardDiffMove(e,n[1],1)}static bringForward(e,t){let a=new Map;for(let n of(this.buildParentChildrenMap(t,a),a))this.sameLayerNodeForwardDiffMove(e,n[1],1)}static bringToFront(e,t){let a=new Map;for(let n of(this.buildParentChildrenMap(t,a),a)){let t=n[0],a=(e.nodeManager.getNode(t)||e.nodeManager.root).children.length;this.sameLayerNodeForwardDiffMove(e,n[1],a)}}static buildParentChildrenMap(e,t){for(let a of e){let e=a.parent?.id||"ROOT";t.has(e)||t.set(e,[]),t.get(e).push(a)}}}class ej extends s.w{type=l.V.SquareBracketLeft;keydown(e,t){e.preventDefault();let a=[...t.auxiliaryManager.selectManager.selectNodes];0!==a.length&&(t.actionManager.execAction(new p.M),eF.sendToBack(t,a),t.actionManager.execAction(new d.q))}enable(e,t){return(t?e.metaKey:e.ctrlKey)&&!e.altKey}}class eH extends s.w{type=l.V.SquareBracketLeft;keydown(e,t){e.preventDefault();let a=[...t.auxiliaryManager.selectManager.selectNodes];0!==a.length&&(t.actionManager.execAction(new p.M),eF.sendBackward(t,a),t.actionManager.execAction(new d.q))}enable(e,t){return(t?e.metaKey:e.ctrlKey)&&e.altKey}}class eG extends s.w{type=l.V.SquareBracketLeft;keydown(e,t){e.preventDefault();let a=[...t.auxiliaryManager.selectManager.selectNodes];0!==a.length&&(t.actionManager.execAction(new p.M),eF.bringToFront(t,a),t.actionManager.execAction(new d.q))}enable(e,t){return(t?e.metaKey:e.ctrlKey)&&!e.altKey}}class eY extends s.w{type=l.V.SquareBracketLeft;keydown(e,t){e.preventDefault();let a=[...t.auxiliaryManager.selectManager.selectNodes];0!==a.length&&(t.actionManager.execAction(new p.M),eF.bringForward(t,a),t.actionManager.execAction(new d.q))}enable(e,t){return(t?e.metaKey:e.ctrlKey)&&e.altKey}}var eZ=a(991435);class e_ extends s.w{type=l.V.KeyV;keydown(e,t){e.preventDefault(),eZ.c.pasteFormat(t)}enable(e,t){return(t?e.metaKey:e.ctrlKey)&&e.altKey}}var eW=a(202473),eX=a(128003);let e$=new Set([m.Jq.Rect,m.Jq.IconSource,m.Jq.CompositeShape]),eQ=new Set([H.DY.conditionShape,H.DY.conditionShape2,H.DY.bubble,H.DY.rectBubble,H.DY.circularRing,H.DY.pie,H.DY.cube]);class e0{static flipH(e){if(!this.canFlip(e))return;let t=[...e.auxiliaryManager.selectManager.selectNodes];for(let a of(e.actionManager.execAction(new p.M),t)){let t=a.propMap.get(v.d.Flip);if(t){let n=new eX.w;n.hFlip=!t.hFlip,delete n.vFlip,e.actionManager.execAction(new V.x({id:a.id,props:[n]}))}}e.actionManager.execAction(new d.q)}static flipV(e){if(!this.canFlip(e))return;let t=[...e.auxiliaryManager.selectManager.selectNodes];for(let a of(e.actionManager.execAction(new p.M),t)){let t=a.propMap.get(v.d.Flip);if(t){let n=new eX.w;n.vFlip=!t.vFlip,delete n.hFlip,e.actionManager.execAction(new V.x({id:a.id,props:[n]}))}}e.actionManager.execAction(new d.q)}static canFlip(e){let t=[...e.auxiliaryManager.selectManager.selectNodes];if(1!==t.length)return!1;let a=t[0];if(a.type===m.Jq.MindMapNode)return!1;if(a.type===m.Jq.CompositeShape){let e=a.shapeType;if(eQ.has(e))return!1}return!!e$.has(a.type)}}class e1 extends s.w{type=l.V.SquareBracketLeft;keydown(e,t){e.preventDefault(),e0.flipV(t)}enable(e){return e.shiftKey}}class e8 extends s.w{type=l.V.SquareBracketLeft;keydown(e,t){e.preventDefault(),e0.flipH(t)}enable(e){return e.shiftKey}}class e9{static lockUnlock(e){let t=[...e.auxiliaryManager.selectManager.selectNodes];if(0!==t.length){for(let a of(e.actionManager.execAction(new p.M),t)){let t=a.lockedStatusProps.clone();t.locked=!t.locked,e.actionManager.execAction(new V.x({id:a.id,props:[t]}))}e.actionManager.execAction(new d.q)}}}class e5 extends s.w{type=l.V.KeyL;keydown(e,t){e.preventDefault(),e9.lockUnlock(t)}enable(e,t){return(t?e.metaKey:e.ctrlKey)&&e.altKey}}var e6=a(374834);class e4 extends s.w{type=l.V.Space;enable(e){return!0}keydown(e,t){t.toolManager.currentTool.tool!==j.w.HAND_TOOL&&(t.toolManager.setCurrentTool(j.w.HAND_TOOL),t.refresh())}keyup(e,t){t.toolManager.setCurrentTool(j.w.DEFAULT),t.refresh()}}class e2 extends s.w{type=l.V.KeyS;keydown(e,t){t.toolManager.setCurrentTool(j.w.SECTION),t.setCursor("crosshair"),t.refresh()}enable(e){return e.shiftKey}}class e3 extends F{type=l.V.Backspace}var e7=a(808687);class te extends s.w{type=l.V.Tab;keydown(e,t){e.preventDefault();let a=[...t.auxiliaryManager.selectManager.selectNodes];if(1!==a.length)return;let n=a[0];if(n.type!==m.Jq.MindMapNode)return;t.actionManager.execAction(new p.M),n.mindMapProps.collapsed&&e7.D.foldUnfoldChildNode(n,t);let r=O.R.convertToCollapseSideEnum(n.mindMapProps.layoutEnum);e7.D.insertChildNode(n,t,r),t.actionManager.execAction(new d.q)}enable(e){return!0}}class tt extends s.w{type=l.V.Period;keydown(e,t){e.preventDefault();let a=[...t.auxiliaryManager.selectManager.selectNodes];if(1!==a.length)return;let n=a[0];n.type===m.Jq.MindMapNode&&e7.D.foldUnfoldChildNode(n,t)}enable(e){return e.metaKey}}var ta=a(906891);let tn=()=>new Map([[l.V.ArrowRight,[new x]],[l.V.ArrowLeft,[new y]],[l.V.ArrowUp,[new f]],[l.V.ArrowDown,[new h]],[l.V.Delete,[new F]],[l.V.Backspace,[new e3]],[l.V.Comma,[new ev]],[l.V.Digit7,[new ek]],[l.V.Digit8,[new eC]],[l.V.Escape,[new Y.L]],[l.V.Enter,[new c]],[l.V.KeyA,[new ea,new ec,new eo]],[l.V.KeyB,[new eM]],[l.V.KeyC,[new ta.w,new eW.f,new e6.v]],[l.V.KeyD,[new et,new ed,new en]],[l.V.KeyE,[new eS,new eN]],[l.V.KeyG,[new ez,new eJ]],[l.V.KeyH,[new ey,new eu,new e8,new eE]],[l.V.KeyI,[new ew]],[l.V.KeyL,[new eb,new e5,new es]],[l.V.KeyO,[new el]],[l.V.KeyP,[new eL,new eq]],[l.V.KeyR,[new em,new G]],[l.V.KeyS,[new eg,new e2,new er]],[l.V.KeyU,[new eT]],[l.V.KeyV,[new e_,new ef,new ex,new e1,new eI]],[l.V.KeyW,[new ep]],[l.V.KeyX,[new eA]],[l.V.KeyZ,[new i.i,new o.$]],[l.V.Period,[new eK,new eD,new tt]],[l.V.SquareBracketLeft,[new ej,new eH]],[l.V.SquareBracketRight,[new eG,new eY]],[l.V.Tab,[new te]],[l.V.Space,[new e4]]])},512370:function(e,t,a){var n=a(166413);a(648290),a(489597),n.l},648290:function(e,t,a){a.d(t,{U:()=>E});var n=a(580182),r=a(911620),l=a(3406),i=a(976780),o=a(805433),s=a(808687);class c extends n.w{type=r.V.Enter;enable(e){return!0}keydown(e,t){let{editTextInfo:a}=t.inputManager;if(!a)return;let{cursorPos:n}=a,{renderText:r}=a.inputableText.graphicText,{prev:c,next:d}=s.D.splitText(r,n),p=o.G.computeOverrideStyle(r,n,!0),g={type:i.d.Text,text:`${c}
${d}`,textCharProps:p};t.inputManager.execTextUpdateAction(g,t);let u=l.M.cursorMoveNext(r,n);t.inputManager.cursorMove(u)}}class d extends n.w{type=r.V.Escape;enable(e){return!0}keydown(e,t){t.inputManager.blur(),t.toolManager.resetTool()}}var p=a(988382),g=a(175005),u=a(318440),x=a(652260),y=a(944379),f=a(455360),h=a(943451);class M extends n.w{type=r.V.Backspace;enable(e){return!0}keydown(e,t){let{editTextInfo:a}=t.inputManager;if(!a)return;if(t.execAction(new y.M),this.deleteSelectedText(t))return void t.execAction(new f.q);if(this.handleTableCell(t))return;let{cursorPos:n}=a;if(0===n.paragraphIndex&&0===n.lineIndex&&-1===n.charIndex)return;let{renderText:r}=a.inputableText.graphicText,i=s.D.generateDeleteProps(r,n);t.inputManager.execTextUpdateAction(i,t);let o=l.M.cursorMovePrev(r,n);t.inputManager.cursorMove(o),t.inputManager.mentionManager.handleMention({inputText:"",eventCtx:t}),t.execAction(new f.q)}deleteSelectedText(e){if(!e.auxiliaryManager.hasTextSelection())return!1;let{selectionInfo:t}=e.auxiliaryManager.selectionManager;if(!t?.selectionList.length)return!1;let{start:a,end:n}=t,r=e.inputManager.editTextInfo,{renderText:l}=r.inputableText.graphicText,i=l.getCharIndex(a),o=l.getCharIndex(n),c=s.D.generateDeleteProps(l,n,o-i);return e.inputManager.execTextUpdateAction(c,e),e.auxiliaryManager.clearTextSelection(),e.inputManager.focus({...r,cursorPos:a},r.inputableText.graphicText.textProps.fontSize),!0}handleTableCell(e){let t=e.inputManager.editTextInfo;if(t.inputableText.type!==h.P.TableCell)return!1;if(""===t.inputableText.graphicText.textProps.text){let a=t.node,n=p.P.getPreviousCell(a,t.inputableText.i,t.inputableText.j),r=p.P.getTableCellText(a,n.i,n.j);if(r||(r=p.P.initTableCellText(a,n.i,n.j)),e.actionManager.execAction(g.O.selectTableCell(a.id,[n])),""===r.textProps.text){let t=x.t.head();e.inputManager.focus({node:a,inputableText:{type:h.P.TableCell,graphicText:r,i:n.i,j:n.j},cursorPos:t},r.textProps.fontSize)}else{e.inputManager.blur();let t=e.auxiliaryManager.selectionManager.selectAllNodeText(a,r);e.auxiliaryManager.addOrUpdateAuxiliaryGraphic(u.T.TextSelection,{selectionList:t,baseProps:a.globalBaseProps})}return!0}return!1}}class w extends n.w{type=r.V.ArrowRight;enable(e){return!0}keydown(e,t){let{editTextInfo:a}=t.inputManager;if(!a)return;let{inputableText:n,cursorPos:r}=a,i=l.M.cursorMoveNext(n.graphicText.renderText,r);t.inputManager.cursorMove(i),t.removeAuxiliaryGraphic(u.T.TextSelection),t.auxiliaryManager.clearTextSelection()}}class T extends n.w{type=r.V.ArrowLeft;enable(e){return!0}keydown(e,t){let{editTextInfo:a}=t.inputManager;if(!a)return;let{inputableText:n,cursorPos:r}=a,i=l.M.cursorMovePrev(n.graphicText.renderText,r);t.inputManager.cursorMove(i),t.removeAuxiliaryGraphic(u.T.TextSelection),t.auxiliaryManager.clearTextSelection()}}class A extends n.w{type=r.V.ArrowUp;enable(e){return!0}keydown(e,t){let{editTextInfo:a}=t.inputManager;if(!a)return;let{inputableText:n,cursorPos:r}=a,i=l.M.cursorMoveUp(n.graphicText.renderText,r);t.inputManager.cursorMove(i),t.removeAuxiliaryGraphic(u.T.TextSelection)}}class P extends n.w{type=r.V.ArrowDown;enable(e){return!0}keydown(e,t){let{editTextInfo:a}=t.inputManager;if(!a)return;let{inputableText:n,cursorPos:r}=a,i=l.M.cursorMoveDown(n.graphicText.renderText,r);t.inputManager.cursorMove(i),t.removeAuxiliaryGraphic(u.T.TextSelection)}}var b=a(666742),m=a(366216);class S extends n.w{type=r.V.ArrowDown;keydown(e,t){}enable(e){return!0}}class K extends n.w{type=r.V.KeyB;enable(e){return e.metaKey}keydown(e,t){let{editTextInfo:a}=t.inputManager;if(!a||this.toggleSelectedTextBold(t))return;let n=a.inputableText.graphicText.textProps.clone();for(let e of(n.bold=!n.bold,n.textCharProps))e.bold=n.bold;t.inputManager.execTextUpdateAction(n,t)}toggleSelectedTextBold(e){if(!e.auxiliaryManager.hasTextSelection())return!1;let{selectionInfo:t}=e.auxiliaryManager.selectionManager;if(!t?.selectionList.length)return!1;let{start:a,end:n}=t,{textProps:r,renderText:l}=e.inputManager.editTextInfo.inputableText.graphicText,o=r.splitTextCharProps(),s=r.calculateCharIndex(a,l,1),c=r.calculateCharIndex(n,l),d=this.isAllBold(o,s,c);for(let e=s;e<=c;e++){let t=o.get(e);t&&(t.bold=!d)}let p=r.mergeTextCharProps(o);return e.inputManager.execTextUpdateAction({type:i.d.Text,textCharProps:p},e),!0}isAllBold(e,t,a){for(let n=t;n<=a;n++)if(e.get(n)?.bold===!1)return!1;return!0}}class C extends n.w{type=r.V.KeyI;enable(e){return e.metaKey}keydown(e,t){let{editTextInfo:a}=t.inputManager;if(!a||this.toggleSelectedTextItalic(t))return;let n=a.inputableText.graphicText.textProps.clone();for(let e of(n.italic=!n.italic,n.textCharProps))e.italic=n.italic;t.inputManager.execTextUpdateAction(n,t)}toggleSelectedTextItalic(e){if(!e.auxiliaryManager.hasTextSelection())return!1;let{selectionInfo:t}=e.auxiliaryManager.selectionManager;if(!t?.selectionList.length)return!1;let{start:a,end:n}=t,{textProps:r,renderText:l}=e.inputManager.editTextInfo.inputableText.graphicText,o=r.splitTextCharProps(),s=r.calculateCharIndex(a,l,1),c=r.calculateCharIndex(n,l),d=this.isAllItalic(o,s,c);for(let e=s;e<=c;e++){let t=o.get(e);t&&(t.italic=!d)}let p=r.mergeTextCharProps(o);return e.inputManager.execTextUpdateAction({type:i.d.Text,textCharProps:p},e),!0}isAllItalic(e,t,a){for(let n=t;n<=a;n++)if(e.get(n)?.italic===!1)return!1;return!0}}class k extends n.w{type=r.V.KeyU;enable(e){return e.metaKey}keydown(e,t){let{editTextInfo:a}=t.inputManager;if(!a||this.toggleSelectedTextUnderline(t))return;let n=a.inputableText.graphicText.textProps.clone();for(let e of(n.underline=!n.underline,n.textCharProps))e.underline=n.underline;t.inputManager.execTextUpdateAction(n,t)}toggleSelectedTextUnderline(e){if(!e.auxiliaryManager.hasTextSelection())return!1;let{selectionInfo:t}=e.auxiliaryManager.selectionManager;if(!t?.selectionList.length)return!1;let{start:a,end:n}=t,{graphicText:r}=e.inputManager.editTextInfo.inputableText,{textProps:l,renderText:o}=r,s=l.splitTextCharProps(),c=l.calculateCharIndex(a,o,1),d=l.calculateCharIndex(n,o),p=this.isAllUnderlined(s,c,d);for(let e=c;e<=d;e++){let t=s.get(e);t&&(t.underline=!p)}let g=l.mergeTextCharProps(s);return e.inputManager.execTextUpdateAction({type:i.d.Text,textCharProps:g},e),!0}isAllUnderlined(e,t,a){for(let n=t;n<=a;n++)if(e.get(n)?.underline===!1)return!1;return!0}}class D extends n.w{type=r.V.KeyX;enable(e){return e.metaKey&&e.shiftKey}keydown(e,t){e.preventDefault();let{editTextInfo:a}=t.inputManager;if(!a||this.toggleSelectedTextStrikeThrough(t))return;let n=a.inputableText.graphicText.textProps.clone();for(let e of(n.strikeThrough=!n.strikeThrough,n.textCharProps))e.strikeThrough=n.strikeThrough;t.inputManager.execTextUpdateAction(n,t)}toggleSelectedTextStrikeThrough(e){if(!e.auxiliaryManager.hasTextSelection())return!1;let{selectionInfo:t}=e.auxiliaryManager.selectionManager;if(!t?.selectionList.length)return!1;let{start:a,end:n}=t,{graphicText:r}=e.inputManager.editTextInfo.inputableText,{textProps:l,renderText:o}=r,s=l.splitTextCharProps(),c=l.calculateCharIndex(a,o,1),d=l.calculateCharIndex(n,o),p=this.isAllStrikeThrough(s,c,d);for(let e=c;e<=d;e++){let t=s.get(e);t&&(t.strikeThrough=!p)}let g=l.mergeTextCharProps(s);return e.inputManager.execTextUpdateAction({type:i.d.Text,textCharProps:g},e),!0}isAllStrikeThrough(e,t,a){for(let n=t;n<=a;n++)if(e.get(n)?.strikeThrough===!1)return!1;return!0}}var v=a(893641);class V extends n.w{type=r.V.Period;enable(e){return e.metaKey&&e.shiftKey}keydown(e,t){let{editTextInfo:a}=t.inputManager;if(!a||this.toggleSelectedTextQuote(t))return;let{cursorPos:n}=a,r=a.inputableText.graphicText.textProps.clone();if(n.paragraphIndex>r.textParagraphProps.length-1)for(let e=0;e<=n.paragraphIndex;e++)void 0===r.textParagraphProps[e]&&(r.textParagraphProps[e]=new v.W);let l=r.textParagraphProps[n.paragraphIndex];l.quote=!l.quote,t.inputManager.execTextUpdateAction(r,t)}toggleSelectedTextQuote(e){if(!e.auxiliaryManager.hasTextSelection())return!1;let{selectionInfo:t}=e.auxiliaryManager.selectionManager;if(!t?.selectionList.length)return!1;let{start:a,end:n}=t,r=e.inputManager.editTextInfo.inputableText.graphicText.textProps.clone(),l=this.isAllQuote(r,a.paragraphIndex,n.paragraphIndex);for(let e=a.paragraphIndex;e<=n.paragraphIndex;e++)r.textParagraphProps[e].quote=!l;return e.inputManager.execTextUpdateAction(r,e),!0}isAllQuote(e,t,a){let{textParagraphProps:n}=e;for(let e=0;e<=a;e++)void 0===n[e]&&(n[e]=new v.W);for(let e=t;e<=a;e++)if(!n[e].quote)return!1;return!0}}var N=a(797615);class q extends n.w{type=r.V.Digit8;enable(e){return e.metaKey&&e.shiftKey}keydown(e,t){let{editTextInfo:a}=t.inputManager;if(!a||this.toggleSelectedTextUnorderedList(t))return;let{cursorPos:n}=a,r=a.inputableText.graphicText.textProps.clone();if(n.paragraphIndex>r.textParagraphProps.length-1)for(let e=0;e<=n.paragraphIndex;e++)void 0===r.textParagraphProps[e]&&(r.textParagraphProps[e]=new v.W);let l=r.textParagraphProps[n.paragraphIndex];l.listType=l.listType===N.P0.UNORDERED?N.P0.PARAGRAPH:N.P0.UNORDERED,l.computeOrderedListShowIndex(),r.refreshTextParagraphPropsListIndex(),t.inputManager.execTextUpdateAction(r,t)}toggleSelectedTextUnorderedList(e){if(!e.auxiliaryManager.hasTextSelection())return!1;let{selectionInfo:t}=e.auxiliaryManager.selectionManager;if(!t?.selectionList.length)return!1;let{start:a,end:n}=t,r=e.inputManager.editTextInfo.inputableText.graphicText.textProps.clone(),l=this.isAllUnordered(r,a.paragraphIndex,n.paragraphIndex),{textParagraphProps:o}=r;for(let e=a.paragraphIndex;e<=n.paragraphIndex;e++)o[e].listType=l?N.P0.PARAGRAPH:N.P0.UNORDERED;return r.refreshTextParagraphPropsListIndex(),e.inputManager.execTextUpdateAction({type:i.d.Text,textParagraphProps:o},e),!0}isAllUnordered(e,t,a){let{textParagraphProps:n}=e;for(let e=0;e<=a;e++)void 0===n[e]&&(n[e]=new v.W);for(let e=t;e<=a;e++)if(n[e].listType!==N.P0.UNORDERED)return!1;return!0}}class L extends n.w{type=r.V.Digit7;enable(e){return e.metaKey&&e.shiftKey}keydown(e,t){let{editTextInfo:a}=t.inputManager;if(!a||this.toggleSelectedTextOrderedList(t))return;let{cursorPos:n}=a,r=a.inputableText.graphicText.textProps.clone();if(n.paragraphIndex>r.textParagraphProps.length-1)for(let e=0;e<=n.paragraphIndex;e++)void 0===r.textParagraphProps[e]&&(r.textParagraphProps[e]=new v.W);let l=r.textParagraphProps[n.paragraphIndex];l.listType=l.listType===N.P0.ORDERED?N.P0.PARAGRAPH:N.P0.ORDERED,l.computeOrderedListShowIndex(),r.refreshTextParagraphPropsListIndex(),t.inputManager.execTextUpdateAction(r,t)}toggleSelectedTextOrderedList(e){if(!e.auxiliaryManager.hasTextSelection())return!1;let{selectionInfo:t}=e.auxiliaryManager.selectionManager;if(!t?.selectionList.length)return!1;let{start:a,end:n}=t,r=e.inputManager.editTextInfo.inputableText.graphicText.textProps.clone(),{textParagraphProps:l}=r,i=this.isAllOrdered(r,a.paragraphIndex,n.paragraphIndex);for(let e=a.paragraphIndex;e<=n.paragraphIndex;e++)l[e].listType=i?N.P0.PARAGRAPH:N.P0.ORDERED;return r.refreshTextParagraphPropsListIndex(),e.inputManager.execTextUpdateAction(r,e),!0}isAllOrdered(e,t,a){let{textParagraphProps:n}=e;for(let e=0;e<=a;e++)void 0===n[e]&&(n[e]=new v.W);for(let e=t;e<=a;e++)if(n[e].listType!==N.P0.ORDERED)return!1;return!0}}class R extends n.w{type=r.V.Period;enable(e){return e.shiftKey&&e.altKey}keydown(e,t){e.preventDefault();let{editTextInfo:a}=t.inputManager;if(!a||this.increaseSelectedTextFontSize(t))return;let n=a.inputableText.graphicText.textProps.clone();for(let e of(n.fontSize++,n.textCharProps))e.fontSize=n.fontSize;t.inputManager.execTextUpdateAction(n,t)}increaseSelectedTextFontSize(e){if(!e.auxiliaryManager.hasTextSelection())return!1;let{selectionInfo:t}=e.auxiliaryManager.selectionManager;if(!t?.selectionList.length)return!1;let{start:a,end:n}=t,{textProps:r,renderText:l}=e.inputManager.editTextInfo.inputableText.graphicText,o=r.splitTextCharProps(),s=r.calculateCharIndex(a,l,1),c=r.calculateCharIndex(n,l);if(!this.isSameFontSize(o,s,c))return!0;for(let e=s;e<=c;e++){let t=o.get(e);t?.fontSize&&t.fontSize++}let d=r.mergeTextCharProps(o);return e.inputManager.execTextUpdateAction({type:i.d.Text,textCharProps:d},e),!0}isSameFontSize(e,t,a){let n=e.get(t)?.fontSize;for(let r=t+1;r<=a;r++)if(e.get(r)?.fontSize!==n)return!1;return!0}}class I extends n.w{type=r.V.Comma;enable(e){return e.shiftKey&&e.altKey}keydown(e,t){e.preventDefault();let{editTextInfo:a}=t.inputManager;if(!a||this.reduceSelectedTextFontSize(t))return;let n=a.inputableText.graphicText.textProps.clone();for(let e of(n.fontSize--,n.textCharProps))e.fontSize=n.fontSize;t.inputManager.execTextUpdateAction(n,t)}reduceSelectedTextFontSize(e){if(!e.auxiliaryManager.hasTextSelection())return!1;let{selectionInfo:t}=e.auxiliaryManager.selectionManager;if(!t?.selectionList.length)return!1;let{start:a,end:n}=t,{textProps:r,renderText:l}=e.inputManager.editTextInfo.inputableText.graphicText,o=r.splitTextCharProps(),s=r.calculateCharIndex(a,l,1),c=r.calculateCharIndex(n,l);if(!this.isSameFontSize(o,s,c))return!0;for(let e=s;e<=c;e++){let t=o.get(e);t?.fontSize&&t.fontSize--}let d=r.mergeTextCharProps(o);return e.inputManager.execTextUpdateAction({type:i.d.Text,textCharProps:d},e),!0}isSameFontSize(e,t,a){let n=e.get(t)?.fontSize;for(let r=t+1;r<=a;r++)if(e.get(r)?.fontSize!==n)return!1;return!0}}let E=()=>new Map([[r.V.Enter,[new c]],[r.V.Escape,[new d]],[r.V.Backspace,[new M]],[r.V.ArrowRight,[new w]],[r.V.ArrowLeft,[new T]],[r.V.ArrowUp,[new A]],[r.V.ArrowDown,[new P]],[r.V.Tab,[new S]],[r.V.KeyZ,[new b.i,new m.$]],[r.V.KeyB,[new K]],[r.V.KeyI,[new C]],[r.V.KeyU,[new k]],[r.V.KeyX,[new D]],[r.V.Period,[new R,new V]],[r.V.Comma,[new I]],[r.V.Digit7,[new L]],[r.V.Digit8,[new q]]])},625904:function(e,t,a){var n=a(166413);a(911620),a(202843),a(489597),n.l},202843:function(e,t,a){a.d(t,{L:()=>l});var n=a(580182),r=a(911620);class l extends n.w{enable(e){return!0}type=r.V.Escape;keydown(e,t){t.toolManager.resetTool(),t.setCursor("default"),t.refresh()}}},374834:function(e,t,a){a.d(t,{v:()=>l});var n=a(580182),r=a(911620);class l extends n.w{type=r.V.SquareBracketLeft;async keydown(e,t){if(e.preventDefault(),!navigator.clipboard?.write)return void console.error("\u526A\u8D34\u677FAPI\u4E0D\u53EF\u7528");let a=[...t.auxiliaryManager.selectManager.selectNodes];if(0!==a.length)try{let e=await t.renderManager.exportToNodesImgBlob(a,2,"",[25,25,25,25]);if(!e)return void console.error("\u65E0\u6CD5\u751F\u6210\u56FE\u50CFBlob");await navigator.clipboard.write([new ClipboardItem({"image/png":e})])}catch(e){console.error("\u590D\u5236\u56FE\u50CF\u8FC7\u7A0B\u4E2D\u53D1\u751F\u9519\u8BEF:",e)}}enable(e,t){return(t?e.metaKey:e.ctrlKey)&&e.shiftKey}}},202473:function(e,t,a){a.d(t,{f:()=>i});var n=a(580182),r=a(911620),l=a(991435);class i extends n.w{type=r.V.KeyC;keydown(e,t){e.preventDefault(),l.c.copyFormat(t)}enable(e,t){return(t?e.metaKey:e.ctrlKey)&&e.altKey}}},991435:function(e,t,a){a.d(t,{c:()=>p});var n=a(513665),r=a(944379),l=a(455360),i=a(976780),o=a(797615),s=a(891763),c=a(937282);let d=new Set([o.Jq.Rect,o.Jq.IconSource,o.Jq.DirectFocusGroup,o.Jq.Table,o.Jq.TableUML,o.Jq.TableER]);class p{static copyFormat(e){let t=[...e.auxiliaryManager.selectManager.selectNodes];if(0===t.length)return;let a=t[0];if(d.has(a.type))return;let n={type:o.Jq.CompositeShape,props:[]};n.type=a.type,a.type===o.Jq.CompositeShape?this.handleCompositeShape(n,a):a.type===o.Jq.Connector?this.handleConnector(n,a):a.type===o.Jq.Section?this.handleSection(n,a):this.handleCompositeShape(n,a),c.j.getInstance().setFormatData(n)}static pasteFormat(e){let t=[...e.auxiliaryManager.selectManager.selectNodes];if(0===t.length)return;let a=c.j.getInstance().getFormatData();if(t.every(e=>e.type===a?.type)&&a&&0!==a.props.length){for(let l of(e.actionManager.execAction(new r.M),t))e.actionManager.execAction(new n.x({id:l.id,props:[...a.props]}));e.actionManager.execAction(new l.q)}}static handleCompositeShape(e,t){let a=t.propMap.get(i.d.Theme),n=t.propMap.get(i.d.Color),r=t.propMap.get(i.d.Border),l=t.propMap.get(i.d.Opacity),o=t.propMap.get(i.d.Text);if(a&&e.props.push(a),n&&e.props.push(n),r&&e.props.push(r),l&&e.props.push(l),o){let t=o.clone();delete t.text,delete t.textParagraphProps,delete t.textCharProps,e.props.push(t)}}static handleConnector(e,t){let a=t.propMap.get(i.d.Line),n=t.propMap.get(i.d.LineCaptions);if(a){let t=a.clone();delete t.points,delete t.lineType,e.props.push(t)}if(n){let t=n.clone().captions[0].textProps;delete t.text,delete t.textCharProps,delete t.textParagraphProps;let a=new s.l;a.captions=[{textProps:t}],e.props.push(a)}this.handleCompositeShape(e,t)}static handleSection(e,t){let a=t.propMap.get(i.d.Title);if(a){let t=a.clone();delete t.title,e.props.push(t)}this.handleCompositeShape(e,t)}}},906891:function(e,t,a){a.d(t,{w:()=>o});var n=a(580182),r=a(911620),l=a(797615),i=a(808687);class o extends n.w{type=r.V.KeyC;keydown(e,t){e.preventDefault();let a=[...t.auxiliaryManager.selectManager.selectNodes];if(0!==a.length&&!a.some(e=>e.type!==l.Jq.MindMapNode))for(let e of a)i.D.foldUnfoldAllChildNode(e,t)}enable(e,t){return(t?e.metaKey:e.ctrlKey)&&e.altKey&&e.shiftKey}}},917519:function(e,t,a){a.d(t,{cR:()=>x,eV:()=>g,fm:()=>d,oo:()=>u,sT:()=>p,uV:()=>f,xn:()=>y});var n=a(797615),r=a(976780),l=a(797379),i=a(513665),o=a(457063),s=a(893641),c=a(567524);let d=e=>!e.some(e=>![n.Jq.Table,n.Jq.TableER,n.Jq.TableUML,n.Jq.CombinedFragment].includes(e.type)),p=e=>!e.some(e=>![n.Jq.Text,n.Jq.CompositeShape,n.Jq.Connector,n.Jq.StickyNote,n.Jq.MindMapNode,n.Jq.LifelineObject].includes(e.type)),g=e=>!e.some(e=>![n.Jq.Text,n.Jq.CompositeShape,n.Jq.StickyNote,n.Jq.MindMapNode,n.Jq.LifelineObject,n.Jq.Table,n.Jq.CombinedFragment].includes(e.type)),u=e=>{let t=[];return e.forEach(e=>{if(e.type===n.Jq.CombinedFragment);else{let{tableProps:a,tableStatus:n}=e,r=a.rows.length,l=a.columns.length,i=n.hasSelectItem(),o=n.getSelectedMatrix(r,l);for(let e=0;e<r;e++)for(let n=0;n<l;n++){let r=a.cellMatrix.getCell(e,n);r?.textProps&&(!i||o[e][n])&&t.push(r.textProps)}}}),t},x=e=>{let t=[];for(let a of e)switch(a.type){case n.Jq.CompositeShape:{t.push(a.getProp(r.d.Text));let{shapeType:e}=a;if(e===l.DY.dataProcess){let e=a.getProp(r.d.ExtraText);t.push(e)}break}case n.Jq.Connector:{let{captions:e}=a;e.length>0&&t.push(e[0].textProps);break}default:t.push(a.getProp(r.d.Text))}return t},y=(e,t,a={type:r.d.Text},l)=>{for(let r of e){let{textCharProps:e,textParagraphProps:s,...d}=a;if(t.actionManager.execAction(new i.x({id:r.id,props:[d]})),r.type===n.Jq.CombinedFragment);else{let{tableProps:e,tableStatus:a}=r,i=e.rows.length,s=e.columns.length,p=a.hasSelectItem(),g=a.getSelectedMatrix(i,s),u=function(e){let t=[],{tableCells:a}=e.tableProps;for(let n of a){let a=new c.f(n.i,n.j),r=e.cellTextMap.get(a.toString());n.textProps&&r&&(t[n.i]||=[],t[n.i][n.j]=r)}return t}(r),x=[];for(let t=0;t<i;t++)for(let a=0;a<s;a++){let i=e.cellMatrix.getCell(t,a);if(!i?.textProps||p&&!g[t][a])continue;let o={i:i.i,j:i.j,alpha:i.alpha,opacityProps:i.opacityProps,color:i.color??void 0},s=i.textProps.clone();if(s.update(d),h(s.textCharProps,d),r.type===n.Jq.Table&&u[t][a]){let{paragraphs:e}=u[t][a].renderText;M(e,s.textParagraphProps,l)}o.textProps=s,x.push(o)}x.length&&t.actionManager.execAction(new o.g({id:r.id,infos:x}))}}},f=(e,t,a={type:r.d.Text},o)=>{let{textCharProps:s,textParagraphProps:c,...d}=a;for(let a of e)switch(a.type){case n.Jq.CompositeShape:!function(e,t,a={type:r.d.Text},n){let{textCharProps:o,textParagraphProps:s}=e.textProps;h(o,a);let{paragraphs:c}=e.graphicText.renderText;M(c,s,n);let d=[{...a,textCharProps:o}];if(e.shapeType===l.DY.dataProcess){let t=e.getProp(r.d.ExtraText).clone();t.update(a),h(t.textCharProps,a);let{paragraphs:l}=e.extraText.renderText;M(l,t.textParagraphProps,n),d.push(t)}t.actionManager.execAction(new i.x({id:e.id,props:d}))}(a,t,d,o);break;case n.Jq.Connector:{let e=a.captionsProps.clone();if(0===e.captions.length)continue;let n=e.captions[0].textProps;n.update(d),h(n.textCharProps,d),t.actionManager.execAction(new i.x({id:a.id,props:[e]}));break}default:{let{textCharProps:e,textParagraphProps:n}=a.getProp(r.d.Text);h(e,d);let{paragraphs:l}=a.graphicText.renderText;M(l,n,o),t.actionManager.execAction(new i.x({id:a.id,props:[{...d,textCharProps:e}]}))}}};function h(e,t){if(0===e.length)return;let a=["bold","italic","fontSize","strikeThrough","underline"];Object.keys(t).filter(e=>a.includes(e)).forEach(a=>{e.forEach(e=>{e[a]=t[a]})})}function M(e,t,a){if(0!==e.length&&a&&0!==Object.keys(a).length)for(let r=0;r<e.length;r++)void 0===t[r]&&(t[r]=new s.W),"quote"in a&&(t[r].quote=a.quote),"listType"in a&&(t[r].listType=a.listType,t[r].listType===n.P0.ORDERED&&(t[r].indent=0,t[r].listIndex=r+1),t[r].computeOrderedListShowIndex())}},175747:function(e,t,a){a.d(t,{U:()=>n});class n{static IMAGE_BLOB_CACHE=new Map;static async downloadImageAsBlob(e){if(n.IMAGE_BLOB_CACHE.has(e))return n.IMAGE_BLOB_CACHE.get(e);let t=await fetch(e,{method:"GET",credentials:"include"}),a=await t.blob(),r=URL.createObjectURL(a);return n.IMAGE_BLOB_CACHE.set(e,r),r}uploadBlobImg(e,t){return new Promise((e,a)=>{e(URL.createObjectURL(t))})}}},227407:function(e,t,a){a.d(t,{c:()=>l});let n="",r=null;function l(){return n?Promise.resolve(n):r||(r=new Promise(async(e,t)=>{let a=new Blob(['<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="0 0 120 120" fill="none"><path d="M109.913 68.254v-7.701c4.306 2.726 5.607 5.932 5.607 9.168 0 1.388.007 2.525.014 3.57.012 1.856.022 3.421-.014 5.576-.401-2.406-1.556-7.633-5.607-10.614ZM10.33 42.75v7.681c-1.947 1.78-3.725 6.219-2.479 9.89-.29-.363-.558-.682-.808-.978C5.636 57.669 4.818 56.697 4 52.547c0-2.291.99-7.412 6.33-9.797Z" fill="#0C296E"/><path d="M10.33 23.174V93.59a4 4 0 0 0 4 4h38.975l8.61-20.393-11.634-19.334L61.915 31.61h-5.333a4 4 0 0 1-3.163-1.552l-7.226-9.333a4 4 0 0 0-3.163-1.551h-28.7a4 4 0 0 0-4 4Z" fill="#BBBFC4" fill-opacity=".45"/><path d="M109.912 93.59V35.61a4 4 0 0 0-4-4H73.093l-11.53 26.254L73.01 77.198 64.55 97.59h41.362a4 4 0 0 0 4-4Z" fill="#BBBFC4" fill-opacity=".45"/><path d="M5 64.511v-7.43c1.004 1.546 2.252 2.86 3.745 3.993 2.51 1.904 5.677 3.267 9.456 4.387v8.525C9.484 71.526 6.142 67.198 5 64.51Zm0-9.445a17.03 17.03 0 0 1-1-2.498V64.71c1.214 3.027 4.836 7.743 14.2 10.314.327.089.66.176 1 .26V64.71C12.19 62.727 7.494 60.067 5 55.066Z" fill="#0C296E"/><path d="M19.068 27.633a1.98 1.98 0 1 1 0 3.96 1.98 1.98 0 0 1 0-3.96Zm2.98 1.98a2.98 2.98 0 1 0-5.96 0 2.98 2.98 0 0 0 5.96 0Zm6.868-1.98a1.98 1.98 0 1 1 0 3.96 1.98 1.98 0 0 1 0-3.96Zm2.98 1.98a2.98 2.98 0 1 0-5.96 0 2.98 2.98 0 0 0 5.96 0ZM15.588 49.748a.5.5 0 0 1 .5-.5h20.899a.5.5 0 0 1 0 1h-20.9a.5.5 0 0 1-.5-.5Zm0 9.302a.5.5 0 0 1 .5-.5h20.899a.5.5 0 1 1 0 1h-20.9a.5.5 0 0 1-.5-.5Z" fill="#8F959E"/><path d="M95.314 104.058c10.449-.806 13.554-4.543 16.576-7.712v7.712c-1.843 2.771-8.201 5.994-16.576 6.666-8.374.673-18.03 0-34.045-.784v-6.663c12.691 0 23.597 1.587 34.045.781ZM80.542 89.192v-7.718c6.74.59 12.834 1.444 21.98 0 9.241-1.46 12.998-7.096 12.998-12.517v10.07c-.481 3.41-4.814 9.186-12.516 10.15-7.703.962-14.794.931-22.462.015Z" fill="#3370FF"/><path d="M5.4 93.674v-8.201c8.2 6.4 21.12 9.376 33.296 9.376v8.105c-14.094 0-27.696-3.679-33.297-9.28Z" fill="#00D6B9"/><path d="M98.031 44.633c9.941 0 18-8.06 18-18 0-9.941-8.059-18-18-18s-18 8.059-18 18c0 9.94 8.059 18 18 18Z" fill="#F80"/><path d="M97.213 18.451a.818.818 0 0 0-.819.818v9.819a.82.82 0 0 0 .819.818h1.636a.818.818 0 0 0 .818-.819V19.27a.818.818 0 0 0-.818-.818h-1.636Zm0 13.091a.818.818 0 0 0-.819.818v1.637c0 .452.367.818.819.818h1.636a.818.818 0 0 0 .818-.818V32.36a.818.818 0 0 0-.818-.818h-1.636Z" fill="#fff"/></svg>'],{type:"image/svg+xml"}),l=URL.createObjectURL(a),i=new Image;i.src=l;try{await i.decode(),n=l,r=null,e(n)}catch(t){n="",r=null,e("")}}))}},845426:function(e,t,a){a.d(t,{Dl:()=>l.D,WS:()=>r.W,ap:()=>n.N,cx:()=>i.c}),a(733999);var n=a(933552),r=a(706790);a(129476),a(750019),a(196468),a(931425),a(570148),a(671833),a(441505),a(937093),a(602534),a(243107),a(3981),a(793720),a(755928),a(797379),a(335342),a(138743),a(456323),a(873411),a(965732),a(596500),a(624362),a(128003),a(916207),a(873225),a(891763),a(976780),a(995363),a(635094),a(742849),a(561347),a(508241),a(732526),a(131326),a(826125),a(29725),a(272348),a(567524),a(205186),a(973042),a(268283),a(624905),a(272578),a(492663),a(451935),a(334918),a(541340),a(298809),a(175005),a(513665),a(455360),a(944379),a(397172),a(558040);var l=a(958926);a(539020),a(818856),a(276890),a(731082),a(645574),a(398799),a(452833),a(988382),a(592235),a(192657),a(648290),a(489597),a(515599),a(202473),a(374834),a(906891);var i=a(49104);a(805433),a(347250),a(180354),a(997299),a(968531),a(501458),a(785545),a(649356),a(911620),a(238897),a(788277),a(12506),a(107671),a(799473),a(578588),a(942068),a(943451)}}]);