"use strict";(window.webpackChunkweb=window.webpackChunkweb||[]).push([["55994"],{226511:function(){},277531:function(){},244433:function(e,n,i){i.d(n,{Z:()=>X});var o="&#8203;";function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var i=0,o=Array(n);i<n;i++)o[i]=e[i];return o}function a(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return r(e,void 0);var i=Object.prototype.toString.call(e).slice(8,-1);if("Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s={isEnabled:function(){var e;return null==(e=window.TAGIFY_DEBUG)||e},log:function(){for(var e,n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];this.isEnabled()&&(e=console).log.apply(e,["[Tagify]:"].concat(a(i)))},warn:function(){for(var e,n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];this.isEnabled()&&(e=console).warn.apply(e,["[Tagify]:"].concat(a(i)))}},l=function(e,n,i,o){return e=""+e,n=""+n,o&&(e=e.trim(),n=n.trim()),i?e==n:e.toLowerCase()==n.toLowerCase()},d=function(e,n){return e&&Array.isArray(e)&&e.map(function(e){return c(e,n)})};function c(e,n){var i,o={};for(i in e)0>n.indexOf(i)&&(o[i]=e[i]);return o}function u(e){return(new DOMParser).parseFromString(e.trim(),"text/html").body.firstElementChild}function h(e,n){for(n=n||"previous";e=e[n+"Sibling"];)if(3==e.nodeType)return e}function g(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/`|'/g,"&#039;"):e}function p(e){var n=Object.prototype.toString.call(e).split(" ")[1].slice(0,-1);return e===Object(e)&&"Array"!=n&&"Function"!=n&&"RegExp"!=n&&"HTMLUnknownElement"!=n}function f(e,n,i){var o,r;function a(e,n){for(var i in n)if(n.hasOwnProperty(i)){if(p(n[i])){p(e[i])?a(e[i],n[i]):e[i]=Object.assign({},n[i]);continue}if(Array.isArray(n[i])){e[i]=Object.assign([],n[i]);continue}e[i]=n[i]}}return o=e,(null!=(r=Object)&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?r[Symbol.hasInstance](o):o instanceof r)||(e={}),a(e,n),i&&a(e,i),e}function m(){var e=[],n={},i=!0,o=!1,r=void 0;try{for(var a,s=arguments[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var l=a.value,d=!0,c=!1,u=void 0;try{for(var h,g=l[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var f=h.value;p(f)?n[f.value]||(e.push(f),n[f.value]=1):e.includes(f)||e.push(f)}}catch(e){c=!0,u=e}finally{try{d||null==g.return||g.return()}finally{if(c)throw u}}}}catch(e){o=!0,r=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return e}function v(e){return String.prototype.normalize?"string"==typeof e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,""):void 0:e}var y=function(){return/(?=.*chrome)(?=.*android)/i.test(navigator.userAgent)};function w(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})}function b(e){var n,i=S.call(this,e),o=null==e||null==(n=e.classList)?void 0:n.contains(this.settings.classNames.tag);return i&&o}function x(e){return S.call(this,e)&&(null==e?void 0:e.closest(this.settings.classNames.tagSelector))}function S(e){var n;return(null==e||null==(n=e.closest)?void 0:n.call(e,this.settings.classNames.namespaceSelector))===this.DOM.scope}function T(e,n){var i=window.getSelection();return n=n||i.getRangeAt(0),"string"==typeof e&&(e=document.createTextNode(e)),n&&(n.deleteContents(),n.insertNode(e)),e}function E(e,n,i){return e?(n&&(e.__tagifyTagData=i?n:f({},e.__tagifyTagData||{},n)),e.__tagifyTagData):(s.warn("tag element doesn't exist",{tagElm:e,data:n}),n)}function M(e){if(e&&e.parentNode){var n=window.getSelection(),i=n.getRangeAt(0);n.rangeCount&&(i.setStartAfter(e),i.collapse(!0),n.removeAllRanges(),n.addRange(i))}}function C(e,n){e.forEach(function(e){if(E(e.previousSibling)||!e.previousSibling){var i=document.createTextNode("\u200B");e.before(i),n&&M(i)}})}var N={delimiters:",",pattern:null,tagTextProp:"value",maxTags:1/0,callbacks:{},addTagOnBlur:!0,addTagOn:["blur","tab","enter"],onChangeAfterBlur:!0,duplicates:!1,whitelist:[],blacklist:[],enforceWhitelist:!1,userInput:!0,focusable:!0,focusInputOnRemove:!0,keepInvalidTags:!1,createInvalidTags:!0,mixTagsAllowedAfter:/,|\.|\:|\s/,mixTagsInterpolator:["[[","]]"],backspace:!0,skipInvalid:!1,pasteAsTags:!0,editTags:{clicks:2,keepInvalid:!0},transformTag:function(){},trim:!0,a11y:{focusableTags:!1},mixMode:{insertAfterTag:"\xa0"},autoComplete:{enabled:!0,rightKey:!1,tabKey:!1},classNames:{namespace:"tagify",mixMode:"tagify--mix",selectMode:"tagify--select",input:"tagify__input",focus:"tagify--focus",tagNoAnimation:"tagify--noAnim",tagInvalid:"tagify--invalid",tagNotAllowed:"tagify--notAllowed",scopeLoading:"tagify--loading",hasMaxTags:"tagify--hasMaxTags",hasNoTags:"tagify--noTags",empty:"tagify--empty",inputInvalid:"tagify__input--invalid",dropdown:"tagify__dropdown",dropdownWrapper:"tagify__dropdown__wrapper",dropdownHeader:"tagify__dropdown__header",dropdownFooter:"tagify__dropdown__footer",dropdownItem:"tagify__dropdown__item",dropdownItemActive:"tagify__dropdown__item--active",dropdownItemHidden:"tagify__dropdown__item--hidden",dropdownItemSelected:"tagify__dropdown__item--selected",dropdownInital:"tagify__dropdown--initial",tag:"tagify__tag",tagText:"tagify__tag-text",tagX:"tagify__tag__removeBtn",tagLoading:"tagify__tag--loading",tagEditing:"tagify__tag--editable",tagFlash:"tagify__tag--flash",tagHide:"tagify__tag--hide"},dropdown:{classname:"",enabled:2,maxItems:10,searchKeys:["value","searchBy"],fuzzySearch:!0,caseSensitive:!1,accentedSearch:!0,includeSelectedTags:!1,escapeHTML:!0,highlightFirst:!0,closeOnSelect:!0,clearOnSelect:!0,position:"all",appendTarget:null},hooks:{beforeRemoveTag:function(){return Promise.resolve()},beforePaste:function(){return Promise.resolve()},suggestionClick:function(){return Promise.resolve()},beforeKeyDown:function(){return Promise.resolve()}}};function O(e,n){(null==n||n>e.length)&&(n=e.length);for(var i=0,o=Array(n);i<n;i++)o[i]=e[i];return o}function I(){for(var e in this.dropdown={},this._dropdown)this.dropdown[e]="function"==typeof this._dropdown[e]?this._dropdown[e].bind(this):this._dropdown[e];this.dropdown.refs(),this.DOM.dropdown.__tagify=this}var D,k,_=(D=function(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{},o=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),o.forEach(function(n){var o;o=i[n],n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o})}return e}({},{events:{binding:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this.dropdown.events.callbacks,i=this.listeners.dropdown=this.listeners.dropdown||{position:this.dropdown.position.bind(this,null),onKeyDown:n.onKeyDown.bind(this),onMouseOver:n.onMouseOver.bind(this),onMouseLeave:n.onMouseLeave.bind(this),onClick:n.onClick.bind(this),onScroll:n.onScroll.bind(this)},o=e?"addEventListener":"removeEventListener";"manual"!=this.settings.dropdown.position&&(document[o]("scroll",i.position,!0),window[o]("resize",i.position),window[o]("keydown",i.onKeyDown)),this.DOM.dropdown[o]("mouseover",i.onMouseOver),this.DOM.dropdown[o]("mouseleave",i.onMouseLeave),this.DOM.dropdown[o]("mousedown",i.onClick),this.DOM.dropdown.content[o]("scroll",i.onScroll)},callbacks:{onKeyDown:function(e){var n=this;if(this.state.hasFocus&&!this.state.composing){var i=this.settings,o=i.dropdown.includeSelectedTags,r=this.DOM.dropdown.querySelector(i.classNames.dropdownItemActiveSelector),a=this.dropdown.getSuggestionDataByNode(r),l="mix"==i.mode,d="select"==i.mode;i.hooks.beforeKeyDown(e,{tagify:this}).then(function(c){switch(e.key){case"ArrowDown":case"ArrowUp":case"Down":case"Up":e.preventDefault();var u=n.dropdown.getAllSuggestionsRefs(),h="ArrowUp"==e.key||"Up"==e.key;r&&(r=n.dropdown.getNextOrPrevOption(r,!h)),r&&r.matches(i.classNames.dropdownItemSelector)||(r=u[h?u.length-1:0]),n.dropdown.highlightOption(r,!0);break;case"PageUp":case"PageDown":e.preventDefault();var g,p=n.dropdown.getAllSuggestionsRefs(),f=Math.floor(n.DOM.dropdown.content.clientHeight/(null==(g=p[0])?void 0:g.offsetHeight))||1,m="PageUp"===e.key;if(r){var v=p.indexOf(r),y=m?Math.max(0,v-f):Math.min(p.length-1,v+f);r=p[y]}else r=p[0];n.dropdown.highlightOption(r,!0);break;case"Home":case"End":e.preventDefault();var w=n.dropdown.getAllSuggestionsRefs();r=w["Home"===e.key?0:w.length-1],n.dropdown.highlightOption(r,!0);break;case"Escape":case"Esc":n.dropdown.hide();break;case"ArrowRight":if(n.state.actions.ArrowLeft||i.autoComplete.rightKey)return;case"Tab":var b=!i.autoComplete.rightKey||!i.autoComplete.tabKey;if(!l&&!d&&r&&b&&!n.state.editing&&a){e.preventDefault();var x=n.dropdown.getMappedValue(a);return n.state.autoCompleteData=a,n.input.autocomplete.set.call(n,x),!1}return!0;case"Enter":e.preventDefault(),n.state.actions.selectOption=!0,setTimeout(function(){return n.state.actions.selectOption=!1},100),i.hooks.suggestionClick(e,{tagify:n,tagData:a,suggestionElm:r}).then(function(){if(r){var i=o?r:n.dropdown.getNextOrPrevOption(r,!h);n.dropdown.selectOption(r,e,function(){if(i){var e=i.getAttribute("value");i=n.dropdown.getSuggestionNodeByValue(e),n.dropdown.highlightOption(i)}})}else n.dropdown.hide(),l||n.addTags(n.state.inputText.trim(),!0)}).catch(function(e){return s.warn(e)});break;case"Backspace":if(l||n.state.editing.scope)return;var S=n.input.raw.call(n);""!=S&&8203!=S.charCodeAt(0)||(!0===i.backspace?n.removeTags():"edit"==i.backspace&&setTimeout(n.editTag.bind(n),0))}})}},onMouseOver:function(e){var n=e.target.closest(this.settings.classNames.dropdownItemSelector);this.dropdown.highlightOption(n)},onMouseLeave:function(e){this.dropdown.highlightOption()},onClick:function(e){var n=this;if(0==e.button&&e.target!=this.DOM.dropdown&&e.target!=this.DOM.dropdown.content){var i=e.target.closest(this.settings.classNames.dropdownItemSelector),o=this.dropdown.getSuggestionDataByNode(i);this.state.actions.selectOption=!0,setTimeout(function(){return n.state.actions.selectOption=!1},100),this.settings.hooks.suggestionClick(e,{tagify:this,tagData:o,suggestionElm:i}).then(function(){i?n.dropdown.selectOption(i,e):n.dropdown.hide()}).catch(function(e){return s.warn(e)})}},onScroll:function(e){var n=e.target,i=n.scrollTop/(n.scrollHeight-n.parentNode.clientHeight)*100;this.trigger("dropdown:scroll",{percentage:Math.round(i)})}}},refilter:function(e){e=e||this.state.dropdown.query||"",this.suggestedListItems=this.dropdown.filterListItems(e),this.dropdown.fill(),this.suggestedListItems.length||this.dropdown.hide(),this.trigger("dropdown:updated",this.DOM.dropdown)},getSuggestionDataByNode:function(e){for(var n,i=e&&e.getAttribute("value"),o=this.suggestedListItems.length;o--;){if(p(n=this.suggestedListItems[o])&&n.value==i)return n;if(n==i)return{value:n}}},getSuggestionNodeByValue:function(e){return this.dropdown.getAllSuggestionsRefs().find(function(n){return n.getAttribute("value")===e})},getNextOrPrevOption:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.dropdown.getAllSuggestionsRefs(),o=i.findIndex(function(n){return n===e});return n?i[o+1]:i[o-1]},highlightOption:function(e,n){var i,o=this.settings.classNames.dropdownItemActive;if(this.state.ddItemElm&&(this.state.ddItemElm.classList.remove(o),this.state.ddItemElm.removeAttribute("aria-selected")),!e)return this.state.ddItemData=null,this.state.ddItemElm=null,void this.input.autocomplete.suggest.call(this);i=this.dropdown.getSuggestionDataByNode(e),this.state.ddItemData=i,this.state.ddItemElm=e,e.classList.add(o),e.setAttribute("aria-selected",!0),n&&(e.parentNode.scrollTop=e.clientHeight+e.offsetTop-e.parentNode.clientHeight),this.settings.autoComplete&&(this.input.autocomplete.suggest.call(this,i),this.dropdown.position())},selectOption:function(e,n,i){var o=this,r=this.settings,a=r.dropdown.includeSelectedTags,s=r.dropdown,l=s.clearOnSelect,d=s.closeOnSelect;if(!e)return this.addTags(this.state.inputText,!0),void(d&&this.dropdown.hide());n=n||{};var c=e.getAttribute("value"),u="mix"==r.mode,h=this.suggestedListItems.find(function(e){var n;return(null!=(n=e.value)?n:e)==c});if(this.trigger("dropdown:select",{data:h,elm:e,event:n}),h||"noMatch"==c){if(this.state.editing){var g=this.normalizeTags([h])[0];h=r.transformTag.call(this,g)||g,this.onEditTagDone(null,f({__isValid:!0},h))}else this[u?"addMixTags":"addTags"]([h||this.input.raw.call(this)],l);(u||this.DOM.input.parentNode)&&(setTimeout(function(){o.DOM.input.focus(),o.toggleFocusClass(!0)}),d&&setTimeout(this.dropdown.hide.bind(this)),a?i&&i():(e.addEventListener("transitionend",function(){o.dropdown.fillHeaderFooter(),setTimeout(function(){e.remove(),o.dropdown.refilter(),i&&i()},100)},{once:!0}),e.classList.add(this.settings.classNames.dropdownItemHidden)))}else d&&setTimeout(this.dropdown.hide.bind(this))},selectAll:function(e){this.suggestedListItems.length=0,this.dropdown.hide(),this.dropdown.filterListItems("");var n=this.dropdown.filterListItems("");return e||(n=this.state.dropdown.suggestions),this.addTags(n,!0),this},filterListItems:function(e,n){var i,o,r,a,s,l,d=this,c=this.settings,u=c.dropdown,h=(n=n||{},[]),g=[],f=c.whitelist,m=u.maxItems>=0?u.maxItems:1/0,y=u.includeSelectedTags,w="function"==typeof u.sortby,b=u.searchKeys,x=0;if(!(e="select"==c.mode&&this.value.length&&this.value[0][c.tagTextProp]==e?"":e)||!b.length){h=y?f:f.filter(function(e){return!d.isTagDuplicate(p(e)?e.value:e)});var S=w?u.sortby(h,l):h.slice(0,m);return this.state.dropdown.suggestions=S,S}for(l=u.caseSensitive?""+e:(""+e).toLowerCase();x<f.length;x++)i=this,function(){var e,d,c=void 0,m=void 0;e=f[x];var y,w=Object.keys(o=(null!=(d=Object)&&"undefined"!=typeof Symbol&&d[Symbol.hasInstance]?d[Symbol.hasInstance](e):e instanceof d)?f[x]:{value:f[x]}).some(function(e){return b.includes(e)})?b:["value"];u.fuzzySearch&&!n.exact?(a=w.reduce(function(e,n){return e+" "+(o[n]||"")},"").toLowerCase().trim(),u.accentedSearch&&(a=v(a),l=v(l)),c=0==a.indexOf(l),m=a===l,y=a,r=l.toLowerCase().split(" ").every(function(e){return y.includes(e.toLowerCase())})):(c=!0,r=w.some(function(e){var i=""+(o[e]||"");return u.accentedSearch&&(i=v(i),l=v(l)),u.caseSensitive||(i=i.toLowerCase()),m=i===l,n.exact?i===l:0==i.indexOf(l)})),s=!u.includeSelectedTags&&i.isTagDuplicate(p(o)?o.value:o),r&&!s&&(m&&c?g.push(o):"startsWith"==u.sortby&&c?h.unshift(o):h.push(o))}();return this.state.dropdown.suggestions=g.concat(h),S=w?u.sortby(g.concat(h),l):g.concat(h).slice(0,m),this.state.dropdown.suggestions=S,S},getMappedValue:function(e){var n=this.settings.dropdown.mapValueTo;return n?"function"==typeof n?n(e):e[n]||e.value:e.value},createListHTML:function(e){var n=this;return f([],e).map(function(e,i){"string"!=typeof e&&"number"!=typeof e||(e={value:e});var o,r,a=n.dropdown.getMappedValue(e);return a="string"==typeof a&&n.settings.dropdown.escapeHTML?g(a):a,n.settings.templates.dropdownItem.apply(n,[(o=function(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{},o=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),o.forEach(function(n){var o;o=i[n],n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o})}return e}({},e),r=r={mappedValue:a},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):(function(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);i.push.apply(i,o)}return i})(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))}),o),n])}).join("")}}),k=k={refs:function(){this.DOM.dropdown=this.parseTemplate("dropdown",[this.settings]),this.DOM.dropdown.content=this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-wrapper']")},getHeaderRef:function(){return this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-header']")},getFooterRef:function(){return this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-footer']")},getAllSuggestionsRefs:function(){var e;return function(e){if(Array.isArray(e))return O(e)}(e=this.DOM.dropdown.content.querySelectorAll(this.settings.classNames.dropdownItemSelector))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return O(e,void 0);var i=Object.prototype.toString.call(e).slice(8,-1);if("Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return O(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},show:function(e){var n,i,o,r=this,a=this.settings,s="mix"==a.mode&&!a.enforceWhitelist,d=!a.whitelist||!a.whitelist.length,c="manual"==a.dropdown.position;if(e=void 0===e?this.state.inputText:e,!(d&&!s&&!a.templates.dropdownItemNoMatch||!1===a.dropdown.enabled||this.state.isLoading||this.settings.readonly)){if(clearTimeout(this.dropdownHide__bindEventsTimeout),this.suggestedListItems=this.dropdown.filterListItems(e),e&&!this.suggestedListItems.length&&(this.trigger("dropdown:noMatch",e),a.templates.dropdownItemNoMatch&&(o=a.templates.dropdownItemNoMatch.call(this,{value:e}))),!o){if(this.suggestedListItems.length)e&&s&&!this.state.editing.scope&&!l(this.suggestedListItems[0].value,e)&&this.suggestedListItems.unshift({value:e});else{if(!e||!s||this.state.editing.scope)return this.input.autocomplete.suggest.call(this),void this.dropdown.hide();this.suggestedListItems=[{value:e}]}i=""+(p(n=this.suggestedListItems[0])?n.value:n),a.autoComplete&&i&&0==i.indexOf(e)&&this.input.autocomplete.suggest.call(this,n)}this.dropdown.fill(o),a.dropdown.highlightFirst&&this.dropdown.highlightOption(this.DOM.dropdown.content.querySelector(a.classNames.dropdownItemSelector)),this.state.dropdown.visible||setTimeout(this.dropdown.events.binding.bind(this)),this.state.dropdown.visible=e||!0,this.state.dropdown.query=e,this.setStateSelection(),c||setTimeout(function(){r.dropdown.position(),r.dropdown.render()}),setTimeout(function(){r.trigger("dropdown:show",r.DOM.dropdown)})}},hide:function(e){var n=this,i=this.DOM,o=i.scope,r=i.dropdown,a="manual"==this.settings.dropdown.position&&!e;if(r&&document.body.contains(r)&&!a)return window.removeEventListener("resize",this.dropdown.position),this.dropdown.events.binding.call(this,!1),o.setAttribute("aria-expanded",!1),r.parentNode.removeChild(r),setTimeout(function(){n.state.dropdown.visible=!1},100),this.state.dropdown.query=this.state.ddItemData=this.state.ddItemElm=this.state.selection=null,this.state.tag&&this.state.tag.value.length&&(this.state.flaggedTags[this.state.tag.baseOffset]=this.state.tag),this.trigger("dropdown:hide",r),this},toggle:function(e){this.dropdown[this.state.dropdown.visible&&!e?"hide":"show"]()},getAppendTarget:function(){var e=this.settings.dropdown;return"function"==typeof e.appendTarget?e.appendTarget():e.appendTarget},render:function(){var e,n,i=this,o=((n=this.DOM.dropdown.cloneNode(!0)).style.cssText="position:fixed; top:-9999px; opacity:0",document.body.appendChild(n),e=n.clientHeight,n.parentNode.removeChild(n),e),r=this.settings,a=this.dropdown.getAppendTarget();return!1===r.dropdown.enabled||(this.DOM.scope.setAttribute("aria-expanded",!0),document.body.contains(this.DOM.dropdown)||(this.DOM.dropdown.classList.add(r.classNames.dropdownInital),this.dropdown.position(o),a.appendChild(this.DOM.dropdown),setTimeout(function(){return i.DOM.dropdown.classList.remove(r.classNames.dropdownInital)}))),this},fill:function(e){e="string"==typeof e?e:this.dropdown.createListHTML(e||this.suggestedListItems);var n=this.settings.templates.dropdownContent.call(this,e);this.DOM.dropdown.content.innerHTML=n?n.replace(/\>[\r\n ]+\</g,"><").split(/>\s+</).join("><").trim():""},fillHeaderFooter:function(){var e=this.dropdown.filterListItems(this.state.dropdown.query),n=this.parseTemplate("dropdownHeader",[e]),i=this.parseTemplate("dropdownFooter",[e]),o=this.dropdown.getHeaderRef(),r=this.dropdown.getFooterRef();n&&(null==o||o.parentNode.replaceChild(n,o)),i&&(null==r||r.parentNode.replaceChild(i,r))},position:function(e){var n=this.settings.dropdown,i=this.dropdown.getAppendTarget();if("manual"!=n.position&&i){var o,r,a,s,l,d,c,u,h,g,p=this.DOM.dropdown,f=n.RTL,m=i===document.body,v=i===this.DOM.scope,y=m?window.pageYOffset:i.scrollTop,w=document.fullscreenElement||document.webkitFullscreenElement||document.documentElement,b=w.clientHeight,x=Math.max(w.clientWidth||0,window.innerWidth||0),S=x>480?n.position:"all",T=this.DOM["input"==S?"input":"scope"];if(e=e||p.clientHeight,this.state.dropdown.visible){if("text"==S?(a=(o=function(){var e=document.getSelection();if(e.rangeCount){var n,i,o=e.getRangeAt(0),r=o.startContainer,a=o.startOffset;if(a>0)return(i=document.createRange()).setStart(r,a-1),i.setEnd(r,a),{left:(n=i.getBoundingClientRect()).right,top:n.top,bottom:n.bottom};if(r.getBoundingClientRect)return r.getBoundingClientRect()}return{left:-9999,top:-9999}}()).bottom,r=o.top,s=o.left,l="auto"):(d=function(e){var n=0,i=0;for(e=e.parentNode;e&&e!=w;)n+=e.offsetTop||0,i+=e.offsetLeft||0,e=e.parentNode;return{top:n,left:i}}(i),o=T.getBoundingClientRect(),r=v?-1:o.top-d.top,a=(v?o.height:o.bottom-d.top)-1,s=v?-1:o.left-d.left,l=o.width+"px"),!m){var E,M=function(){for(var e=0,i=n.appendTarget.parentNode;i;)e+=i.scrollTop||0,i=i.parentNode;return e}();r+=M,a+=M}r=Math.floor(r),a=Math.ceil(a),u=x-s<120,h=((c=null!=(E=n.placeAbove)?E:b-o.bottom<e)?r:a)+y,g=s+(f&&o.width||0)+window.pageXOffset,g="text"==S&&u?"right: 0;":"left: ".concat(g,"px;"),p.style.cssText="".concat(g," top: ").concat(h,"px; min-width: ").concat(l,"; max-width: ").concat(l),p.setAttribute("placement",c?"top":"bottom"),p.setAttribute("position",S)}}}},Object.getOwnPropertyDescriptors?Object.defineProperties(D,Object.getOwnPropertyDescriptors(k)):(function(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);i.push.apply(i,o)}return i})(Object(k)).forEach(function(e){Object.defineProperty(D,e,Object.getOwnPropertyDescriptor(k,e))}),D),A="@yaireo/tagify/",P={empty:"empty",exceed:"number of tags exceeded",pattern:"pattern mismatch",duplicate:"already exists",notAllowed:"not allowed"};function L(e,n){(null==n||n>e.length)&&(n=e.length);for(var i=0,o=Array(n);i<n;i++)o[i]=e[i];return o}function j(e,n){return null!=n&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](e):e instanceof n}function R(e,n){(null==n||n>e.length)&&(n=e.length);for(var i=0,o=Array(n);i<n;i++)o[i]=e[i];return o}function V(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function B(e,n){return null!=n&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](e):e instanceof n}function H(e){return function(e){if(Array.isArray(e))return R(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return R(e,void 0);var i=Object.prototype.toString.call(e).slice(8,-1);if("Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return R(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,n){(null==n||n>e.length)&&(n=e.length);for(var i=0,o=Array(n);i<n;i++)o[i]=e[i];return o}function z(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function F(e,n){return null!=n&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](e):e instanceof n}function W(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{},o=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),o.forEach(function(n){z(e,n,i[n])})}return e}function Z(e){return function(e){if(Array.isArray(e))return $(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return $(e,void 0);var i=Object.prototype.toString.call(e).slice(8,-1);if("Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return $(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(e,n){if(!e){s.warn("input element not found",e);var i,o,r,a,l=new Proxy(this,{get:function(){return function(){return l}}});return l}if(e.__tagify)return s.warn("input element is already Tagified - Same instance is returned.",e),e.__tagify;f(this,function(e){var n=document.createTextNode(""),i={};function o(e,i,o){o&&i.split(/\s+/g).forEach(function(i){return n[e+"EventListener"].call(n,i,o)})}return{removeAllCustomListeners:function(){Object.entries(i).forEach(function(e){var n=function(e){if(Array.isArray(e))return e}(e)||function(e,n){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var o,r,a=[],s=!0,l=!1;try{for(i=i.call(e);!(s=(o=i.next()).done)&&(a.push(o.value),a.length!==n);s=!0);}catch(e){l=!0,r=e}finally{try{s||null==i.return||i.return()}finally{if(l)throw r}}return a}}(e,2)||function(e,n){if(e){if("string"==typeof e)return L(e,2);var i=Object.prototype.toString.call(e).slice(8,-1);if("Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return L(e,n)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=n[0];n[1].forEach(function(e){return o("remove",i,e)})}),i={}},off:function(e,n){return e&&(n?o("remove",e,n):e.split(/\s+/g).forEach(function(e){var n;null==(n=i[e])||n.forEach(function(n){return o("remove",e,n)}),delete i[e]})),this},on:function(e,n){return n&&"function"==typeof n&&(e.split(/\s+/g).forEach(function(e){Array.isArray(i[e])?i[e].push(n):i[e]=[n]}),o("add",e,n)),this},trigger:function(i,o,r){var a;if(r=r||{cloneData:!0},i)if(e.settings.isJQueryPlugin)"remove"==i&&(i="removeTag"),jQuery(e.DOM.originalInput).triggerHandler(i,[o]);else{try{var l="object"==typeof o?o:{value:o};if((l=r.cloneData?f({},l):l).tagify=this,o.event&&(l.event=this.cloneEvent(o.event)),j(o,Object))for(var d in o)j(o[d],HTMLElement)&&(l[d]=o[d]);a=new CustomEvent(i,{detail:l})}catch(e){s.warn(e)}n.dispatchEvent(a)}}}}(this)),this.isFirefox=/firefox|fxios/i.test(navigator.userAgent)&&!/seamonkey/i.test(navigator.userAgent),this.isIE=window.document.documentMode,n=n||{},this.getPersistedData=(a=n.id,function(e){var n,i;if(a){if(1===(null==(n=localStorage)?void 0:n.getItem(A+a+"/v")))try{i=JSON.parse(localStorage[A+a+"/"+e])}catch(e){}return i}}),this.setPersistedData=(i=n.id)?(null==(o=localStorage)||o.setItem(A+i+"/v",1),function(e,n){var o,r=JSON.stringify(e);e&&n&&(null==(o=localStorage)||o.setItem(A+i+"/"+n,r),dispatchEvent(new Event("storage")))}):function(){},this.clearPersistedData=(r=n.id,function(e){var n=A+"/"+r+"/";if(e)localStorage.removeItem(n+e);else for(var i in localStorage)i.includes(n)&&localStorage.removeItem(i)}),this.applySettings(e,n),this.state={inputText:"",editing:!1,composing:!1,actions:{},mixMode:{},dropdown:{},flaggedTags:{}},this.value=[],this.listeners={},this.DOM={},this.build(e),I.call(this),this.getCSSVars(),this.loadOriginalValues(),this.events.customBinding.call(this),this.events.binding.call(this),e.autofocus&&this.DOM.input.focus(),e.__tagify=this}X.prototype={_dropdown:_,placeCaretAfterNode:M,getSetTagData:E,helpers:{sameStr:l,removeCollectionProp:d,omit:c,isObject:p,parseHTML:u,escapeHTML:g,extend:f,concatWithoutDups:m,getUID:w,isNodeTag:b},customEventsList:["change","add","remove","invalid","input","paste","click","keydown","focus","blur","edit:input","edit:beforeUpdate","edit:updated","edit:start","edit:keydown","dropdown:show","dropdown:hide","dropdown:select","dropdown:updated","dropdown:noMatch","dropdown:scroll"],dataProps:["__isValid","__removed","__originalData","__originalHTML","__tagId"],trim:function(e){return this.settings.trim&&e&&"string"==typeof e?e.trim():e},parseHTML:u,templates:{wrapper:function(e,n){return'<tags class="'.concat(n.classNames.namespace," ").concat(n.mode?"".concat(n.classNames[n.mode+"Mode"]):""," ").concat(e.className,'"\n                    ').concat(n.readonly?"readonly":"","\n                    ").concat(n.disabled?"disabled":"","\n                    ").concat(n.required?"required":"","\n                    ").concat("select"===n.mode?"spellcheck='false'":"",'\n                    tabIndex="-1">\n                    ').concat(this.settings.templates.input.call(this),"\n                ").concat(o,"\n        </tags>")},input:function(){var e=this.settings,n=e.placeholder||o;return"<span ".concat(!e.readonly&&e.userInput?"contenteditable":"",' data-can-editable tabIndex="0" data-placeholder="').concat(n,'" aria-placeholder="').concat(e.placeholder||"",'"\n                    class="').concat(e.classNames.input,'"\n                    role="textbox"\n                    autocapitalize="false"\n                    autocorrect="off"\n                    aria-autocomplete="both"\n                    aria-multiline="').concat("mix"==e.mode,'"></span>')},tag:function(e,n){var i=n.settings;return'<tag title="'.concat(e.title||e.value,"\"\n                    contenteditable='false'\n                    tabIndex=\"").concat(i.a11y.focusableTags?0:-1,'"\n                    class="').concat(i.classNames.tag," ").concat(e.class||"",'"\n                    ').concat(this.getAttributes(e),">\n            <x title='' tabIndex=\"").concat(i.a11y.focusableTags?0:-1,'" class="').concat(i.classNames.tagX,"\" role='button' aria-label='remove tag'></x>\n            <div>\n                <span ").concat("select"===i.mode&&i.userInput?"contenteditable='true'":"",' autocapitalize="false" autocorrect="off" spellcheck=\'false\' class="').concat(i.classNames.tagText,'">').concat(e[i.tagTextProp]||e.value,"</span>\n            </div>\n        </tag>")},dropdown:function(e){var n=e.dropdown,i="manual"==n.position;return'<div class="'.concat(i?"":e.classNames.dropdown," ").concat(n.classname,'" role="listbox" aria-labelledby="dropdown" dir="').concat(n.RTL?"rtl":"","\">\n                    <div data-selector='tagify-suggestions-wrapper' class=\"").concat(e.classNames.dropdownWrapper,'"></div>\n                </div>')},dropdownContent:function(e){var n=this.settings.templates,i=this.state.dropdown.suggestions;return"\n            ".concat(n.dropdownHeader.call(this,i),"\n            ").concat(e,"\n            ").concat(n.dropdownFooter.call(this,i),"\n        ")},dropdownItem:function(e){return"<div ".concat(this.getAttributes(e),"\n                    class='").concat(this.settings.classNames.dropdownItem," ").concat(this.isTagDuplicate(e.value)?this.settings.classNames.dropdownItemSelected:""," ").concat(e.class||"",'\'\n                    tabindex="0"\n                    role="option">').concat(e.mappedValue||e.value,"</div>")},dropdownHeader:function(e){return"<header data-selector='tagify-suggestions-header' class=\"".concat(this.settings.classNames.dropdownHeader,'"></header>')},dropdownFooter:function(e){var n=e.length-this.settings.dropdown.maxItems;return n>0?"<footer data-selector='tagify-suggestions-footer' class=\"".concat(this.settings.classNames.dropdownFooter,'">\n                ').concat(n," more items. Refine your search.\n            </footer>"):""},dropdownItemNoMatch:null},parseTemplate:function(e,n){return u((e=this.settings.templates[e]||e).apply(this,n))},set whitelist(t){var K=t&&Array.isArray(t);this.settings.whitelist=K?t:[],this.setPersistedData(K?t:[],"whitelist")},get whitelist(){return this.settings.whitelist},set userInput(t){this.settings.userInput=!!t,this.setContentEditable(!!t)},get userInput(){return this.settings.userInput},generateClassSelectors:function(e){var n=function(n){Object.defineProperty(e,n+"Selector",{get:function(){return"."+this[n].split(" ")[0]}})};for(var i in e)n(i)},applySettings:function(e,n){N.templates=this.templates;var i,o,r=f({},N,"mix"==n.mode?{dropdown:{position:"text"}}:{}),a=this.settings=f({},r,n);if(a.disabled=e.hasAttribute("disabled"),a.readonly=a.readonly||e.hasAttribute("readonly"),a.placeholder=g(e.getAttribute("placeholder")||a.placeholder||""),a.required=e.hasAttribute("required"),this.generateClassSelectors(a.classNames),this.isIE&&(a.autoComplete=!1),["whitelist","blacklist"].forEach(function(n){var i=e.getAttribute("data-"+n);i&&F(i=i.split(a.delimiters),Array)&&(a[n]=i)}),"autoComplete"in n&&!p(n.autoComplete)&&(a.autoComplete=N.autoComplete,a.autoComplete.enabled=n.autoComplete),"mix"==a.mode&&(a.pattern=a.pattern||/@/,a.autoComplete.rightKey=!0,a.delimiters=n.delimiters||null,a.tagTextProp&&!a.dropdown.searchKeys.includes(a.tagTextProp)&&a.dropdown.searchKeys.push(a.tagTextProp)),e.pattern)try{a.pattern=new RegExp(e.pattern)}catch(e){}if(a.delimiters){a._delimiters=a.delimiters;try{a.delimiters=RegExp(this.settings.delimiters,"g")}catch(e){}}(a.disabled||a.readonly)&&(a.userInput=!1),this.TEXTS=W({},P,a.texts||{}),"select"==a.mode&&(a.dropdown.includeSelectedTags=!0),("select"!=a.mode||(null==(i=n.dropdown)?void 0:i.enabled))&&a.userInput||(a.dropdown.enabled=0),a.disabled&&(a.dropdown.enabled=!1),a.dropdown.appendTarget=(null==(o=n.dropdown)?void 0:o.appendTarget)||document.body,void 0===a.dropdown.includeSelectedTags&&(a.dropdown.includeSelectedTags=a.duplicates);var s=this.getPersistedData("whitelist");Array.isArray(s)&&(this.whitelist=Array.isArray(a.whitelist)?m(a.whitelist,s):s)},getAttributes:function(e){var n,i=this.getCustomAttributes(e),o="";for(n in i)o+=" "+n+(void 0!==e[n]?'="'.concat(i[n],'"'):"");return o},getCustomAttributes:function(e){if(!p(e))return"";var n,i={};for(n in e)"__"!=n.slice(0,2)&&"class"!=n&&e.hasOwnProperty(n)&&void 0!==e[n]&&(i[n]=g(e[n]));return i},setStateSelection:function(){var e=window.getSelection(),n={anchorOffset:e.anchorOffset,anchorNode:e.anchorNode,range:e.getRangeAt&&e.rangeCount&&e.getRangeAt(0)};return this.state.selection=n,n},getCSSVars:function(){var e,n,i,o=getComputedStyle(this.DOM.scope,null);this.CSSVars={tagHideTransition:(n=(e=function(e){if(!e)return{};var n=(e=e.trim().split(" ")[0]).split(/\d+/g).filter(function(e){return e}).pop().trim();return{value:+e.split(n).filter(function(e){return e})[0].trim(),unit:n}}((i="tag-hide-transition",o.getPropertyValue("--"+i)))).value,"s"==e.unit?1e3*n:n)}},build:function(e){var n=this.DOM,i=e.closest("label");this.settings.mixMode.integrated?(n.originalInput=null,n.scope=e,n.input=e):(n.originalInput=e,n.originalInput_tabIndex=e.tabIndex,n.scope=this.parseTemplate("wrapper",[e,this.settings]),n.input=n.scope.querySelector(this.settings.classNames.inputSelector),e.parentNode.insertBefore(n.scope,e),e.tabIndex=-1),i&&i.setAttribute("for","")},destroy:function(){var e,n,i;this.events.unbindGlobal.call(this),null==(e=this.DOM.scope.parentNode)||e.removeChild(this.DOM.scope),this.DOM.originalInput.tabIndex=this.DOM.originalInput_tabIndex,delete this.DOM.originalInput.__tagify,this.dropdown.hide(!0),this.removeAllCustomListeners(),clearTimeout(this.dropdownHide__bindEventsTimeout),clearInterval(null==(i=this.listeners)||null==(n=i.main)?void 0:n.originalInputValueObserverInterval)},loadOriginalValues:function(e){var n,i=this.settings;if(this.state.blockChangeEvent=!0,void 0===e){var o=this.getPersistedData("value");e=o&&!this.DOM.originalInput.value?o:i.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value}if(this.removeAllTags(),e)if("mix"==i.mode)this.parseMixTags(e),(n=this.DOM.input.lastChild)&&"BR"==n.tagName||this.DOM.input.insertAdjacentHTML("beforeend","<br>");else{try{F(JSON.parse(e),Array)&&(e=JSON.parse(e))}catch(e){}this.addTags(e,!0).forEach(function(e){return e&&e.classList.add(i.classNames.tagNoAnimation)})}else this.postUpdate();this.state.lastOriginalValueReported=i.mixMode.integrated?"":this.DOM.originalInput.value},cloneEvent:function(e){var n={};for(var i in e)"path"!=i&&(n[i]=e[i]);return n},loading:function(e){return this.state.isLoading=e,this.DOM.scope.classList[e?"add":"remove"](this.settings.classNames.scopeLoading),this},tagLoading:function(e,n){return e&&e.classList[n?"add":"remove"](this.settings.classNames.tagLoading),this},toggleClass:function(e,n){"string"==typeof e&&this.DOM.scope.classList.toggle(e,n)},toggleScopeValidation:function(e){var n=!0===e||void 0===e;!this.settings.required&&e&&e===this.TEXTS.empty&&(n=!0),this.toggleClass(this.settings.classNames.tagInvalid,!n),this.DOM.scope.title=n?"":e},toggleFocusClass:function(e){this.toggleClass(this.settings.classNames.focus,!!e)},setPlaceholder:function(e){var n=this;["data","aria"].forEach(function(i){return n.DOM.input.setAttribute("".concat(i,"-placeholder"),e)})},triggerChangeEvent:function(){if(!this.settings.mixMode.integrated){var e=this.DOM.originalInput,n=this.state.lastOriginalValueReported!==e.value,i=new CustomEvent("change",{bubbles:!0});n&&(this.state.lastOriginalValueReported=e.value,i.simulated=!0,e._valueTracker&&e._valueTracker.setValue(Math.random()),e.dispatchEvent(i),this.trigger("change",this.state.lastOriginalValueReported),e.value=this.state.lastOriginalValueReported)}},events:{customBinding:function(){var e=this;this.customEventsList.forEach(function(n){e.on(n,e.settings.callbacks[n])})},binding:function(){var e,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=this.settings,o=this.events.callbacks,r=n?"addEventListener":"removeEventListener";if(!(this.state.mainEvents&&n||i.disabled||i.readonly)){for(var a in this.state.mainEvents=n,n&&!this.listeners.main&&(this.events.bindGlobal.call(this),this.settings.isJQueryPlugin&&jQuery(this.DOM.originalInput).on("tagify.removeAllTags",this.removeAllTags.bind(this))),e=this.listeners.main=this.listeners.main||{keydown:["input",o.onKeydown.bind(this)],click:["scope",o.onClickScope.bind(this)],dblclick:"select"!=i.mode&&["scope",o.onDoubleClickScope.bind(this)],paste:["input",o.onPaste.bind(this)],drop:["input",o.onDrop.bind(this)],compositionstart:["input",o.onCompositionStart.bind(this)],compositionend:["input",o.onCompositionEnd.bind(this)]})e[a]&&this.DOM[e[a][0]][r](a,e[a][1]);var s=this.listeners.main.inputMutationObserver||new MutationObserver(o.onInputDOMChange.bind(this));s.disconnect(),"mix"==i.mode&&s.observe(this.DOM.input,{childList:!0}),this.events.bindOriginaInputListener.call(this),n&&(this.listeners.main=void 0)}},bindOriginaInputListener:function(e){this.listeners.main&&(clearInterval(this.listeners.main.originalInputValueObserverInterval),this.listeners.main.originalInputValueObserverInterval=setInterval(this.events.callbacks.observeOriginalInputValue.bind(this),(e||0)+500))},bindGlobal:function(e){var n,i=this.events.callbacks,o=e?"removeEventListener":"addEventListener";if(this.listeners&&(e||!this.listeners.global)){this.listeners.global=this.listeners.global||[{type:this.isIE?"keydown":"input",target:this.DOM.input,cb:i[this.isIE?"onInputIE":"onInput"].bind(this)},{type:"keydown",target:window,cb:i.onWindowKeyDown.bind(this)},{type:"focusin",target:this.DOM.scope,cb:i.onFocusBlur.bind(this)},{type:"focusout",target:this.DOM.scope,cb:i.onFocusBlur.bind(this)},{type:"click",target:document,cb:i.onClickAnywhere.bind(this),useCapture:!0}];var r=!0,a=!1,s=void 0;try{for(var l,d=this.listeners.global[Symbol.iterator]();!(r=(l=d.next()).done);r=!0)(n=l.value).target[o](n.type,n.cb,!!n.useCapture)}catch(e){a=!0,s=e}finally{try{r||null==d.return||d.return()}finally{if(a)throw s}}e&&(this.listeners.global=void 0)}},unbindGlobal:function(){this.events.bindGlobal.call(this,!0)},callbacks:{onFocusBlur:function(e){var n,i,o=this.settings,r=x.call(this,e.relatedTarget),a=b.call(this,e.target),s=e.target.classList.contains(o.classNames.tagX),l="focusin"==e.type,d="focusout"==e.type;s&&"mix"!=o.mode&&o.focusInputOnRemove&&this.DOM.input.focus(),r&&l&&!a&&!s&&this.toggleFocusClass(this.state.hasFocus=+new Date);var c=e.target?this.trim(this.DOM.input.textContent):"",u=null==(i=this.value)||null==(n=i[0])?void 0:n[o.tagTextProp],h=o.dropdown.enabled>=0,g={relatedTarget:e.relatedTarget},p=this.state.actions.selectOption&&(h||!o.dropdown.closeOnSelect),f=this.state.actions.addNew&&h;if(d){if(e.relatedTarget===this.DOM.scope)return this.dropdown.hide(),void this.DOM.input.focus();this.postUpdate(),o.onChangeAfterBlur&&this.triggerChangeEvent()}if(!(p||f||s))if(this.state.hasFocus=!(!l&&!r)&&+new Date,this.toggleFocusClass(this.state.hasFocus),"mix"!=o.mode){if(l){if(!o.focusable)return;var m=0===o.dropdown.enabled&&!this.state.dropdown.visible,v=this.DOM.scope.querySelector(this.settings.classNames.tagTextSelector);return this.trigger("focus",g),void(m&&!a&&(this.dropdown.show(this.value.length?"":void 0),"select"===o.mode&&this.setRangeAtStartEnd(!1,v)))}if(d){if(this.trigger("blur",g),this.loading(!1),"select"==o.mode){if(this.value.length){var y=this.getTagElms()[0];c=this.trim(y.textContent)}u===c&&(c="")}c&&!this.state.actions.selectOption&&o.addTagOnBlur&&o.addTagOn.includes("blur")&&this.addTags(c,!0)}r||(this.DOM.input.removeAttribute("style"),this.dropdown.hide())}else l?this.trigger("focus",g):d&&(this.trigger("blur",g),this.loading(!1),this.dropdown.hide(),this.state.dropdown.visible=void 0,this.setStateSelection())},onCompositionStart:function(e){this.state.composing=!0},onCompositionEnd:function(e){this.state.composing=!1},onWindowKeyDown:function(e){var n,i=this.settings,o=document.activeElement,r=x.call(this,o)&&this.DOM.scope.contains(o),a=o===this.DOM.input,s=r&&o.hasAttribute("readonly"),l=this.DOM.scope.querySelector(this.settings.classNames.tagTextSelector),d=this.state.dropdown.visible;if(("Tab"===e.key&&d||this.state.hasFocus||r&&!s)&&!a){n=o.nextElementSibling;var c=e.target.classList.contains(i.classNames.tagX);switch(e.key){case"Backspace":i.readonly||this.state.editing||(this.removeTags(o),(n||this.DOM.input).focus());break;case"Enter":if(c)return void this.removeTags(e.target.parentNode);i.a11y.focusableTags&&b.call(this,o)&&setTimeout(this.editTag.bind(this),0,o);break;case"ArrowDown":this.state.dropdown.visible||"mix"==i.mode||this.dropdown.show();break;case"Tab":null==l||l.focus()}}},onKeydown:function(e){var n=this,i=this.settings;if(!this.state.composing&&i.userInput){"select"==i.mode&&i.enforceWhitelist&&this.value.length&&"Tab"!=e.key&&e.preventDefault();var o=this.trim(e.target.textContent);this.trigger("keydown",{event:e}),i.hooks.beforeKeyDown(e,{tagify:this}).then(function(r){if("mix"==i.mode){switch(e.key){case"Left":case"ArrowLeft":n.state.actions.ArrowLeft=!0;break;case"Delete":case"Backspace":if(n.state.editing)return;var a=document.getSelection(),s="Delete"==e.key&&a.anchorOffset==(a.anchorNode.length||0),l=a.anchorNode.previousSibling,d=1==a.anchorNode.nodeType||!a.anchorOffset&&l&&1==l.nodeType&&a.anchorNode.previousSibling;c=n.DOM.input.innerHTML,u=document.createElement("div"),c.replace(/\&#?[0-9a-z]+;/gi,function(e){return u.innerHTML=e,u.innerText});var c,u,g,p,f,m=n.getTagElms(),v=1===a.anchorNode.length&&a.anchorNode.nodeValue==String.fromCharCode(8203);if("edit"==i.backspace&&d)return g=1==a.anchorNode.nodeType?null:a.anchorNode.previousElementSibling,setTimeout(n.editTag.bind(n),0,g),void e.preventDefault();if(y()&&B(d,Element))return f=h(d),d.hasAttribute("readonly")||d.remove(),n.DOM.input.focus(),void setTimeout(function(){M(f),n.DOM.input.click()});if("BR"==a.anchorNode.nodeName)return;if((s||d)&&1==a.anchorNode.nodeType?p=0==a.anchorOffset?s?m[0]:null:m[Math.min(m.length,a.anchorOffset)-1]:s?p=a.anchorNode.nextElementSibling:B(d,Element)&&(p=d),3==a.anchorNode.nodeType&&!a.anchorNode.nodeValue&&a.anchorNode.previousElementSibling&&e.preventDefault(),(d||s)&&!i.backspace||"Range"!=a.type&&!a.anchorOffset&&a.anchorNode==n.DOM.input&&"Delete"!=e.key)return void e.preventDefault();if("Range"!=a.type&&p&&p.hasAttribute("readonly"))return void M(h(p));"Delete"==e.key&&v&&E(a.anchorNode.nextSibling)&&n.removeTags(a.anchorNode.nextSibling);break;case"Enter":if(e.preventDefault(),n.state.tag)return;var w=window.getSelection();w.getRangeAt(0).insertNode(document.createElement("br")),w.collapseToEnd()}return!0}var b="manual"==i.dropdown.position;switch(e.key){case"Backspace":"select"==i.mode&&i.enforceWhitelist&&n.value.length?n.removeTags():n.state.dropdown.visible&&"manual"!=i.dropdown.position||""!=e.target.textContent&&8203!=o.charCodeAt(0)||(!0===i.backspace?n.removeTags():"edit"==i.backspace&&setTimeout(n.editTag.bind(n),0));break;case"Esc":case"Escape":if(n.state.dropdown.visible)return;e.target.blur();break;case"Down":case"ArrowDown":n.state.dropdown.visible||n.dropdown.show();break;case"ArrowRight":var x=n.state.inputSuggestion||n.state.ddItemData;if(x&&i.autoComplete.rightKey)return void n.addTags([x],!0);break;case"Tab":return!0;case"Enter":if(n.state.dropdown.visible&&!b)return;e.preventDefault();var S=n.state.autoCompleteData||o;setTimeout(function(){n.state.dropdown.visible&&!b||n.state.actions.selectOption||!i.addTagOn.includes(e.key.toLowerCase())||(n.addTags([S],!0),n.state.autoCompleteData=null)})}}).catch(function(e){return e})}},onInput:function(e){this.postUpdate();var n=this.settings;if("mix"==n.mode)return this.events.callbacks.onMixTagsInput.call(this,e);var i=this.input.normalize.call(this,void 0,{trim:!1}),o=i.length>=n.dropdown.enabled,r={value:i,inputElm:this.DOM.input},a=this.validateTag({value:i});"select"==n.mode&&this.toggleScopeValidation(a),r.isValid=a,this.state.inputText!=i&&(this.input.set.call(this,i,!1),-1!=i.search(n.delimiters)?this.addTags(i)&&this.input.set.call(this):n.dropdown.enabled>=0&&this.dropdown[o?"show":"hide"](i),this.trigger("input",r))},onMixTagsInput:function(e){var n,i,o,r,a,s,l,d,c=this,u=this.settings,h=this.value.length,g=this.getTagElms(),p=document.createDocumentFragment(),m=window.getSelection().getRangeAt(0),v=[].map.call(g,function(e){return E(e).value});if("deleteContentBackward"==e.inputType&&y()&&this.events.callbacks.onKeydown.call(this,{target:e.target,key:"Backspace"}),C(this.getTagElms()),this.value.slice().forEach(function(e){e.readonly&&!v.includes(e.value)&&p.appendChild(c.createTagElem(e))}),p.childNodes.length&&(m.insertNode(p),this.setRangeAtStartEnd(!1,p.lastChild)),g.length!=h)return this.value=[].map.call(this.getTagElms(),function(e){return E(e)}),void this.update({withoutChangeEvent:!0});if(this.hasMaxTags())return!0;if(window.getSelection&&(s=window.getSelection()).rangeCount>0&&3==s.anchorNode.nodeType){if((m=s.getRangeAt(0).cloneRange()).collapse(!0),m.setStart(s.focusNode,0),o=(n=m.toString().slice(0,m.endOffset)).split(u.pattern).length-1,(i=n.match(u.pattern))&&(r=n.slice(n.lastIndexOf(i[i.length-1]))),r){if(this.state.actions.ArrowLeft=!1,this.state.tag={prefix:r.match(u.pattern)[0],value:r.replace(u.pattern,"")},this.state.tag.baseOffset=s.baseOffset-this.state.tag.value.length,d=this.state.tag.value.match(u.delimiters))return this.state.tag.value=this.state.tag.value.replace(u.delimiters,""),this.state.tag.delimiters=d[0],this.addTags(this.state.tag.value,u.dropdown.clearOnSelect),void this.dropdown.hide();a=this.state.tag.value.length>=u.dropdown.enabled;try{l=(l=this.state.flaggedTags[this.state.tag.baseOffset]).prefix==this.state.tag.prefix&&l.value[0]==this.state.tag.value[0],this.state.flaggedTags[this.state.tag.baseOffset]&&!this.state.tag.value&&delete this.state.flaggedTags[this.state.tag.baseOffset]}catch(e){}(l||o<this.state.mixMode.matchedPatternCount)&&(a=!1)}else this.state.flaggedTags={};this.state.mixMode.matchedPatternCount=o}setTimeout(function(){c.update({withoutChangeEvent:!0}),c.trigger("input",f({},c.state.tag,{textContent:c.DOM.input.textContent})),c.state.tag&&c.dropdown[a?"show":"hide"](c.state.tag.value)},10)},onInputIE:function(e){var n=this;setTimeout(function(){n.events.callbacks.onInput.call(n,e)})},observeOriginalInputValue:function(){this.DOM.originalInput.parentNode||this.destroy(),this.DOM.originalInput.value!=this.DOM.originalInput.tagifyValue&&this.loadOriginalValues()},onClickAnywhere:function(e){if(e.target!=this.DOM.scope&&!this.DOM.scope.contains(e.target)){this.toggleFocusClass(!1),this.state.hasFocus=!1;var n=e.target.closest(this.settings.classNames.dropdownSelector);(null==n?void 0:n.__tagify)!=this&&this.dropdown.hide()}},onClickScope:function(e){var n,i,o=this.settings,r=e.target.closest("."+o.classNames.tag);e.target,this.DOM.scope;var a=new Date-this.state.hasFocus;if(!e.target.classList.contains(o.classNames.tagX))return r&&!this.state.editing?(this.trigger("click",{tag:r,index:this.getNodeIndex(r),data:E(r),event:e}),void(1!==o.editTags&&1!==o.editTags.clicks&&"select"!=o.mode||this.events.callbacks.onDoubleClickScope.call(this,e))):void(e.target==this.DOM.input&&("mix"==o.mode&&this.fixFirefoxLastTagNoCaret(),a>500||!o.focusable)?this.state.dropdown.visible?this.dropdown.hide():0===o.dropdown.enabled&&"mix"!=o.mode&&this.dropdown.show(this.value.length?"":void 0):"select"!=o.mode||0!==o.dropdown.enabled||this.state.dropdown.visible||(this.events.callbacks.onDoubleClickScope.call(this,(n=function(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{},o=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),o.forEach(function(n){V(e,n,i[n])})}return e}({},e),i=i={target:this.getTagElms()[0]},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):(function(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);i.push.apply(i,o)}return i})(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))}),n)),!o.userInput&&this.dropdown.show()));this.removeTags(e.target.parentNode)},onPaste:function(e){var n=this;e.preventDefault();var i,o,r,a=this.settings;if(!a.userInput)return!1;a.readonly||(r=(o=e.clipboardData||window.clipboardData).getData("Text"),a.hooks.beforePaste(e,{tagify:this,pastedText:r,clipboardData:o}).then(function(a){void 0===a&&(a=r),a&&(n.injectAtCaret(a,window.getSelection().getRangeAt(0)),"mix"==n.settings.mode?n.events.callbacks.onMixTagsInput.call(n,e):n.settings.pasteAsTags?i=n.addTags(n.state.inputText+a,!0):(n.state.inputText=a,n.dropdown.show(a))),n.trigger("paste",{event:e,pastedText:r,clipboardData:o,tagsElems:i})}).catch(function(e){return e}))},onDrop:function(e){e.preventDefault()},onEditTagInput:function(e,n){var i,o=e.closest("."+this.settings.classNames.tag),r=this.getNodeIndex(o),a=E(o),s=this.input.normalize.call(this,e),l=(V(i={},this.settings.tagTextProp,s),V(i,"__tagId",a.__tagId),i),d=this.validateTag(l);this.editTagChangeDetected(f(a,l))||!0!==e.originalIsValid||(d=!0),o.classList.toggle(this.settings.classNames.tagInvalid,!0!==d),a.__isValid=d,o.title=!0===d?a.title||a.value:d,s.length>=this.settings.dropdown.enabled&&(this.state.editing&&(this.state.editing.value=s),this.dropdown.show(s)),this.trigger("edit:input",{tag:o,index:r,data:f({},this.value[r],{newValue:s}),event:n})},onEditTagPaste:function(e,n){var i=(n.clipboardData||window.clipboardData).getData("Text");n.preventDefault();var o=T(i);this.setRangeAtStartEnd(!1,o)},onEditTagClick:function(e,n){this.events.callbacks.onClickScope.call(this,n)},onEditTagFocus:function(e){this.state.editing={scope:e,input:e.querySelector("[contenteditable]")}},onEditTagBlur:function(e,n){var i=b.call(this,n.relatedTarget);if("select"==this.settings.mode&&i&&n.relatedTarget.contains(n.target))this.dropdown.hide();else if(this.state.editing&&(this.state.hasFocus||this.toggleFocusClass(),this.DOM.scope.contains(document.activeElement)||this.trigger("blur",{}),this.DOM.scope.contains(e))){var o,r,a,s,l=this.settings,d=e.closest("."+l.classNames.tag),c=E(d),u=this.input.normalize.call(this,e),h=(V(r={},l.tagTextProp,u),V(r,"__tagId",c.__tagId),r),g=c.__originalData,p=this.editTagChangeDetected(f(c,h)),m=this.validateTag(h);if(u)if(p){if(a=this.hasMaxTags(),s=f({},g,(V(o={},l.tagTextProp,this.trim(u)),V(o,"__isValid",m),o)),l.transformTag.call(this,s,g),!0!==(m=(!a||!0===g.__isValid)&&this.validateTag(s))){if(this.trigger("invalid",{data:s,tag:d,message:m}),l.editTags.keepInvalid)return;l.keepInvalidTags?s.__isValid=m:s=g}else l.keepInvalidTags&&(delete s.title,delete s["aria-invalid"],delete s.class);this.onEditTagDone(d,s)}else this.onEditTagDone(d,g);else this.onEditTagDone(d)}},onEditTagkeydown:function(e,n){if(!this.state.composing)switch(this.trigger("edit:keydown",{event:e}),e.key){case"Esc":case"Escape":this.state.editing=!1,n.__tagifyTagData.__originalData.value?n.parentNode.replaceChild(n.__tagifyTagData.__originalHTML,n):n.remove();break;case"Enter":case"Tab":e.preventDefault(),setTimeout(function(){return e.target.blur()},0)}},onDoubleClickScope:function(e){var n=e.target.closest("."+this.settings.classNames.tag);if(n){var i,o,r=E(n),a=this.settings;!1!==(null==r?void 0:r.editable)&&(i=n.classList.contains(this.settings.classNames.tagEditing),o=n.hasAttribute("readonly"),a.readonly||i||o||!this.settings.editTags||!a.userInput||(this.events.callbacks.onEditTagFocus.call(this,n),this.editTag(n)),this.toggleFocusClass(!0),"select"!=a.mode&&this.trigger("dblclick",{tag:n,index:this.getNodeIndex(n),data:E(n)}))}},onInputDOMChange:function(e){var n=this;e.forEach(function(e){e.addedNodes.forEach(function(e){if("<div><br></div>"==e.outerHTML)e.replaceWith(document.createElement("br"));else if(1==e.nodeType&&e.querySelector(n.settings.classNames.tagSelector)){var i,o=document.createTextNode("");3==e.childNodes[0].nodeType&&"BR"!=e.previousSibling.nodeName&&(o=document.createTextNode("\n")),e.replaceWith.apply(e,H([o].concat(H(H(e.childNodes).slice(0,-1))))),M(o)}else if(b.call(n,e))if(3!=(null==(i=e.previousSibling)?void 0:i.nodeType)||e.previousSibling.textContent||e.previousSibling.remove(),e.previousSibling&&"BR"==e.previousSibling.nodeName){e.previousSibling.replaceWith("\n\u200B");for(var r=e.nextSibling,a="";r;)a+=r.textContent,r=r.nextSibling;a.trim()&&M(e.previousSibling)}else e.previousSibling&&!E(e.previousSibling)||e.before("\u200B")}),e.removedNodes.forEach(function(e){e&&"BR"==e.nodeName&&b.call(n,i)&&(n.removeTags(i),n.fixFirefoxLastTagNoCaret())})});var i=this.DOM.input.lastChild;i&&""==i.nodeValue&&i.remove(),i&&"BR"==i.nodeName||this.DOM.input.appendChild(document.createElement("br"))}}},fixFirefoxLastTagNoCaret:function(){},setRangeAtStartEnd:function(e,n){if(n){e="number"==typeof e?e:!!e,n=n.lastChild||n;var i=document.getSelection();if(F(i.focusNode,Element)&&!this.DOM.input.contains(i.focusNode))return!0;try{i.rangeCount>=1&&["Start","End"].forEach(function(o){return i.getRangeAt(0)["set"+o](n,e||n.length)})}catch(e){console.warn(e)}}},insertAfterTag:function(e,n){if(n=n||this.settings.mixMode.insertAfterTag,e&&e.parentNode&&n)return n="string"==typeof n?document.createTextNode(n):n,e.parentNode.insertBefore(n,e.nextSibling),n},editTagChangeDetected:function(e){var n=e.__originalData;for(var i in n)if(!this.dataProps.includes(i)&&e[i]!=n[i])return!0;return!1},getTagTextNode:function(e){return e.querySelector(this.settings.classNames.tagTextSelector)},setTagTextNode:function(e,n){this.getTagTextNode(e).innerHTML=g(n)},editTag:function(e,n){var i=this;e=e||this.getLastTag(),n=n||{};var o=this.settings,r=this.getTagTextNode(e),a=this.getNodeIndex(e),l=E(e),d=this.events.callbacks,c=!0,u="select"==o.mode;if(u||this.dropdown.hide(),r){if(!F(l,Object)||!("editable"in l)||l.editable)return l=E(e,{__originalData:f({},l),__originalHTML:e.cloneNode(!0)}),E(l.__originalHTML,l.__originalData),r.setAttribute("contenteditable",!0),e.classList.add(o.classNames.tagEditing),this.events.callbacks.onEditTagFocus.call(this,e),r.addEventListener("click",d.onEditTagClick.bind(this,e)),r.addEventListener("blur",d.onEditTagBlur.bind(this,this.getTagTextNode(e))),r.addEventListener("input",d.onEditTagInput.bind(this,r)),r.addEventListener("paste",d.onEditTagPaste.bind(this,r)),r.addEventListener("keydown",function(n){return d.onEditTagkeydown.call(i,n,e)}),r.addEventListener("compositionstart",d.onCompositionStart.bind(this)),r.addEventListener("compositionend",d.onCompositionEnd.bind(this)),n.skipValidation||(c=this.editTagToggleValidity(e)),r.originalIsValid=c,this.trigger("edit:start",{tag:e,index:a,data:l,isValid:c}),r.focus(),u||this.setRangeAtStartEnd(!1,r),0!==o.dropdown.enabled||u||this.dropdown.show(),this.state.hasFocus=!0,this}else s.warn("Cannot find element in Tag template: .",o.classNames.tagTextSelector)},editTagToggleValidity:function(e,n){var i;if(n=n||E(e))return(i=!("__isValid"in n)||!0===n.__isValid)||this.removeTagsFromValue(e),this.update(),e.classList.toggle(this.settings.classNames.tagNotAllowed,!i),n.__isValid=i,n.__isValid;s.warn("tag has no data: ",e,n)},onEditTagDone:function(e,n){e=e||this.state.editing.scope,n=n||{};var i,o,r=this.settings,a={tag:e,index:this.getNodeIndex(e),previousData:E(e),data:n};this.trigger("edit:beforeUpdate",a,{cloneData:!1}),this.state.editing=!1,delete n.__originalData,delete n.__originalHTML,e&&e.parentNode&&((void 0!==(o=n[r.tagTextProp])?null==(i=(o+="").trim)?void 0:i.call(o):r.tagTextProp in n?void 0:n.value)?(e=this.replaceTag(e,n),this.editTagToggleValidity(e,n),r.a11y.focusableTags?e.focus():"select"!=r.mode&&M(e)):this.removeTags(e)),this.trigger("edit:updated",a),r.dropdown.closeOnSelect&&this.dropdown.hide(),this.settings.keepInvalidTags&&this.reCheckInvalidTags()},replaceTag:function(e,n){n&&""!==n.value&&void 0!==n.value||(n=e.__tagifyTagData),n.__isValid&&1!=n.__isValid&&f(n,this.getInvalidTagAttrs(n,n.__isValid));var i=this.createTagElem(n);return e.parentNode.replaceChild(i,e),this.updateValueByDOMTags(),i},updateValueByDOMTags:function(){var e=this;this.value.length=0;var n=this.settings.classNames,i=[n.tagNotAllowed.split(" ")[0],n.tagHide];[].forEach.call(this.getTagElms(),function(n){Z(n.classList).some(function(e){return i.includes(e)})||e.value.push(E(n))}),this.update(),this.dropdown.refilter()},injectAtCaret:function(e,n){if(n=n||(null==(i=this.state.selection)?void 0:i.range),"string"==typeof e&&(e=document.createTextNode(e)),!n&&e)return this.appendMixTags(e),this;if(!this.DOM.scope.contains(null==n?void 0:n.startContainer))return this;var i,o=T(e,n);return this.setRangeAtStartEnd(!1,o),this.updateValueByDOMTags(),this.update(),this},input:{set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.settings,o=i.dropdown.closeOnSelect;this.state.inputText=e,n&&(this.DOM.input.innerHTML=g(""+e),e&&this.toggleClass(i.classNames.empty,!this.DOM.input.innerHTML)),!e&&o&&this.dropdown.hide.bind(this),this.input.autocomplete.suggest.call(this),this.input.validate.call(this)},raw:function(){return this.DOM.input.textContent},validate:function(){var e=!this.state.inputText||!0===this.validateTag({value:this.state.inputText});return this.DOM.input.classList.toggle(this.settings.classNames.inputInvalid,!e),e},normalize:function(e,n){var i=e||this.DOM.input,o=[];i.childNodes.forEach(function(e){return 3==e.nodeType&&o.push(e.nodeValue)}),o=o.join("\n");try{o=o.replace(/(?:\r\n|\r|\n)/g,this.settings.delimiters.source.charAt(0))}catch(e){}return o=o.replace(/\s/g," "),(null==n?void 0:n.trim)?this.trim(o):o},autocomplete:{suggest:function(e){if(this.settings.autoComplete.enabled){"object"!=typeof(e=e||{value:""})&&(e={value:e});var n=this.dropdown.getMappedValue(e);if("number"!=typeof n){var i=this.state.inputText.toLowerCase(),o=n.substr(0,this.state.inputText.length).toLowerCase(),r=n.substring(this.state.inputText.length);n&&this.state.inputText&&o==i?(this.DOM.input.setAttribute("data-suggest",r),this.state.inputSuggestion=e):(this.DOM.input.removeAttribute("data-suggest"),delete this.state.inputSuggestion)}}},set:function(e){var n=this.DOM.input.getAttribute("data-suggest"),i=e||(n?this.state.inputText+n:null);return!!i&&("mix"==this.settings.mode?this.replaceTextWithNode(document.createTextNode(this.state.tag.prefix+i)):(this.input.set.call(this,i),this.setRangeAtStartEnd(!1,this.DOM.input)),this.input.autocomplete.suggest.call(this),this.dropdown.hide(),!0)}}},getTagIdx:function(e){return this.value.findIndex(function(n){return n.__tagId==(e||{}).__tagId})},getNodeIndex:function(e){var n=0;if(e)for(;e=e.previousElementSibling;)n++;return n},getTagElms:function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var o="."+Z(this.settings.classNames.tag.split(" ")).concat(Z(n)).join(".");return[].slice.call(this.DOM.scope.querySelectorAll(o))},getLastTag:function(){var e=this.settings.classNames,n=this.DOM.scope.querySelectorAll("".concat(e.tagSelector,":not(.").concat(e.tagHide,"):not([readonly])"));return n[n.length-1]},isTagDuplicate:function(e,n,i){var o=0,r=!0,a=!1,s=void 0;try{for(var d,c=this.value[Symbol.iterator]();!(r=(d=c.next()).done);r=!0){var u=d.value;l(this.trim(""+e),u.value,n)&&i!=u.__tagId&&o++}}catch(e){a=!0,s=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw s}}return o},getTagIndexByValue:function(e){var n=this,i=[],o=this.settings.dropdown.caseSensitive;return this.getTagElms().forEach(function(r,a){r.__tagifyTagData&&l(n.trim(r.__tagifyTagData.value),e,o)&&i.push(a)}),i},getTagElmByValue:function(e){var n=this.getTagIndexByValue(e)[0];return this.getTagElms()[n]},flashTag:function(e){var n=this;e&&(e.classList.add(this.settings.classNames.tagFlash),setTimeout(function(){e.classList.remove(n.settings.classNames.tagFlash)},100))},isTagBlacklisted:function(e){return e=this.trim(e.toLowerCase()),this.settings.blacklist.filter(function(n){return(""+n).toLowerCase()==e}).length},isTagWhitelisted:function(e){return!!this.getWhitelistItem(e)},getWhitelistItem:function(e,n,i){n=n||"value";var o,r=this.settings;return(i=i||r.whitelist).some(function(i){if(l("object"==typeof i?i[n]||i.value:i,e,r.dropdown.caseSensitive,r.trim))return o="object"==typeof i?i:{value:i},!0}),o||"value"!=n||"value"==r.tagTextProp||(o=this.getWhitelistItem(e,r.tagTextProp,i)),o},validateTag:function(e){var n=this.settings,i="value"in e?"value":n.tagTextProp,o=this.trim(e[i]+"");return(e[i]+"").trim()?"mix"!=n.mode&&n.pattern&&F(n.pattern,RegExp)&&!n.pattern.test(o)?this.TEXTS.pattern:!n.duplicates&&this.isTagDuplicate(o,n.dropdown.caseSensitive,e.__tagId)?this.TEXTS.duplicate:this.isTagBlacklisted(o)||n.enforceWhitelist&&!this.isTagWhitelisted(o)?this.TEXTS.notAllowed:!n.validate||n.validate(e):this.TEXTS.empty},getInvalidTagAttrs:function(e,n){return{"aria-invalid":!0,class:"".concat(e.class||""," ").concat(this.settings.classNames.tagNotAllowed).trim(),title:n}},hasMaxTags:function(){return this.value.length>=this.settings.maxTags&&this.TEXTS.exceed},setReadonly:function(e,n){var i=this.settings;this.DOM.scope.contains(document.activeElement)&&document.activeElement.blur(),i[n||"readonly"]=e,this.DOM.scope[(e?"set":"remove")+"Attribute"](n||"readonly",!0),this.settings.userInput=!0,this.setContentEditable(!e),e||(this.events.binding.call(this,!0),this.events.binding.call(this))},setContentEditable:function(e){this.DOM.scope.querySelectorAll("[data-can-editable]").forEach(function(n){n.contentEditable=e,n.tabIndex=e?0:-1})},setDisabled:function(e){this.setReadonly(e,"disabled")},normalizeTags:function(e){var n=this,i=this.settings,o=i.whitelist,r=i.delimiters,a=i.mode,s=i.tagTextProp,l=[],d=!!o&&F(o[0],Object),c=Array.isArray(e),u=c&&e[0].value,h=function(e){return(e+"").split(r).reduce(function(e,i){var o,r=n.trim(i);return r&&e.push((z(o={},s,r),z(o,"value",r),o)),e},[])};if("number"==typeof e&&(e=e.toString()),"string"==typeof e){if(!e.trim())return[];e=h(e)}else c&&(e=e.reduce(function(e,i){if(p(i)){var o=f({},i);s in o||(s="value"),o[s]=n.trim(o[s]),(o[s]||0===o[s])&&e.push(o)}else null!=i&&""!==i&&void 0!==i&&e.push.apply(e,Z(h(i)));return e},[]));return d&&!u&&(e.forEach(function(e){var i=l.map(function(e){return e.value}),o=n.dropdown.filterListItems.call(n,e[s],{exact:!0});n.settings.duplicates||(o=o.filter(function(e){return!i.includes(e.value)}));var r=o.length>1?n.getWhitelistItem(e[s],s,o):o[0];r&&F(r,Object)?l.push(r):"mix"!=a&&(null==e.value&&(e.value=e[s]),l.push(e))}),l.length&&(e=l)),e},parseMixTags:function(e){var n=this,i=this.settings,o=i.mixTagsInterpolator,r=i.duplicates,a=i.transformTag,s=i.enforceWhitelist,l=i.maxTags,d=i.tagTextProp,c=[];e=e.split(o[0]).map(function(e,i){var u,h,g,p=e.split(o[1]),f=p[0],m=c.length==l;try{if(f==+f)throw Error;h=JSON.parse(f)}catch(e){h=n.normalizeTags(f)[0]||{value:f}}if(a.call(n,h),m||!(p.length>1)||s&&!n.isTagWhitelisted(h.value)||!r&&n.isTagDuplicate(h.value)){if(e)return i?o[0]+e:e}else h[u=h[d]?d:"value"]=n.trim(h[u]),g=n.createTagElem(h),c.push(h),g.classList.add(n.settings.classNames.tagNoAnimation),p[0]=g.outerHTML,n.value.push(h);return p.join("")}).join(""),this.DOM.input.innerHTML=e,this.DOM.input.appendChild(document.createTextNode("")),this.DOM.input.normalize();var u=this.getTagElms();return u.forEach(function(e,n){return E(e,c[n])}),this.update({withoutChangeEvent:!0}),C(u,this.state.hasFocus),e},replaceTextWithNode:function(e,n){if(this.state.tag||n){n=n||this.state.tag.prefix+this.state.tag.value;var i,o,r=this.state.selection||window.getSelection(),a=r.anchorNode,s=this.state.tag.delimiters?this.state.tag.delimiters.length:0;return a.splitText(r.anchorOffset-s),-1==(i=a.nodeValue.lastIndexOf(n))||(o=a.splitText(i),e&&a.parentNode.replaceChild(e,o),!0)}},prepareNewTagNode:function(e,n){n=n||{};var i=this.settings,o=[],r={},a=Object.assign({},e,{value:e.value+""});if(e=Object.assign({},a),i.transformTag.call(this,e),e.__isValid=this.hasMaxTags()||this.validateTag(e),!0!==e.__isValid){if(n.skipInvalid)return;if(f(r,this.getInvalidTagAttrs(e,e.__isValid),{__preInvalidData:a}),e.__isValid==this.TEXTS.duplicate&&this.flashTag(this.getTagElmByValue(e.value)),!i.createInvalidTags)return void o.push(e.value)}return"readonly"in e&&(e.readonly?r["aria-readonly"]=!0:delete e.readonly),{tagElm:this.createTagElem(e,r),tagData:e,aggregatedInvalidInput:o}},postProcessNewTagNode:function(e,n){var i=this,o=this.settings,r=n.__isValid;r&&!0===r?this.value.push(n):(this.trigger("invalid",{data:n,index:this.value.length,tag:e,message:r}),o.keepInvalidTags||setTimeout(function(){return i.removeTags(e,!0)},1e3)),this.dropdown.position()},selectTag:function(e,n){var i=this;if(!this.settings.enforceWhitelist||this.isTagWhitelisted(n.value)){this.state.actions.selectOption&&setTimeout(function(){return i.setRangeAtStartEnd(!1,i.DOM.input)});var o=this.getLastTag();return o?this.replaceTag(o,n):this.appendTag(e),this.value[0]=n,this.update(),this.trigger("add",{tag:e,data:n}),[e]}},addEmptyTag:function(e){var n=f({value:""},e||{}),i=this.createTagElem(n);E(i,n),this.appendTag(i),this.editTag(i,{skipValidation:!0}),this.toggleFocusClass(!0)},addTags:function(e,n,i){var o=this,r=[],a=this.settings,s=[],l=document.createDocumentFragment(),d=[];if(!e||0==e.length)return r;switch(e=this.normalizeTags(e),a.mode){case"mix":return this.addMixTags(e);case"select":n=!1,this.removeAllTags()}return this.DOM.input.removeAttribute("style"),e.forEach(function(e){var n=o.prepareNewTagNode(e,{skipInvalid:i||a.skipInvalid});if(n){var c=n.tagElm;if(e=n.tagData,s=n.aggregatedInvalidInput,r.push(c),"select"==a.mode)return o.selectTag(c,e);l.appendChild(c),o.postProcessNewTagNode(c,e),d.push({tagElm:c,tagData:e})}}),this.appendTag(l),d.forEach(function(e){var n=e.tagElm,i=e.tagData;return o.trigger("add",{tag:n,index:o.getTagIdx(i),data:i})}),this.update(),e.length&&n&&(this.input.set.call(this,a.createInvalidTags?"":s.join(a._delimiters)),this.setRangeAtStartEnd(!1,this.DOM.input)),this.dropdown.refilter(),r},addMixTags:function(e){var n=this;if((e=this.normalizeTags(e))[0].prefix||this.state.tag)return this.prefixedTextToTag(e[0]);var i=document.createDocumentFragment(),o=[];return e.forEach(function(e){var r=n.prepareNewTagNode(e);i.appendChild(r.tagElm),n.insertAfterTag(r.tagElm),n.postProcessNewTagNode(r.tagElm,r.tagData),o.push({tagElm:r.tagElm,tagData:r.tagData})}),this.appendMixTags(i,o),i.children},appendMixTags:function(e,n){var i=!!this.state.selection;i?this.injectAtCaret(e):(this.DOM.input.focus(),(i=this.setStateSelection()).range.setStart(this.DOM.input,i.range.endOffset),i.range.setEnd(this.DOM.input,i.range.endOffset),this.DOM.input.appendChild(e),this.updateValueByDOMTags(),this.update(),this.trigger("add",{tags:n||e.children}))},prefixedTextToTag:function(e){var n,i,o,r=this,a=this.settings,s=null==(n=this.state.tag)?void 0:n.delimiters;return e.prefix=e.prefix||this.state.tag?this.state.tag.prefix:(a.pattern.source||a.pattern)[0],i=(o=this.prepareNewTagNode(e)).tagElm,this.replaceTextWithNode(i)||this.DOM.input.appendChild(i),setTimeout(function(){return i.classList.add(r.settings.classNames.tagNoAnimation)},300),this.update(),s||setTimeout(M,0,this.insertAfterTag(i)||i),this.state.tag=null,this.postProcessNewTagNode(i,o.tagData),this.trigger("add",{tag:o,data:e}),i},appendTag:function(e){var n=this.DOM,i=n.input;n.scope.insertBefore(e,i)},createTagElem:function(e,n){e.__tagId=w();var i,o=f({},e,W({value:g(e.value+"")},n));return function(e){for(var n,i=document.createNodeIterator(e,NodeFilter.SHOW_TEXT,null,!1);n=i.nextNode();)n.textContent.trim()||n.parentNode.removeChild(n)}(i=this.parseTemplate("tag",[o,this])),E(i,e),i},reCheckInvalidTags:function(){var e=this,n=this.settings;this.getTagElms(n.classNames.tagNotAllowed).forEach(function(i,o){var r=E(i),a=e.hasMaxTags(),s=e.validateTag(r),l=!0===s&&!a;if("select"==n.mode&&e.toggleScopeValidation(s),l)return r=r.__preInvalidData?r.__preInvalidData:{value:r.value},e.replaceTag(i,r);i.title=a||s})},removeTags:function(e,n,i){var o,r=this,a=this.settings;if(o=(e=e&&F(e,HTMLElement)?[e]:F(e,Array)?e:e?[e]:[this.getLastTag()].filter(function(e){return e})).reduce(function(e,n){n&&"string"==typeof n&&(n=r.getTagElmByValue(n));var i=E(n);return n&&i&&!i.readonly&&e.push({node:n,idx:r.getTagIdx(i),data:E(n,{__removed:!0})}),e},[]),i="number"==typeof i?i:this.CSSVars.tagHideTransition,"select"==a.mode&&(i=0,this.input.set.call(this)),1==o.length&&"select"!=a.mode&&o[0].node.classList.contains(a.classNames.tagNotAllowed)&&(n=!0),o.length)return a.hooks.beforeRemoveTag(o,{tagify:this}).then(function(){var e=function(e){e.node.parentNode&&(e.node.parentNode.removeChild(e.node),n?a.keepInvalidTags&&this.trigger("remove",{tag:e.node,index:e.idx}):(this.dropdown.refilter(),this.dropdown.position(),this.DOM.input.normalize(),a.keepInvalidTags&&this.reCheckInvalidTags(),this.trigger("remove",{tag:e.node,index:e.idx,data:e.data})))};n||(r.removeTagsFromValue(o.map(function(e){return e.node})),r.update(),"select"==a.mode&&a.userInput&&r.setContentEditable(!0)),i&&i>10&&1==o.length?(function(n){n.node.style.width=parseFloat(window.getComputedStyle(n.node).width)+"px",document.body.clientTop,n.node.classList.add(a.classNames.tagHide),setTimeout(e.bind(this),i,n)}).call(r,o[0]):o.forEach(e.bind(r))}).catch(function(e){})},removeTagsFromDOM:function(){this.getTagElms().forEach(function(e){return e.remove()})},removeTagsFromValue:function(e){var n=this;(e=Array.isArray(e)?e:[e]).forEach(function(e){var i=E(e),o=n.getTagIdx(i);o>-1&&n.value.splice(o,1)})},removeAllTags:function(e){var n=this;e=e||{},this.value=[],"mix"==this.settings.mode?this.DOM.input.innerHTML="":this.removeTagsFromDOM(),this.dropdown.refilter(),this.dropdown.position(),this.state.dropdown.visible&&setTimeout(function(){n.DOM.input.focus()}),"select"==this.settings.mode&&(this.input.set.call(this),this.settings.userInput&&this.setContentEditable(!0)),this.update(e,function(){n.trigger("remove",{})})},postUpdate:function(){this.state.blockChangeEvent=!1;var e,n,i=this.settings,o=i.classNames,r="mix"==i.mode?i.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value.trim():this.value.length+this.input.raw.call(this).length;this.toggleClass(o.hasMaxTags,this.value.length>=i.maxTags),this.toggleClass(o.hasNoTags,!this.value.length),this.toggleClass(o.empty,!r),"select"==i.mode&&this.toggleScopeValidation(null==(n=this.value)||null==(e=n[0])?void 0:e.__isValid)},setOriginalInputValue:function(e){var n=this.DOM.originalInput;this.settings.mixMode.integrated||(n.value=e,n.tagifyValue=n.value)},update:function(e,n){clearTimeout(this.debouncedUpdateTimeout),this.debouncedUpdateTimeout=setTimeout((function(){this.setPersistedData(i,"value"),this.settings.onChangeAfterBlur&&(e||{}).withoutChangeEvent||this.state.blockChangeEvent||this.triggerChangeEvent(),this.postUpdate(),null==n||n()}).bind(this),100),this.events.bindOriginaInputListener.call(this,100);var i=this.getInputValue();this.setOriginalInputValue(i)},getInputValue:function(){var e=this.getCleanValue();return"mix"==this.settings.mode?this.getMixedTagsAsString(e):e.length?this.settings.originalInputValueFormat?this.settings.originalInputValueFormat(e):JSON.stringify(e):""},getCleanValue:function(e){return d(e||this.value,this.dataProps)},getMixedTagsAsString:function(){var e="",n=this,i=this.settings,o=i.originalInputValueFormat||JSON.stringify,r=i.mixTagsInterpolator;return function i(a){a.childNodes.forEach(function(a){if(1==a.nodeType){var s=E(a);if("BR"==a.tagName&&(e+="\r\n"),s&&b.call(n,a)){if(s.__removed)return;e+=r[0]+o(c(s,n.dataProps))+r[1]}else a.getAttribute("style")||["B","I","U"].includes(a.tagName)?e+=a.textContent:"DIV"!=a.tagName&&"P"!=a.tagName||(e+="\r\n",i(a))}else e+=a.textContent})}(this.DOM.input),e}},X.prototype.removeTag=X.prototype.removeTags},394735:function(e){e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},87406:function(e,n,i){function o(e){var n=this;if(n instanceof o||(n=new o),n.tail=null,n.head=null,n.length=0,e&&"function"==typeof e.forEach)e.forEach(function(e){n.push(e)});else if(arguments.length>0)for(var i=0,r=arguments.length;i<r;i++)n.push(arguments[i]);return n}function r(e,n,i,o){if(!(this instanceof r))return new r(e,n,i,o);this.list=o,this.value=e,n?(n.next=this,this.prev=n):this.prev=null,i?(i.prev=this,this.next=i):this.next=null}e.exports=o,o.Node=r,o.create=o,o.prototype.removeNode=function(e){if(e.list!==this)throw Error("removing node which does not belong to this list");var n=e.next,i=e.prev;return n&&(n.prev=i),i&&(i.next=n),e===this.head&&(this.head=n),e===this.tail&&(this.tail=i),e.list.length--,e.next=null,e.prev=null,e.list=null,n},o.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var n=this.head;e.list=this,e.next=n,n&&(n.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},o.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var n=this.tail;e.list=this,e.prev=n,n&&(n.next=e),this.tail=e,this.head||(this.head=e),this.length++}},o.prototype.push=function(){for(var e,n,i=0,o=arguments.length;i<o;i++){e=this,n=arguments[i],e.tail=new r(n,e.tail,null,e),e.head||(e.head=e.tail),e.length++}return this.length},o.prototype.unshift=function(){for(var e,n,i=0,o=arguments.length;i<o;i++){e=this,n=arguments[i],e.head=new r(n,null,e.head,e),e.tail||(e.tail=e.head),e.length++}return this.length},o.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},o.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},o.prototype.forEach=function(e,n){n=n||this;for(var i=this.head,o=0;null!==i;o++)e.call(n,i.value,o,this),i=i.next},o.prototype.forEachReverse=function(e,n){n=n||this;for(var i=this.tail,o=this.length-1;null!==i;o--)e.call(n,i.value,o,this),i=i.prev},o.prototype.get=function(e){for(var n=0,i=this.head;null!==i&&n<e;n++)i=i.next;if(n===e&&null!==i)return i.value},o.prototype.getReverse=function(e){for(var n=0,i=this.tail;null!==i&&n<e;n++)i=i.prev;if(n===e&&null!==i)return i.value},o.prototype.map=function(e,n){n=n||this;for(var i=new o,r=this.head;null!==r;)i.push(e.call(n,r.value,this)),r=r.next;return i},o.prototype.mapReverse=function(e,n){n=n||this;for(var i=new o,r=this.tail;null!==r;)i.push(e.call(n,r.value,this)),r=r.prev;return i},o.prototype.reduce=function(e,n){var i,o=this.head;if(arguments.length>1)i=n;else if(this.head)o=this.head.next,i=this.head.value;else throw TypeError("Reduce of empty list with no initial value");for(var r=0;null!==o;r++)i=e(i,o.value,r),o=o.next;return i},o.prototype.reduceReverse=function(e,n){var i,o=this.tail;if(arguments.length>1)i=n;else if(this.tail)o=this.tail.prev,i=this.tail.value;else throw TypeError("Reduce of empty list with no initial value");for(var r=this.length-1;null!==o;r--)i=e(i,o.value,r),o=o.prev;return i},o.prototype.toArray=function(){for(var e=Array(this.length),n=0,i=this.head;null!==i;n++)e[n]=i.value,i=i.next;return e},o.prototype.toArrayReverse=function(){for(var e=Array(this.length),n=0,i=this.tail;null!==i;n++)e[n]=i.value,i=i.prev;return e},o.prototype.slice=function(e,n){(n=n||this.length)<0&&(n+=this.length),(e=e||0)<0&&(e+=this.length);var i=new o;if(n<e||n<0)return i;e<0&&(e=0),n>this.length&&(n=this.length);for(var r=0,a=this.head;null!==a&&r<e;r++)a=a.next;for(;null!==a&&r<n;r++,a=a.next)i.push(a.value);return i},o.prototype.sliceReverse=function(e,n){(n=n||this.length)<0&&(n+=this.length),(e=e||0)<0&&(e+=this.length);var i=new o;if(n<e||n<0)return i;e<0&&(e=0),n>this.length&&(n=this.length);for(var r=this.length,a=this.tail;null!==a&&r>n;r--)a=a.prev;for(;null!==a&&r>e;r--,a=a.prev)i.push(a.value);return i},o.prototype.splice=function(e,n,...i){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var o=0,a=this.head;null!==a&&o<e;o++)a=a.next;for(var s=[],o=0;a&&o<n;o++)s.push(a.value),a=this.removeNode(a);null===a&&(a=this.tail),a!==this.head&&a!==this.tail&&(a=a.prev);for(var o=0;o<i.length;o++)a=function(e,n,i){var o=n===e.head?new r(i,null,n,e):new r(i,n,n.next,e);return null===o.next&&(e.tail=o),null===o.prev&&(e.head=o),e.length++,o}(this,a,i[o]);return s},o.prototype.reverse=function(){for(var e=this.head,n=this.tail,i=e;null!==i;i=i.prev){var o=i.prev;i.prev=i.next,i.next=o}return this.head=n,this.tail=e,this};try{i(394735)(o)}catch(e){}},157404:function(e,n,i){i.d(n,{HH:()=>ex,Rr:()=>tb,_K:()=>en,ll:()=>tx,tV:()=>tm,x$:()=>tw});var o,r,a=i(931549),s=i(44492),l=i(417247),d=i(834370),c=i(997255),u=i(365574);i(395142);let h=(0,d.createContext)(null),g=h.Provider,p=l.Qj.error001();function f(e,n){let i=(0,d.useContext)(h);if(null===i)throw Error(p);return(0,c.s)(i,e,n)}function m(){let e=(0,d.useContext)(h);if(null===e)throw Error(p);return(0,d.useMemo)(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}let v={display:"none"},y={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},w="react-flow__node-desc",b="react-flow__edge-desc",x=e=>e.ariaLiveMessage;function S({rfId:e}){let n=f(x);return(0,a.jsx)("div",{id:`react-flow__aria-live-${e}`,"aria-live":"assertive","aria-atomic":"true",style:y,children:n})}function T({rfId:e,disableKeyboardA11y:n}){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{id:`${w}-${e}`,style:v,children:["Press enter or space to select a node.",!n&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),(0,a.jsx)("div",{id:`${b}-${e}`,style:v,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!n&&(0,a.jsx)(S,{rfId:e})]})}let E=e=>e.userSelectionActive?"none":"all";function M({position:e="top-left",children:n,className:i,style:o,...r}){let l=f(E),d=`${e}`.split("-");return(0,a.jsx)("div",{className:(0,s.Z)(["react-flow__panel",i,...d]),style:{...o,pointerEvents:l},...r,children:n})}function C({proOptions:e,position:n="bottom-right"}){return e?.hideAttribution?null:(0,a.jsx)(M,{position:n,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:(0,a.jsx)("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}let N=e=>{let n=[],i=[];for(let[,i]of e.nodeLookup)i.selected&&n.push(i.internals.userNode);for(let[,n]of e.edgeLookup)n.selected&&i.push(n);return{selectedNodes:n,selectedEdges:i}},O=e=>e.id;function I(e,n){return(0,u.X)(e.selectedNodes.map(O),n.selectedNodes.map(O))&&(0,u.X)(e.selectedEdges.map(O),n.selectedEdges.map(O))}function D({onSelectionChange:e}){let n=m(),{selectedNodes:i,selectedEdges:o}=f(N,I);return(0,d.useEffect)(()=>{let r={nodes:i,edges:o};e?.(r),n.getState().onSelectionChangeHandlers.forEach(e=>e(r))},[i,o,e]),null}let k=e=>!!e.onSelectionChangeHandlers;function _({onSelectionChange:e}){let n=f(k);return e||n?(0,a.jsx)(D,{onSelectionChange:e}):null}let A=[0,0],P={x:0,y:0,zoom:1},L=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance","rfId"],j=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),R={translateExtent:l.k5,nodeOrigin:A,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function V(e){let{setNodes:n,setEdges:i,setMinZoom:o,setMaxZoom:r,setTranslateExtent:a,setNodeExtent:s,reset:l,setDefaultNodesAndEdges:c,setPaneClickDistance:h}=f(j,u.X),g=m();(0,d.useEffect)(()=>(c(e.defaultNodes,e.defaultEdges),()=>{p.current=R,l()}),[]);let p=(0,d.useRef)(R);return(0,d.useEffect)(()=>{for(let l of L){let d=e[l];d!==p.current[l]&&void 0!==e[l]&&("nodes"===l?n(d):"edges"===l?i(d):"minZoom"===l?o(d):"maxZoom"===l?r(d):"translateExtent"===l?a(d):"nodeExtent"===l?s(d):"paneClickDistance"===l?h(d):"fitView"===l?g.setState({fitViewOnInit:d}):"fitViewOptions"===l?g.setState({fitViewOnInitOptions:d}):g.setState({[l]:d}))}p.current=e},L.map(n=>e[n])),null}function B(){return"undefined"!=typeof window&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null}let H="undefined"!=typeof document?document:null;function $(e=null,n={target:H,actInsideInputWithModifier:!0}){let[i,o]=(0,d.useState)(!1),r=(0,d.useRef)(!1),a=(0,d.useRef)(new Set([])),[s,c]=(0,d.useMemo)(()=>{if(null!==e){let n=(Array.isArray(e)?e:[e]).filter(e=>"string"==typeof e).map(e=>e.split("+")),i=n.reduce((e,n)=>e.concat(...n),[]);return[n,i]}return[[],[]]},[e]);return(0,d.useEffect)(()=>{let i=n?.target||H;if(null!==e){let e=e=>{if(r.current=e.ctrlKey||e.metaKey||e.shiftKey,(!r.current||r.current&&!n.actInsideInputWithModifier)&&(0,l.s$)(e))return!1;let i=F(e.code,c);a.current.add(e[i]),z(s,a.current,!1)&&(e.preventDefault(),o(!0))},d=e=>{if((!r.current||r.current&&!n.actInsideInputWithModifier)&&(0,l.s$)(e))return!1;let i=F(e.code,c);z(s,a.current,!0)?(o(!1),a.current.clear()):a.current.delete(e[i]),"Meta"===e.key&&a.current.clear(),r.current=!1},u=()=>{a.current.clear(),o(!1)};return i?.addEventListener("keydown",e),i?.addEventListener("keyup",d),window.addEventListener("blur",u),window.addEventListener("contextmenu",u),()=>{i?.removeEventListener("keydown",e),i?.removeEventListener("keyup",d),window.removeEventListener("blur",u),window.removeEventListener("contextmenu",u)}}},[e,o]),i}function z(e,n,i){return e.filter(e=>i||e.length===n.size).some(e=>e.every(e=>n.has(e)))}function F(e,n){return n.includes(e)?"code":"key"}function W(e,n){let i=[],o=new Map,r=[];for(let n of e)if("add"===n.type){r.push(n);continue}else if("remove"===n.type||"replace"===n.type)o.set(n.id,[n]);else{let e=o.get(n.id);e?e.push(n):o.set(n.id,[n])}for(let e of n){let n=o.get(e.id);if(!n){i.push(e);continue}if("remove"===n[0].type)continue;if("replace"===n[0].type){i.push({...n[0].item});continue}let r={...e};for(let e of n){var a=e,s=r;switch(a.type){case"select":s.selected=a.selected;break;case"position":void 0!==a.position&&(s.position=a.position),void 0!==a.dragging&&(s.dragging=a.dragging);break;case"dimensions":void 0!==a.dimensions&&(s.measured??={},s.measured.width=a.dimensions.width,s.measured.height=a.dimensions.height,a.setAttributes&&(s.width=a.dimensions.width,s.height=a.dimensions.height)),"boolean"==typeof a.resizing&&(s.resizing=a.resizing)}}i.push(r)}return r.length&&r.forEach(e=>{void 0!==e.index?i.splice(e.index,0,{...e.item}):i.push({...e.item})}),i}function Z(e,n){return{id:e,type:"select",selected:n}}function X(e,n=new Set,i=!1){let o=[];for(let[r,a]of e){let e=n.has(r);(void 0!==a.selected||e)&&a.selected!==e&&(i&&(a.selected=e),o.push(Z(a.id,e)))}return o}function K({items:e=[],lookup:n}){let i=[],o=new Map(e.map(e=>[e.id,e]));for(let[o,r]of e.entries()){let e=n.get(r.id),a=e?.internals?.userNode??e;void 0!==a&&a!==r&&i.push({id:r.id,item:r,type:"replace"}),void 0===a&&i.push({item:r,type:"add",index:o})}for(let[e]of n)void 0===o.get(e)&&i.push({id:e,type:"remove"});return i}function Y(e){return{id:e.id,type:"remove"}}let U=e=>(0,l.Vt)(e);function q(e){return(0,d.forwardRef)(e)}let Q="undefined"!=typeof window?d.useLayoutEffect:d.useEffect;function J(e){let[n,i]=(0,d.useState)(!1),[o]=(0,d.useState)(()=>{var e;let n;return e=()=>i(!0),n=[],{get:()=>n,reset:()=>{n=[]},push:i=>{n.push(i),e()}}});return Q(()=>{if(!n)return void o.reset();let r=o.get();r.length&&(e(r),o.reset()),i(!1)},[n]),o}let G=(0,d.createContext)(null);function ee({children:e}){let n=m(),i=J((0,d.useCallback)(e=>{let{nodes:i=[],setNodes:o,hasDefaultNodes:r,onNodesChange:a,nodeLookup:s}=n.getState(),l=i;for(let n of e)l="function"==typeof n?n(l):n;r?o(l):a&&a(K({items:l,lookup:s}))},[])),o=J((0,d.useCallback)(e=>{let{edges:i=[],setEdges:o,hasDefaultEdges:r,onEdgesChange:a,edgeLookup:s}=n.getState(),l=i;for(let n of e)l="function"==typeof n?n(l):n;r?o(l):a&&a(K({items:l,lookup:s}))},[])),r=(0,d.useMemo)(()=>({nodeQueue:i,edgeQueue:o}),[]);return(0,a.jsx)(G.Provider,{value:r,children:e})}let et=e=>!!e.panZoom;function en(){let e=(()=>{let e=m();return(0,d.useMemo)(()=>({zoomIn:n=>{let{panZoom:i}=e.getState();return i?i.scaleBy(1.2,{duration:n?.duration}):Promise.resolve(!1)},zoomOut:n=>{let{panZoom:i}=e.getState();return i?i.scaleBy(1/1.2,{duration:n?.duration}):Promise.resolve(!1)},zoomTo:(n,i)=>{let{panZoom:o}=e.getState();return o?o.scaleTo(n,{duration:i?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(n,i)=>{let{transform:[o,r,a],panZoom:s}=e.getState();return s?(await s.setViewport({x:n.x??o,y:n.y??r,zoom:n.zoom??a},{duration:i?.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{let[n,i,o]=e.getState().transform;return{x:n,y:i,zoom:o}},fitView:n=>{let{nodeLookup:i,width:o,height:r,minZoom:a,maxZoom:s,panZoom:d}=e.getState(),c=(0,l.J6)(i,n);return d?(0,l.Qu)({nodes:c,width:o,height:r,minZoom:a,maxZoom:s,panZoom:d},n):Promise.resolve(!1)},setCenter:async(n,i,o)=>{let{width:r,height:a,maxZoom:s,panZoom:l}=e.getState(),d=void 0!==o?.zoom?o.zoom:s;return l?(await l.setViewport({x:r/2-n*d,y:a/2-i*d,zoom:d},{duration:o?.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(n,i)=>{let{width:o,height:r,minZoom:a,maxZoom:s,panZoom:d}=e.getState(),c=(0,l.$i)(n,o,r,a,s,i?.padding??.1);return d?(await d.setViewport(c,{duration:i?.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(n,i={snapToGrid:!0})=>{let{transform:o,snapGrid:r,domNode:a}=e.getState();if(!a)return n;let{x:s,y:d}=a.getBoundingClientRect(),c={x:n.x-s,y:n.y-d};return(0,l.m)(c,o,i.snapToGrid,r)},flowToScreenPosition:n=>{let{transform:i,domNode:o}=e.getState();if(!o)return n;let{x:r,y:a}=o.getBoundingClientRect(),s=(0,l.oj)(n,i);return{x:s.x+r,y:s.y+a}}}),[])})(),n=m(),i=function(){let e=(0,d.useContext)(G);if(!e)throw Error("useBatchContext must be used within a BatchProvider");return e}(),o=f(et),r=(0,d.useMemo)(()=>{let e=e=>n.getState().nodeLookup.get(e),o=e=>{i.nodeQueue.push(e)},r=e=>{i.edgeQueue.push(e)},a=e=>{let{nodeLookup:i,nodeOrigin:o}=n.getState(),r=U(e)?e:i.get(e.id),a=r.parentId?(0,l.ZB)(r.position,r.measured,r.parentId,i,o):r.position,s={id:r.id,position:a,width:r.measured?.width??r.width,height:r.measured?.height??r.height,data:r.data};return(0,l.PS)(s)},s=(e,n,i={replace:!1})=>{o(o=>o.map(o=>{if(o.id===e){let e="function"==typeof n?n(o):n;return i.replace&&U(e)?e:{...o,...e}}return o}))},d=(e,n,i={replace:!1})=>{r(o=>o.map(o=>{if(o.id===e){let e="function"==typeof n?n(o):n;return i.replace&&(0,l.J3)(e)?e:{...o,...e}}return o}))};return{getNodes:()=>n.getState().nodes.map(e=>({...e})),getNode:n=>e(n)?.internals.userNode,getInternalNode:e,getEdges:()=>{let{edges:e=[]}=n.getState();return e.map(e=>({...e}))},getEdge:e=>n.getState().edgeLookup.get(e),setNodes:o,setEdges:r,addNodes:e=>{let n=Array.isArray(e)?e:[e];i.nodeQueue.push(e=>[...e,...n])},addEdges:e=>{let n=Array.isArray(e)?e:[e];i.edgeQueue.push(e=>[...e,...n])},toObject:()=>{let{nodes:e=[],edges:i=[],transform:o}=n.getState(),[r,a,s]=o;return{nodes:e.map(e=>({...e})),edges:i.map(e=>({...e})),viewport:{x:r,y:a,zoom:s}}},deleteElements:async({nodes:e=[],edges:i=[]})=>{let{nodes:o,edges:r,onNodesDelete:a,onEdgesDelete:s,triggerNodeChanges:d,triggerEdgeChanges:c,onDelete:u,onBeforeDelete:h}=n.getState(),{nodes:g,edges:p}=await (0,l.WD)({nodesToRemove:e,edgesToRemove:i,nodes:o,edges:r,onBeforeDelete:h}),f=p.length>0,m=g.length>0;if(f){let e=p.map(Y);s?.(p),c(e)}if(m){let e=g.map(Y);a?.(g),d(e)}return(m||f)&&u?.({nodes:g,edges:p}),{deletedNodes:g,deletedEdges:p}},getIntersectingNodes:(e,i=!0,o)=>{let r=(0,l.J$)(e),s=r?e:a(e),d=void 0!==o;return s?(o||n.getState().nodes).filter(o=>{let a=n.getState().nodeLookup.get(o.id);if(a&&!r&&(o.id===e.id||!a.internals.positionAbsolute))return!1;let c=(0,l.PS)(d?o:a),u=(0,l.lp)(c,s);return i&&u>0||u>=s.width*s.height}):[]},isNodeIntersecting:(e,n,i=!0)=>{let o=(0,l.J$)(e)?e:a(e);if(!o)return!1;let r=(0,l.lp)(o,n);return i&&r>0||r>=o.width*o.height},updateNode:s,updateNodeData:(e,n,i={replace:!1})=>{s(e,e=>{let o="function"==typeof n?n(e):n;return i.replace?{...e,data:o}:{...e,data:{...e.data,...o}}},i)},updateEdge:d,updateEdgeData:(e,n,i={replace:!1})=>{d(e,e=>{let o="function"==typeof n?n(e):n;return i.replace?{...e,data:o}:{...e,data:{...e.data,...o}}},i)},getHandleConnections:({type:e,id:i,nodeId:o})=>Array.from(n.getState().connectionLookup.get(`${o}-${e}-${i??null}`)?.values()??[])}},[]);return(0,d.useMemo)(()=>({...r,...e,viewportInitialized:o}),[o])}let ei=e=>e.selected,eo={actInsideInputWithModifier:!1},er="undefined"!=typeof window?window:void 0,ea={position:"absolute",width:"100%",height:"100%",top:0,left:0},es=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function el({onPaneContextMenu:e,zoomOnScroll:n=!0,zoomOnPinch:i=!0,panOnScroll:o=!1,panOnScrollSpeed:r=.5,panOnScrollMode:s=l.IY.Free,zoomOnDoubleClick:c=!0,panOnDrag:h=!0,defaultViewport:g,translateExtent:p,minZoom:v,maxZoom:y,zoomActivationKeyCode:w,preventScrolling:b=!0,children:x,noWheelClassName:S,noPanClassName:T,onViewportChange:E,isControlledViewport:M,paneClickDistance:C}){let N=m(),O=(0,d.useRef)(null),{userSelectionActive:I,lib:D}=f(es,u.X),k=$(w),_=(0,d.useRef)(),A=m();(0,d.useEffect)(()=>{let e=()=>{if(!O.current)return!1;let e=(0,l.t_)(O.current);(0===e.height||0===e.width)&&A.getState().onError?.("004",l.Qj.error004()),A.setState({width:e.width||500,height:e.height||500})};if(O.current){e(),window.addEventListener("resize",e);let n=new ResizeObserver(()=>e());return n.observe(O.current),()=>{window.removeEventListener("resize",e),n&&O.current&&n.unobserve(O.current)}}},[]);let P=(0,d.useCallback)(e=>{E?.({x:e[0],y:e[1],zoom:e[2]}),M||N.setState({transform:e})},[E,M]);return(0,d.useEffect)(()=>{if(O.current){_.current=(0,l.X6)({domNode:O.current,minZoom:v,maxZoom:y,translateExtent:p,viewport:g,paneClickDistance:C,onDraggingChange:e=>N.setState({paneDragging:e}),onPanZoomStart:(e,n)=>{let{onViewportChangeStart:i,onMoveStart:o}=N.getState();o?.(e,n),i?.(n)},onPanZoom:(e,n)=>{let{onViewportChange:i,onMove:o}=N.getState();o?.(e,n),i?.(n)},onPanZoomEnd:(e,n)=>{let{onViewportChangeEnd:i,onMoveEnd:o}=N.getState();o?.(e,n),i?.(n)}});let{x:e,y:n,zoom:i}=_.current.getViewport();return N.setState({panZoom:_.current,transform:[e,n,i],domNode:O.current.closest(".react-flow")}),()=>{_.current?.destroy()}}},[]),(0,d.useEffect)(()=>{_.current?.update({onPaneContextMenu:e,zoomOnScroll:n,zoomOnPinch:i,panOnScroll:o,panOnScrollSpeed:r,panOnScrollMode:s,zoomOnDoubleClick:c,panOnDrag:h,zoomActivationKeyPressed:k,preventScrolling:b,noPanClassName:T,userSelectionActive:I,noWheelClassName:S,lib:D,onTransformChange:P})},[e,n,i,o,r,s,c,h,k,b,T,I,S,D,P]),(0,a.jsx)("div",{className:"react-flow__renderer",ref:O,style:ea,children:x})}let ed=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function ec(){let{userSelectionActive:e,userSelectionRect:n}=f(ed,u.X);return e&&n?(0,a.jsx)("div",{className:"react-flow__selection react-flow__container",style:{width:n.width,height:n.height,transform:`translate(${n.x}px, ${n.y}px)`}}):null}let eu=(e,n)=>i=>{i.target===n.current&&e?.(i)},eh=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function eg({isSelecting:e,selectionKeyPressed:n,selectionMode:i=l.oW.Full,panOnDrag:o,selectionOnDrag:r,onSelectionStart:c,onSelectionEnd:h,onPaneClick:g,onPaneContextMenu:p,onPaneScroll:v,onPaneMouseEnter:y,onPaneMouseMove:w,onPaneMouseLeave:b,children:x}){let S=(0,d.useRef)(null),T=m(),E=(0,d.useRef)(0),M=(0,d.useRef)(0),C=(0,d.useRef)(),N=(0,d.useRef)(new Map),{userSelectionActive:O,elementsSelectable:I,dragging:D}=f(eh,u.X),k=I&&(e||O),_=(0,d.useRef)(!1),A=(0,d.useRef)(!1),P=e=>{if(_.current){_.current=!1;return}g?.(e),T.getState().resetSelectedElements(),T.setState({nodesSelectionActive:!1})},L=!0===o||Array.isArray(o)&&o.includes(0);return(0,a.jsxs)("div",{className:(0,s.Z)(["react-flow__pane",{draggable:L,dragging:D,selection:e}]),onClick:k?void 0:eu(P,S),onContextMenu:eu(e=>{if(Array.isArray(o)&&o?.includes(2))return void e.preventDefault();p?.(e)},S),onWheel:eu(v?e=>v(e):void 0,S),onPointerEnter:k?void 0:y,onPointerDown:k?n=>{let{resetSelectedElements:i,domNode:o,edgeLookup:r}=T.getState();if(C.current=o?.getBoundingClientRect(),!I||!e||0!==n.button||n.target!==S.current||!C.current)return;for(let[e,i]of(n.target?.setPointerCapture?.(n.pointerId),A.current=!0,_.current=!1,N.current=new Map,r))N.current.set(i.source,N.current.get(i.source)?.add(e)||new Set([e])),N.current.set(i.target,N.current.get(i.target)?.add(e)||new Set([e]));let{x:a,y:s}=(0,l.wv)(n.nativeEvent,C.current);i(),T.setState({userSelectionRect:{width:0,height:0,startX:a,startY:s,x:a,y:s}}),c?.(n)}:w,onPointerMove:k?e=>{let{userSelectionRect:n,edgeLookup:o,transform:r,nodeLookup:a,triggerNodeChanges:s,triggerEdgeChanges:d}=T.getState();if(!C.current||!n)return;_.current=!0;let{x:c,y:u}=(0,l.wv)(e.nativeEvent,C.current),{startX:h,startY:g}=n,p={startX:h,startY:g,x:c<h?c:h,y:u<g?u:g,width:Math.abs(c-h),height:Math.abs(u-g)},f=(0,l.f5)(a,p,r,i===l.oW.Partial,!0),m=new Set,v=new Set;for(let e of f){v.add(e.id);let n=N.current.get(e.id);if(n)for(let e of n)m.add(e)}E.current!==v.size&&(E.current=v.size,s(X(a,v,!0))),M.current!==m.size&&(M.current=m.size,d(X(o,m))),T.setState({userSelectionRect:p,userSelectionActive:!0,nodesSelectionActive:!1})}:w,onPointerUp:k?e=>{if(0!==e.button||!A.current)return;e.target?.releasePointerCapture?.(e.pointerId);let{userSelectionRect:i}=T.getState();!O&&i&&e.target===S.current&&P?.(e),E.current>0&&T.setState({nodesSelectionActive:!0}),T.setState({userSelectionActive:!1,userSelectionRect:null}),E.current=0,M.current=0,h?.(e),(n||r)&&(_.current=!1),A.current=!1}:void 0,onPointerLeave:b,ref:S,style:ea,children:[x,(0,a.jsx)(ec,{})]})}function ep({id:e,store:n,unselect:i=!1,nodeRef:o}){let{addSelectedNodes:r,unselectNodesAndEdges:a,multiSelectionActive:s,nodeLookup:d,onError:c}=n.getState(),u=d.get(e);if(!u)return void c?.("012",l.Qj.error012(e));n.setState({nodesSelectionActive:!1}),u.selected?(i||u.selected&&s)&&(a({nodes:[u],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):r([e])}function ef({nodeRef:e,disabled:n=!1,noDragClassName:i,handleSelector:o,nodeId:r,isSelectable:a,nodeClickDistance:s}){let c=m(),[u,h]=(0,d.useState)(!1),g=(0,d.useRef)();return(0,d.useEffect)(()=>{g.current=(0,l.oC)({getStoreItems:()=>c.getState(),onNodeMouseDown:n=>{ep({id:n,store:c,nodeRef:e})},onDragStart:()=>{h(!0)},onDragStop:()=>{h(!1)}})},[]),(0,d.useEffect)(()=>{if(n)g.current?.destroy();else if(e.current)return g.current?.update({noDragClassName:i,handleSelector:o,domNode:e.current,isSelectable:a,nodeId:r,nodeClickDistance:s}),()=>{g.current?.destroy()}},[i,o,n,a,e,r]),u}function em(){let e=m();return(0,d.useCallback)(n=>{let{nodeExtent:i,snapToGrid:o,snapGrid:r,nodesDraggable:a,onError:s,updateNodePositions:d,nodeLookup:c,nodeOrigin:u}=e.getState(),h=new Map,g=e=>e.selected&&(e.draggable||a&&void 0===e.draggable),p=o?r[0]:5,f=o?r[1]:5,m=n.direction.x*p*n.factor,v=n.direction.y*f*n.factor;for(let[,e]of c){if(!g(e))continue;let n={x:e.internals.positionAbsolute.x+m,y:e.internals.positionAbsolute.y+v};o&&(n=(0,l._2)(n,r));let{position:a,positionAbsolute:d}=(0,l.q7)({nodeId:e.id,nextPosition:n,nodeLookup:c,nodeExtent:i,nodeOrigin:u,onError:s});e.position=a,e.internals.positionAbsolute=d,h.set(e.id,e)}d(h)},[])}let ev=(0,d.createContext)(null),ey=ev.Provider;ev.Consumer;let ew=()=>(0,d.useContext)(ev),eb=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),ex=(0,d.memo)(q(function({type:e="source",position:n=l.Ly.Top,isValidConnection:i,isConnectable:o=!0,isConnectableStart:r=!0,isConnectableEnd:d=!0,id:c,onConnect:h,children:g,className:p,onMouseDown:v,onTouchStart:y,...w},b){let x=c||null,S="target"===e,T=m(),E=ew(),{connectOnClick:M,noPanClassName:C,rfId:N}=f(eb,u.X),{connectingFrom:O,connectingTo:I,clickConnecting:D,isPossibleEndHandle:k,connectionInProcess:_,valid:A}=f(n=>{let{connectionClickStartHandle:i,connectionMode:o,connection:r}=n,{fromHandle:a,toHandle:s,isValid:d}=r,c=s?.nodeId===E&&s?.id===x&&s?.type===e;return{connectingFrom:a?.nodeId===E&&a?.id===x&&a?.type===e,connectingTo:c,clickConnecting:i?.nodeId===E&&i?.id===x&&i?.type===e,isPossibleEndHandle:o===l.jD.Strict?a?.type!==e:E!==a?.nodeId||x!==a?.id,connectionInProcess:!!a,valid:c&&d}},u.X);E||T.getState().onError?.("010",l.Qj.error010());let P=e=>{let{defaultEdgeOptions:n,onConnect:i,hasDefaultEdges:o}=T.getState(),r={...n,...e};if(o){let{edges:e,setEdges:n}=T.getState();n((0,l.Z_)(r,e))}i?.(r),h?.(r)},L=e=>{if(!E)return;let n=(0,l.N5)(e.nativeEvent);if(r&&(n&&0===e.button||!n)){let n=T.getState();l.Ql.onPointerDown(e.nativeEvent,{autoPanOnConnect:n.autoPanOnConnect,connectionMode:n.connectionMode,connectionRadius:n.connectionRadius,domNode:n.domNode,nodeLookup:n.nodeLookup,lib:n.lib,isTarget:S,handleId:x,nodeId:E,flowId:n.rfId,panBy:n.panBy,cancelConnection:n.cancelConnection,onConnectStart:n.onConnectStart,onConnectEnd:n.onConnectEnd,updateConnection:n.updateConnection,onConnect:P,isValidConnection:i||n.isValidConnection,getTransform:()=>T.getState().transform,getFromHandle:()=>T.getState().connection.fromHandle,autoPanSpeed:n.autoPanSpeed})}n?v?.(e):y?.(e)};return(0,a.jsx)("div",{"data-handleid":x,"data-nodeid":E,"data-handlepos":n,"data-id":`${N}-${E}-${x}-${e}`,className:(0,s.Z)(["react-flow__handle",`react-flow__handle-${n}`,"nodrag",C,p,{source:!S,target:S,connectable:o,connectablestart:r,connectableend:d,clickconnecting:D,connectingfrom:O,connectingto:I,valid:A,connectionindicator:o&&(!_||k)&&(_?d:r)}]),onMouseDown:L,onTouchStart:L,onClick:M?n=>{let{onClickConnectStart:o,onClickConnectEnd:a,connectionClickStartHandle:s,connectionMode:d,isValidConnection:c,lib:u,rfId:h,nodeLookup:g,connection:p}=T.getState();if(!E||!s&&!r)return;if(!s){o?.(n.nativeEvent,{nodeId:E,handleId:x,handleType:e}),T.setState({connectionClickStartHandle:{nodeId:E,type:e,id:x}});return}let f=(0,l.S2)(n.target),m=i||c,{connection:v,isValid:y}=l.Ql.isValid(n.nativeEvent,{handle:{nodeId:E,id:x,type:e},connectionMode:d,fromNodeId:s.nodeId,fromHandleId:s.id||null,fromType:s.type,isValidConnection:m,flowId:h,doc:f,lib:u,nodeLookup:g});y&&v&&P(v);let w=structuredClone(p);delete w.inProgress,w.toPosition=w.toHandle?w.toHandle.position:null,a?.(n,w),T.setState({connectionClickStartHandle:null})}:void 0,ref:b,...w,children:g})})),eS={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},eT={input:function({data:e,isConnectable:n,sourcePosition:i=l.Ly.Bottom}){return(0,a.jsxs)(a.Fragment,{children:[e?.label,(0,a.jsx)(ex,{type:"source",position:i,isConnectable:n})]})},default:function({data:e,isConnectable:n,targetPosition:i=l.Ly.Top,sourcePosition:o=l.Ly.Bottom}){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ex,{type:"target",position:i,isConnectable:n}),e?.label,(0,a.jsx)(ex,{type:"source",position:o,isConnectable:n})]})},output:function({data:e,isConnectable:n,targetPosition:i=l.Ly.Top}){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ex,{type:"target",position:i,isConnectable:n}),e?.label]})},group:function(){return null}},eE=e=>{let{width:n,height:i,x:o,y:r}=(0,l.W0)(e.nodeLookup,{filter:e=>!!e.selected});return{width:(0,l.kE)(n)?n:null,height:(0,l.kE)(i)?i:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${r}px)`}};function eM({onSelectionContextMenu:e,noPanClassName:n,disableKeyboardA11y:i}){let o=m(),{width:r,height:l,transformString:c,userSelectionActive:h}=f(eE,u.X),g=em(),p=(0,d.useRef)(null);if((0,d.useEffect)(()=>{i||p.current?.focus({preventScroll:!0})},[i]),ef({nodeRef:p}),h||!r||!l)return null;let v=e?n=>{e(n,o.getState().nodes.filter(e=>e.selected))}:void 0;return(0,a.jsx)("div",{className:(0,s.Z)(["react-flow__nodesselection","react-flow__container",n]),style:{transform:c},children:(0,a.jsx)("div",{ref:p,className:"react-flow__nodesselection-rect",onContextMenu:v,tabIndex:i?void 0:-1,onKeyDown:i?void 0:e=>{Object.prototype.hasOwnProperty.call(eS,e.key)&&g({direction:eS[e.key],factor:e.shiftKey?4:1})},style:{width:r,height:l}})})}let eC="undefined"!=typeof window?window:void 0,eN=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function eO({children:e,onPaneClick:n,onPaneMouseEnter:i,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:s,onPaneScroll:l,paneClickDistance:c,deleteKeyCode:u,selectionKeyCode:h,selectionOnDrag:g,selectionMode:p,onSelectionStart:v,onSelectionEnd:y,multiSelectionKeyCode:w,panActivationKeyCode:b,zoomActivationKeyCode:x,elementsSelectable:S,zoomOnScroll:T,zoomOnPinch:E,panOnScroll:M,panOnScrollSpeed:C,panOnScrollMode:N,zoomOnDoubleClick:O,panOnDrag:I,defaultViewport:D,translateExtent:k,minZoom:_,maxZoom:A,preventScrolling:P,onSelectionContextMenu:L,noWheelClassName:j,noPanClassName:R,disableKeyboardA11y:V,onViewportChange:B,isControlledViewport:H}){let{nodesSelectionActive:z,userSelectionActive:F}=f(eN),W=$(h,{target:eC}),Z=$(b,{target:eC}),X=Z||I,K=Z||M,Y=g&&!0!==X,U=W||F||Y;return!function({deleteKeyCode:e,multiSelectionKeyCode:n}){let i=m(),{deleteElements:o}=en(),r=$(e,eo),a=$(n,{target:er});(0,d.useEffect)(()=>{if(r){let{edges:e,nodes:n}=i.getState();o({nodes:n.filter(ei),edges:e.filter(ei)}),i.setState({nodesSelectionActive:!1})}},[r]),(0,d.useEffect)(()=>{i.setState({multiSelectionActive:a})},[a])}({deleteKeyCode:u,multiSelectionKeyCode:w}),(0,a.jsx)(el,{onPaneContextMenu:s,elementsSelectable:S,zoomOnScroll:T,zoomOnPinch:E,panOnScroll:K,panOnScrollSpeed:C,panOnScrollMode:N,zoomOnDoubleClick:O,panOnDrag:!W&&X,defaultViewport:D,translateExtent:k,minZoom:_,maxZoom:A,zoomActivationKeyCode:x,preventScrolling:P,noWheelClassName:j,noPanClassName:R,onViewportChange:B,isControlledViewport:H,paneClickDistance:c,children:(0,a.jsxs)(eg,{onSelectionStart:v,onSelectionEnd:y,onPaneClick:n,onPaneMouseEnter:i,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:s,onPaneScroll:l,panOnDrag:X,isSelecting:!!U,selectionMode:p,selectionKeyPressed:W,selectionOnDrag:Y,children:[e,z&&(0,a.jsx)(eM,{onSelectionContextMenu:L,noPanClassName:R,disableKeyboardA11y:V})]})})}eO.displayName="FlowRenderer";let eI=(0,d.memo)(eO),eD=e=>e.updateNodeInternals;function ek({id:e,onClick:n,onMouseEnter:i,onMouseMove:o,onMouseLeave:r,onContextMenu:c,onDoubleClick:h,nodesDraggable:g,elementsSelectable:p,nodesConnectable:v,nodesFocusable:y,resizeObserver:b,noDragClassName:x,noPanClassName:S,disableKeyboardA11y:T,rfId:E,nodeTypes:M,nodeExtent:C,nodeClickDistance:N,onError:O}){let{node:I,internals:D,isParent:k}=f(n=>{let i=n.nodeLookup.get(e),o=n.parentLookup.has(e);return{node:i,internals:i.internals,isParent:o}},u.X),_=I.type||"default",A=M?.[_]||eT[_];void 0===A&&(O?.("003",l.Qj.error003(_)),_="default",A=eT.default);let P=!!(I.draggable||g&&void 0===I.draggable),L=!!(I.selectable||p&&void 0===I.selectable),j=!!(I.connectable||v&&void 0===I.connectable),R=!!(I.focusable||y&&void 0===I.focusable),V=m(),B=(0,l.nb)(I),H=function({node:e,nodeType:n,hasDimensions:i,resizeObserver:o}){let r=m(),a=(0,d.useRef)(null),s=(0,d.useRef)(null),l=(0,d.useRef)(e.sourcePosition),c=(0,d.useRef)(e.targetPosition),u=(0,d.useRef)(n),h=i&&!!e.internals.handleBounds;return(0,d.useEffect)(()=>{!a.current||e.hidden||h&&s.current===a.current||(s.current&&o?.unobserve(s.current),o?.observe(a.current),s.current=a.current)},[h,e.hidden]),(0,d.useEffect)(()=>()=>{s.current&&(o?.unobserve(s.current),s.current=null)},[]),(0,d.useEffect)(()=>{if(a.current){let i=u.current!==n,o=l.current!==e.sourcePosition,s=c.current!==e.targetPosition;(i||o||s)&&(u.current=n,l.current=e.sourcePosition,c.current=e.targetPosition,r.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:a.current,force:!0}]])))}},[e.id,n,e.sourcePosition,e.targetPosition]),a}({node:I,nodeType:_,hasDimensions:B,resizeObserver:b}),$=ef({nodeRef:H,disabled:I.hidden||!P,noDragClassName:x,handleSelector:I.dragHandle,nodeId:e,isSelectable:L,nodeClickDistance:N}),z=em();if(I.hidden)return null;let F=(0,l.Rf)(I),W=void 0===I.internals.handleBounds?{width:I.width??I.initialWidth??I.style?.width,height:I.height??I.initialHeight??I.style?.height}:{width:I.width??I.style?.width,height:I.height??I.style?.height},Z=C?(0,l.s9)(D.positionAbsolute,C):D.positionAbsolute,X=L||P||n||i||o||r,K=i?e=>i(e,{...D.userNode}):void 0,Y=o?e=>o(e,{...D.userNode}):void 0,U=r?e=>r(e,{...D.userNode}):void 0,q=c?e=>c(e,{...D.userNode}):void 0,Q=h?e=>h(e,{...D.userNode}):void 0;return(0,a.jsx)("div",{className:(0,s.Z)(["react-flow__node",`react-flow__node-${_}`,{[S]:P},I.className,{selected:I.selected,selectable:L,parent:k,draggable:P,dragging:$}]),ref:H,style:{zIndex:D.z,transform:`translate(${Z.x}px,${Z.y}px)`,pointerEvents:X?"all":"none",visibility:B?"visible":"hidden",...I.style,...W},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:K,onMouseMove:Y,onMouseLeave:U,onContextMenu:q,onClick:i=>{let{selectNodesOnDrag:o,nodeDragThreshold:r}=V.getState();L&&(!o||!P||r>0)&&ep({id:e,store:V,nodeRef:H}),n&&n(i,{...D.userNode})},onDoubleClick:Q,onKeyDown:R?n=>{!(0,l.s$)(n.nativeEvent)&&!T&&(l.wQ.includes(n.key)&&L?ep({id:e,store:V,unselect:"Escape"===n.key,nodeRef:H}):P&&I.selected&&Object.prototype.hasOwnProperty.call(eS,n.key)&&(V.setState({ariaLiveMessage:`Moved selected node ${n.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~Z.x}, y: ${~~Z.y}`}),z({direction:eS[n.key],factor:n.shiftKey?4:1})))}:void 0,tabIndex:R?0:void 0,role:R?"button":void 0,"aria-describedby":T?void 0:`${w}-${E}`,"aria-label":I.ariaLabel,children:(0,a.jsx)(ey,{value:e,children:(0,a.jsx)(A,{id:e,data:I.data,type:_,positionAbsoluteX:Z.x,positionAbsoluteY:Z.y,selected:I.selected,selectable:L,draggable:P,deletable:I.deletable??!0,isConnectable:j,sourcePosition:I.sourcePosition,targetPosition:I.targetPosition,dragging:$,dragHandle:I.dragHandle,zIndex:D.z,parentId:I.parentId,...F})})})}let e_=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function eA(e){var n;let{nodesDraggable:i,nodesConnectable:o,nodesFocusable:r,elementsSelectable:s,onError:c}=f(e_,u.X),h=(n=e.onlyRenderVisibleElements,f((0,d.useCallback)(e=>n?(0,l.f5)(e.nodeLookup,{x:0,y:0,width:e.width,height:e.height},e.transform,!0).map(e=>e.id):Array.from(e.nodeLookup.keys()),[n]),u.X)),g=function(){let e=f(eD),[n]=(0,d.useState)(()=>"undefined"==typeof ResizeObserver?null:new ResizeObserver(n=>{let i=new Map;n.forEach(e=>{let n=e.target.getAttribute("data-id");i.set(n,{id:n,nodeElement:e.target,force:!0})}),e(i)}));return(0,d.useEffect)(()=>()=>{n?.disconnect()},[n]),n}();return(0,a.jsx)("div",{className:"react-flow__nodes",style:ea,children:h.map(n=>(0,a.jsx)(ek,{id:n,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:g,nodesDraggable:i,nodesConnectable:o,nodesFocusable:r,elementsSelectable:s,nodeClickDistance:e.nodeClickDistance,onError:c},n))})}eA.displayName="NodeRenderer";let eP=(0,d.memo)(eA),eL={[l.QZ.Arrow]:({color:e="none",strokeWidth:n=1})=>(0,a.jsx)("polyline",{style:{stroke:e,strokeWidth:n},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),[l.QZ.ArrowClosed]:({color:e="none",strokeWidth:n=1})=>(0,a.jsx)("polyline",{style:{stroke:e,fill:e,strokeWidth:n},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},ej=({id:e,type:n,color:i,width:o=12.5,height:r=12.5,markerUnits:s="strokeWidth",strokeWidth:c,orient:u="auto-start-reverse"})=>{let h=function(e){let n=m();return(0,d.useMemo)(()=>Object.prototype.hasOwnProperty.call(eL,e)?eL[e]:(n.getState().onError?.("009",l.Qj.error009(e)),null),[e])}(n);return h?(0,a.jsx)("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:u,refX:"0",refY:"0",children:(0,a.jsx)(h,{color:i,strokeWidth:c})}):null},eR=({defaultColor:e,rfId:n})=>{let i=f(e=>e.edges),o=f(e=>e.defaultEdgeOptions),r=(0,d.useMemo)(()=>(0,l.n3)(i,{id:n,defaultColor:e,defaultMarkerStart:o?.markerStart,defaultMarkerEnd:o?.markerEnd}),[i,o,n,e]);return r.length?(0,a.jsx)("svg",{className:"react-flow__marker",children:(0,a.jsx)("defs",{children:r.map(e=>(0,a.jsx)(ej,{id:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient},e.id))})}):null};eR.displayName="MarkerDefinitions";var eV=(0,d.memo)(eR);function eB({x:e,y:n,label:i,labelStyle:o={},labelShowBg:r=!0,labelBgStyle:l={},labelBgPadding:c=[2,4],labelBgBorderRadius:u=2,children:h,className:g,...p}){let[f,m]=(0,d.useState)({x:1,y:0,width:0,height:0}),v=(0,s.Z)(["react-flow__edge-textwrapper",g]),y=(0,d.useRef)(null);return((0,d.useEffect)(()=>{if(y.current){let e=y.current.getBBox();m({x:e.x,y:e.y,width:e.width,height:e.height})}},[i]),void 0!==i&&i)?(0,a.jsxs)("g",{transform:`translate(${e-f.width/2} ${n-f.height/2})`,className:v,visibility:f.width?"visible":"hidden",...p,children:[r&&(0,a.jsx)("rect",{width:f.width+2*c[0],x:-c[0],y:-c[1],height:f.height+2*c[1],className:"react-flow__edge-textbg",style:l,rx:u,ry:u}),(0,a.jsx)("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:y,style:o,children:i}),h]}):null}eB.displayName="EdgeText";let eH=(0,d.memo)(eB);function e$({id:e,path:n,labelX:i,labelY:o,label:r,labelStyle:d,labelShowBg:c,labelBgStyle:u,labelBgPadding:h,labelBgBorderRadius:g,style:p,markerEnd:f,markerStart:m,className:v,interactionWidth:y=20}){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("path",{id:e,style:p,d:n,fill:"none",className:(0,s.Z)(["react-flow__edge-path",v]),markerEnd:f,markerStart:m}),y&&(0,a.jsx)("path",{d:n,fill:"none",strokeOpacity:0,strokeWidth:y,className:"react-flow__edge-interaction"}),r&&(0,l.kE)(i)&&(0,l.kE)(o)?(0,a.jsx)(eH,{x:i,y:o,label:r,labelStyle:d,labelShowBg:c,labelBgStyle:u,labelBgPadding:h,labelBgBorderRadius:g}):null]})}function ez({pos:e,x1:n,y1:i,x2:o,y2:r}){return e===l.Ly.Left||e===l.Ly.Right?[.5*(n+o),i]:[n,.5*(i+r)]}function eF({sourceX:e,sourceY:n,sourcePosition:i=l.Ly.Bottom,targetX:o,targetY:r,targetPosition:a=l.Ly.Top}){let[s,d]=ez({pos:i,x1:e,y1:n,x2:o,y2:r}),[c,u]=ez({pos:a,x1:o,y1:r,x2:e,y2:n}),[h,g,p,f]=(0,l.lM)({sourceX:e,sourceY:n,targetX:o,targetY:r,sourceControlX:s,sourceControlY:d,targetControlX:c,targetControlY:u});return[`M${e},${n} C${s},${d} ${c},${u} ${o},${r}`,h,g,p,f]}function eW(e){return(0,d.memo)(({id:n,sourceX:i,sourceY:o,targetX:r,targetY:s,sourcePosition:d=l.Ly.Bottom,targetPosition:c=l.Ly.Top,label:u,labelStyle:h,labelShowBg:g,labelBgStyle:p,labelBgPadding:f,labelBgBorderRadius:m,style:v,markerEnd:y,markerStart:w,interactionWidth:b})=>{let[x,S,T]=eF({sourceX:i,sourceY:o,sourcePosition:d,targetX:r,targetY:s,targetPosition:c}),E=e.isInternal?void 0:n;return(0,a.jsx)(e$,{id:E,path:x,labelX:S,labelY:T,label:u,labelStyle:h,labelShowBg:g,labelBgStyle:p,labelBgPadding:f,labelBgBorderRadius:m,style:v,markerEnd:y,markerStart:w,interactionWidth:b})})}let eZ=eW({isInternal:!1}),eX=eW({isInternal:!0});function eK(e){return(0,d.memo)(({id:n,sourceX:i,sourceY:o,targetX:r,targetY:s,label:d,labelStyle:c,labelShowBg:u,labelBgStyle:h,labelBgPadding:g,labelBgBorderRadius:p,style:f,sourcePosition:m=l.Ly.Bottom,targetPosition:v=l.Ly.Top,markerEnd:y,markerStart:w,pathOptions:b,interactionWidth:x})=>{let[S,T,E]=(0,l.OW)({sourceX:i,sourceY:o,sourcePosition:m,targetX:r,targetY:s,targetPosition:v,borderRadius:b?.borderRadius,offset:b?.offset}),M=e.isInternal?void 0:n;return(0,a.jsx)(e$,{id:M,path:S,labelX:T,labelY:E,label:d,labelStyle:c,labelShowBg:u,labelBgStyle:h,labelBgPadding:g,labelBgBorderRadius:p,style:f,markerEnd:y,markerStart:w,interactionWidth:x})})}eZ.displayName="SimpleBezierEdge",eX.displayName="SimpleBezierEdgeInternal";let eY=eK({isInternal:!1}),eU=eK({isInternal:!0});function eq(e){return(0,d.memo)(({id:n,...i})=>{let o=e.isInternal?void 0:n;return(0,a.jsx)(eY,{...i,id:o,pathOptions:(0,d.useMemo)(()=>({borderRadius:0,offset:i.pathOptions?.offset}),[i.pathOptions?.offset])})})}eY.displayName="SmoothStepEdge",eU.displayName="SmoothStepEdgeInternal";let eQ=eq({isInternal:!1}),eJ=eq({isInternal:!0});function eG(e){return(0,d.memo)(({id:n,sourceX:i,sourceY:o,targetX:r,targetY:s,label:d,labelStyle:c,labelShowBg:u,labelBgStyle:h,labelBgPadding:g,labelBgBorderRadius:p,style:f,markerEnd:m,markerStart:v,interactionWidth:y})=>{let[w,b,x]=(0,l.Hm)({sourceX:i,sourceY:o,targetX:r,targetY:s}),S=e.isInternal?void 0:n;return(0,a.jsx)(e$,{id:S,path:w,labelX:b,labelY:x,label:d,labelStyle:c,labelShowBg:u,labelBgStyle:h,labelBgPadding:g,labelBgBorderRadius:p,style:f,markerEnd:m,markerStart:v,interactionWidth:y})})}eQ.displayName="StepEdge",eJ.displayName="StepEdgeInternal";let e0=eG({isInternal:!1}),e1=eG({isInternal:!0});function e2(e){return(0,d.memo)(({id:n,sourceX:i,sourceY:o,targetX:r,targetY:s,sourcePosition:d=l.Ly.Bottom,targetPosition:c=l.Ly.Top,label:u,labelStyle:h,labelShowBg:g,labelBgStyle:p,labelBgPadding:f,labelBgBorderRadius:m,style:v,markerEnd:y,markerStart:w,pathOptions:b,interactionWidth:x})=>{let[S,T,E]=(0,l.OQ)({sourceX:i,sourceY:o,sourcePosition:d,targetX:r,targetY:s,targetPosition:c,curvature:b?.curvature}),M=e.isInternal?void 0:n;return(0,a.jsx)(e$,{id:M,path:S,labelX:T,labelY:E,label:u,labelStyle:h,labelShowBg:g,labelBgStyle:p,labelBgPadding:f,labelBgBorderRadius:m,style:v,markerEnd:y,markerStart:w,interactionWidth:x})})}e0.displayName="StraightEdge",e1.displayName="StraightEdgeInternal";let e3=e2({isInternal:!1}),e5=e2({isInternal:!0});e3.displayName="BezierEdge",e5.displayName="BezierEdgeInternal";let e4={default:e5,straight:e1,step:eJ,smoothstep:eU,simplebezier:eX},e6={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},e8="react-flow__edgeupdater";function e7({position:e,centerX:n,centerY:i,radius:o=10,onMouseDown:r,onMouseEnter:d,onMouseOut:c,type:u}){return(0,a.jsx)("circle",{onMouseDown:r,onMouseEnter:d,onMouseOut:c,className:(0,s.Z)([e8,`${e8}-${u}`]),cx:e===l.Ly.Left?n-o:e===l.Ly.Right?n+o:n,cy:e===l.Ly.Top?i-o:e===l.Ly.Bottom?i+o:i,r:o,stroke:"transparent",fill:"transparent"})}function e9({isReconnectable:e,reconnectRadius:n,edge:i,sourceX:o,sourceY:r,targetX:s,targetY:d,sourcePosition:c,targetPosition:u,onReconnect:h,onReconnectStart:g,onReconnectEnd:p,setReconnecting:f,setUpdateHover:v}){let y=m(),w=(e,n)=>{if(0!==e.button)return;let{autoPanOnConnect:o,domNode:r,isValidConnection:a,connectionMode:s,connectionRadius:d,lib:c,onConnectStart:u,onConnectEnd:m,cancelConnection:v,nodeLookup:w,rfId:b,panBy:x,updateConnection:S}=y.getState(),T="target"===n.type;f(!0),g?.(e,i,n.type),l.Ql.onPointerDown(e.nativeEvent,{autoPanOnConnect:o,connectionMode:s,connectionRadius:d,domNode:r,handleId:n.id,nodeId:n.nodeId,nodeLookup:w,isTarget:T,edgeUpdaterType:n.type,lib:c,flowId:b,cancelConnection:v,panBy:x,isValidConnection:a,onConnect:e=>h?.(i,e),onConnectStart:u,onConnectEnd:m,onReconnectEnd:(e,o)=>{f(!1),p?.(e,i,n.type,o)},updateConnection:S,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle})},b=()=>v(!0),x=()=>v(!1);return(0,a.jsxs)(a.Fragment,{children:[(!0===e||"source"===e)&&(0,a.jsx)(e7,{position:c,centerX:o,centerY:r,radius:n,onMouseDown:e=>w(e,{nodeId:i.target,id:i.targetHandle??null,type:"target"}),onMouseEnter:b,onMouseOut:x,type:"source"}),(!0===e||"target"===e)&&(0,a.jsx)(e7,{position:u,centerX:s,centerY:d,radius:n,onMouseDown:e=>w(e,{nodeId:i.source,id:i.sourceHandle??null,type:"source"}),onMouseEnter:b,onMouseOut:x,type:"target"})]})}function te({id:e,edgesFocusable:n,edgesReconnectable:i,elementsSelectable:o,onClick:r,onDoubleClick:c,onContextMenu:h,onMouseEnter:g,onMouseMove:p,onMouseLeave:v,reconnectRadius:y,onReconnect:w,onReconnectStart:x,onReconnectEnd:S,rfId:T,edgeTypes:E,noPanClassName:M,onError:C,disableKeyboardA11y:N}){let O=f(n=>n.edgeLookup.get(e)),I=f(e=>e.defaultEdgeOptions),D=(O=I?{...I,...O}:O).type||"default",k=E?.[D]||e4[D];void 0===k&&(C?.("011",l.Qj.error011(D)),D="default",k=e4.default);let _=!!(O.focusable||n&&void 0===O.focusable),A=void 0!==w&&(O.reconnectable||i&&void 0===O.reconnectable),P=!!(O.selectable||o&&void 0===O.selectable),L=(0,d.useRef)(null),[j,R]=(0,d.useState)(!1),[V,B]=(0,d.useState)(!1),H=m(),{zIndex:$,sourceX:z,sourceY:F,targetX:W,targetY:Z,sourcePosition:X,targetPosition:K}=f((0,d.useCallback)(n=>{let i=n.nodeLookup.get(O.source),o=n.nodeLookup.get(O.target);if(!i||!o)return{zIndex:O.zIndex,...e6};let r=(0,l.JU)({id:e,sourceNode:i,targetNode:o,sourceHandle:O.sourceHandle||null,targetHandle:O.targetHandle||null,connectionMode:n.connectionMode,onError:C});return{zIndex:(0,l.xx)({selected:O.selected,zIndex:O.zIndex,sourceNode:i,targetNode:o,elevateOnSelect:n.elevateEdgesOnSelect}),...r||e6}},[O.source,O.target,O.sourceHandle,O.targetHandle,O.selected,O.zIndex]),u.X),Y=(0,d.useMemo)(()=>O.markerStart?`url('#${(0,l.dW)(O.markerStart,T)}')`:void 0,[O.markerStart,T]),U=(0,d.useMemo)(()=>O.markerEnd?`url('#${(0,l.dW)(O.markerEnd,T)}')`:void 0,[O.markerEnd,T]);if(O.hidden||null===z||null===F||null===W||null===Z)return null;let q=c?e=>{c(e,{...O})}:void 0,Q=h?e=>{h(e,{...O})}:void 0,J=g?e=>{g(e,{...O})}:void 0,G=p?e=>{p(e,{...O})}:void 0,ee=v?e=>{v(e,{...O})}:void 0;return(0,a.jsx)("svg",{style:{zIndex:$},children:(0,a.jsxs)("g",{className:(0,s.Z)(["react-flow__edge",`react-flow__edge-${D}`,O.className,M,{selected:O.selected,animated:O.animated,inactive:!P&&!r,updating:j,selectable:P}]),onClick:n=>{let{addSelectedEdges:i,unselectNodesAndEdges:o,multiSelectionActive:a}=H.getState();P&&(H.setState({nodesSelectionActive:!1}),O.selected&&a?(o({nodes:[],edges:[O]}),L.current?.blur()):i([e])),r&&r(n,O)},onDoubleClick:q,onContextMenu:Q,onMouseEnter:J,onMouseMove:G,onMouseLeave:ee,onKeyDown:_?n=>{if(!N&&l.wQ.includes(n.key)&&P){let{unselectNodesAndEdges:i,addSelectedEdges:o}=H.getState();"Escape"===n.key?(L.current?.blur(),i({edges:[O]})):o([e])}}:void 0,tabIndex:_?0:void 0,role:_?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":null===O.ariaLabel?void 0:O.ariaLabel||`Edge from ${O.source} to ${O.target}`,"aria-describedby":_?`${b}-${T}`:void 0,ref:L,children:[!V&&(0,a.jsx)(k,{id:e,source:O.source,target:O.target,type:O.type,selected:O.selected,animated:O.animated,selectable:P,deletable:O.deletable??!0,label:O.label,labelStyle:O.labelStyle,labelShowBg:O.labelShowBg,labelBgStyle:O.labelBgStyle,labelBgPadding:O.labelBgPadding,labelBgBorderRadius:O.labelBgBorderRadius,sourceX:z,sourceY:F,targetX:W,targetY:Z,sourcePosition:X,targetPosition:K,data:O.data,style:O.style,sourceHandleId:O.sourceHandle,targetHandleId:O.targetHandle,markerStart:Y,markerEnd:U,pathOptions:"pathOptions"in O?O.pathOptions:void 0,interactionWidth:O.interactionWidth}),A&&(0,a.jsx)(e9,{edge:O,isReconnectable:A,reconnectRadius:y,onReconnect:w,onReconnectStart:x,onReconnectEnd:S,sourceX:z,sourceY:F,targetX:W,targetY:Z,sourcePosition:X,targetPosition:K,setUpdateHover:R,setReconnecting:B})]})})}let tt=e=>({width:e.width,height:e.height,edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function tn({defaultMarkerColor:e,onlyRenderVisibleElements:n,rfId:i,edgeTypes:o,noPanClassName:r,onReconnect:s,onEdgeContextMenu:c,onEdgeMouseEnter:h,onEdgeMouseMove:g,onEdgeMouseLeave:p,onEdgeClick:m,reconnectRadius:v,onEdgeDoubleClick:y,onReconnectStart:w,onReconnectEnd:b,disableKeyboardA11y:x}){let{edgesFocusable:S,edgesReconnectable:T,elementsSelectable:E,onError:M}=f(tt,u.X),C=f((0,d.useCallback)(e=>{if(!n)return e.edges.map(e=>e.id);let i=[];if(e.width&&e.height)for(let n of e.edges){let o=e.nodeLookup.get(n.source),r=e.nodeLookup.get(n.target);o&&r&&(0,l.RY)({sourceNode:o,targetNode:r,width:e.width,height:e.height,transform:e.transform})&&i.push(n.id)}return i},[n]),u.X);return(0,a.jsxs)("div",{className:"react-flow__edges",children:[(0,a.jsx)(eV,{defaultColor:e,rfId:i}),C.map(e=>(0,a.jsx)(te,{id:e,edgesFocusable:S,edgesReconnectable:T,elementsSelectable:E,noPanClassName:r,onReconnect:s,onContextMenu:c,onMouseEnter:h,onMouseMove:g,onMouseLeave:p,onClick:m,reconnectRadius:v,onDoubleClick:y,onReconnectStart:w,onReconnectEnd:b,rfId:i,onError:M,edgeTypes:o,disableKeyboardA11y:x},e))]})}tn.displayName="EdgeRenderer";let ti=(0,d.memo)(tn),to=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function tr({children:e}){let n=f(to);return(0,a.jsx)("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:n},children:e})}let ta=e=>e.panZoom?.syncViewport;function ts(e){return e.connection.inProgress?{...e.connection,to:(0,l.m)(e.connection.to,e.transform)}:{...e.connection}}let tl=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function td({containerStyle:e,style:n,type:i,component:o}){let{nodesConnectable:r,width:d,height:c,isValid:h,inProgress:g}=f(tl,u.X);return d&&r&&g?(0,a.jsx)("svg",{style:e,width:d,height:c,className:"react-flow__connectionline react-flow__container",children:(0,a.jsx)("g",{className:(0,s.Z)(["react-flow__connection",(0,l.Zp)(h)]),children:(0,a.jsx)(tc,{style:n,type:i,CustomComponent:o,isValid:h})})}):null}let tc=({style:e,type:n=l.t8.Bezier,CustomComponent:i,isValid:o})=>{let{inProgress:r,from:s,fromNode:d,fromHandle:c,fromPosition:h,to:g,toNode:p,toHandle:m,toPosition:v}=f(ts,u.X);if(!r)return;if(i)return(0,a.jsx)(i,{connectionLineType:n,connectionLineStyle:e,fromNode:d,fromHandle:c,fromX:s.x,fromY:s.y,toX:g.x,toY:g.y,fromPosition:h,toPosition:v,connectionStatus:(0,l.Zp)(o),toNode:p,toHandle:m});let y="",w={sourceX:s.x,sourceY:s.y,sourcePosition:h,targetX:g.x,targetY:g.y,targetPosition:v};switch(n){case l.t8.Bezier:[y]=(0,l.OQ)(w);break;case l.t8.SimpleBezier:[y]=eF(w);break;case l.t8.Step:[y]=(0,l.OW)({...w,borderRadius:0});break;case l.t8.SmoothStep:[y]=(0,l.OW)(w);break;default:[y]=(0,l.Hm)(w)}return(0,a.jsx)("path",{d:y,fill:"none",className:"react-flow__connection-path",style:e})};tc.displayName="ConnectionLine";let tu={};function th(e=tu){(0,d.useRef)(e),m(),(0,d.useEffect)(()=>{},[e])}function tg({nodeTypes:e,edgeTypes:n,onInit:i,onNodeClick:o,onEdgeClick:r,onNodeDoubleClick:s,onEdgeDoubleClick:l,onNodeMouseEnter:c,onNodeMouseMove:u,onNodeMouseLeave:h,onNodeContextMenu:g,onSelectionContextMenu:p,onSelectionStart:v,onSelectionEnd:y,connectionLineType:w,connectionLineStyle:b,connectionLineComponent:x,connectionLineContainerStyle:S,selectionKeyCode:T,selectionOnDrag:E,selectionMode:M,multiSelectionKeyCode:C,panActivationKeyCode:N,zoomActivationKeyCode:O,deleteKeyCode:I,onlyRenderVisibleElements:D,elementsSelectable:k,defaultViewport:_,translateExtent:A,minZoom:P,maxZoom:L,preventScrolling:j,defaultMarkerColor:R,zoomOnScroll:V,zoomOnPinch:B,panOnScroll:H,panOnScrollSpeed:$,panOnScrollMode:z,zoomOnDoubleClick:F,panOnDrag:W,onPaneClick:Z,onPaneMouseEnter:X,onPaneMouseMove:K,onPaneMouseLeave:Y,onPaneScroll:U,onPaneContextMenu:q,paneClickDistance:Q,nodeClickDistance:J,onEdgeContextMenu:G,onEdgeMouseEnter:ee,onEdgeMouseMove:et,onEdgeMouseLeave:ei,reconnectRadius:eo,onReconnect:er,onReconnectStart:ea,onReconnectEnd:es,noDragClassName:el,noWheelClassName:ed,noPanClassName:ec,disableKeyboardA11y:eu,nodeExtent:eh,rfId:eg,viewport:ep,onViewportChange:ef}){th(e),th(n),m(),(0,d.useRef)(!1),(0,d.useEffect)(()=>{},[]);let em=en(),ev=(0,d.useRef)(!1);return(0,d.useEffect)(()=>{!ev.current&&em.viewportInitialized&&i&&(setTimeout(()=>i(em),1),ev.current=!0)},[i,em.viewportInitialized]),!function(e){let n=f(ta),i=m();(0,d.useEffect)(()=>{e&&(n?.(e),i.setState({transform:[e.x,e.y,e.zoom]}))},[e,n])}(ep),(0,a.jsx)(eI,{onPaneClick:Z,onPaneMouseEnter:X,onPaneMouseMove:K,onPaneMouseLeave:Y,onPaneContextMenu:q,onPaneScroll:U,paneClickDistance:Q,deleteKeyCode:I,selectionKeyCode:T,selectionOnDrag:E,selectionMode:M,onSelectionStart:v,onSelectionEnd:y,multiSelectionKeyCode:C,panActivationKeyCode:N,zoomActivationKeyCode:O,elementsSelectable:k,zoomOnScroll:V,zoomOnPinch:B,zoomOnDoubleClick:F,panOnScroll:H,panOnScrollSpeed:$,panOnScrollMode:z,panOnDrag:W,defaultViewport:_,translateExtent:A,minZoom:P,maxZoom:L,onSelectionContextMenu:p,preventScrolling:j,noDragClassName:el,noWheelClassName:ed,noPanClassName:ec,disableKeyboardA11y:eu,onViewportChange:ef,isControlledViewport:!!ep,children:(0,a.jsxs)(tr,{children:[(0,a.jsx)(ti,{edgeTypes:n,onEdgeClick:r,onEdgeDoubleClick:l,onReconnect:er,onReconnectStart:ea,onReconnectEnd:es,onlyRenderVisibleElements:D,onEdgeContextMenu:G,onEdgeMouseEnter:ee,onEdgeMouseMove:et,onEdgeMouseLeave:ei,reconnectRadius:eo,defaultMarkerColor:R,noPanClassName:ec,disableKeyboardA11y:eu,rfId:eg}),(0,a.jsx)(td,{style:b,type:w,component:x,containerStyle:S}),(0,a.jsx)("div",{className:"react-flow__edgelabel-renderer"}),(0,a.jsx)(eP,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:s,onNodeMouseEnter:c,onNodeMouseMove:u,onNodeMouseLeave:h,onNodeContextMenu:g,nodeClickDistance:J,onlyRenderVisibleElements:D,noPanClassName:ec,noDragClassName:el,disableKeyboardA11y:eu,nodeExtent:eh,rfId:eg}),(0,a.jsx)("div",{className:"react-flow__viewport-portal"})]})})}tg.displayName="GraphView";let tp=(0,d.memo)(tg),tf=({nodes:e,edges:n,defaultNodes:i,defaultEdges:o,width:r,height:a,fitView:s,nodeOrigin:d}={})=>{let c=new Map,u=new Map,h=new Map,g=new Map,p=o??n??[],f=i??e??[],m=d??[0,0];(0,l.be)(h,g,p),(0,l.yF)(f,c,u,{nodeOrigin:m,elevateNodesOnSelect:!1});let v=[0,0,1];if(s&&r&&a){let e=(0,l.W0)(c,{filter:e=>!!((e.width||e.initialWidth)&&(e.height||e.initialHeight))}),{x:n,y:i,zoom:o}=(0,l.$i)(e,r,a,.5,2,.1);v=[n,i,o]}return{rfId:"1",width:0,height:0,transform:v,nodes:f,nodeLookup:c,parentLookup:u,edges:p,edgeLookup:g,connectionLookup:h,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:void 0!==i,hasDefaultEdges:void 0!==o,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:l.k5,nodeExtent:l.k5,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:l.jD.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:m,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...l.Ky},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:l.Ki,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}};function tm({initialNodes:e,initialEdges:n,defaultNodes:i,defaultEdges:o,initialWidth:r,initialHeight:s,fitView:u,nodeOrigin:h,children:p}){let[f]=(0,d.useState)(()=>(({nodes:e,edges:n,defaultNodes:i,defaultEdges:o,width:r,height:a,fitView:s,nodeOrigin:d})=>(0,c.F)((c,u)=>({...tf({nodes:e,edges:n,width:r,height:a,fitView:s,nodeOrigin:d,defaultNodes:i,defaultEdges:o}),setNodes:e=>{let{nodeLookup:n,parentLookup:i,nodeOrigin:o,elevateNodesOnSelect:r}=u();(0,l.yF)(e,n,i,{nodeOrigin:o,elevateNodesOnSelect:r,checkEquality:!0}),c({nodes:e})},setEdges:e=>{let{connectionLookup:n,edgeLookup:i}=u();(0,l.be)(n,i,e),c({edges:e})},setDefaultNodesAndEdges:(e,n)=>{if(e){let{setNodes:n}=u();n(e),c({hasDefaultNodes:!0})}if(n){let{setEdges:e}=u();e(n),c({hasDefaultEdges:!0})}},updateNodeInternals:(e,n={triggerFitView:!0})=>{let{triggerNodeChanges:i,nodeLookup:o,parentLookup:r,fitViewOnInit:a,fitViewDone:s,fitViewOnInitOptions:d,domNode:h,nodeOrigin:g,debug:p,fitViewSync:f}=u(),{changes:m,updatedInternals:v}=(0,l.B1)(e,o,r,h,g);if(v){if((0,l.VV)(o,r,{nodeOrigin:g}),n.triggerFitView){let e=s;!s&&a&&(e=f({...d,nodes:d?.nodes})),c({fitViewDone:e})}else c({});m?.length>0&&(p&&console.log("React Flow: trigger node changes",m),i?.(m))}},updateNodePositions:(e,n=!1)=>{let i=[],o=[];for(let[r,a]of e){let e={id:r,type:"position",position:a.position,dragging:n};a?.expandParent&&a?.parentId&&e.position&&(i.push({id:r,parentId:a.parentId,rect:{...a.internals.positionAbsolute,width:a.measured.width,height:a.measured.height}}),e.position.x=Math.max(0,e.position.x),e.position.y=Math.max(0,e.position.y)),o.push(e)}if(i.length>0){let{nodeLookup:e,parentLookup:n,nodeOrigin:r}=u(),a=(0,l.so)(i,e,n,r);o.push(...a)}u().triggerNodeChanges(o)},triggerNodeChanges:e=>{let{onNodesChange:n,setNodes:i,nodes:o,hasDefaultNodes:r,debug:a}=u();e?.length&&(r&&i(W(e,o)),a&&console.log("React Flow: trigger node changes",e),n?.(e))},triggerEdgeChanges:e=>{let{onEdgesChange:n,setEdges:i,edges:o,hasDefaultEdges:r,debug:a}=u();e?.length&&(r&&i(W(e,o)),a&&console.log("React Flow: trigger edge changes",e),n?.(e))},addSelectedNodes:e=>{let{multiSelectionActive:n,edgeLookup:i,nodeLookup:o,triggerNodeChanges:r,triggerEdgeChanges:a}=u();if(n)return void r(e.map(e=>Z(e,!0)));r(X(o,new Set([...e]),!0)),a(X(i))},addSelectedEdges:e=>{let{multiSelectionActive:n,edgeLookup:i,nodeLookup:o,triggerNodeChanges:r,triggerEdgeChanges:a}=u();if(n)return void a(e.map(e=>Z(e,!0)));a(X(i,new Set([...e]))),r(X(o,new Set,!0))},unselectNodesAndEdges:({nodes:e,edges:n}={})=>{let{edges:i,nodes:o,triggerNodeChanges:r,triggerEdgeChanges:a}=u(),s=(e||o).map(e=>(e.selected=!1,Z(e.id,!1))),l=(n||i).map(e=>Z(e.id,!1));r(s),a(l)},setMinZoom:e=>{let{panZoom:n,maxZoom:i}=u();n?.setScaleExtent([e,i]),c({minZoom:e})},setMaxZoom:e=>{let{panZoom:n,minZoom:i}=u();n?.setScaleExtent([i,e]),c({maxZoom:e})},setTranslateExtent:e=>{u().panZoom?.setTranslateExtent(e),c({translateExtent:e})},setPaneClickDistance:e=>{u().panZoom?.setClickDistance(e)},resetSelectedElements:()=>{let{edges:e,nodes:n,triggerNodeChanges:i,triggerEdgeChanges:o}=u(),r=n.reduce((e,n)=>n.selected?[...e,Z(n.id,!1)]:e,[]),a=e.reduce((e,n)=>n.selected?[...e,Z(n.id,!1)]:e,[]);i(r),o(a)},setNodeExtent:e=>{let{nodeLookup:n}=u();for(let[,i]of n){let o=(0,l.s9)(i.internals.positionAbsolute,e);n.set(i.id,{...i,internals:{...i.internals,positionAbsolute:o}})}c({nodeExtent:e})},panBy:e=>{let{transform:n,width:i,height:o,panZoom:r,translateExtent:a}=u();return(0,l.hO)({delta:e,panZoom:r,transform:n,translateExtent:a,width:i,height:o})},fitView:e=>{let{panZoom:n,width:i,height:o,minZoom:r,maxZoom:a,nodeLookup:s}=u();if(!n)return Promise.resolve(!1);let d=(0,l.J6)(s,e);return(0,l.Qu)({nodes:d,width:i,height:o,panZoom:n,minZoom:r,maxZoom:a},e)},fitViewSync:e=>{let{panZoom:n,width:i,height:o,minZoom:r,maxZoom:a,nodeLookup:s}=u();if(!n)return!1;let d=(0,l.J6)(s,e);return(0,l.Qu)({nodes:d,width:i,height:o,panZoom:n,minZoom:r,maxZoom:a},e),d.size>0},cancelConnection:()=>{c({connection:{...l.Ky}})},updateConnection:e=>{c({connection:e})},reset:()=>c({...tf()})}),Object.is))({nodes:e,edges:n,defaultNodes:i,defaultEdges:o,width:r,height:s,fitView:u,nodeOrigin:h}));return(0,a.jsx)(g,{value:f,children:(0,a.jsx)(ee,{children:p})})}function tv({children:e,nodes:n,edges:i,defaultNodes:o,defaultEdges:r,width:s,height:l,fitView:c,nodeOrigin:u}){return(0,d.useContext)(h)?(0,a.jsx)(a.Fragment,{children:e}):(0,a.jsx)(tm,{initialNodes:n,initialEdges:i,defaultNodes:o,defaultEdges:r,initialWidth:s,initialHeight:l,fitView:c,nodeOrigin:u,children:e})}let ty={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};var tw=q(function({nodes:e,edges:n,defaultNodes:i,defaultEdges:o,className:r,nodeTypes:c,edgeTypes:u,onNodeClick:h,onEdgeClick:g,onInit:p,onMove:f,onMoveStart:m,onMoveEnd:v,onConnect:y,onConnectStart:w,onConnectEnd:b,onClickConnectStart:x,onClickConnectEnd:S,onNodeMouseEnter:E,onNodeMouseMove:M,onNodeMouseLeave:N,onNodeContextMenu:O,onNodeDoubleClick:I,onNodeDragStart:D,onNodeDrag:k,onNodeDragStop:L,onNodesDelete:j,onEdgesDelete:R,onDelete:H,onSelectionChange:$,onSelectionDragStart:z,onSelectionDrag:F,onSelectionDragStop:W,onSelectionContextMenu:Z,onSelectionStart:X,onSelectionEnd:K,onBeforeDelete:Y,connectionMode:U,connectionLineType:q=l.t8.Bezier,connectionLineStyle:Q,connectionLineComponent:J,connectionLineContainerStyle:G,deleteKeyCode:ee="Backspace",selectionKeyCode:et="Shift",selectionOnDrag:en=!1,selectionMode:ei=l.oW.Full,panActivationKeyCode:eo="Space",multiSelectionKeyCode:er=(0,l.Q5)()?"Meta":"Control",zoomActivationKeyCode:ea=(0,l.Q5)()?"Meta":"Control",snapToGrid:es,snapGrid:el,onlyRenderVisibleElements:ed=!1,selectNodesOnDrag:ec,nodesDraggable:eu,nodesConnectable:eh,nodesFocusable:eg,nodeOrigin:ep=A,edgesFocusable:ef,edgesReconnectable:em,elementsSelectable:ev=!0,defaultViewport:ey=P,minZoom:ew=.5,maxZoom:eb=2,translateExtent:ex=l.k5,preventScrolling:eS=!0,nodeExtent:eT,defaultMarkerColor:eE="#b1b1b7",zoomOnScroll:eM=!0,zoomOnPinch:eC=!0,panOnScroll:eN=!1,panOnScrollSpeed:eO=.5,panOnScrollMode:eI=l.IY.Free,zoomOnDoubleClick:eD=!0,panOnDrag:ek=!0,onPaneClick:e_,onPaneMouseEnter:eA,onPaneMouseMove:eP,onPaneMouseLeave:eL,onPaneScroll:ej,onPaneContextMenu:eR,paneClickDistance:eV=0,nodeClickDistance:eB=0,children:eH,onReconnect:e$,onReconnectStart:ez,onReconnectEnd:eF,onEdgeContextMenu:eW,onEdgeDoubleClick:eZ,onEdgeMouseEnter:eX,onEdgeMouseMove:eK,onEdgeMouseLeave:eY,reconnectRadius:eU=10,onNodesChange:eq,onEdgesChange:eQ,noDragClassName:eJ="nodrag",noWheelClassName:eG="nowheel",noPanClassName:e0="nopan",fitView:e1,fitViewOptions:e2,connectOnClick:e3,attributionPosition:e5,proOptions:e4,defaultEdgeOptions:e6,elevateNodesOnSelect:e8,elevateEdgesOnSelect:e7,disableKeyboardA11y:e9=!1,autoPanOnConnect:te,autoPanOnNodeDrag:tt,autoPanSpeed:tn,connectionRadius:ti,isValidConnection:to,onError:tr,style:ta,id:ts,nodeDragThreshold:tl,viewport:td,onViewportChange:tc,width:tu,height:th,colorMode:tg="light",debug:tf,...tm},tw){let tb=ts||"1",tx=function(e){let[n,i]=(0,d.useState)("system"===e?null:e);return(0,d.useEffect)(()=>{if("system"!==e)return void i(e);let n=B(),o=()=>i(n?.matches?"dark":"light");return o(),n?.addEventListener("change",o),()=>{n?.removeEventListener("change",o)}},[e]),null!==n?n:B()?.matches?"dark":"light"}(tg);return(0,a.jsx)("div",{...tm,style:{...ta,...ty},ref:tw,className:(0,s.Z)(["react-flow",r,tx]),"data-testid":"rf__wrapper",id:ts,children:(0,a.jsxs)(tv,{nodes:e,edges:n,width:tu,height:th,fitView:e1,nodeOrigin:ep,children:[(0,a.jsx)(tp,{onInit:p,onNodeClick:h,onEdgeClick:g,onNodeMouseEnter:E,onNodeMouseMove:M,onNodeMouseLeave:N,onNodeContextMenu:O,onNodeDoubleClick:I,nodeTypes:c,edgeTypes:u,connectionLineType:q,connectionLineStyle:Q,connectionLineComponent:J,connectionLineContainerStyle:G,selectionKeyCode:et,selectionOnDrag:en,selectionMode:ei,deleteKeyCode:ee,multiSelectionKeyCode:er,panActivationKeyCode:eo,zoomActivationKeyCode:ea,onlyRenderVisibleElements:ed,defaultViewport:ey,translateExtent:ex,minZoom:ew,maxZoom:eb,preventScrolling:eS,zoomOnScroll:eM,zoomOnPinch:eC,zoomOnDoubleClick:eD,panOnScroll:eN,panOnScrollSpeed:eO,panOnScrollMode:eI,panOnDrag:ek,onPaneClick:e_,onPaneMouseEnter:eA,onPaneMouseMove:eP,onPaneMouseLeave:eL,onPaneScroll:ej,onPaneContextMenu:eR,paneClickDistance:eV,nodeClickDistance:eB,onSelectionContextMenu:Z,onSelectionStart:X,onSelectionEnd:K,onReconnect:e$,onReconnectStart:ez,onReconnectEnd:eF,onEdgeContextMenu:eW,onEdgeDoubleClick:eZ,onEdgeMouseEnter:eX,onEdgeMouseMove:eK,onEdgeMouseLeave:eY,reconnectRadius:eU,defaultMarkerColor:eE,noDragClassName:eJ,noWheelClassName:eG,noPanClassName:e0,rfId:tb,disableKeyboardA11y:e9,nodeExtent:eT,viewport:td,onViewportChange:tc}),(0,a.jsx)(V,{nodes:e,edges:n,defaultNodes:i,defaultEdges:o,onConnect:y,onConnectStart:w,onConnectEnd:b,onClickConnectStart:x,onClickConnectEnd:S,nodesDraggable:eu,nodesConnectable:eh,nodesFocusable:eg,edgesFocusable:ef,edgesReconnectable:em,elementsSelectable:ev,elevateNodesOnSelect:e8,elevateEdgesOnSelect:e7,minZoom:ew,maxZoom:eb,nodeExtent:eT,onNodesChange:eq,onEdgesChange:eQ,snapToGrid:es,snapGrid:el,connectionMode:U,translateExtent:ex,connectOnClick:e3,defaultEdgeOptions:e6,fitView:e1,fitViewOptions:e2,onNodesDelete:j,onEdgesDelete:R,onDelete:H,onNodeDragStart:D,onNodeDrag:k,onNodeDragStop:L,onSelectionDrag:F,onSelectionDragStart:z,onSelectionDragStop:W,onMove:f,onMoveStart:m,onMoveEnd:v,noPanClassName:e0,nodeOrigin:ep,rfId:tb,autoPanOnConnect:te,autoPanOnNodeDrag:tt,autoPanSpeed:tn,onError:tr,connectionRadius:ti,isValidConnection:to,selectNodesOnDrag:ec,nodeDragThreshold:tl,onBeforeDelete:Y,paneClickDistance:eV,debug:tf}),(0,a.jsx)(_,{onSelectionChange:$}),eH,(0,a.jsx)(C,{proOptions:e4,position:e5}),(0,a.jsx)(T,{rfId:tb,disableKeyboardA11y:e9})]})})});function tb(e){let[n,i]=(0,d.useState)(e),o=(0,d.useCallback)(e=>i(n=>W(e,n)),[]);return[n,i,o]}function tx(e){let[n,i]=(0,d.useState)(e),o=(0,d.useCallback)(e=>i(n=>W(e,n)),[]);return[n,i,o]}function tS({dimensions:e,lineWidth:n,variant:i,className:o}){return(0,a.jsx)("path",{strokeWidth:n,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:(0,s.Z)(["react-flow__background-pattern",i,o])})}function tT({radius:e,className:n}){return(0,a.jsx)("circle",{cx:e,cy:e,r:e,className:(0,s.Z)(["react-flow__background-pattern","dots",n])})}(o=r||(r={})).Lines="lines",o.Dots="dots",o.Cross="cross";let tE={[r.Dots]:1,[r.Lines]:1,[r.Cross]:6},tM=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function tC({id:e,variant:n=r.Dots,gap:i=20,size:o,lineWidth:l=1,offset:c=0,color:h,bgColor:g,style:p,className:m,patternClassName:v}){let y=(0,d.useRef)(null),{transform:w,patternId:b}=f(tM,u.X),x=o||tE[n],S=n===r.Dots,T=n===r.Cross,E=Array.isArray(i)?i:[i,i],M=[E[0]*w[2]||1,E[1]*w[2]||1],C=x*w[2],N=Array.isArray(c)?c:[c,c],O=T?[C,C]:M,I=[N[0]*w[2]||1+O[0]/2,N[1]*w[2]||1+O[1]/2],D=`${b}${e||""}`;return(0,a.jsxs)("svg",{className:(0,s.Z)(["react-flow__background",m]),style:{...p,...ea,"--xy-background-color-props":g,"--xy-background-pattern-color-props":h},ref:y,"data-testid":"rf__background",children:[(0,a.jsx)("pattern",{id:D,x:w[0]%M[0],y:w[1]%M[1],width:M[0],height:M[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${I[0]},-${I[1]})`,children:S?(0,a.jsx)(tT,{radius:C/2,className:v}):(0,a.jsx)(tS,{dimensions:O,lineWidth:l,variant:n,className:v})}),(0,a.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${D})`})]})}function tN(){return(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:(0,a.jsx)("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function tO(){return(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:(0,a.jsx)("path",{d:"M0 0h32v4.2H0z"})})}function tI(){return(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:(0,a.jsx)("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function tD(){return(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,a.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function tk(){return(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,a.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function t_({children:e,className:n,...i}){return(0,a.jsx)("button",{type:"button",className:(0,s.Z)(["react-flow__controls-button",n]),...i,children:e})}tC.displayName="Background",(0,d.memo)(tC);let tA=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function tP({style:e,showZoom:n=!0,showFitView:i=!0,showInteractive:o=!0,fitViewOptions:r,onZoomIn:l,onZoomOut:d,onFitView:c,onInteractiveChange:h,className:g,children:p,position:v="bottom-left",orientation:y="vertical","aria-label":w="React Flow controls"}){let b=m(),{isInteractive:x,minZoomReached:S,maxZoomReached:T}=f(tA,u.X),{zoomIn:E,zoomOut:C,fitView:N}=en();return(0,a.jsxs)(M,{className:(0,s.Z)(["react-flow__controls","horizontal"===y?"horizontal":"vertical",g]),position:v,style:e,"data-testid":"rf__controls","aria-label":w,children:[n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t_,{onClick:()=>{E(),l?.()},className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:T,children:(0,a.jsx)(tN,{})}),(0,a.jsx)(t_,{onClick:()=>{C(),d?.()},className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:S,children:(0,a.jsx)(tO,{})})]}),i&&(0,a.jsx)(t_,{className:"react-flow__controls-fitview",onClick:()=>{N(r),c?.()},title:"fit view","aria-label":"fit view",children:(0,a.jsx)(tI,{})}),o&&(0,a.jsx)(t_,{className:"react-flow__controls-interactive",onClick:()=>{b.setState({nodesDraggable:!x,nodesConnectable:!x,elementsSelectable:!x}),h?.(!x)},title:"toggle interactivity","aria-label":"toggle interactivity",children:x?(0,a.jsx)(tk,{}):(0,a.jsx)(tD,{})}),p]})}tP.displayName="Controls",(0,d.memo)(tP);let tL=(0,d.memo)(function({id:e,x:n,y:i,width:o,height:r,style:l,color:d,strokeColor:c,strokeWidth:u,className:h,borderRadius:g,shapeRendering:p,selected:f,onClick:m}){let{background:v,backgroundColor:y}=l||{};return(0,a.jsx)("rect",{className:(0,s.Z)(["react-flow__minimap-node",{selected:f},h]),x:n,y:i,rx:g,ry:g,width:o,height:r,style:{fill:d||v||y,stroke:c,strokeWidth:u},shapeRendering:p,onClick:m?n=>m(n,e):void 0})}),tj=e=>e.nodes.map(e=>e.id),tR=e=>e instanceof Function?e:()=>e,tV=(0,d.memo)(function({id:e,nodeColorFunc:n,nodeStrokeColorFunc:i,nodeClassNameFunc:o,nodeBorderRadius:r,nodeStrokeWidth:s,shapeRendering:d,NodeComponent:c,onClick:h}){let{node:g,x:p,y:m}=f(n=>{let i=n.nodeLookup.get(e),{x:o,y:r}=i.internals.positionAbsolute;return{node:i,x:o,y:r}},u.X);if(!g||g.hidden||!(0,l.nb)(g))return null;let{width:v,height:y}=(0,l.Rf)(g);return(0,a.jsx)(c,{x:p,y:m,width:v,height:y,style:g.style,selected:!!g.selected,className:o(g),color:n(g),borderRadius:r,strokeColor:i(g),strokeWidth:s,shapeRendering:d,onClick:h,id:g.id})});var tB=(0,d.memo)(function({nodeStrokeColor:e,nodeColor:n,nodeClassName:i="",nodeBorderRadius:o=5,nodeStrokeWidth:r,nodeComponent:s=tL,onClick:l}){let d=f(tj,u.X),c=tR(n),h=tR(e),g=tR(i),p="undefined"==typeof window||window.chrome?"crispEdges":"geometricPrecision";return(0,a.jsx)(a.Fragment,{children:d.map(e=>(0,a.jsx)(tV,{id:e,nodeColorFunc:c,nodeStrokeColorFunc:h,nodeClassNameFunc:g,nodeBorderRadius:o,nodeStrokeWidth:r,NodeComponent:s,onClick:l,shapeRendering:p},e))})});let tH=e=>{let n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:e.nodeLookup.size>0?(0,l.oI)((0,l.W0)(e.nodeLookup),n):n,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}};function t$({style:e,className:n,nodeStrokeColor:i,nodeColor:o,nodeClassName:r="",nodeBorderRadius:c=5,nodeStrokeWidth:h,nodeComponent:g,bgColor:p,maskColor:v,maskStrokeColor:y,maskStrokeWidth:w,position:b="bottom-right",onClick:x,onNodeClick:S,pannable:T=!1,zoomable:E=!1,ariaLabel:C="React Flow mini map",inversePan:N,zoomStep:O=10,offsetScale:I=5}){let D=m(),k=(0,d.useRef)(null),{boundingRect:_,viewBB:A,rfId:P,panZoom:L,translateExtent:j,flowWidth:R,flowHeight:V}=f(tH,u.X),B=e?.width??200,H=e?.height??150,$=Math.max(_.width/B,_.height/H),z=$*B,F=$*H,W=I*$,Z=_.x-(z-_.width)/2-W,X=_.y-(F-_.height)/2-W,K=z+2*W,Y=F+2*W,U=`react-flow__minimap-desc-${P}`,q=(0,d.useRef)(0),Q=(0,d.useRef)();q.current=$,(0,d.useEffect)(()=>{if(k.current&&L)return Q.current=(0,l.FD)({domNode:k.current,panZoom:L,getTransform:()=>D.getState().transform,getViewScale:()=>q.current}),()=>{Q.current?.destroy()}},[L]),(0,d.useEffect)(()=>{Q.current?.update({translateExtent:j,width:R,height:V,inversePan:N,pannable:T,zoomStep:O,zoomable:E})},[T,E,N,O,j,R,V]);let J=x?e=>{let[n,i]=Q.current?.pointer(e)||[0,0];x(e,{x:n,y:i})}:void 0,G=S?(0,d.useCallback)((e,n)=>{S(e,D.getState().nodeLookup.get(n))},[]):void 0;return(0,a.jsx)(M,{position:b,style:{...e,"--xy-minimap-background-color-props":"string"==typeof p?p:void 0,"--xy-minimap-mask-background-color-props":"string"==typeof v?v:void 0,"--xy-minimap-mask-stroke-color-props":"string"==typeof y?y:void 0,"--xy-minimap-mask-stroke-width-props":"number"==typeof w?w*$:void 0,"--xy-minimap-node-background-color-props":"string"==typeof o?o:void 0,"--xy-minimap-node-stroke-color-props":"string"==typeof i?i:void 0,"--xy-minimap-node-stroke-width-props":"string"==typeof h?h:void 0},className:(0,s.Z)(["react-flow__minimap",n]),"data-testid":"rf__minimap",children:(0,a.jsxs)("svg",{width:B,height:H,viewBox:`${Z} ${X} ${K} ${Y}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":U,ref:k,onClick:J,children:[C&&(0,a.jsx)("title",{id:U,children:C}),(0,a.jsx)(tB,{onClick:G,nodeColor:o,nodeStrokeColor:i,nodeBorderRadius:c,nodeClassName:r,nodeStrokeWidth:h,nodeComponent:g}),(0,a.jsx)("path",{className:"react-flow__minimap-mask",d:`M${Z-W},${X-W}h${K+2*W}v${Y+2*W}h${-K-2*W}z
        M${A.x},${A.y}h${A.width}v${A.height}h${-A.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}t$.displayName="MiniMap",(0,d.memo)(t$),(0,d.memo)(function({nodeId:e,position:n,variant:i=l.pB.Handle,className:o,style:r={},children:c,color:u,minWidth:h=10,minHeight:g=10,maxWidth:p=Number.MAX_VALUE,maxHeight:f=Number.MAX_VALUE,keepAspectRatio:v=!1,shouldResize:y,onResizeStart:w,onResize:b,onResizeEnd:x}){let S=ew(),T="string"==typeof e?e:S,E=m(),M=(0,d.useRef)(null),C=i===l.pB.Line?"right":"bottom-right",N=n??C,O=(0,d.useRef)(null);(0,d.useEffect)(()=>{if(M.current&&T)return O.current||(O.current=(0,l.Cz)({domNode:M.current,nodeId:T,getStoreItems:()=>{let{nodeLookup:e,transform:n,snapGrid:i,snapToGrid:o,nodeOrigin:r}=E.getState();return{nodeLookup:e,transform:n,snapGrid:i,snapToGrid:o,nodeOrigin:r}},onChange:(e,n)=>{let{triggerNodeChanges:i,nodeLookup:o,parentLookup:r,nodeOrigin:a}=E.getState(),s=[],d={x:e.x,y:e.y},c=o.get(T);if(c&&c.expandParent&&c.parentId){let n=c.origin??a,i=e.width??c.measured.width,u=e.height??c.measured.height,h={id:c.id,parentId:c.parentId,rect:{width:i,height:u,...(0,l.ZB)({x:e.x??c.position.x,y:e.y??c.position.y},{width:i,height:u},c.parentId,o,n)}},g=(0,l.so)([h],o,r,a);s.push(...g),d.x=e.x?Math.max(n[0]*i,e.x):void 0,d.y=e.y?Math.max(n[1]*u,e.y):void 0}if(void 0!==d.x&&void 0!==d.y){let e={id:T,type:"position",position:{...d}};s.push(e)}if(void 0!==e.width&&void 0!==e.height){let n={id:T,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:e.width,height:e.height}};s.push(n)}for(let e of n){let n={...e,type:"position"};s.push(n)}i(s)},onEnd:()=>{E.getState().triggerNodeChanges([{id:T,type:"dimensions",resizing:!1}])}})),O.current.update({controlPosition:N,boundaries:{minWidth:h,minHeight:g,maxWidth:p,maxHeight:f},keepAspectRatio:v,onResizeStart:w,onResize:b,onResizeEnd:x,shouldResize:y}),()=>{O.current?.destroy()}},[N,h,g,p,f,v,w,b,x,y]);let I=N.split("-"),D=i===l.pB.Line?"borderColor":"backgroundColor",k=u?{...r,[D]:u}:r;return(0,a.jsx)("div",{className:(0,s.Z)(["react-flow__resize-control","nodrag",...I,i,o]),ref:M,style:k,children:c})})},417247:function(e,n,i){i.d(n,{$i:()=>et,B1:()=>ez,Cz:()=>tn,FD:()=>eG,Hm:()=>eT,IY:()=>h,J$:()=>U,J3:()=>O,J6:()=>P,JU:()=>eI,Ki:()=>Q,Ky:()=>M,Ly:()=>m,N5:()=>eh,OQ:()=>ey,OW:()=>eN,PS:()=>Z,Q5:()=>en,QZ:()=>f,Qj:()=>S,Ql:()=>eJ,Qu:()=>L,RY:()=>ex,Rf:()=>eo,S2:()=>ed,VV:()=>eR,Vt:()=>I,W0:()=>_,WD:()=>R,X6:()=>e6,ZB:()=>ea,Z_:()=>eS,Zp:()=>N,_2:()=>J,be:()=>eW,dW:()=>eA,f5:()=>A,hO:()=>eF,jD:()=>u,k5:()=>T,kE:()=>q,lM:()=>ef,lp:()=>Y,m:()=>G,n3:()=>eP,nb:()=>er,oC:()=>eK,oI:()=>K,oW:()=>g,oj:()=>ee,pB:()=>v,q7:()=>j,s$:()=>eu,s9:()=>B,so:()=>e$,t8:()=>p,t_:()=>el,wQ:()=>E,wv:()=>eg,xx:()=>eb,yF:()=>eV});var o,r,a,s,l,d,c,u,h,g,p,f,m,v,y=i(483098),w=i(941079),b=i(260527),x=i(406391);let S={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:n,sourceHandle:i,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${"source"===e?i:o}", edge id: ${n}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`},T=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],E=["Enter"," ","Escape"];(o=u||(u={})).Strict="strict",o.Loose="loose",(r=h||(h={})).Free="free",r.Vertical="vertical",r.Horizontal="horizontal",(a=g||(g={})).Partial="partial",a.Full="full";let M={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};(s=p||(p={})).Bezier="default",s.Straight="straight",s.Step="step",s.SmoothStep="smoothstep",s.SimpleBezier="simplebezier",(l=f||(f={})).Arrow="arrow",l.ArrowClosed="arrowclosed",(d=m||(m={})).Left="left",d.Top="top",d.Right="right",d.Bottom="bottom";let C={[m.Left]:m.Right,[m.Right]:m.Left,[m.Top]:m.Bottom,[m.Bottom]:m.Top};function N(e){return null===e?null:e?"valid":"invalid"}let O=e=>"id"in e&&"source"in e&&"target"in e,I=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),D=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),k=(e,n=[0,0])=>{let{width:i,height:o}=eo(e),r=e.origin??n,a=i*r[0],s=o*r[1];return{x:e.position.x-a,y:e.position.y-s}},_=(e,n={})=>{if(0===e.size)return{x:0,y:0,width:0,height:0};let i={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(e=>{if(void 0===n.filter||n.filter(e)){let n=X(e);i=z(i,n)}}),W(i)},A=(e,n,[i,o,r]=[0,0,1],a=!1,s=!1)=>{let l={...G(n,[i,o,r]),width:n.width/r,height:n.height/r},d=[];for(let n of e.values()){let{measured:e,selectable:i=!0,hidden:o=!1}=n;if(s&&!i||o)continue;let r=e.width??n.width??n.initialWidth??null,c=e.height??n.height??n.initialHeight??null,u=Y(l,Z(n)),h=(r??0)*(c??0),g=a&&u>0;(!n.internals.handleBounds||g||u>=h||n.dragging)&&d.push(n)}return d};function P(e,n){let i=new Map,o=n?.nodes?new Set(n.nodes.map(e=>e.id)):null;return e.forEach(e=>{e.measured.width&&e.measured.height&&(n?.includeHiddenNodes||!e.hidden)&&(!o||o.has(e.id))&&i.set(e.id,e)}),i}async function L({nodes:e,width:n,height:i,panZoom:o,minZoom:r,maxZoom:a},s){if(0===e.size)return Promise.resolve(!1);let l=et(_(e),n,i,s?.minZoom??r,s?.maxZoom??a,s?.padding??.1);return await o.setViewport(l,{duration:s?.duration}),Promise.resolve(!0)}function j({nodeId:e,nextPosition:n,nodeLookup:i,nodeOrigin:o=[0,0],nodeExtent:r,onError:a}){var s;let l=i.get(e),d=l.parentId?i.get(l.parentId):void 0,{x:c,y:u}=d?d.internals.positionAbsolute:{x:0,y:0},h=l.origin??o,g=(s=l.extent||r)&&"parent"!==s?[s[0],[s[1][0]-(l.measured?.width??0),s[1][1]-(l.measured?.height??0)]]:s;if("parent"!==l.extent||l.expandParent)d&&ei(l.extent)&&(g=[[l.extent[0][0]+c,l.extent[0][1]+u],[l.extent[1][0]+c,l.extent[1][1]+u]]);else if(d){let e=l.measured.width,n=l.measured.height,i=d.measured.width,o=d.measured.height;e&&n&&i&&o&&(g=[[c,u],[c+i-e,u+o-n]])}else a?.("005",S.error005());let p=ei(g)?B(n,g):n;return{position:{x:p.x-c+l.measured.width*h[0],y:p.y-u+l.measured.height*h[1]},positionAbsolute:p}}async function R({nodesToRemove:e=[],edgesToRemove:n=[],nodes:i,edges:o,onBeforeDelete:r}){let a=new Set(e.map(e=>e.id)),s=[];for(let e of i){if(!1===e.deletable)continue;let n=a.has(e.id),i=!n&&e.parentId&&s.find(n=>n.id===e.parentId);(n||i)&&s.push(e)}let l=new Set(n.map(e=>e.id)),d=o.filter(e=>!1!==e.deletable),c=((e,n)=>{let i=new Set;return e.forEach(e=>{i.add(e.id)}),n.filter(e=>i.has(e.source)||i.has(e.target))})(s,d);for(let e of d)l.has(e.id)&&!c.find(n=>n.id===e.id)&&c.push(e);if(!r)return{edges:c,nodes:s};let u=await r({nodes:s,edges:c});return"boolean"==typeof u?u?{edges:c,nodes:s}:{edges:[],nodes:[]}:u}let V=(e,n=0,i=1)=>Math.min(Math.max(e,n),i),B=(e={x:0,y:0},n)=>({x:V(e.x,n[0][0],n[1][0]),y:V(e.y,n[0][1],n[1][1])}),H=(e,n,i)=>e<n?V(Math.abs(e-n),1,n)/n:e>i?-V(Math.abs(e-i),1,n)/n:0,$=(e,n,i=15,o=40)=>[H(e.x,o,n.width-o)*i,H(e.y,o,n.height-o)*i],z=(e,n)=>({x:Math.min(e.x,n.x),y:Math.min(e.y,n.y),x2:Math.max(e.x2,n.x2),y2:Math.max(e.y2,n.y2)}),F=({x:e,y:n,width:i,height:o})=>({x:e,y:n,x2:e+i,y2:n+o}),W=({x:e,y:n,x2:i,y2:o})=>({x:e,y:n,width:i-e,height:o-n}),Z=(e,n=[0,0])=>{let{x:i,y:o}=D(e)?e.internals.positionAbsolute:k(e,n);return{x:i,y:o,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},X=(e,n=[0,0])=>{let{x:i,y:o}=D(e)?e.internals.positionAbsolute:k(e,n);return{x:i,y:o,x2:i+(e.measured?.width??e.width??e.initialWidth??0),y2:o+(e.measured?.height??e.height??e.initialHeight??0)}},K=(e,n)=>W(z(F(e),F(n))),Y=(e,n)=>Math.ceil(Math.max(0,Math.min(e.x+e.width,n.x+n.width)-Math.max(e.x,n.x))*Math.max(0,Math.min(e.y+e.height,n.y+n.height)-Math.max(e.y,n.y))),U=e=>q(e.width)&&q(e.height)&&q(e.x)&&q(e.y),q=e=>!isNaN(e)&&isFinite(e),Q=(e,n)=>{},J=(e,n=[1,1])=>({x:n[0]*Math.round(e.x/n[0]),y:n[1]*Math.round(e.y/n[1])}),G=({x:e,y:n},[i,o,r],a=!1,s=[1,1])=>{let l={x:(e-i)/r,y:(n-o)/r};return a?J(l,s):l},ee=({x:e,y:n},[i,o,r])=>({x:e*r+i,y:n*r+o}),et=(e,n,i,o,r,a)=>{let s=V(Math.min(n/(e.width*(1+a)),i/(e.height*(1+a))),o,r),l=e.x+e.width/2;return{x:n/2-l*s,y:i/2-(e.y+e.height/2)*s,zoom:s}},en=()=>"undefined"!=typeof navigator&&navigator?.userAgent?.indexOf("Mac")>=0;function ei(e){return void 0!==e&&"parent"!==e}function eo(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function er(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function ea(e,n={width:0,height:0},i,o,r){let a=i,s={...e};for(;a;){let e=o.get(a);if(a=e?.parentId,e){let i=e.origin||r;s.x+=e.internals.positionAbsolute.x-(n.width??0)*i[0],s.y+=e.internals.positionAbsolute.y-(n.height??0)*i[1]}}return s}function es(e,{snapGrid:n=[0,0],snapToGrid:i=!1,transform:o}){let{x:r,y:a}=eg(e),s=G({x:r,y:a},o),{x:l,y:d}=i?J(s,n):s;return{xSnapped:l,ySnapped:d,...s}}let el=e=>({width:e.offsetWidth,height:e.offsetHeight}),ed=e=>e.getRootNode?.()||window?.document,ec=["INPUT","SELECT","TEXTAREA"];function eu(e){let n=e.composedPath?.()?.[0]||e.target;return ec.includes(n?.nodeName)||n?.hasAttribute("contenteditable")||!!n?.closest(".nokey")}let eh=e=>"clientX"in e,eg=(e,n)=>{let i=eh(e),o=i?e.clientX:e.touches?.[0].clientX,r=i?e.clientY:e.touches?.[0].clientY;return{x:o-(n?.left??0),y:r-(n?.top??0)}},ep=(e,n,i,o,r)=>{let a=n.querySelectorAll(`.${e}`);return a&&a.length?Array.from(a).map(n=>{let a=n.getBoundingClientRect();return{id:n.getAttribute("data-handleid"),type:e,nodeId:r,position:n.getAttribute("data-handlepos"),x:(a.left-i.left)/o,y:(a.top-i.top)/o,...el(n)}}):null};function ef({sourceX:e,sourceY:n,targetX:i,targetY:o,sourceControlX:r,sourceControlY:a,targetControlX:s,targetControlY:l}){let d=.125*e+.375*r+.375*s+.125*i,c=.125*n+.375*a+.375*l+.125*o,u=Math.abs(d-e),h=Math.abs(c-n);return[d,c,u,h]}function em(e,n){return e>=0?.5*e:25*n*Math.sqrt(-e)}function ev({pos:e,x1:n,y1:i,x2:o,y2:r,c:a}){switch(e){case m.Left:return[n-em(n-o,a),i];case m.Right:return[n+em(o-n,a),i];case m.Top:return[n,i-em(i-r,a)];case m.Bottom:return[n,i+em(r-i,a)]}}function ey({sourceX:e,sourceY:n,sourcePosition:i=m.Bottom,targetX:o,targetY:r,targetPosition:a=m.Top,curvature:s=.25}){let[l,d]=ev({pos:i,x1:e,y1:n,x2:o,y2:r,c:s}),[c,u]=ev({pos:a,x1:o,y1:r,x2:e,y2:n,c:s}),[h,g,p,f]=ef({sourceX:e,sourceY:n,targetX:o,targetY:r,sourceControlX:l,sourceControlY:d,targetControlX:c,targetControlY:u});return[`M${e},${n} C${l},${d} ${c},${u} ${o},${r}`,h,g,p,f]}function ew({sourceX:e,sourceY:n,targetX:i,targetY:o}){let r=Math.abs(i-e)/2,a=Math.abs(o-n)/2;return[i<e?i+r:i-r,o<n?o+a:o-a,r,a]}function eb({sourceNode:e,targetNode:n,selected:i=!1,zIndex:o=0,elevateOnSelect:r=!1}){if(!r)return o;let a=i||n.selected||e.selected,s=Math.max(e.internals.z||0,n.internals.z||0,1e3);return o+(a?s:0)}function ex({sourceNode:e,targetNode:n,width:i,height:o,transform:r}){let a=z(X(e),X(n));return a.x===a.x2&&(a.x2+=1),a.y===a.y2&&(a.y2+=1),Y({x:-r[0]/r[2],y:-r[1]/r[2],width:i/r[2],height:o/r[2]},W(a))>0}let eS=(e,n)=>{let i,o;return e.source&&e.target?(o=i=O(e)?{...e}:{...e,id:(({source:e,sourceHandle:n,target:i,targetHandle:o})=>`xy-edge__${e}${n||""}-${i}${o||""}`)(e)},n.some(e=>e.source===o.source&&e.target===o.target&&(e.sourceHandle===o.sourceHandle||!e.sourceHandle&&!o.sourceHandle)&&(e.targetHandle===o.targetHandle||!e.targetHandle&&!o.targetHandle)))?n:(null===i.sourceHandle&&delete i.sourceHandle,null===i.targetHandle&&delete i.targetHandle,n.concat(i)):(Q("006",S.error006()),n)};function eT({sourceX:e,sourceY:n,targetX:i,targetY:o}){let[r,a,s,l]=ew({sourceX:e,sourceY:n,targetX:i,targetY:o});return[`M ${e},${n}L ${i},${o}`,r,a,s,l]}let eE={[m.Left]:{x:-1,y:0},[m.Right]:{x:1,y:0},[m.Top]:{x:0,y:-1},[m.Bottom]:{x:0,y:1}},eM=({source:e,sourcePosition:n=m.Bottom,target:i})=>n===m.Left||n===m.Right?e.x<i.x?{x:1,y:0}:{x:-1,y:0}:e.y<i.y?{x:0,y:1}:{x:0,y:-1},eC=(e,n)=>Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2));function eN({sourceX:e,sourceY:n,sourcePosition:i=m.Bottom,targetX:o,targetY:r,targetPosition:a=m.Top,borderRadius:s=5,centerX:l,centerY:d,offset:c=20}){let[u,h,g,p,f]=function({source:e,sourcePosition:n=m.Bottom,target:i,targetPosition:o=m.Top,center:r,offset:a}){let s,l,d=eE[n],c=eE[o],u={x:e.x+d.x*a,y:e.y+d.y*a},h={x:i.x+c.x*a,y:i.y+c.y*a},g=eM({source:u,sourcePosition:n,target:h}),p=0!==g.x?"x":"y",f=g[p],v=[],y={x:0,y:0},w={x:0,y:0},[b,x,S,T]=ew({sourceX:e.x,sourceY:e.y,targetX:i.x,targetY:i.y});if(d[p]*c[p]==-1){s=r.x??b,l=r.y??x;let e=[{x:s,y:u.y},{x:s,y:h.y}],n=[{x:u.x,y:l},{x:h.x,y:l}];v=d[p]===f?"x"===p?e:n:"x"===p?n:e}else{let r=[{x:u.x,y:h.y}],g=[{x:h.x,y:u.y}];if(v="x"===p?d.x===f?g:r:d.y===f?r:g,n===o){let n=Math.abs(e[p]-i[p]);if(n<=a){let o=Math.min(a-1,a-n);d[p]===f?y[p]=(u[p]>e[p]?-1:1)*o:w[p]=(h[p]>i[p]?-1:1)*o}}if(n!==o){let e="x"===p?"y":"x",n=d[p]===c[e],i=u[e]>h[e],o=u[e]<h[e];(1===d[p]&&(!n&&i||n&&o)||1!==d[p]&&(!n&&o||n&&i))&&(v="x"===p?r:g)}let m={x:u.x+y.x,y:u.y+y.y},b={x:h.x+w.x,y:h.y+w.y};Math.max(Math.abs(m.x-v[0].x),Math.abs(b.x-v[0].x))>=Math.max(Math.abs(m.y-v[0].y),Math.abs(b.y-v[0].y))?(s=(m.x+b.x)/2,l=v[0].y):(s=v[0].x,l=(m.y+b.y)/2)}return[[e,{x:u.x+y.x,y:u.y+y.y},...v,{x:h.x+w.x,y:h.y+w.y},i],s,l,S,T]}({source:{x:e,y:n},sourcePosition:i,target:{x:o,y:r},targetPosition:a,center:{x:l,y:d},offset:c});return[u.reduce((e,n,i)=>e+(i>0&&i<u.length-1?function(e,n,i,o){let r=Math.min(eC(e,n)/2,eC(n,i)/2,o),{x:a,y:s}=n;if(e.x===a&&a===i.x||e.y===s&&s===i.y)return`L${a} ${s}`;if(e.y===s){let n=e.x<i.x?-1:1,o=e.y<i.y?1:-1;return`L ${a+r*n},${s}Q ${a},${s} ${a},${s+r*o}`}let l=e.x<i.x?1:-1,d=e.y<i.y?-1:1;return`L ${a},${s+r*d}Q ${a},${s} ${a+r*l},${s}`}(u[i-1],n,u[i+1],s):`${0===i?"M":"L"}${n.x} ${n.y}`),""),h,g,p,f]}function eO(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function eI(e){let{sourceNode:n,targetNode:i}=e;if(!eO(n)||!eO(i))return null;let o=n.internals.handleBounds||eD(n.handles),r=i.internals.handleBounds||eD(i.handles),a=e_(o?.source??[],e.sourceHandle),s=e_(e.connectionMode===u.Strict?r?.target??[]:(r?.target??[]).concat(r?.source??[]),e.targetHandle);if(!a||!s)return e.onError?.("008",S.error008(!a?"source":"target",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;let l=a?.position||m.Bottom,d=s?.position||m.Top,c=ek(n,a,l),h=ek(i,s,d);return{sourceX:c.x,sourceY:c.y,targetX:h.x,targetY:h.y,sourcePosition:l,targetPosition:d}}function eD(e){if(!e)return null;let n=[],i=[];for(let o of e)o.width=o.width??1,o.height=o.height??1,"source"===o.type?n.push(o):"target"===o.type&&i.push(o);return{source:n,target:i}}function ek(e,n,i=m.Left,o=!1){let r=(n?.x??0)+e.internals.positionAbsolute.x,a=(n?.y??0)+e.internals.positionAbsolute.y,{width:s,height:l}=n??eo(e);if(o)return{x:r+s/2,y:a+l/2};switch(n?.position??i){case m.Top:return{x:r+s/2,y:a};case m.Right:return{x:r+s,y:a+l/2};case m.Bottom:return{x:r+s/2,y:a+l};case m.Left:return{x:r,y:a+l/2}}}function e_(e,n){return e&&(n?e.find(e=>e.id===n):e[0])||null}function eA(e,n){if(!e)return"";if("string"==typeof e)return e;let i=n?`${n}__`:"";return`${i}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`}function eP(e,{id:n,defaultColor:i,defaultMarkerStart:o,defaultMarkerEnd:r}){let a=new Set;return e.reduce((e,s)=>([s.markerStart||o,s.markerEnd||r].forEach(o=>{if(o&&"object"==typeof o){let r=eA(o,n);a.has(r)||(e.push({id:r,color:o.color||i,...o}),a.add(r))}}),e),[]).sort((e,n)=>e.id.localeCompare(n.id))}let eL={nodeOrigin:[0,0],elevateNodesOnSelect:!0,defaults:{}},ej={...eL,checkEquality:!0};function eR(e,n,i){let o={...eL,...i};for(let i of e.values())i.parentId&&eB(i,e,n,o)}function eV(e,n,i,o){let r={...ej,...o},a=new Map(n);n.clear(),i.clear();let s=1e3*!!o?.elevateNodesOnSelect;for(let l of e){let e=a.get(l.id);r.checkEquality&&l===e?.internals.userNode||(e={...r.defaults,...l,measured:{width:l.measured?.width,height:l.measured?.height},internals:{positionAbsolute:k(l,r.nodeOrigin),handleBounds:l.measured?e?.internals.handleBounds:void 0,z:eH(l,s),userNode:l}}),n.set(l.id,e),l.parentId&&eB(e,n,i,o)}}function eB(e,n,i,o){let r={...eL,...o},a=e.parentId,s=n.get(a);if(!s)return void console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);let l=i.get(a);l?l.set(e.id,e):i.set(a,new Map([[e.id,e]]));let d=1e3*!!o?.elevateNodesOnSelect,{x:c,y:u,z:h}=function(e,n,i,o){let r=k(e,i),a=eH(e,o),s=n.internals.z??0;return{x:n.internals.positionAbsolute.x+r.x,y:n.internals.positionAbsolute.y+r.y,z:s>a?s:a}}(e,s,r.nodeOrigin,d),g=e.internals.positionAbsolute,p=c!==g.x||u!==g.y;(p||h!==e.internals.z)&&(e.internals={...e.internals,positionAbsolute:p?{x:c,y:u}:g,z:h})}function eH(e,n){return(q(e.zIndex)?e.zIndex:0)+(e.selected?n:0)}function e$(e,n,i,o=[0,0]){let r=[],a=new Map;for(let i of e){let e=n.get(i.parentId);if(!e)continue;let o=K(a.get(i.parentId)?.expandedRect??Z(e),i.rect);a.set(i.parentId,{expandedRect:o,parent:e})}return a.size>0&&a.forEach(({expandedRect:n,parent:a},s)=>{let l=a.internals.positionAbsolute,d=eo(a),c=a.origin??o,u=n.x<l.x?Math.round(Math.abs(l.x-n.x)):0,h=n.y<l.y?Math.round(Math.abs(l.y-n.y)):0,g=Math.max(d.width,Math.round(n.width)),p=Math.max(d.height,Math.round(n.height)),f=(g-d.width)*c[0],m=(p-d.height)*c[1];(u>0||h>0||f||m)&&(r.push({id:s,type:"position",position:{x:a.position.x-u+f,y:a.position.y-h+m}}),i.get(s)?.forEach(n=>{e.some(e=>e.id===n.id)||r.push({id:n.id,type:"position",position:{x:n.position.x+u,y:n.position.y+h}})})),(d.width<n.width||d.height<n.height||u||h)&&r.push({id:s,type:"dimensions",setAttributes:!0,dimensions:{width:g+(u?c[0]*u-f:0),height:p+(h?c[1]*h-m:0)}})}),r}function ez(e,n,i,o,r){let a=o?.querySelector(".xyflow__viewport"),s=!1;if(!a)return{changes:[],updatedInternals:s};let l=[],d=window.getComputedStyle(a),{m22:c}=new window.DOMMatrixReadOnly(d.transform),u=[];for(let o of e.values()){let e=n.get(o.id);if(e)if(e.hidden)e.internals={...e.internals,handleBounds:void 0},s=!0;else{let a=el(o.nodeElement),d=e.measured.width!==a.width||e.measured.height!==a.height;if(a.width&&a.height&&(d||!e.internals.handleBounds||o.force)){let h=o.nodeElement.getBoundingClientRect();e.measured=a,e.internals={...e.internals,positionAbsolute:k(e,r),handleBounds:{source:ep("source",o.nodeElement,h,c,e.id),target:ep("target",o.nodeElement,h,c,e.id)}},e.parentId&&eB(e,n,i,{nodeOrigin:r}),s=!0,d&&(l.push({id:e.id,type:"dimensions",dimensions:a}),e.expandParent&&e.parentId&&u.push({id:e.id,parentId:e.parentId,rect:Z(e,r)}))}}}if(u.length>0){let e=e$(u,n,i,r);l.push(...e)}return{changes:l,updatedInternals:s}}async function eF({delta:e,panZoom:n,transform:i,translateExtent:o,width:r,height:a}){if(!n||!e.x&&!e.y)return Promise.resolve(!1);let s=await n.setViewportConstrained({x:i[0]+e.x,y:i[1]+e.y,zoom:i[2]},[[0,0],[r,a]],o);return Promise.resolve(!!s&&(s.x!==i[0]||s.y!==i[1]||s.k!==i[2]))}function eW(e,n,i){for(let o of(e.clear(),n.clear(),i)){let{source:i,target:r,sourceHandle:a=null,targetHandle:s=null}=o,l=`${i}-source-${a}`,d=`${r}-target-${s}`,c=e.get(l)||new Map,u=e.get(d)||new Map,h={edgeId:o.id,source:i,target:r,sourceHandle:a,targetHandle:s};n.set(o.id,o),e.set(l,c.set(`${r}-${s}`,h)),e.set(d,u.set(`${i}-${a}`,h))}}function eZ(e,n,i){let o=e;do{if(o?.matches(n))return!0;if(o===i)break;o=o.parentElement}while(o);return!1}function eX({nodeId:e,dragItems:n,nodeLookup:i,dragging:o=!0}){let r=[];for(let[e,a]of n){let n=i.get(e)?.internals.userNode;n&&r.push({...n,position:a.position,dragging:o})}if(!e)return[r[0],r];let a=i.get(e).internals.userNode;return[{...a,position:n.get(e)?.position||a.position,dragging:o},r]}function eK({onNodeMouseDown:e,getStoreItems:n,onDragStart:i,onDrag:o,onDragStop:r}){let a={x:null,y:null},s=0,l=new Map,d=!1,c={x:0,y:0},u=null,h=!1,g=null,p=!1;return{update:function({noDragClassName:f,handleSelector:m,domNode:v,isSelectable:b,nodeId:x,nodeClickDistance:S=0}){function T({x:e,y:i},r){let{nodeLookup:s,nodeExtent:d,snapGrid:c,snapToGrid:u,nodeOrigin:h,onNodeDrag:g,onSelectionDrag:p,onError:f,updateNodePositions:m}=n();a={x:e,y:i};let v=!1,y={x:0,y:0,x2:0,y2:0};for(let[n,o]of(l.size>1&&d&&(y=F(_(l))),l)){let r={x:e-o.distance.x,y:i-o.distance.y};u&&(r=J(r,c));let a=[[d[0][0],d[0][1]],[d[1][0],d[1][1]]];if(l.size>1&&d&&!o.extent){let{positionAbsolute:e}=o.internals,n=e.x-y.x+d[0][0],i=e.x+o.measured.width-y.x2+d[1][0];a=[[n,e.y-y.y+d[0][1]],[i,e.y+o.measured.height-y.y2+d[1][1]]]}let{position:g,positionAbsolute:p}=j({nodeId:n,nextPosition:r,nodeLookup:s,nodeExtent:a,nodeOrigin:h,onError:f});v=v||o.position.x!==g.x||o.position.y!==g.y,o.position=g,o.internals.positionAbsolute=p}if(v&&(m(l,!0),r&&(o||g||!x&&p))){let[e,n]=eX({nodeId:x,dragItems:l,nodeLookup:s});o?.(r,l,e,n),g?.(r,e,n),x||p?.(r,n)}}async function E(){if(!u)return;let{transform:e,panBy:i,autoPanSpeed:o}=n(),[r,l]=$(c,u,o);(0!==r||0!==l)&&(a.x=(a.x??0)-r/e[2],a.y=(a.y??0)-l/e[2],await i({x:r,y:l})&&T(a,null)),s=requestAnimationFrame(E)}function M(o){let{nodeLookup:r,multiSelectionActive:s,nodesDraggable:d,transform:c,snapGrid:u,snapToGrid:g,selectNodesOnDrag:p,onNodeDragStart:f,onSelectionDragStart:m,unselectNodesAndEdges:v}=n();h=!0,p&&b||s||!x||r.get(x)?.selected||v(),b&&p&&x&&e?.(x);let y=es(o.sourceEvent,{transform:c,snapGrid:u,snapToGrid:g});if(a=y,(l=function(e,n,i,o){let r=new Map;for(let[a,s]of e)if((s.selected||s.id===o)&&(!s.parentId||!function e(n,i){if(!n.parentId)return!1;let o=i.get(n.parentId);return!!o&&(!!o.selected||e(o,i))}(s,e))&&(s.draggable||n&&void 0===s.draggable)){let n=e.get(a);n&&r.set(a,{id:a,position:n.position||{x:0,y:0},distance:{x:i.x-n.internals.positionAbsolute.x,y:i.y-n.internals.positionAbsolute.y},extent:n.extent,parentId:n.parentId,origin:n.origin,expandParent:n.expandParent,internals:{positionAbsolute:n.internals.positionAbsolute||{x:0,y:0}},measured:{width:n.measured.width??0,height:n.measured.height??0}})}return r}(r,d,y,x)).size>0&&(i||f||!x&&m)){let[e,n]=eX({nodeId:x,dragItems:l,nodeLookup:r});i?.(o.sourceEvent,l,e,n),f?.(o.sourceEvent,e,n),x||m?.(o.sourceEvent,n)}}g=(0,w.Z)(v);let C=(0,y.Z)().clickDistance(S).on("start",e=>{let{domNode:i,nodeDragThreshold:o,transform:r,snapGrid:s,snapToGrid:l}=n();p=!1,0===o&&M(e),a=es(e.sourceEvent,{transform:r,snapGrid:s,snapToGrid:l}),u=i?.getBoundingClientRect()||null,c=eg(e.sourceEvent,u)}).on("drag",e=>{let{autoPanOnNodeDrag:i,transform:o,snapGrid:r,snapToGrid:s,nodeDragThreshold:g}=n(),f=es(e.sourceEvent,{transform:o,snapGrid:r,snapToGrid:s});if("touchmove"===e.sourceEvent.type&&e.sourceEvent.touches.length>1&&(p=!0),!p){if(!d&&i&&h&&(d=!0,E()),!h){let n=f.xSnapped-(a.x??0),i=f.ySnapped-(a.y??0);Math.sqrt(n*n+i*i)>g&&M(e)}(a.x!==f.xSnapped||a.y!==f.ySnapped)&&l&&h&&(c=eg(e.sourceEvent,u),T(f,e.sourceEvent))}}).on("end",e=>{if(h&&!p&&(d=!1,h=!1,cancelAnimationFrame(s),l.size>0)){let{nodeLookup:i,updateNodePositions:o,onNodeDragStop:a,onSelectionDragStop:s}=n();if(o(l,!1),r||a||!x&&s){let[n,o]=eX({nodeId:x,dragItems:l,nodeLookup:i,dragging:!1});r?.(e.sourceEvent,l,n,o),a?.(e.sourceEvent,n,o),x||s?.(e.sourceEvent,o)}}}).filter(e=>{let n=e.target;return!e.button&&(!f||!eZ(n,`.${f}`,v))&&(!m||eZ(n,m,v))});g.call(C)},destroy:function(){g?.on(".drag",null)}}}function eY(e,n,i,o,r,a=!1){let s=o.get(e);if(!s)return null;let l="strict"===r?s.internals.handleBounds?.[n]:[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]],d=(i?l?.find(e=>e.id===i):l?.[0])??null;return d&&a?{...d,...ek(s,d,d.position,!0)}:d}function eU(e,n){return e?e:n?.classList.contains("target")?"target":n?.classList.contains("source")?"source":null}let eq=()=>!0;function eQ(e,{handle:n,connectionMode:i,fromNodeId:o,fromHandleId:r,fromType:a,doc:s,lib:l,flowId:d,isValidConnection:c=eq,nodeLookup:h}){let g="target"===a,p=n?s.querySelector(`.${l}-flow__handle[data-id="${d}-${n?.nodeId}-${n?.id}-${n?.type}"]`):null,{x:f,y:m}=eg(e),v=s.elementFromPoint(f,m),y=v?.classList.contains(`${l}-flow__handle`)?v:p,w={handleDomNode:y,isValid:!1,connection:null,toHandle:null};if(y){let e=eU(void 0,y),n=y.getAttribute("data-nodeid"),a=y.getAttribute("data-handleid"),s=y.classList.contains("connectable"),l=y.classList.contains("connectableend");if(!n||!e)return w;let d={source:g?n:o,sourceHandle:g?a:r,target:g?o:n,targetHandle:g?r:a};w.connection=d,w.isValid=s&&l&&(i===u.Strict?g&&"source"===e||!g&&"target"===e:n!==o||a!==r)&&c(d),w.toHandle=eY(n,e,a,h,i,!1)}return w}let eJ={onPointerDown:function(e,{connectionMode:n,connectionRadius:i,handleId:o,nodeId:r,edgeUpdaterType:a,isTarget:s,domNode:l,nodeLookup:d,lib:c,autoPanOnConnect:u,flowId:h,panBy:g,cancelConnection:p,onConnectStart:f,onConnect:v,onConnectEnd:y,isValidConnection:w=eq,onReconnectEnd:b,updateConnection:x,getTransform:S,getFromHandle:T,autoPanSpeed:E}){let M,N=ed(e.target),O=0,{x:I,y:D}=eg(e),k=eU(a,N?.elementFromPoint(I,D)),_=l?.getBoundingClientRect();if(!_||!k)return;let A=eY(r,k,o,d,n);if(!A)return;let P=eg(e,_),L=!1,j=null,R=!1,V=null,B={...A,nodeId:r,type:k,position:A.position},H=d.get(r),z={inProgress:!0,isValid:null,from:ek(H,B,m.Left,!0),fromHandle:B,fromPosition:B.position,fromNode:H,to:P,toHandle:null,toPosition:C[B.position],toNode:null};x(z);let F=z;function W(e){var a,l;let p;if(!T()||!B)return void X(e);let f=S();M=function(e,n,i,o){let r=[],a=1/0;for(let s of function(e,n,i){let o=[],r={x:e.x-i,y:e.y-i,width:2*i,height:2*i};for(let e of n.values())Y(r,Z(e))>0&&o.push(e);return o}(e,i,n+250))for(let i of[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]]){if(o.nodeId===i.nodeId&&o.type===i.type&&o.id===i.id)continue;let{x:l,y:d}=ek(s,i,i.position,!0),c=Math.sqrt(Math.pow(l-e.x,2)+Math.pow(d-e.y,2));c>n||(c<a?(r=[{...i,x:l,y:d}],a=c):c===a&&r.push({...i,x:l,y:d}))}if(!r.length)return null;if(r.length>1){let e="source"===o.type?"target":"source";return r.find(n=>n.type===e)??r[0]}return r[0]}(G(P=eg(e,_),f,!1,[1,1]),i,d,B),L||(!function e(){if(!u||!_)return;let[n,i]=$(P,_,E);g({x:n,y:i}),O=requestAnimationFrame(e)}(),L=!0);let m=eQ(e,{handle:M,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:s?"target":"source",isValidConnection:w,doc:N,lib:c,flowId:h,nodeLookup:d});V=m.handleDomNode,j=m.connection,a=!!M,l=m.isValid,p=null,l?p=!0:a&&!l&&(p=!1),R=p;let v={...F,isValid:R,to:M&&R?ee({x:M.x,y:M.y},f):P,toHandle:m.toHandle,toPosition:R&&m.toHandle?m.toHandle.position:C[B.position],toNode:m.toHandle?d.get(m.toHandle.nodeId):null};R&&M&&F.toHandle&&v.toHandle&&F.toHandle.type===v.toHandle.type&&F.toHandle.nodeId===v.toHandle.nodeId&&F.toHandle.id===v.toHandle.id&&F.to.x===v.to.x&&F.to.y===v.to.y||(x(v),F=v)}function X(e){(M||V)&&j&&R&&v?.(j);let{inProgress:n,...i}=F,o={...i,toPosition:F.toHandle?F.toPosition:null};y?.(e,o),a&&b?.(e,o),p(),cancelAnimationFrame(O),L=!1,R=!1,j=null,V=null,N.removeEventListener("mousemove",W),N.removeEventListener("mouseup",X),N.removeEventListener("touchmove",W),N.removeEventListener("touchend",X)}f?.(e,{nodeId:r,handleId:o,handleType:k}),N.addEventListener("mousemove",W),N.addEventListener("mouseup",X),N.addEventListener("touchmove",W),N.addEventListener("touchend",X)},isValid:eQ};function eG({domNode:e,panZoom:n,getTransform:i,getViewScale:o}){let r=(0,w.Z)(e);return{update:function({translateExtent:e,width:a,height:s,zoomStep:l=10,pannable:d=!0,zoomable:c=!0,inversePan:u=!1}){let h=[0,0],g=(0,x.sP)().on("start",e=>{("mousedown"===e.sourceEvent.type||"touchstart"===e.sourceEvent.type)&&(h=[e.sourceEvent.clientX??e.sourceEvent.touches[0].clientX,e.sourceEvent.clientY??e.sourceEvent.touches[0].clientY])}).on("zoom",d?r=>{let l=i();if("mousemove"!==r.sourceEvent.type&&"touchmove"!==r.sourceEvent.type||!n)return;let d=[r.sourceEvent.clientX??r.sourceEvent.touches[0].clientX,r.sourceEvent.clientY??r.sourceEvent.touches[0].clientY],c=[d[0]-h[0],d[1]-h[1]];h=d;let g=o()*Math.max(l[2],Math.log(l[2]))*(u?-1:1),p={x:l[0]-c[0]*g,y:l[1]-c[1]*g};n.setViewportConstrained({x:p.x,y:p.y,zoom:l[2]},[[0,0],[a,s]],e)}:null).on("zoom.wheel",c?e=>{let o=i();if("wheel"!==e.sourceEvent.type||!n)return;let r=-e.sourceEvent.deltaY*(1===e.sourceEvent.deltaMode?.05:e.sourceEvent.deltaMode?1:.002)*l,a=o[2]*Math.pow(2,r);n.scaleTo(a)}:null);r.call(g,{})},destroy:function(){r.on("zoom",null)},pointer:b.Z}}let e0=e=>({x:e.x,y:e.y,zoom:e.k}),e1=({x:e,y:n,zoom:i})=>x.CR.translate(e,n).scale(i),e2=(e,n)=>e.target.closest(`.${n}`),e3=(e,n)=>2===n&&Array.isArray(e)&&e.includes(2),e5=(e,n=0,i=()=>{})=>{let o="number"==typeof n&&n>0;return o||i(),o?e.transition().duration(n).on("end",i):e},e4=e=>{let n=e.ctrlKey&&en()?10:1;return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*n};function e6({domNode:e,minZoom:n,maxZoom:i,paneClickDistance:o,translateExtent:r,viewport:a,onPanZoom:s,onPanZoomStart:l,onPanZoomEnd:d,onDraggingChange:c}){let u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},g=e.getBoundingClientRect(),p=(0,x.sP)().clickDistance(!q(o)||o<0?0:o).scaleExtent([n,i]).translateExtent(r),f=(0,w.Z)(e).call(p);T({x:a.x,y:a.y,zoom:V(a.zoom,n,i)},[[0,0],[g.width,g.height]],r);let m=f.on("wheel.zoom"),v=f.on("dblclick.zoom");function y(e,n){return f?new Promise(i=>{p?.transform(e5(f,n?.duration,()=>i(!0)),e)}):Promise.resolve(!1)}function S(){p.on("zoom",null)}async function T(e,n,i){let o=e1(e),r=p?.constrain()(o,n,i);return r&&await y(r),new Promise(e=>e(r))}return p.wheelDelta(e4),{update:function({noWheelClassName:e,noPanClassName:n,onPaneContextMenu:i,userSelectionActive:o,panOnScroll:r,panOnDrag:a,panOnScrollMode:g,panOnScrollSpeed:y,preventScrolling:w,zoomOnPinch:x,zoomOnScroll:T,zoomOnDoubleClick:E,zoomActivationKeyPressed:M,lib:C,onTransformChange:N}){o&&!u.isZoomingOrPanning&&S();let O=!r||M||o?function({noWheelClassName:e,preventScrolling:n,d3ZoomHandler:i}){return function(o,r){if(!n&&"wheel"===o.type&&!o.ctrlKey||e2(o,e))return null;o.preventDefault(),i.call(this,o,r)}}({noWheelClassName:e,preventScrolling:w,d3ZoomHandler:m}):function({zoomPanValues:e,noWheelClassName:n,d3Selection:i,d3Zoom:o,panOnScrollMode:r,panOnScrollSpeed:a,zoomOnPinch:s,onPanZoomStart:l,onPanZoom:d,onPanZoomEnd:c}){return u=>{if(e2(u,n))return!1;u.preventDefault(),u.stopImmediatePropagation();let g=i.property("__zoom").k||1;if(u.ctrlKey&&s){let e=(0,b.Z)(u),n=g*Math.pow(2,e4(u));o.scaleTo(i,n,e,u);return}let p=1===u.deltaMode?20:1,f=r===h.Vertical?0:u.deltaX*p,m=r===h.Horizontal?0:u.deltaY*p;!en()&&u.shiftKey&&r!==h.Vertical&&(f=u.deltaY*p,m=0),o.translateBy(i,-(f/g)*a,-(m/g)*a,{internal:!0});let v=e0(i.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,l?.(u,v)),e.isPanScrolling&&(d?.(u,v),e.panScrollTimeout=setTimeout(()=>{c?.(u,v),e.isPanScrolling=!1},150))}}({zoomPanValues:u,noWheelClassName:e,d3Selection:f,d3Zoom:p,panOnScrollMode:g,panOnScrollSpeed:y,zoomOnPinch:x,onPanZoomStart:l,onPanZoom:s,onPanZoomEnd:d});if(f.on("wheel.zoom",O,{passive:!1}),!o){let e=function({zoomPanValues:e,onDraggingChange:n,onPanZoomStart:i}){return o=>{if(o.sourceEvent?.internal)return;let r=e0(o.transform);e.mouseButton=o.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=r,o.sourceEvent?.type==="mousedown"&&n(!0),i&&i?.(o.sourceEvent,r)}}({zoomPanValues:u,onDraggingChange:c,onPanZoomStart:l});p.on("start",e);let n=function({zoomPanValues:e,panOnDrag:n,onPaneContextMenu:i,onTransformChange:o,onPanZoom:r}){return a=>{e.usedRightMouseButton=!!(i&&e3(n,e.mouseButton??0)),a.sourceEvent?.sync||o([a.transform.x,a.transform.y,a.transform.k]),r&&!a.sourceEvent?.internal&&r?.(a.sourceEvent,e0(a.transform))}}({zoomPanValues:u,panOnDrag:a,onPaneContextMenu:!!i,onPanZoom:s,onTransformChange:N});p.on("zoom",n);let o=function({zoomPanValues:e,panOnDrag:n,panOnScroll:i,onDraggingChange:o,onPanZoomEnd:r,onPaneContextMenu:a}){return s=>{if(!s.sourceEvent?.internal){let l,d;if(e.isZoomingOrPanning=!1,a&&e3(n,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&a(s.sourceEvent),e.usedRightMouseButton=!1,o(!1),r&&(l=e.prevViewport,d=s.transform,l.x!==d.x||l.y!==d.y||l.zoom!==d.k)){let n=e0(s.transform);e.prevViewport=n,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{r?.(s.sourceEvent,n)},150*!!i)}}}}({zoomPanValues:u,panOnDrag:a,panOnScroll:r,onPaneContextMenu:i,onPanZoomEnd:d,onDraggingChange:c});p.on("end",o)}let I=function({zoomActivationKeyPressed:e,zoomOnScroll:n,zoomOnPinch:i,panOnDrag:o,panOnScroll:r,zoomOnDoubleClick:a,userSelectionActive:s,noWheelClassName:l,noPanClassName:d,lib:c}){return u=>{let h=e||n,g=i&&u.ctrlKey;if(1===u.button&&"mousedown"===u.type&&(e2(u,`${c}-flow__node`)||e2(u,`${c}-flow__edge`)))return!0;if(!o&&!h&&!r&&!a&&!i||s||e2(u,l)&&"wheel"===u.type||e2(u,d)&&("wheel"!==u.type||r&&"wheel"===u.type&&!e)||!i&&u.ctrlKey&&"wheel"===u.type)return!1;if(!i&&"touchstart"===u.type&&u.touches?.length>1)return u.preventDefault(),!1;if(!h&&!r&&!g&&"wheel"===u.type||!o&&("mousedown"===u.type||"touchstart"===u.type)||Array.isArray(o)&&!o.includes(u.button)&&"mousedown"===u.type)return!1;let p=Array.isArray(o)&&o.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||"wheel"===u.type)&&p}}({zoomActivationKeyPressed:M,panOnDrag:a,zoomOnScroll:T,panOnScroll:r,zoomOnDoubleClick:E,zoomOnPinch:x,userSelectionActive:o,noPanClassName:n,noWheelClassName:e,lib:C});p.filter(I),E?f.on("dblclick.zoom",v):f.on("dblclick.zoom",null)},destroy:S,setViewport:async function e(e,n){let i=e1(e);return await y(i,n),new Promise(e=>e(i))},setViewportConstrained:T,getViewport:function(){let e=f?(0,x.P2)(f.node()):{x:0,y:0,k:1};return{x:e.x,y:e.y,zoom:e.k}},scaleTo:function(e,n){return f?new Promise(i=>{p?.scaleTo(e5(f,n?.duration,()=>i(!0)),e)}):Promise.resolve(!1)},scaleBy:function(e,n){return f?new Promise(i=>{p?.scaleBy(e5(f,n?.duration,()=>i(!0)),e)}):Promise.resolve(!1)},setScaleExtent:function(e){p?.scaleExtent(e)},setTranslateExtent:function(e){p?.translateExtent(e)},syncViewport:function(e){if(f){let n=e1(e),i=f.property("__zoom");(i.k!==e.zoom||i.x!==e.x||i.y!==e.y)&&p?.transform(f,n,null,{sync:!0})}},setClickDistance:function(e){let n=!q(e)||e<0?0:e;p?.clickDistance(n)}}}function e8(e,n){return Math.max(0,n-e)}function e7(e,n){return Math.max(0,e-n)}function e9(e,n,i){return Math.max(0,n-e,e-i)}(c=v||(v={})).Line="line",c.Handle="handle";let te={width:0,height:0,x:0,y:0},tt={...te,pointerX:0,pointerY:0,aspectRatio:1};function tn({domNode:e,nodeId:n,getStoreItems:i,onChange:o,onEnd:r}){let a=(0,w.Z)(e);return{update:function({controlPosition:e,boundaries:s,keepAspectRatio:l,onResizeStart:d,onResize:c,onResizeEnd:u,shouldResize:h}){let g,p,f,m,v={...te},w={...tt},b=function(e){let n=e.includes("right")||e.includes("left"),i=e.includes("bottom")||e.includes("top");return{isHorizontal:n,isVertical:i,affectsX:e.includes("left"),affectsY:e.includes("top")}}(e),x=[],S=(0,y.Z)().on("start",e=>{let{nodeLookup:o,transform:r,snapGrid:a,snapToGrid:s,nodeOrigin:l}=i();if(!(g=o.get(n)))return;let{xSnapped:c,ySnapped:u}=es(e.sourceEvent,{transform:r,snapGrid:a,snapToGrid:s});if(w={...v={width:g.measured.width??0,height:g.measured.height??0,x:g.position.x??0,y:g.position.y??0},pointerX:c,pointerY:u,aspectRatio:v.width/v.height},p=void 0,g.parentId&&("parent"===g.extent||g.expandParent)){var h;f=(p=o.get(g.parentId))&&"parent"===g.extent?[[0,0],[(h=p).measured.width,h.measured.height]]:void 0}for(let[e,i]of(x=[],m=void 0,o))if(i.parentId===n&&(x.push({id:e,position:{...i.position},extent:i.extent}),"parent"===i.extent||i.expandParent)){let e=function(e,n,i){let o=n.position.x+e.position.x,r=n.position.y+e.position.y,a=e.measured.width??0,s=e.measured.height??0,l=i[0]*a,d=i[1]*s;return[[o-l,r-d],[o+a-l,r+s-d]]}(i,g,i.origin??l);m=m?[[Math.min(e[0][0],m[0][0]),Math.min(e[0][1],m[0][1])],[Math.max(e[1][0],m[1][0]),Math.max(e[1][1],m[1][1])]]:e}d?.(e,{...v})}).on("drag",e=>{let{transform:n,snapGrid:r,snapToGrid:a,nodeOrigin:d}=i(),u=es(e.sourceEvent,{transform:n,snapGrid:r,snapToGrid:a}),y=[];if(!g)return;let{x:S,y:T,width:E,height:M}=v,C={},N=g.origin??d,{width:O,height:I,x:D,y:k}=function(e,n,i,o,r,a,s,l){var d,c,u,h;let{affectsX:g,affectsY:p}=n,{isHorizontal:f,isVertical:m}=n,v=f&&m,{xSnapped:y,ySnapped:w}=i,{minWidth:b,maxWidth:x,minHeight:S,maxHeight:T}=o,{x:E,y:M,width:C,height:N,aspectRatio:O}=e,I=Math.floor(f?y-e.pointerX:0),D=Math.floor(m?w-e.pointerY:0),k=C+(g?-I:I),_=N+(p?-D:D),A=-a[0]*C,P=-a[1]*N,L=e9(k,b,x),j=e9(_,S,T);if(s){let e=0,n=0;g&&I<0?e=e8(E+I+A,s[0][0]):!g&&I>0&&(e=e7(E+k+A,s[1][0])),p&&D<0?n=e8(M+D+P,s[0][1]):!p&&D>0&&(n=e7(M+_+P,s[1][1])),L=Math.max(L,e),j=Math.max(j,n)}if(l){let e=0,n=0;g&&I>0?e=e7(E+I,l[0][0]):!g&&I<0&&(e=e8(E+k,l[1][0])),p&&D>0?n=e7(M+D,l[0][1]):!p&&D<0&&(n=e8(M+_,l[1][1])),L=Math.max(L,e),j=Math.max(j,n)}if(r){if(f){(L=Math.max(L,e9(k/O,S,T)*O),s)&&(L=Math.max(L,(g||p)&&(!g||p||!v)?e8(M+P+(g?I:-I)/O,s[0][1])*O:e7(M+P+k/O,s[1][1])*O));l&&(L=Math.max(L,(g||p)&&(!g||p||!v)?e7(M+(g?I:-I)/O,l[0][1])*O:e8(M+k/O,l[1][1])*O))}if(m){(j=Math.max(j,e9(_*O,b,x)/O),s)&&(j=Math.max(j,(g||p)&&(!p||g||!v)?e8(E+(p?D:-D)*O+A,s[0][0])/O:e7(E+_*O+A,s[1][0])/O));l&&(j=Math.max(j,(g||p)&&(!p||g||!v)?e7(E+(p?D:-D)*O,l[0][0])/O:e8(E+_*O,l[1][0])/O))}}D+=D<0?j:-j,I+=I<0?L:-L,r&&(v?k>_*O?D=((d=g,c=p,d?!c:c)?-I:I)/O:I=((u=g,h=p,u?!h:h)?-D:D)*O:f?(D=I/O,p=g):(I=D*O,g=p));let R=g?E+I:E,V=p?M+D:M;return{width:C+(g?-I:I),height:N+(p?-D:D),x:a[0]*I*(g?-1:1)+R,y:a[1]*D*(p?-1:1)+V}}(w,b,u,s,l,N,f,m),_=O!==E,A=I!==M,P=D!==S&&_,L=k!==T&&A;if(!P&&!L&&!_&&!A)return;if((P||L||1===N[0]||1===N[1])&&(C.x=P?D:v.x,C.y=L?k:v.y,v.x=C.x,v.y=C.y,x.length>0)){let e=D-S,n=k-T;for(let i of x)i.position={x:i.position.x-e+N[0]*(O-E),y:i.position.y-n+N[1]*(I-M)},y.push(i)}if((_||A)&&(C.width=_?O:v.width,C.height=A?I:v.height,v.width=C.width,v.height=C.height),p&&g.expandParent){let e=N[0]*(C.width??0);C.x&&C.x<e&&(v.x=e,w.x=w.x-(C.x-e));let n=N[1]*(C.height??0);C.y&&C.y<n&&(v.y=n,w.y=w.y-(C.y-n))}let j=function({width:e,prevWidth:n,height:i,prevHeight:o,affectsX:r,affectsY:a}){let s=e-n,l=i-o,d=[s>0?1:s<0?-1:0,l>0?1:l<0?-1:0];return s&&r&&(d[0]=-1*d[0]),l&&a&&(d[1]=-1*d[1]),d}({width:v.width,prevWidth:E,height:v.height,prevHeight:M,affectsX:b.affectsX,affectsY:b.affectsY}),R={...v,direction:j};!1!==h?.(e,R)&&(c?.(e,R),o(C,y))}).on("end",e=>{u?.(e,{...v}),r?.()});a.call(S)},destroy:function(){a.on(".drag",null)}}}}}]);